!function(e,t){function i(e,t,i){var n=t/2,a=i/2;this.animation=null,this.position={x:0,y:0},this.active=!1,this.elapsedTime=0,this.frame=0,this.timePerFrame=0,this.Init=function(t){this.position={x:t.x,y:t.y},this.animation=document.getElementById(e).animDetails,this.animation.Reset(),this.animation.Pause(!1),this.active=!0,this.elapsedTime=0;var i=this.animation.GetTotalDuration(),n=this.animation.GetTotalFrames();n>0&&(this.timePerFrame=i/n)},this.Update=function(){return 0==this.timePerFrame?void(this.active=!1):(this.elapsedTime+=GameManager.dt,void(this.elapsedTime>=this.animation.GetTotalDuration()?this.active=!1:this.frame=GameManager.MathFunctions.Clamp(this.elapsedTime/this.timePerFrame,0,this.animation.GetTotalFrames()-1)))},this.Draw=function(e){this.animation.SetFrame(Math.floor(this.frame)),this.animation.Draw(e,this.position.x-n,this.position.y-a,t,i)}}function n(e,t,n,a){var s=[];this.Trigger=function(e){for(var t=0;t<s.length;t++)if(!s[t].active){s[t].Init(e);break}},this.Init=function(){for(var e=0;e<s.length;e++)s[e].active=!1},this.Update=function(){for(var e=0;e<s.length;e++)s[e].active&&s[e].Update()},this.Draw=function(e){for(var t=0;t<s.length;t++)s[t].active&&s[t].Draw(e)};for(var o=0;e>o;o++){var r=new i(t,n,a);s.push(r)}}function a(e,t){var i={frames:1,duration:1,direction:"x",startPaused:!1,playOnce:!1,onComplete:null,reverse:!1,preventEffectReplace:!1};for(var n in t)i[n]=t[n];var a=i.time/i.frames;e.setAttribute("data-animated","true");for(var s=i.startPaused,o=0,r="x"==i.direction?e.naturalWidth/i.frames:e.naturalHeight/i.frames,h=[],l=0;l<i.frames;l++)h[l]={sx:"x"==i.direction?r*l:0,sy:"x"==i.direction?0:r*l,sw:"x"==i.direction?r:e.naturalWidth,sh:"x"==i.direction?e.naturalHeight:r};e.animDetails={preventEffectReplace:i.preventEffectReplace,elapsedTime:0,Pause:function(e){s=e},IsPaused:function(){return s},GetTotalDuration:function(){return i.time},GetTotalFrames:function(){return i.frames},Reset:function(){s=!1,o=0},SetFrame:function(e){o=e},SetOnComplete:function(e){i.onComplete=e},Reverse:function(e){i.reverse=e},Update:function(){s||(this.elapsedTime+=GameManager.dt,this.elapsedTime>=a&&(o++,this.elapsedTime=0,o>=i.frames&&(null!=i.onComplete&&i.onComplete(e),i.playOnce&&(s=!0),o=0)))},Draw:function(t,n,a,s,r,l){var m=i.reverse?i.frames-o-1:o,u=l||!1,g=s,d=r,c=0,p=0;if(u){var f=h[m].sw/h[m].sh,M=s/r,y=f>M?s/h[m].sw:r/h[m].sh;g=h[m].sw*y,d=h[m].sh*y,c=s>g?(s-g)/2:0,p=r>d?(r-d)/2:0}t.drawImage(e,h[m].sx,h[m].sy,h[m].sw,h[m].sh,n+c,a+p,g,d)}}}function s(){function e(){console.log("Audio error...")}var t=200;if(!GameManager.support.webAudio)return o();window.AudioContext=window.AudioContext||window.webkitAudioContext;var i=null,n={},a={},s={},r=1,h=!1,l={Init:function(){i=new AudioContext,i.createGain=i.createGain||i.createGainNode,i.createDelay=i.createDelay||i.createDelayNode,i.createScriptProcessor=i.createScriptProcessor||i.createJavaScriptNode,i.setTargetAtTime=i.setTargetAtTime||i.setTargetValueAtTime,s.gain=i.createGain(),s.gain.connect(i.destination)},LoadSound:function(a,o,r,h,l,m){var u="";if(u=GameManager.support.ogg?o+"/OGG/"+r+".ogg":o+"/WAV/"+r+".wav",console.log("Loading sound: - "+u),void 0!=n[a])return console.log("sound with this name already exists"),void m();n[a]={ready:!1,buffer:null,volume:i.createGain(),type:h},void 0!=l&&null!=l&&(n[a].volume.gain.value=l);var g=new XMLHttpRequest;g.open("GET",u,!0),g.responseType="arraybuffer",g.onload=function(){g.status==t?i.decodeAudioData(g.response,function(e){n[a].buffer=e,n[a].ready=!0,n[a].looping=!1,n[a].volume.connect(s.gain),void 0!=m&&null!=m&&m()},e):e()},g.send()},PlaySound:function(e,t,a,s){if(void 0==n[e]||null==n[e])return void console.log("playSound-> sound doesn't exist: "+e);if(!n[e].ready)return void console.log("playSound-> sound not ready: "+e);n[e].callback=a,n[e].isPlaying=!0;var o=function(){null!=n[e].timeoutCallback&&void 0!=n[e].timeoutCallback&&(clearTimeout(n[e].timeoutCallback),n[e].timeoutCallback=null,void 0!==n[e].source.onended&&(n[e].source.onended=function(){})),void 0!=n[e].callback&&n[e].callback(),n[e].isPlaying=!1};void 0!=s&&null!=s&&void 0!=a&&null!=a&&(n[e].timeoutCallback=setTimeout(o,s)),n[e].source=i.createBufferSource(),n[e].source.start=n[e].source.start||n[e].source.noteOn,n[e].source.stop=n[e].source.stop||n[e].source.noteOff,n[e].source.loop=t||!1,n[e].looping=n[e].source.loop,n[e].source.buffer=n[e].buffer,n[e].source.connect(n[e].volume),void 0!==n[e].source.onended?n[e].source.onended=o:n[e].timeout=setTimeout(o,1e3*n[e].buffer.duration),n[e].source.start(0)},StopSound:function(e){if(void 0==n[e]||null==n[e])return void console.log("stopSound-> sound doesn't exist "+e);if(!n[e].ready)return void console.log("stopSound-> sound not ready");if(void 0!=n[e].source&&null!=n[e].source)try{n[e].source.stop(0),void 0!==n[e].source.onended&&(n[e].source.onended=function(){}),void 0!=n[e].timeout&&null!=n[e].timeout&&clearTimeout(n[e].timeout)}catch(t){console.log(t.message)}},StopAllNonLoopSounds:function(){for(var e in n)n[e].looping||GameManager.audio.StopSound(e)},StopAllSounds:function(){a=[];for(var e in n)GameManager.audio.StopSound(e)},SetSoundVolume:function(e,t){return void 0==n[e]||null==n[e]?void console.log("setSoundVolume-> sound doesn't exist"):void(n[e].volume.gain.value=t)},SetMasterVolume:function(e){r=e,s.gain.gain.value=h?0:e},SetSoundSpeed:function(e,t){n[e].source.playbackRate.value=t},Mute:function(){h=!0,s.gain.gain.value=0},Unmute:function(){h=!1,s.gain.gain.value=r},Pause:function(){for(var e in n)n[e].isPlaying&&(this.StopSound(e),n[e].type==O.music&&(a[e]=n[e]))},Resume:function(){for(var e in a)this.PlaySound(e,n[e].looping,n[e].callback);a={}}};return l.Init(),l}function o(){var e=document.getElementById("gameSounds"),t={},i={},n=1,a=!1,s={Init:function(){},LoadSound:function(i,n,a,s,o,r){var h=n+"/OGG/"+a+".ogg",l=n+"/WAV/"+a+".wav",m=n+"/MP3/"+a+".mp3";console.log("Loading sound: - "+a);var u=document.createElement("audio"),g=document.createElement("source"),d=document.createElement("source"),c=document.createElement("source");c.setAttribute("type","audio/mpeg"),g.setAttribute("type","audio/ogg"),d.setAttribute("type","audio/wav"),c.src=m,g.src=h,d.src=l,u.appendChild(c),u.appendChild(g),u.appendChild(d),e.appendChild(u),u.setAttribute("preload","metadata"),u.load(),t[i]={elem:u,volume:o,looping:!1,type:s},void 0!=r&&null!=r&&r()},PlaySound:function(e,i,a,s){return void 0==t[e]||null==t[e]?void console.log("playSound-> sound doesn't exist: "+e):GameManager.support.android&&!GameManager.support.chrome&&t[e].type!=O.dialog?void(void 0!=a&&null!=a&&a()):(t[e].callback=a,t[e].isPlaying=!0,t[e].endCallback=function(){void 0!=t[e].callback&&null!=t[e].callback&&(null!=t[e].timeoutCallback&&void 0!=t[e].timeoutCallback&&(clearTimeout(t[e].timeoutCallback),void 0!=t[e].elem.onended?t[e].elem.onended=function(){}:void 0!=t[e].endCallback&&t[e].elem.removeEventListener("ended",t[e].endCallback)),t[e].callback()),t[e].isPlaying=!1},t[e].looping=t[e].elem.loop=i||!1,t[e].elem.volume=GameManager.MathFunctions.Clamp(t[e].volume*n,0,1),void 0!=s&&null!=s&&void 0!=a&&null!=a&&(t[e].timeoutCallback=setTimeout(t[e].endCallback,s)),void 0!=t[e].elem.onended?t[e].elem.onended=t[e].endCallback:(t[e].elem.removeEventListener("ended",t[e].endCallback),t[e].elem.addEventListener("ended",t[e].endCallback)),void t[e].elem.play())},StopSound:function(e){if(void 0==t[e]||null==t[e])return void console.log("stopSound-> sound doesn't exist "+e);try{t[e].elem.pause(),t[e].elem.currentTime=0,void 0!=t[e].elem.onended?t[e].elem.onended=function(){}:void 0!=t[e].endCallback&&t[e].elem.removeEventListener("ended",t[e].endCallback)}catch(i){console.log(i.message)}},StopAllNonLoopSounds:function(){for(var e in t)t[e].looping||GameManager.audio.StopSound(e)},StopAllSounds:function(){i=[];for(var e in t)GameManager.audio.StopSound(e)},SetSoundVolume:function(e,i){return void 0==t[e]||null==t[e]?void console.log("setSoundVolume-> sound doesn't exist "+e):(t[e].volume=i,void(t[e].elem.volume=GameManager.MathFunctions.Clamp(t[e].volume*n,0,1)))},SetMasterVolume:function(e){n=e;for(var i in t)t[i].elem.volume=GameManager.MathFunctions.Clamp(t[i].volume*(a?0:n),0,1)},SetSoundSpeed:function(){},Mute:function(){a=!0;for(var e in t)t[e].elem.volume=GameManager.MathFunctions.Clamp(0,0,1)},Unmute:function(){a=!1;for(var e in t)t[e].elem.volume=GameManager.MathFunctions.Clamp(t[e].volume*n,0,1)},Pause:function(){for(var e in t)t[e].isPlaying&&(this.StopSound(e),(t[e].type==O.music||t[e].type==O.effect)&&(i[e]=t[e]))},Resume:function(){for(var e in i)this.PlaySound(e,t[e].looping,t[e].callback);i={}}};return s.Init(),s}function r(){var e=navigator.userAgent.toLowerCase(),t={performanceMode:"normal",canvas:!1,touch:!!("ontouchstart"in window),iPod:e.search("ipod")>-1,iPhone:e.search("iphone")>-1,iPad:e.search("ipad")>-1,safari:e.search("safari")>-1,ie:e.search("msie")>-1,firefox:e.search("firefox")>-1,android:e.search("android")>-1,chrome:e.search("chrome")>-1,silk:e.search("silk")>-1,iOS:!1,mobile:!1,desktop:!1,multitouch:!1,ogg:!0,m4a:!0,mp3:!0,webAudio:!1};if(t.iOS=t.iPod||t.iPhone||t.iPad,t.mobile=t.iOS||t.android||t.silk,t.desktop=!t.mobile,t.iOS){try{var i=e.match(/(OS|os)\s(\d)_(\d)/);i=parseFloat(i[2].toString()+"."+i[3].toString()),7.1>i&&(t.performanceMode="low")}catch(n){t.performanceMode="low"}var a=CookieJar.Read("shouldUseLowQuality");null!=a&&parseInt(a)>0&&(t.performanceMode="low")}else t.mobile&&(t.performanceMode="low");t.touch&&(t.android?parseInt(e.slice(e.indexOf("android")+8))>2&&(t.multitouch=!0):t.multitouch=!0);var s=document.createElement("audio");!s.canPlayType||s.canPlayType&&""!=s.canPlayType('audio/ogg; codecs="vorbis"')||(t.ogg=!1,(t.ie||!s.canPlayType||""==s.canPlayType("audio/mp4"))&&(t.m4a=!1)),delete s;try{var o=void 0!=window.AudioContext?new AudioContext:new window.webkitAudioContext;o.createBufferSource(),delete o,t.webAudio=!0}catch(n){console.log("No support for HTML5 Web Audio API, use Audio tag instead.")}var r=document.createElement("canvas");try{t.canvas=!!r.getContext("2d")}catch(n){t.canvas=!!r.getContext}return delete r,t}function h(){return!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect}function l(e){return"low"==e?{svgClass:"performanceMode",floorClass:"perspective",drawDistance:400,drawFloor:!0,drawMaxAngle:.85,drawGradient:!1,drawAllProps:!1,maxRenderProps:100,horizon:262,frameTime:50}:"high"==e?{svgClass:"superMode",floorClass:"perspective",drawDistance:800,drawFloor:!0,drawMaxAngle:1.4,drawGradient:!0,drawAllProps:!0,maxRenderProps:999,horizon:250,frameTime:26}:{svgClass:"",floorClass:"perspective",drawDistance:800,drawFloor:!0,drawMaxAngle:1,drawGradient:!0,drawAllProps:!1,maxRenderProps:500,horizon:250,frameTime:33}}function m(e){e.parentNode.appendChild(e)}function u(){document.body.onkeydown=function(e){H[e.keyCode]=!0,W.indexOf(e.keyCode)>-1&&(e.preventDefault(),e.stopPropagation())},document.body.onkeyup=function(e){H[e.keyCode]=!1,W.indexOf(e.keyCode)>-1&&(e.preventDefault(),e.stopPropagation())}}function g(e){return void 0!=H[e]&&null!=H[e]?H[e]:!1}function d(){return g(37)}function c(){return g(39)}function p(){var e=!1,t={screen:$("#pauseScreenSvg")[0],toggle:$("#pauseToggleButton")[0],openButton:$("#pauseButtonOpen")[0],closeButton:$("#pauseButtonClose")[0],continueButton:$("#pauseContinueButton")[0],menuButton:$("#pauseMainMenuButton")[0]};return t.currentButtonGroup=t.openButton,t.Open=function(){e||(m(t.screen),$(t.screen).show(),e=!0,t.currentButtonGroup=t.closeButton,m(t.closeButton),m(t.toggle))},t.Close=function(){$(t.screen).hide(),e=!1,t.currentButtonGroup=t.openButton,m(t.openButton)},G({item:t.toggle,Down:function(){$(t.currentButtonGroup).children("image")[1].setAttribute("style","")},Up:function(){$(t.currentButtonGroup).children("image")[1].setAttribute("style","display:none;"),e?t.Close():t.Open()}}),G({item:t.continueButton,Down:function(){$(t.continueButton).children("image")[1].setAttribute("style","")},Up:function(){$(t.continueButton).children("image")[1].setAttribute("style","display:none;"),t.Close()}}),G({item:t.menuButton,Down:function(){$(t.menuButton).children("image")[1].setAttribute("style","")},Up:function(){$(t.menuButton).children("image")[1].setAttribute("style","display:none;"),GameManager.sceneManager.ChangeScene("menuScene"),t.Close()}}),t}function f(){var e={fillstyle:"white",strokeStyle:"black",font:"30pt badaboom",strokeWidth:1},t=30,i=2,n=25,a=1,s=0,o=1,r=1.5,h=[];this.Init=function(){h=[]},this.Update=function(){for(var e=0;e<h.length;e++)h[e].position.y-=n*GameManager.dt,h[e].scale=GameManager.MathFunctions.Lerp(h[e].elapsedTime/i,o,r),h[e].opacity=GameManager.MathFunctions.Lerp(h[e].elapsedTime/i,a,s),h[e].elapsedTime+=GameManager.dt,h[e].elapsedTime>=i&&h.shift()},this.Draw=function(i){i.fillStyle=e.fillstyle,i.font=e.font,i.strokeStyle=e.strokeStyle,i.lineWidth=e.strokeWidth;for(var n=0;n<h.length;n++)i.save(),i.globalAlpha=h[n].opacity,i.translate(h[n].position.x,h[n].position.y-t/2),i.scale(h[n].scale,h[n].scale),i.fillText(h[n].text,0,0),i.strokeText(h[n].text,0,0),i.restore()},f.Trigger=function(e,t){h.push({text:e,position:t,elapsedTime:0,opacity:1,scale:1})}}function M(){var e={loading:"loading",delay:"delay",idle:"idle"},t=[144,400,700,45],i="Loading...",n=t[1]+32,a={},s=null,o=0,r=e.idle,h=1,l=1,m=!0;this.AddScene=function(e){a[e.name]=e},this.Reset=function(){if(null!=s){var e=s.name;s.UnInit(),this.ChangeScene(e)}},this.ChangeScene=function(t,i,n){function u(){r=e.delay,h=1,l=h}m=void 0!=i?i:!0,$("#"+U).hide(),r=e.loading,o=0,this.Draw(GameManager.frontContext),null!=s&&s.UnInit(),GameManager.audio.StopAllSounds(),s=a[t],s.args=n,void 0!=s.preloadItems&&null!=s.preloadItems?GameManager.PreLoadFromList(s.preloadItems.images,s.preloadItems.sounds,function(){u()},function(e){o=e}):u()},this.Update=function(){r==e.idle&&s.Update(),r==e.delay&&(h-=GameManager.dt,0>h&&(s.Init(),r=e.idle,$("#"+U).show()))},this.Draw=function(a){r!=e.loading&&r!=e.delay||!m?r==e.idle&&s.Draw(a):(GameManager.frontContext.setTransform(1,0,0,1,0,0),GameManager.frontContext.fillStyle="black",GameManager.frontContext.fillRect(0,0,988,556),a.drawImage(document.getElementById(GameManager.loadingImage),0,0,988,566),r==e.delay&&(a.globalAlpha=h/l),GameManager.frontContext.fillStyle="#222222",a.strokeStyle="black",a.lineWidth=2,GameManager.frontContext.fillRect(t[0],t[1],t[2],t[3]),GameManager.frontContext.strokeRect(t[0],t[1],t[2],t[3]),GameManager.frontContext.fillStyle="#005500",GameManager.frontContext.textAlign="center",GameManager.frontContext.font="26pt Calibri",GameManager.frontContext.fillText(i,t[0]+t[2]/2,n),GameManager.frontContext.fillStyle="green",GameManager.frontContext.fillRect(t[0],t[1],t[2]*o,t[3]),a.save(),a.beginPath(),a.moveTo(t[0],t[1]),a.lineTo(t[0]+t[2]*o,t[1]),a.lineTo(t[0]+t[2]*o,t[1]+t[3]),a.lineTo(t[0],t[1]+t[3]),a.closePath(),a.clip(),GameManager.frontContext.fillStyle="white",GameManager.frontContext.fillText(i,t[0]+t[2]/2,n),a.restore(),a.globalAlpha=1)}}function y(e,t){function i(){n=setTimeout(i,e),t()}if(!isNaN(e)&&void 0!=t&&null!=t){var n=null;return{Start:function(){i()},Stop:function(){clearTimeout(n)}}}}function v(e){$(e).unbind("contextmenu"),$(e).unbind("mousedown"),$(e).unbind("mouseup"),$(e).unbind("mousemove"),$(e).unbind("mouseleave"),$(e).unbind("click"),$(e).unbind("touchstart"),$(e).unbind("touchend"),$(e).unbind("touchmove")}function b(){GameManager.support.iOS&&(document.ontouchstart=function(e){e.preventDefault()},document.ontouchmove=function(e){e.preventDefault()})}function G(e){var t={item:null,Down:function(){},Up:function(){},Move:function(){},stopEvent:!0,allowMultiple:!1,allowUpWithoutDown:!0};for(var i in e)t[i]=e[i];if(void 0!=t.item&&null!=t.item){v(e.item),t.item.TouchEventInfo=t;var n=!1,a=!1,s=null,o=null;$(t.item).on("contextmenu",function(){return!1}),GameManager.support.desktop&&($(t.item).on("mousedown",function(e){if(!(a&&!t.allowMultiple||n&&!t.allowMultiple)){a=!0;var i=GameManager.screenScale>0?e.pageX/GameManager.screenScale:e.pageX,s=GameManager.screenScale>0?e.pageY/GameManager.screenScale:e.pageY;t.Down(e,i,s,this),t.stopEvent&&e.stopPropagation()}}),$(t.item).on("mouseup",function(e){if(a||t.allowUpWithoutDown){a=!1;var i=GameManager.screenScale>0?e.pageX/GameManager.screenScale:e.pageX,n=GameManager.screenScale>0?e.pageY/GameManager.screenScale:e.pageY;t.Up(e,i,n,this),t.stopEvent&&e.stopPropagation()}}),$(t.item).on("mouseleave",function(e){if(a){a=!1;var i=GameManager.screenScale>0?e.pageX/GameManager.screenScale:e.pageX,n=GameManager.screenScale>0?e.pageY/GameManager.screenScale:e.pageY;t.Up(e,i,n,this),t.stopEvent&&e.stopPropagation()}}),$(t.item).on("mousemove",function(e){if(null!=s){var i=e.pageX-s.pageX,n=e.pageY-s.pageY;i=GameManager.screenScale>0?i/GameManager.screenScale:i,n=GameManager.screenScale>0?n/GameManager.screenScale:n,(0!=i||0!=n)&&t.Move(e,i,n,this)}s=e,t.stopEvent&&e.stopPropagation()})),GameManager.support.mobile&&($(t.item).on("click",function(e){e.preventDefault()}),$(t.item).on("touchstart",function(e){if(e.preventDefault(),!(a&&!t.allowMultiple||n&&!t.allowMultiple)){n=!0;var i=GameManager.screenScale>0?e.originalEvent.touches[0].pageX/GameManager.screenScale:e.originalEvent.touches[0].pageX,s=GameManager.screenScale>0?e.originalEvent.touches[0].pageY/GameManager.screenScale:e.originalEvent.touches[0].pageY;t.Down(e,i,s,this),o=null,t.stopEvent&&e.stopPropagation()}}),$(t.item).on("touchend",function(e){if(e.preventDefault(),n||t.allowUpWithoutDown){n=!1;var i=0,a=0;null!=o&&(i=GameManager.screenScale>0?o[0]/GameManager.screenScale:o[0],a=GameManager.screenScale>0?o[1]/GameManager.screenScale:o[1]),t.Up(e,i,a,this),t.stopEvent&&e.stopPropagation()}}),$(t.item).on("touchmove",function(e){var i=e.originalEvent;i.preventDefault();try{if(null!=o){var n=i.touches[0].pageX-o[0],a=i.touches[0].pageY-o[1];n=GameManager.screenScale>0?n/GameManager.screenScale:n,a=GameManager.screenScale>0?a/GameManager.screenScale:a,(0!=n||0!=a)&&t.Move(i,n,a,this)}o=[i.touches[0].pageX,i.touches[0].pageY]}catch(s){}t.stopEvent&&i.stopPropagation()}))}}function S(e,t,i,n,a,s){var o={up:"",down:"",Event:function(){},sound:null,text:null,extraRadius:0,allowUpWithoutDown:!0};for(var r in s)o[r]=s[r];var h=document.createElementNS(svgns,"g");h.className.baseVal="gameButton";var l=document.createElementNS(svgns,"image"),m=document.createElementNS(svgns,"image");if(l.setAttributeNS(xlinkns,"href",o.up),m.setAttributeNS(xlinkns,"href",o.down),l.setAttribute("preserveAspectRatio","none"),m.setAttribute("preserveAspectRatio","none"),h.setAttribute("transform","translate("+e+","+t+")"),l.setAttribute("x",0),l.setAttribute("class","upimg"),l.setAttribute("y",0),l.setAttribute("width",i),l.setAttribute("height",n),m.setAttribute("x",0),m.setAttribute("class","downimg"),m.setAttribute("y",0),m.setAttribute("width",i),m.setAttribute("height",n),o.extraRadius>0){var u=document.createElementNS(svgns,"circle");u.setAttribute("fill","rgba(0,0,0,0)"),u.setAttribute("r",o.extraRadius),u.setAttribute("cx",i/2),u.setAttribute("cy",n/2),h.appendChild(u)}var g=null;return null!=o.text&&(g=document.createElementNS(svgns,"text"),g.setAttribute("x",i/2),g.setAttribute("y",40),g.setAttribute("font-size",30),g.setAttribute("fill","white"),g.setAttribute("stroke","black"),g.setAttribute("stroke-width",.5),g.setAttribute("text-anchor","middle"),g.textContent=o.text),G({item:h,Down:function(){l.setAttribute("style","display:none;"),m.setAttribute("style","")},Up:function(){m.setAttribute("style","display:none;"),l.setAttribute("style",""),null!=o.sound&&GameManager.audio.PlaySound(o.sound),o.Event()},allowUpWithoutDown:o.allowUpWithoutDown}),a.appendChild(h),h.appendChild(m),h.appendChild(l),g&&h.appendChild(g),h.setText=function(e){g.textContent=e},h}function w(e,t,i,n,a,s){GameManager.frontContext.lineWidth=s||1,GameManager.frontContext.beginPath(),GameManager.frontContext.arc(e,t,i,0,2*Math.PI),void 0!=n&&(GameManager.frontContext.fillStyle=n||"#000000",GameManager.frontContext.fill()),void 0!=a&&(GameManager.frontContext.strokeStyle=a||"#000000",GameManager.frontContext.stroke())}function _(){var e=440,t=10,i=180,n=320,a="big_splash",s="bird_hit",o="bird_dive";this.IMAGE_INFO={image_fly:"",image_dive:"",image_rise:""},this.STATES={flying:"flying",diving:"diving",rising:"rising"},this.stateTime=0,this.destination={x:0,y:0},this.startPosition={x:0,y:0},this.elapsedTime=0,this.currentAnimation=null,this.state=null,this.position={x:0,y:0},this.width=0,this.height=0,this.startY=0,this.waterLevelY=0,this.movingRight=!0,this.moveSpeed=0,this.diveAngle=0,this.diveDuration=0,this.riseDuration=0,this.underWater=!1,this.collisionRadius=0,this.checkCollisions=null,this.checkDebrisCollisions=null,this.maxFish=0,this.fishCaught=0,this.capturedFishImage="",this.diveRotation=0,this.riseRotation=0,this.catchSound="",this.riseHeight=0,this.sinAngle=0,this.riseLength=0,this.riseDistance=0,this.diveHeight=0,this.diveLength=0,this.diveDistance=0,_.prototype.Init=function(){this.SetState(this.STATES.flying),this.fishCaught=0,this.moveSpeed=GameManager.MathFunctions.RandomInt(i,n)},_.prototype.Update=function(){switch(this.state){case this.STATES.flying:this.movingRight?(this.position.x+=this.moveSpeed*GameManager.dt,this.position.x+this.width/2>=GameManager.FrameSize.width&&(this.movingRight=!1,this.moveSpeed=GameManager.MathFunctions.RandomInt(i,n))):(this.position.x-=this.moveSpeed*GameManager.dt,this.position.x-this.width/2<=0&&(this.movingRight=!0,this.moveSpeed=GameManager.MathFunctions.RandomInt(i,n)));break;case this.STATES.diving:if(this.elapsedTime+=GameManager.dt,this.elapsedTime>=this.diveDuration){this.Rise();break}if(!this.underWater&&this.position.y+t>e&&(this.underWater=!0,GameManager.splashManager.Trigger({x:this.position.x,y:e}),GameManager.audio.PlaySound(a,!1)),this.stateTime=this.elapsedTime/this.diveDuration,this.position.x=GameManager.MathFunctions.Lerp(this.stateTime,this.startPosition.x,this.destination.x),this.position.y=GameManager.MathFunctions.Lerp(this.stateTime,this.startPosition.y,this.destination.y),null!=this.checkCollisions&&this.fishCaught<this.maxFish){var o=this.checkCollisions(this);null!=o&&(this.fishCaught++,this.capturedFishImage=o.image)}null!=this.checkDebrisCollisions&&this.checkDebrisCollisions(this)&&(this.Rise(),GameManager.hitManager.Trigger(this.position),GameManager.audio.PlaySound(s,!1));break;case this.STATES.rising:if(this.elapsedTime+=GameManager.dt,this.elapsedTime>=this.riseDuration){this.SetState(this.STATES.flying);break}if(this.underWater&&this.position.y+t<e&&(this.underWater=!1,GameManager.splashManager.Trigger({x:this.position.x,y:e})),this.stateTime=this.elapsedTime/this.riseDuration,this.position.x=GameManager.MathFunctions.Lerp(this.stateTime,this.startPosition.x,this.destination.x),this.position.y=GameManager.MathFunctions.Lerp(this.stateTime,this.startPosition.y,this.destination.y),null!=this.checkCollisions&&this.fishCaught<this.maxFish){var o=this.checkCollisions(this);null!=o&&(this.fishCaught++,this.capturedFishImage=o.image)}}this.currentAnimation.Update()},_.prototype.Draw=function(e){e.save(),e.translate(this.position.x,this.position.y),this.movingRight?this.state==this.STATES.diving?e.rotate(GameManager.MathFunctions.DegToRad(this.diveRotation)):this.state==this.STATES.rising&&e.rotate(GameManager.MathFunctions.DegToRad(-this.riseRotation)):(this.state==this.STATES.diving?e.rotate(GameManager.MathFunctions.DegToRad(-this.diveRotation)):this.state==this.STATES.rising&&e.rotate(GameManager.MathFunctions.DegToRad(this.riseRotation)),e.scale(-1,1)),this.currentAnimation.IsPaused()&&this.currentAnimation.SetFrame(this.currentAnimation.GetTotalFrames()-1),this.currentAnimation.Draw(e,-this.width/2,-this.height/2,this.width,this.height),e.restore(),GameManager.debugDraw&&w(this.position.x,this.position.y,this.collisionRadius,"rgba(0, 0, 255, 0.2)","rgba(255, 255, 255, 1)",1)},_.prototype.Dive=function(){GameManager.audio.PlaySound(o,!1),this.SetState(this.STATES.diving),this.destination=this.GetDiveDestination(),this.startPosition={x:this.position.x,y:this.position.y},GameManager.energy=GameManager.MathFunctions.Clamp(GameManager.energy-A.ENERGY_DIVE_DECREASE,0,A.MAX_ENERGY),GameManager.tutorialManager.hasDove=!0},_.prototype.Rise=function(){this.SetState(this.STATES.rising),this.riseHeight=this.position.y-this.startY,this.sinAngle=Math.sin(GameManager.MathFunctions.DegToRad(this.diveAngle)),this.riseLength=this.riseHeight/(this.sinAngle>0?this.sinAngle:1),this.riseDistance=Math.sqrt(Math.pow(this.riseLength,2)-Math.pow(this.riseHeight,2)),this.movingRight||(this.riseDistance*=-1),this.destination={x:this.position.x+this.riseDistance,y:this.startY},this.startPosition={x:this.position.x,y:this.position.y}},_.prototype.GetDiveDestination=function(){return this.diveHeight=this.waterLevelY-this.position.y,this.sinAngle=Math.sin(GameManager.MathFunctions.DegToRad(this.diveAngle)),this.diveLength=this.diveHeight/(this.sinAngle>0?this.sinAngle:1),this.diveDistance=Math.sqrt(Math.pow(this.diveLength,2)-Math.pow(this.diveHeight,2)),this.movingRight||(this.diveDistance*=-1),{x:this.position.x+this.diveDistance,y:this.waterLevelY}},_.prototype.SetState=function(e){switch(this.state=e,this.elapsedTime=0,e){case this.STATES.flying:this.fishCaught=0,this.underWater=!1,this.currentAnimation=document.getElementById(this.IMAGE_INFO.image_fly).animDetails;break;case this.STATES.diving:this.currentAnimation=document.getElementById(this.IMAGE_INFO.image_dive).animDetails,this.currentAnimation.Reset();break;case this.STATES.rising:this.currentAnimation=document.getElementById(this.IMAGE_INFO.image_rise).animDetails}},_.prototype.GetDiveDuration=function(){return this.diveDuration+this.riseDuration}}function x(){this.IMAGE_INFO={image_fly:"image_osprey_fly",image_dive:"image_osprey_dive",image_rise:"image_osprey_rise"};var e=455,t=100,i=220,n=210,a=i/2,s=n/2+t,o=52,r=.75,h=.75,l=45,m=1,u={x:-30,y:50},g={x:30,y:50},d={x:-50,y:10},c=1.5,p="osprey_catch";this.showFish=!1,this.fishOffset={x:0,y:0},this.fishPosition={x:0,y:0},this.fishOpacity=1,this.fishVisibleCountdown=c,this.Init=function(){_.prototype.Init.call(this),this.width=i,this.height=n,this.position.x=a,this.position.y=s,this.startY=s,this.waterLevelY=e,this.movingRight=!0,this.diveAngle=o,this.diveDuration=r,this.riseDuration=h,this.collisionRadius=l,this.maxFish=m,this.fishOffset={x:0,y:0},this.showFish=!1,this.fishOpacity=1,this.fishVisibleCountdown=c,this.catchSound=p},this.Update=function(){if(_.prototype.Update.call(this),!this.showFish&&this.fishCaught>0&&(this.showFish=!0,this.fishOpacity=1,this.fishVisibleCountdown=c),this.showFish){switch(this.state){case this.STATES.diving:this.fishOffset={x:g.x,y:g.y};break;case this.STATES.rising:this.fishOffset={x:u.x,y:u.y};break;case this.STATES.flying:this.fishOffset={x:d.x,y:d.y}}this.movingRight||(this.fishOffset.x*=-1),this.fishOpacity=GameManager.MathFunctions.Lerp(this.fishVisibleCountdown/c,0,1),this.fishOpacity=GameManager.MathFunctions.Clamp(this.fishOpacity,0,1),this.fishVisibleCountdown-=GameManager.dt,this.fishVisibleCountdown<=0&&(this.showFish=!1)}},this.Draw=function(e){this.showFish&&(e.save(),e.globalAlpha=this.fishOpacity,this.fishPosition={x:this.position.x+this.fishOffset.x-E.INITIAL_WIDTH/2,y:this.position.y+this.fishOffset.y-E.INITIAL_HEIGHT/2},e.drawImage(document.getElementById(this.capturedFishImage),this.fishPosition.x,this.fishPosition.y,E.INITIAL_WIDTH,E.INITIAL_HEIGHT),e.restore()),_.prototype.Draw.call(this,e)}}function T(){this.IMAGE_INFO={image_fly:"image_pelican_fly",image_dive:"image_pelican_dive",image_rise:"image_pelican_rise"};var e=610,t=0,i=200,n=190,a=GameManager.FrameSize.width-i/2,s=n/2+t,o=78,r=1.2,h=1.6,l=30,m=Number.MAX_VALUE,u={x:30,y:-50},g={x:-10,y:40},d={x:50,y:10},c=2.5,p="pelican_catch";this.showFish=!1,this.fishOffset={x:0,y:0},this.fishPosition={x:0,y:0},this.fishOpacity=1,this.fishVisibleCountdown=c,this.Init=function(){_.prototype.Init.call(this),this.width=i,this.height=n,this.position.x=a,this.position.y=s,this.startY=s,this.waterLevelY=e,this.movingRight=!1,this.diveAngle=o,this.diveDuration=r,this.riseDuration=h,this.diveRotation=o,this.riseRotation=o,this.collisionRadius=l,this.maxFish=m,this.fishOffset={x:0,y:0},this.showFish=!1,this.fishOpacity=1,this.fishVisibleCountdown=c,this.catchSound=p},this.Update=function(){if(_.prototype.Update.call(this),!this.showFish&&this.fishCaught>0&&(this.showFish=!0,this.fishOpacity=1,this.fishVisibleCountdown=c),this.showFish){switch(this.state){case this.STATES.diving:this.fishOffset={x:g.x,y:g.y};break;case this.STATES.rising:this.fishOffset={x:u.x,y:u.y};break;case this.STATES.flying:this.fishOffset={x:d.x,y:d.y}}this.movingRight||(this.fishOffset.x*=-1),this.fishOpacity=GameManager.MathFunctions.Lerp(this.fishVisibleCountdown/c,0,1),this.fishOpacity=GameManager.MathFunctions.Clamp(this.fishOpacity,0,1),this.fishVisibleCountdown-=GameManager.dt,this.fishVisibleCountdown<=0&&(this.showFish=!1)}},this.Draw=function(e){this.showFish&&(e.save(),e.globalAlpha=this.fishOpacity,this.fishPosition={x:this.position.x+this.fishOffset.x-E.INITIAL_WIDTH/2,y:this.position.y+this.fishOffset.y-E.INITIAL_HEIGHT/2},e.drawImage(document.getElementById(this.capturedFishImage),this.fishPosition.x,this.fishPosition.y,E.INITIAL_WIDTH,E.INITIAL_HEIGHT),e.restore()),_.prototype.Draw.call(this,e)}}function C(){var e=["image_kelp_1","image_kelp_2","image_kelp_3"],t=485,i=5,n=10,a=100,s=140,o=50,r=100,h=2*Math.PI,l=15,m={x:0,y:-40},u=o;this.position={x:0,y:0},this.width=a,this.height=s,this.active=!1,this.collisionRadius=l,this.collisionOffset=m,this.image=e[0],this.wave=0,this.Init=function(){u=GameManager.MathFunctions.RandomInt(o,r),this.position.x=GameManager.gameScreen.x-this.width/2,this.position.y=t,this.active=!0,this.image=e[GameManager.MathFunctions.RandomInt(0,e.length-1)]},this.Update=function(){for(this.position.x+=u*GameManager.dt,this.position.x+this.width/2>=GameManager.gameScreen.width&&(this.position.x=GameManager.gameScreen.x-this.width/2,this.active=!1),this.wave=(this.position.x+Math.abs(GameManager.gameScreen.x))/GameManager.gameScreen.width*h*n;this.wave>h;)this.wave-=h;this.position.y=t+Math.sin(this.wave)*i},this.Draw=function(e){e.drawImage(document.getElementById(this.image),this.position.x-this.width/2,this.position.y-this.height/2,this.width,this.height),GameManager.debugDraw&&w(this.position.x+this.collisionOffset.x,this.position.y+this.collisionOffset.y,this.collisionRadius,"rgba(255, 0, 0, 0.2)","rgba(255, 255, 255, 1)",1)},this.GetCollisionPosition=function(){return{x:this.position.x+this.collisionOffset.x,y:this.position.y+this.collisionOffset.y}}}function I(e){var t=[],i=!0,n="chris_obstacle",a=3,s=["chris_hit1","chris_hit2","chris_hit3"],o=15,r=20,h=5,l=10;for(this.spawnCountdown=0,this.elapsedTime=0,this.minSpawnTime=o,this.maxSpawnTime=r,this.debrisCounter=0,this.Init=function(){for(this.debrisCounter=0;this.debrisCounter<t.length;this.debrisCounter++)t[this.debrisCounter].active=!1;this.spawnCountdown=GameManager.MathFunctions.RandomInt(this.minSpawnTime,this.maxSpawnTime),this.elapsedTime=0},this.Update=function(){if(0!=GameManager.difficutlyProgressionDuration)for(this.elapsedTime<GameManager.difficutlyProgressionDuration&&(this.elapsedTime=GameManager.MathFunctions.Clamp(this.elapsedTime+GameManager.dt,0,GameManager.difficutlyProgressionDuration),this.minSpawnTime=GameManager.MathFunctions.Lerp(this.elapsedTime/GameManager.difficutlyProgressionDuration,o,h),this.maxSpawnTime=GameManager.MathFunctions.Lerp(this.elapsedTime/GameManager.difficutlyProgressionDuration,r,l)),this.spawnCountdown-=GameManager.dt,this.spawnCountdown<=0&&(this.Spawn(),this.spawnCountdown=GameManager.MathFunctions.RandomInt(this.minSpawnTime,this.maxSpawnTime)),this.debrisCounter=0;this.debrisCounter<t.length;this.debrisCounter++)t[this.debrisCounter].active&&t[this.debrisCounter].Update()
},this.Draw=function(e){for(this.debrisCounter=0;this.debrisCounter<t.length;this.debrisCounter++)t[this.debrisCounter].active&&t[this.debrisCounter].Draw(e)},this.Spawn=function(){for(1==i&&(i=!1,GameManager.audio.PlaySound(n,!1)),this.debrisCounter=0;this.debrisCounter<t.length;this.debrisCounter++)if(!t[this.debrisCounter].active){t[this.debrisCounter].Init();break}},this.CheckCollisions=function(e){for(this.debrisCounter=0;this.debrisCounter<t.length;this.debrisCounter++)if(t[this.debrisCounter].active){var i=t[this.debrisCounter].collisionRadius+e.collisionRadius,n=t[this.debrisCounter].GetCollisionPosition().x-e.position.x,o=t[this.debrisCounter].GetCollisionPosition().y-e.position.y;if(i*i>n*n+o*o)return GameManager.audio.PlaySound(s[GameManager.MathFunctions.RandomInt(0,a-1)],!1),!0}return!1},this.debrisCounter=0;this.debrisCounter<e;this.debrisCounter++){var m=new C;t.push(m)}}function F(){var e=0,t="end_background",i="chris_outOfEnergy",n="chris_outOfEnergyCheers",a={screen:$("#endGameScreenSvg")[e],endTitle:$("#endTitle")[e],scoreText:$("#endScoreText")[e],playButton:$("#playAgainButton")[e],menuButton:$("#mainMenuButton")[e]};return a.Open=function(){m(a.screen),$(a.screen).show(),0==GameManager.score?(a.endTitle.textContent="TRY AGAIN!",a.scoreText.textContent="You caught "+GameManager.score+" fishmobiles!"):1==GameManager.score?(a.endTitle.textContent="GREAT JOB!",a.scoreText.textContent="You caught "+GameManager.score+" fishmobile!"):(a.endTitle.textContent="GREAT JOB!",a.scoreText.textContent="You caught "+GameManager.score+" fishmobiles!"),GameManager.Pause(),GameManager.audio.StopAllSounds(),GameManager.audio.PlaySound(t,!0),0==GameManager.score?GameManager.audio.PlaySound(i,!1):GameManager.audio.PlaySound(n,!1)},a.Close=function(){$(a.screen).hide(),GameManager.Resume()},G({item:a.playButton,Down:function(){$(a.playButton).children("image")[1].setAttribute("style",""),$(a.playButton).children("text")[0].setAttribute("fill","black"),$(a.playButton).children("text")[0].setAttribute("stroke","white")},Up:function(){$(a.playButton).children("image")[1].setAttribute("style","display:none;"),$(a.playButton).children("text")[0].setAttribute("fill","white"),$(a.playButton).children("text")[0].setAttribute("stroke","black"),GameManager.sceneManager.ChangeScene("gameScene"),a.Close()}}),G({item:a.menuButton,Down:function(){$(a.menuButton).children("image")[1].setAttribute("style",""),$(a.menuButton).children("text")[0].setAttribute("fill","black"),$(a.menuButton).children("text")[0].setAttribute("stroke","white")},Up:function(){$(a.menuButton).children("image")[1].setAttribute("style","display:none;"),$(a.menuButton).children("text")[0].setAttribute("fill","white"),$(a.menuButton).children("text")[0].setAttribute("stroke","black"),GameManager.sceneManager.ChangeScene("menuScene"),a.Close()}}),a}function A(){A.MAX_ENERGY=100,A.ENERGY_DELTA_DECREASE=2,A.ENERGY_DIVE_DECREASE=4,A.ENERGY_CATCH_INCREASE=10;var e="energyAlert",t=25,i={x:294,y:10,width:400,height:30},n=2,a={x:i.x+n,y:i.y,width:i.width-2*n,height:i.height-2*n};this.progressRemaining=1,this.tutorialGiven=!1,this.Init=function(){this.progressRemaining=1},this.Update=function(){GameManager.maxEnergy>0&&(this.progressRemaining=GameManager.MathFunctions.Clamp(GameManager.energy/GameManager.maxEnergy,0,1),!this.tutorialGiven&&this.progressRemaining*A.MAX_ENERGY<t&&(this.tutorialGiven=!0,GameManager.audio.StopAllNonLoopSounds(),FishmobileAudio.PlayRandomBro(e,!1)))},this.Draw=function(e){e.save(),e.lineWidth=i.height,e.strokeStyle="#ffffff",e.beginPath(),e.moveTo(i.x,i.y+i.height/2),e.lineTo(i.x+i.width,i.y+i.height/2),e.stroke(),e.lineWidth=a.height,e.strokeStyle="#330000",e.beginPath(),e.moveTo(a.x,a.y+i.height/2),e.lineTo(a.x+a.width,a.y+i.height/2),e.stroke(),e.lineWidth=a.height,e.strokeStyle="#ff5500",e.beginPath(),e.moveTo(a.x,a.y+i.height/2),e.lineTo(a.x+a.width*this.progressRemaining,a.y+i.height/2),e.stroke(),e.restore()}}function E(){var e=475,t=525,i=150,n=440;E.INITIAL_WIDTH=80,E.INITIAL_HEIGHT=40;var a=50,s=150,o=200,r={x:0,y:0},h=4,l=10,m=2,u=100,g=2*Math.PI,d=3*Math.PI,c="small_splash";E.STATE={jumping:"jumping",diving:"diving",none:"none"},this.image=null,this.lastPosition={x:0,y:0},this.position={x:0,y:0},this.defaultY=0,this.width=E.INITIAL_WIDTH,this.height=E.INITIAL_HEIGHT,this.moveRight=!0,this.moveSpeed=0,this.opacity=1,this.collisionRadius=30,this.state=E.STATE.none,this.rotation=0,this.actionCountdown=0,this.actionComplete=!1,this.underWater=!0,this.Init=function(i,n){this.image=i[GameManager.MathFunctions.RandomInt(0,i.length-1)],this.position.y=GameManager.MathFunctions.RandomInt(e,t),this.defaultY=this.position.y,this.moveRight=GameManager.MathFunctions.RandomInt(0,1),this.moveSpeed=GameManager.MathFunctions.RandomInt(a,s),this.opacity=1,this.height=n?2*E.INITIAL_HEIGHT:E.INITIAL_HEIGHT,this.actionCountdown=GameManager.MathFunctions.RandomInt(h,l),this.actionComplete=!1,this.state=E.STATE.none,this.position.x=this.moveRight?GameManager.gameScreen.x-this.width/2:GameManager.gameScreen.width+this.width/2},this.Update=function(){switch(this.lastPosition={x:this.position.x,y:this.position.y},this.moveRight?this.position.x+=this.moveSpeed*GameManager.dt:this.position.x-=this.moveSpeed*GameManager.dt,this.state){case E.STATE.jumping:this.actionComplete?(!this.underWater&&this.position.y>n&&(this.underWater=!0,GameManager.splashManager.Trigger({x:this.position.x,y:n}),GameManager.audio.PlaySound(c,!1)),this.position.y!=this.defaultY?this.position.y=Math.min(this.position.y+o*GameManager.dt,this.defaultY):this.SetState(E.STATE.none)):(this.position.y-=o*GameManager.dt,this.underWater&&this.position.y<n&&(this.underWater=!1,GameManager.splashManager.Trigger({x:this.position.x,y:n}),GameManager.audio.PlaySound(c,!1)),this.position.y<this.defaultY-i&&(this.actionComplete=!0));break;case E.STATE.diving:this.actionComplete?this.position.y!=this.defaultY?this.position.y=Math.max(this.position.y-o*GameManager.dt,this.defaultY):this.SetState(E.STATE.none):(this.position.y+=o*GameManager.dt,this.position.y>this.defaultY+i&&(this.actionComplete=!0));break;case E.STATE.none:this.actionCountdown-=GameManager.dt,this.actionCountdown<=0&&this.SetState(GameManager.MathFunctions.RandomInt(0,u)<u/m?E.STATE.diving:E.STATE.jumping)}var e=Math.atan2(this.position.y-this.lastPosition.y,this.position.x-this.lastPosition.x);!this.moveRight&&0>e&&(e+=g),this.rotation=this.rotation>e?Math.max(this.rotation-d*GameManager.dt,e):Math.min(this.rotation+d*GameManager.dt,e)},this.Draw=function(e){if(e.globalAlpha=this.opacity,e.save(),e.translate(this.position.x,this.position.y),e.rotate(this.rotation),this.moveRight||e.scale(1,-1),e.drawImage(document.getElementById(this.image),-this.width/2,-this.height/2,this.width,this.height),e.restore(),GameManager.debugDraw){var t=this.GetCollisionPosition();w(t.x,t.y,this.collisionRadius,"rgba(255, 0, 0, 0.2)","rgba(255, 255, 255, 1)",1)}e.globalAlpha=1},this.SetState=function(e){switch(this.state=e,this.state){case E.STATE.jumping:this.actionComplete=!1,this.underWater=!0;break;case E.STATE.diving:this.actionComplete=!1;break;case E.STATE.none:this.actionCountdown=GameManager.MathFunctions.RandomInt(h,l)}},this.GetCollisionPosition=function(){var e={x:this.position.x+r.x,y:this.position.y+r.y};return this.moveRight||(e.x=this.position.x-r.x),e}}function P(){var e=["image_fishmobile_aviva","image_fishmobile_koki","image_fishmobile_jimmy"],t=["image_fish1","image_fish2","image_fish3"],i=2,n=["chris_blowfish1","chris_blowfish2"],a="image_fishpuff1",s="image_fishpuff2",o=40,r=0,h=2,l=1,m=4,u=4e4,g=5,d=[],c=null,p=0,M=0,y=0,v=25,b=5;this.minSpawnTime=r,this.maxSpawnTime=h,this.spawnCountdown=0,this.elapsedTime=0,this.Init=function(){for(p=0;p<d.length;p++)d[p].spawned=!1;for(p=d.length;o>p;p++){var e=new E;d.push({fishmobile:e,spawned:!1,caught:!1,isFishmobile:!1,isBlowFish:!1})}this.elapsedTime=0},this.Update=function(){if(0!=GameManager.difficutlyProgressionDuration)for(this.elapsedTime<GameManager.difficutlyProgressionDuration&&(this.elapsedTime=GameManager.MathFunctions.Clamp(this.elapsedTime+GameManager.dt,0,GameManager.difficutlyProgressionDuration),this.minSpawnTime=GameManager.MathFunctions.Lerp(this.elapsedTime/GameManager.difficutlyProgressionDuration,r,l),this.maxSpawnTime=GameManager.MathFunctions.Lerp(this.elapsedTime/GameManager.difficutlyProgressionDuration,h,m)),this.spawnCountdown=GameManager.MathFunctions.Clamp(this.spawnCountdown-GameManager.dt,0,m),0==this.spawnCountdown&&(this.Spawn(),this.spawnCountdown=GameManager.MathFunctions.RandomInt(this.minSpawnTime,this.maxSpawnTime)),p=0;p<d.length;p++)d[p].spawned&&(c=d[p].fishmobile,d[p].caught?(d[p].spawned=!1,d[p].isFishmobile&&M--):(c.Update(),c.moveRight?c.position.x-c.width/2>GameManager.gameScreen.width&&(d[p].spawned=!1,d[p].isFishmobile&&M--,GameManager.tutorialManager.HasShown(B.TUTORIAL_TYPE.dive)||GameManager.tutorialManager.hasDove||GameManager.tutorialManager.Show(B.TUTORIAL_TYPE.dive)):c.position.x+c.width/2<GameManager.gameScreen.x&&(d[p].spawned=!1,d[p].isFishmobile&&M--,GameManager.tutorialManager.HasShown(B.TUTORIAL_TYPE.dive)||GameManager.tutorialManager.hasDove||GameManager.tutorialManager.Show(B.TUTORIAL_TYPE.dive))))},this.Draw=function(e){for(p=0;p<d.length;p++)d[p].spawned&&d[p].fishmobile.Draw(e)},this.Spawn=function(){for(p=0;p<d.length;p++)if(!d[p].spawned){d[p].isBlowFish=!1,d[p].isFishmobile=!1,M<e.length-1&&GameManager.MathFunctions.RandomInt(0,100)<v&&(d[p].isFishmobile=!0,M++,y++,y>=e.length&&(y=0)),0==d[p].isFishmobile&&1==GameManager.introComplete&&GameManager.MathFunctions.RandomInt(0,100)<b&&(d[p].isBlowFish=!0),d[p].isFishmobile?d[p].fishmobile.Init([e[y]],!1):d[p].isBlowFish?d[p].fishmobile.Init([a],!0):d[p].fishmobile.Init(t,!1),d[p].spawned=!0,d[p].caught=!1;break}};var G=function(e){for(p=0;p<d.length;p++)if(d[p].spawned&&!d[p].caught){var t=d[p].fishmobile.GetCollisionPosition(),i=t.x-e.x,n=t.y-e.y;if(u>i*i+n*n){var a=e.x-t.x;d[p].fishmobile.moveRight&&0>a||!d[p].fishmobile.moveRight&&a>0?d[p].fishmobile.SetState(E.STATE.jumping):(d[p].fishmobile.moveRight=!d[p].fishmobile.moveRight,d[p].fishmobile.SetState(E.STATE.diving))}}};this.CheckCollisions=function(e){for(p=0;p<d.length;p++)if(d[p].spawned&&!d[p].caught){var t=d[p].fishmobile.collisionRadius+e.collisionRadius,a=d[p].fishmobile.GetCollisionPosition(),o=a.x-e.position.x,r=a.y-e.position.y;if(t*t>o*o+r*r){if(!d[p].isBlowFish){GameManager.audio.PlaySound(e.catchSound,!1),d[p].caught=!0;var h=d[p].isFishmobile?2:1;return GameManager.score+=h,GameManager.energy=GameManager.MathFunctions.Clamp(GameManager.energy+A.ENERGY_CATCH_INCREASE*h,0,A.MAX_ENERGY),f.Trigger("+"+h,{x:d[p].fishmobile.position.x,y:d[p].fishmobile.position.y}),G({x:e.position.x,y:e.position.y}),GameManager.introComplete&&GameManager.score%g==0&&FishmobileAudio.PlayRandomEncouragement(),d[p].fishmobile}e.state==e.STATES.diving&&GameManager.audio.PlaySound(n[GameManager.MathFunctions.RandomInt(0,i-1)],!1),d[p].fishmobile.image=s,e.Rise()}}return null}}function D(){function e(e,t,i,n){if(0!=e.duration){var a={x:t.x+t.width/2,y:t.y+t.height/2};i.strokeStyle=n,i.lineWidth=b,i.beginPath(),i.arc(a.x,a.y,S,_,_+C*e.progress),i.stroke()}}GameManager.loadingImage="image_loading_fishMobiles",GameManager.difficutlyProgressionDuration=300,GameManager.gameScreen={x:-231,y:-148,width:GameManager.FrameSize.width+462,height:GameManager.FrameSize.height+296};var t={image:"image_gameBackground",x:GameManager.gameScreen.x,y:GameManager.gameScreen.y,width:GameManager.gameScreen.width,height:GameManager.gameScreen.height},i={image:"image_water_level",x:GameManager.gameScreen.x,y:425,width:GameManager.gameScreen.width,height:40},a={imageNormal:"image_button_osprey_normal",imagePress:"image_button_osprey_press",imageCharging:"image_button_osprey_charging",x:813,y:265,width:200,height:200},s={imageNormal:"image_button_pelican_normal",imagePress:"image_button_pelican_press",imageCharging:"image_button_pelican_charging",x:-25,y:265,width:200,height:200},o={image:"image_splash",width:100,height:100},r={image:"image_hit",width:100,height:100},h=3e3,l="pauseToggleButton",m="hud",u="scoreText",g="ospreyButton",p="pelicanButton",M="birdArea",y="rgba(0, 255, 255, 1)",v="rgba(100, 255, 100, 1)",b=10,S=62,w=5625,_=Math.PI+Math.PI/2,C=2*Math.PI,F=10,E=2,D=5,k="background",R=document.getElementById(l),L=document.getElementById(m),U=document.getElementById(u),N=document.getElementById(g),Y=document.getElementById(p),H=document.getElementById(M),W=a.imageNormal,V=s.imageNormal,z=null,X=new x,j=new T,J=new P,q=new A,Q=new I(D),K=new f;GameManager.splashManager=new n(F,o.image,o.width,o.height),GameManager.hitManager=new n(E,r.image,r.width,r.height),GameManager.tutorialManager=new B;var Z={name:"gameScene",preloadItems:{images:[{name:"gameBackground",src:"./Images/FishMobiles/game_background_large.png"},{name:"button_osprey_normal",src:"./Images/FishMobiles/button_osp_normal.png"},{name:"button_osprey_press",src:"./Images/FishMobiles/button_osp_press.png"},{name:"button_osprey_charging",src:"./Images/FishMobiles/button_osp_charging.png"},{name:"button_pelican_normal",src:"./Images/FishMobiles/button_pel_normal.png"},{name:"button_pelican_press",src:"./Images/FishMobiles/button_pel_press.png"},{name:"button_pelican_charging",src:"./Images/FishMobiles/button_pel_charging.png"},{name:"fishmobile_aviva",src:"./Images/FishMobiles/fishmobile_aviva.png"},{name:"fishmobile_koki",src:"./Images/FishMobiles/fishmobile_koki.png"},{name:"fishmobile_jimmy",src:"./Images/FishMobiles/fishmobile_jimmy.png"},{name:"fish1",src:"./Images/FishMobiles/fish1.png"},{name:"fish2",src:"./Images/FishMobiles/fish2.png"},{name:"fish3",src:"./Images/FishMobiles/fish3.png"},{name:"fishpuff1",src:"./Images/FishMobiles/fishpuff1.png"},{name:"fishpuff2",src:"./Images/FishMobiles/fishpuff2.png"},{name:"kelp_1",src:"./Images/FishMobiles/kelp_hunk1.png"},{name:"kelp_2",src:"./Images/FishMobiles/kelp_hunk2.png"},{name:"kelp_3",src:"./Images/FishMobiles/kelp_hunk3.png"},{name:"tutorial_press_right",src:"./Images/FishMobiles/tutorial_press_right.png"},{name:"tutorial_press_left",src:"./Images/FishMobiles/tutorial_press_left.png"},{name:"water_level",src:"./Images/FishMobiles/water_level.png",anim:{direction:"y",frames:10,time:2}},{name:"splash",src:"./Images/FishMobiles/splash.png",anim:{direction:"x",frames:7,time:.5,playOnce:!0}},{name:"hit",src:"./Images/FishMobiles/hit.png",anim:{direction:"x",frames:5,time:.4,playOnce:!0}},{name:"osprey_fly",src:"./Images/FishMobiles/osprey_fly.png",anim:{direction:"y",frames:8,time:.7}},{name:"osprey_dive",src:"./Images/FishMobiles/osprey_dive.png",anim:{direction:"y",frames:6,time:.5,playOnce:!0}},{name:"osprey_rise",src:"./Images/FishMobiles/osprey_rise.png",anim:{direction:"y",frames:6,time:.5}},{name:"pelican_fly",src:"./Images/FishMobiles/pelican_fly.png",anim:{direction:"y",frames:6,time:.5}},{name:"pelican_dive",src:"./Images/FishMobiles/pelican_dive.png",anim:{direction:"y",frames:4,time:.4,playOnce:!0}},{name:"pelican_rise",src:"./Images/FishMobiles/pelican_rise.png",anim:{direction:"y",frames:6,time:.5}}],sounds:[{name:"background",path:"./Sounds/Common",file:"background",type:O.music},{name:"end_background",path:"./Sounds/Common",file:"end_background",type:O.music},{name:"small_splash",path:"./Sounds/FishMobiles",file:"small_splash",type:O.effect},{name:"big_splash",path:"./Sounds/FishMobiles",file:"big_splash",type:O.effect},{name:"bird_hit",path:"./Sounds/FishMobiles",file:"bird_hit",type:O.effect},{name:"bird_dive",path:"./Sounds/FishMobiles",file:"bird_dive",type:O.effect},{name:"pelican_catch",path:"./Sounds/FishMobiles",file:"pelican_catch",type:O.effect},{name:"osprey_catch",path:"./Sounds/FishMobiles",file:"osprey_catch",type:O.effect},{name:"chris_title",path:"./Sounds/FishMobiles",file:"chris_title",type:O.dialog},{name:"chris_intro1",path:"./Sounds/FishMobiles",file:"chris_intro1",type:O.dialog},{name:"chris_intro2",path:"./Sounds/FishMobiles",file:"chris_intro2",type:O.dialog},{name:"chris_intro3",path:"./Sounds/FishMobiles",file:"chris_intro3",type:O.dialog},{name:"chris_encouragement1",path:"./Sounds/FishMobiles",file:"chris_encouragement1",type:O.dialog},{name:"chris_encouragement2",path:"./Sounds/FishMobiles",file:"chris_encouragement2",type:O.dialog},{name:"chris_encouragement3",path:"./Sounds/FishMobiles",file:"chris_encouragement3",type:O.dialog},{name:"chris_encouragement4",path:"./Sounds/FishMobiles",file:"chris_encouragement4",type:O.dialog},{name:"chris_encouragement5",path:"./Sounds/FishMobiles",file:"chris_encouragement5",type:O.dialog},{name:"chris_energy_alert",path:"./Sounds/FishMobiles",file:"chris_energy_alert",type:O.dialog},{name:"chris_pelican_info",path:"./Sounds/FishMobiles",file:"chris_pelican_info",type:O.dialog},{name:"chris_osprey_info",path:"./Sounds/FishMobiles",file:"chris_osprey_info",type:O.dialog},{name:"martin_title",path:"./Sounds/FishMobiles",file:"martin_title",type:O.dialog},{name:"martin_intro1",path:"./Sounds/FishMobiles",file:"martin_intro1",type:O.dialog},{name:"martin_intro2",path:"./Sounds/FishMobiles",file:"martin_intro2",type:O.dialog},{name:"martin_intro3",path:"./Sounds/FishMobiles",file:"martin_intro3",type:O.dialog},{name:"martin_encouragement1",path:"./Sounds/FishMobiles",file:"martin_encouragement1",type:O.dialog},{name:"martin_encouragement2",path:"./Sounds/FishMobiles",file:"martin_encouragement2",type:O.dialog},{name:"martin_encouragement3",path:"./Sounds/FishMobiles",file:"martin_encouragement3",type:O.dialog},{name:"martin_encouragement4",path:"./Sounds/FishMobiles",file:"martin_encouragement4",type:O.dialog},{name:"martin_encouragement5",path:"./Sounds/FishMobiles",file:"martin_encouragement5",type:O.dialog},{name:"martin_energy_alert",path:"./Sounds/FishMobiles",file:"martin_energy_alert",type:O.dialog},{name:"martin_pelican_info",path:"./Sounds/FishMobiles",file:"martin_pelican_info",type:O.dialog},{name:"martin_osprey_info",path:"./Sounds/FishMobiles",file:"martin_osprey_info",type:O.dialog},{name:"chris_blowfish1",path:"./Sounds/FishMobiles",file:"Blowfish1",type:O.dialog},{name:"chris_blowfish2",path:"./Sounds/FishMobiles",file:"Blowfish2",type:O.dialog},{name:"chris_hit1",path:"./Sounds/FishMobiles",file:"Hit1",type:O.dialog},{name:"chris_hit2",path:"./Sounds/FishMobiles",file:"Hit2",type:O.dialog},{name:"chris_hit3",path:"./Sounds/FishMobiles",file:"Hit3",type:O.dialog},{name:"chris_obstacle",path:"./Sounds/FishMobiles",file:"Obstacle1",type:O.dialog},{name:"chris_outOfEnergy",path:"./Sounds/FishMobiles",file:"OutofEnergy",type:O.dialog},{name:"chris_outOfEnergyCheers",path:"./Sounds/FishMobiles",file:"OutofEnergyCheers",type:O.dialog}]},Init:function(){GameManager.audio.SetSoundVolume(k,GameManager.InitialSettings.BackgroundMusicVolume),GameManager.audio.PlaySound(k,!0),GameManager.introComplete=!1,FishmobileAudio.PlayRandomBro("intro1",function(){FishmobileAudio.PlayRandomBro("intro2",function(){FishmobileAudio.PlayRandomBro("intro3",function(){setTimeout(function(){FishmobileAudio.PlayRandomBro("pelicanInfo",function(){FishmobileAudio.PlayRandomBro("ospreyInfo",function(){GameManager.introComplete=!0})})},h)})})}),$(R).show(),$(L).show(),GameManager.score=0,U.textContent=GameManager.score,GameManager.maxEnergy=A.MAX_ENERGY,GameManager.energy=GameManager.maxEnergy,X.Init(),j.Init(),J.Init(),q.Init(),Q.Init(),K.Init(),GameManager.splashManager.Init(),GameManager.hitManager.Init(),GameManager.tutorialManager.Init(X,j),X.checkCollisions=J.CheckCollisions,j.checkCollisions=J.CheckCollisions,X.checkDebrisCollisions=Q.CheckCollisions,j.checkDebrisCollisions=Q.CheckCollisions,z=document.getElementById(i.image),N.pressed=!1,N.progress=0,W=a.imageNormal,Y.pressed=!1,Y.progress=0,V=s.imageNormal},UnInit:function(){$(L).hide(),$(R).hide()},Update:function(){GameManager.tutorialManager.Update(),GameManager.tutorialManager.visible||(0==q.progressRemaining&&GameManager.endGame.Open(),GameManager.energy=GameManager.MathFunctions.Clamp(GameManager.energy-A.ENERGY_DELTA_DECREASE*GameManager.dt,0,A.MAX_ENERGY),U.textContent=GameManager.score,z.animDetails.Update(),X.Update(),j.Update(),J.Update(),q.Update(),1==GameManager.introComplete&&Q.Update(),K.Update(),GameManager.splashManager.Update(),GameManager.hitManager.Update(),d()&&0==Y.pressed&&(Y.pressed=!0,Y.elapsedTime=0,Y.duration=j.GetDiveDuration(),j.Dive(),V=s.imageCharging),c()&&0==N.pressed&&(N.pressed=!0,N.elapsedTime=0,N.duration=X.GetDiveDuration(),X.Dive(),W=a.imageCharging),N.pressed&&(N.elapsedTime+=GameManager.dt,N.progress=GameManager.MathFunctions.Clamp(N.elapsedTime/N.duration,0,1),1==N.progress&&(N.pressed=!1,N.progress=0,W=a.imageNormal)),Y.pressed&&(Y.elapsedTime+=GameManager.dt,Y.progress=GameManager.MathFunctions.Clamp(Y.elapsedTime/Y.duration,0,1),1==Y.progress&&(Y.pressed=!1,Y.progress=0,V=s.imageNormal)))},Draw:function(n){n.clearRect(0,0,GameManager.FrameSize.width,GameManager.FrameSize.height),n.drawImage(document.getElementById(t.image),t.x,t.y,t.width,t.height),Q.Draw(n),GameManager.hitManager.Draw(n),X.Draw(n),j.Draw(n),J.Draw(n),z.animDetails.Draw(n,i.x,i.y,i.width,i.height),GameManager.splashManager.Draw(n),K.Draw(n),n.drawImage(document.getElementById(W),a.x,a.y,a.width,a.height),n.drawImage(document.getElementById(V),s.x,s.y,s.width,s.height),N.pressed&&e(N,a,n,y),Y.pressed&&e(Y,s,n,v),q.Draw(n),GameManager.tutorialManager.Draw(n)}};return G({item:N,Down:function(){this.item.pressed||(W=a.imagePress)},Up:function(){this.item.pressed||(this.item.pressed=!0,this.item.elapsedTime=0,this.item.duration=X.GetDiveDuration(),X.Dive(),W=a.imageCharging)}}),G({item:Y,Down:function(){this.item.pressed||(V=s.imagePress)},Up:function(){this.item.pressed||(this.item.pressed=!0,this.item.elapsedTime=0,this.item.duration=j.GetDiveDuration(),j.Dive(),V=s.imageCharging)}}),G({item:H,Down:function(e,t,i){var n=j.position.x-t,o=j.position.y-i;w>n*n+o*o?Y.pressed||(Y.pressed=!0,Y.elapsedTime=0,Y.duration=j.GetDiveDuration(),j.Dive(),V=s.imageCharging):(n=X.position.x-t,o=X.position.y-i,w>n*n+o*o&&(N.pressed||(N.pressed=!0,N.elapsedTime=0,N.duration=X.GetDiveDuration(),X.Dive(),W=a.imageCharging)))}}),Z}function k(){function e(){for(var e=0;e<n.preloadItems.alternateSounds.length;e++)GameManager.audio.LoadSound(n.preloadItems.alternateSounds[e].name,n.preloadItems.alternateSounds[e].path,n.preloadItems.alternateSounds[e].file,n.preloadItems.alternateSounds[e].type,1)}var t={x:0,y:0,width:GameManager.FrameSize.width,height:GameManager.FrameSize.height,image:"image_menuBackground"},i={x:GameManager.FrameSize.width-154,y:0,width:154,height:120,imageEnabled:"./Images/Common/UI/play_button_off.png",imageDisabled:"./Images/Common/UI/play_button_press.png"},n={name:"menuScene",preloadItems:{images:[{name:"menuBackground",src:"./Images/FishMobiles/menu_background.jpg"}],sounds:[{name:"chris_title",path:"./Sounds/FishMobiles",file:"chris_title",type:O.effect},{name:"martin_title",path:"./Sounds/FishMobiles",file:"martin_title",type:O.effect}],alternateSounds:[{name:"chris_title",path:"./Sounds/FishMobiles",file:"chris_title",type:O.effect},{name:"martin_title",path:"./Sounds/FishMobiles",file:"martin_title",type:O.effect},{name:"background",path:"./Sounds/Common",file:"background",type:O.music},{name:"end_background",path:"./Sounds/Common",file:"end_background",type:O.music},{name:"small_splash",path:"./Sounds/FishMobiles",file:"small_splash",type:O.effect},{name:"big_splash",path:"./Sounds/FishMobiles",file:"big_splash",type:O.effect},{name:"bird_hit",path:"./Sounds/FishMobiles",file:"bird_hit",type:O.effect},{name:"bird_dive",path:"./Sounds/FishMobiles",file:"bird_dive",type:O.effect},{name:"pelican_catch",path:"./Sounds/FishMobiles",file:"pelican_catch",type:O.effect},{name:"osprey_catch",path:"./Sounds/FishMobiles",file:"osprey_catch",type:O.effect},{name:"chris_title",path:"./Sounds/FishMobiles",file:"chris_title",type:O.dialog},{name:"chris_intro1",path:"./Sounds/FishMobiles",file:"chris_intro1",type:O.dialog},{name:"chris_intro2",path:"./Sounds/FishMobiles",file:"chris_intro2",type:O.dialog},{name:"chris_intro3",path:"./Sounds/FishMobiles",file:"chris_intro3",type:O.dialog},{name:"chris_encouragement1",path:"./Sounds/FishMobiles",file:"chris_encouragement1",type:O.dialog},{name:"chris_encouragement2",path:"./Sounds/FishMobiles",file:"chris_encouragement2",type:O.dialog},{name:"chris_encouragement3",path:"./Sounds/FishMobiles",file:"chris_encouragement3",type:O.dialog},{name:"chris_encouragement4",path:"./Sounds/FishMobiles",file:"chris_encouragement4",type:O.dialog},{name:"chris_encouragement5",path:"./Sounds/FishMobiles",file:"chris_encouragement5",type:O.dialog},{name:"chris_energy_alert",path:"./Sounds/FishMobiles",file:"chris_energy_alert",type:O.dialog},{name:"chris_pelican_info",path:"./Sounds/FishMobiles",file:"chris_pelican_info",type:O.dialog},{name:"chris_osprey_info",path:"./Sounds/FishMobiles",file:"chris_osprey_info",type:O.dialog},{name:"martin_title",path:"./Sounds/FishMobiles",file:"martin_title",type:O.dialog},{name:"martin_intro1",path:"./Sounds/FishMobiles",file:"martin_intro1",type:O.dialog},{name:"martin_intro2",path:"./Sounds/FishMobiles",file:"martin_intro2",type:O.dialog},{name:"martin_intro3",path:"./Sounds/FishMobiles",file:"martin_intro3",type:O.dialog},{name:"martin_encouragement1",path:"./Sounds/FishMobiles",file:"martin_encouragement1",type:O.dialog},{name:"martin_encouragement2",path:"./Sounds/FishMobiles",file:"martin_encouragement2",type:O.dialog},{name:"martin_encouragement3",path:"./Sounds/FishMobiles",file:"martin_encouragement3",type:O.dialog},{name:"martin_encouragement4",path:"./Sounds/FishMobiles",file:"martin_encouragement4",type:O.dialog},{name:"martin_encouragement5",path:"./Sounds/FishMobiles",file:"martin_encouragement5",type:O.dialog},{name:"martin_energy_alert",path:"./Sounds/FishMobiles",file:"martin_energy_alert",type:O.dialog},{name:"martin_pelican_info",path:"./Sounds/FishMobiles",file:"martin_pelican_info",type:O.dialog},{name:"martin_osprey_info",path:"./Sounds/FishMobiles",file:"martin_osprey_info",type:O.dialog},{name:"chris_blowfish1",path:"./Sounds/FishMobiles",file:"Blowfish1",type:O.dialog},{name:"chris_blowfish2",path:"./Sounds/FishMobiles",file:"Blowfish2",type:O.dialog},{name:"chris_hit1",path:"./Sounds/FishMobiles",file:"Hit1",type:O.dialog},{name:"chris_hit2",path:"./Sounds/FishMobiles",file:"Hit2",type:O.dialog},{name:"chris_hit3",path:"./Sounds/FishMobiles",file:"Hit3",type:O.dialog},{name:"chris_obstacle",path:"./Sounds/FishMobiles",file:"Obstacle1",type:O.dialog},{name:"chris_outOfEnergy",path:"./Sounds/FishMobiles",file:"OutofEnergy",type:O.dialog},{name:"chris_outOfEnergyCheers",path:"./Sounds/FishMobiles",file:"OutofEnergyCheers",type:O.dialog}]},Init:function(){var t=document.getElementById("svgCanvas"),n=S(i.x,i.y,i.width,i.height,t,{sound:"click",up:i.imageEnabled,down:i.imageDisabled,Event:function(){GameManager.support.webAudio||e(),GameManager.sceneManager.ChangeScene("gameScene"),$(n).hide()}});FishmobileAudio.PlayRandomBro("title")},UnInit:function(){},Update:function(){},Draw:function(e){e.drawImage(document.getElementById(t.image),t.x,t.y,t.width,t.height)}};return n}function R(){var e={press:"press",path:"path",none:"none"},t={image:"image_tutorial_press_left",upPosition:{x:0,y:200},downPosition:{x:30,y:320},width:150,height:150},i={image:"image_tutorial_press_right",upPosition:{x:GameManager.FrameSize.width,y:200},downPosition:{x:GameManager.FrameSize.width-30,y:320},width:150,height:150},n=2,a=2,s=10,o=5,r="rgba(255, 0, 0, 1)",h="rgba(255, 255, 255, 1)";this.state=e.none,this.elapsedTime=0,this.complete=!1,this.pressPositionLeft={x:0,y:0},this.pressPositionRight={x:0,y:0},this.startPositionOsprey={x:0,y:0},this.destinationOsprey={x:0,y:0},this.startPositionPelican={x:0,y:0},this.destinationPelican={x:0,y:0},this.Init=function(){this.state=e.press,this.elapsedTime=0,this.complete=!1,this.pressPositionLeft=t.upPosition,this.pressPositionRight=i.upPosition,this.startPositionOsprey=GameManager.tutorialManager.osprey.position,this.destinationOsprey=GameManager.tutorialManager.osprey.GetDiveDestination(),this.startPositionPelican=GameManager.tutorialManager.pelican.position,this.destinationPelican=GameManager.tutorialManager.pelican.GetDiveDestination()},this.Update=function(){switch(this.state){case e.press:this.pressPositionLeft.x=GameManager.MathFunctions.Lerp(this.elapsedTime/n,t.upPosition.x,t.downPosition.x),this.pressPositionLeft.y=GameManager.MathFunctions.Lerp(this.elapsedTime/n,t.upPosition.y,t.downPosition.y),this.pressPositionRight.x=GameManager.MathFunctions.Lerp(this.elapsedTime/n,i.upPosition.x,i.downPosition.x),this.pressPositionRight.y=GameManager.MathFunctions.Lerp(this.elapsedTime/n,i.upPosition.y,i.downPosition.y),this.elapsedTime+=GameManager.dt,this.elapsedTime>=n&&(this.state=e.path,this.elapsedTime=0);break;case e.path:this.elapsedTime+=GameManager.dt,this.elapsedTime>=a&&(this.complete=!0)}},this.Draw=function(n){if(n.drawImage(document.getElementById(t.image),this.pressPositionLeft.x-t.width/2,this.pressPositionLeft.y-t.height/2,t.width,t.height),n.drawImage(document.getElementById(i.image),this.pressPositionRight.x-i.width/2,this.pressPositionRight.y-i.height/2,i.width,i.height),this.state==e.path)for(var a=1;s>a;a++){var l=0,m=0;l=GameManager.MathFunctions.Lerp(a/s,this.startPositionOsprey.x,this.destinationOsprey.x),m=GameManager.MathFunctions.Lerp(a/s,this.startPositionOsprey.y,this.destinationOsprey.y),w(l,m,o,r,h,1),l=GameManager.MathFunctions.Lerp(a/s,this.startPositionPelican.x,this.destinationPelican.x),m=GameManager.MathFunctions.Lerp(a/s,this.startPositionPelican.y,this.destinationPelican.y),w(l,m,o,r,h,1)}}}function B(){B.TUTORIAL_TYPE={dive:"dive"};var e={dive:{tutorial:new R,shown:!1}};this.visible=!1,this.hasDove=!1,this.osprey=null,this.pelican=null;var t=null;this.Show=function(i){this.visible=!0,t=e[i].tutorial,null!=t&&(t.Init(),e[i].shown=!0)},this.Hide=function(){t=null,this.visible=!1},this.HasShown=function(t){return e[t].shown},this.Init=function(i,n){t=null,this.visible=!1,this.hasDove=!1,this.osprey=i,this.pelican=n;for(var a in e)e[a].shown=!1},this.Update=function(){null!=t&&(t.Update(),t.complete&&this.Hide())},this.Draw=function(e){null!=t&&t.Draw(e)}}t.GameWrap=e;var O={music:"music",dialog:"dialog",effect:"effect"};CookieJar={Write:function(e,t){document.cookie=e+"="+t},Read:function(e){try{return document.cookie.match(new RegExp(e+"=([^;]+)"))[1]}catch(t){return null}},Remove:function(e){document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}};var L="gameView",U="svgCanvas",N="gameImages",Y="image_";GameManager={InitialSettings:{MasterVolume:1,BackgroundMusicVolume:.1,disableLocalAudio:!1},FrameSize:{width:988,height:556},debugDraw:!1,pauseElement:{},isPaused:!1,time:new Date,dt:0,clearColor:"#000000",averageFps:0},svgns="http://www.w3.org/2000/svg",xlinkns="http://www.w3.org/1999/xlink",function(){function e(){var e=document.visibilityState;"visible"==e?GameManager.audio.Unmute():"hidden"==e&&GameManager.audio.Mute()}function t(){function e(){setTimeout(function(){var e=$("#"+L)[0].getClientRects(),t=e[0].width/e[0].height,i=GameManager.FrameSize.width/GameManager.FrameSize.height;GameManager.screenScale=t>i?e[0].height/GameManager.FrameSize.height:e[0].width/GameManager.FrameSize.width,$("#gameCenter")[0].setAttribute("style","transform: scale("+GameManager.screenScale+"); -webkit-transform: scale("+GameManager.screenScale+")")},500)}var t=h();if(!t)return void(location.href="./svg_not_supported.html");if(!window.console){var i=window.console={};i.log=i.warn=i.error=function(){}}window.Array&&!window.Array.isArray&&(window.Array.isArray=function(e){return e instanceof Array}),GameManager.support=r(),GameManager.performance=l(GameManager.support.performanceMode),GameManager.audio=s(),GameManager.help=p(),GameManager.endGame=F(),b(),$("#"+U)[0].setAttribute("class",GameManager.performance.svgClass),document.body.onorientationchange=e,window.onresize=e,e(),GameManager.pauseElement=document.createElementNS(svgns,"rect"),GameManager.pauseElement.setAttribute("x",0),GameManager.pauseElement.setAttribute("y",0),GameManager.pauseElement.setAttribute("width",GameManager.FrameSize.width),GameManager.pauseElement.setAttribute("height",GameManager.FrameSize.height),GameManager.pauseElement.setAttribute("fill","rgba(0,0,0,0)"),GameManager.pauseElement.setAttribute("style","display:none"),GameManager.frontCanvas=document.getElementById("gameCanvas"),GameManager.frontContext=GameManager.frontCanvas.getContext("2d"),GameManager.sceneManager=new M,GameManager.sceneManager.AddScene(k()),GameManager.sceneManager.AddScene(D()),GameManager.timer=y(GameManager.performance.frameTime,function(){var e=new Date;
GameManager.dt=Math.min((e-GameManager.time)/1e3,GameManager.performance.frameTime/1e3),GameManager.time=e,GameManager.isPaused||(GameManager.sceneManager.Update(),GameManager.sceneManager.Draw(GameManager.frontContext)),GameManager.support.iOS&&window.scrollTo(0,0)});var n={images:[{name:"loadingBackground",src:"./Images/Common/loading_background.png"},{name:"loading_rhinoBowl",src:"./Images/Common/rhino_bowl_loading.png"},{name:"loading_powerSuitMaker",src:"./Images/Common/power_suit_loading.png"},{name:"loading_fishMobiles",src:"./Images/Common/fishmobile_loading.png"}],sounds:[{name:"click",path:"./Sounds/Common",file:"click",type:O.effect}]};GameManager.PreLoadFromList(n.images,n.sounds,function(){GameManager.sceneManager.ChangeScene("menuScene",!1),u(),GameManager.timer.Start()})}window.onload=t,document.addEventListener("visibilitychange",e,!1),GameManager.PreLoadFromList=function(e,t,i,n){function s(){h++,r()}function o(){l++,r()}function r(){if(void 0!=n&&null!=n){var a=(h+l)/(e.length+t.length);n(a)}h==e.length&&l==t.length&&i()}var h=0,l=0;if((void 0==e||null==e)&&(e=[]),void 0!=t&&null!=t&&GameManager.support.webAudio||(t=[]),e.length+t.length==0)return void i();for(var m=document.getElementById(N),u=0;u<e.length;u++){var g=Y+e[u].name;if(null!=document.getElementById(g))s();else{var d=new Image;d.onload=function(){void 0!=this.anim&&a(this,this.anim),s()},d.onerror=function(e){console.error("Failed to load image: "+e.originalTarget.src),s()},d.src=e[u].src,m.appendChild(d),d.setAttribute("id",g),d.anim=e[u].anim}}for(var c=0;c<t.length;c++)GameManager.audio.LoadSound(t[c].name,t[c].path,t[c].file,t[c].type,1,o)},GameManager.Pause=function(){GameManager.audio.Pause(),GameManager.isPaused=!0,document.getElementById(U).appendChild(GameManager.pauseElement)},GameManager.Resume=function(){var e=document.getElementById(U);GameManager.pauseElement.parentNode==e&&e.removeChild(GameManager.pauseElement),GameManager.isPaused=!1,GameManager.audio.Resume()},GameManager.GetWrappedText=function(e,t,i){var n=[],a=t.split(" ");if(0!=a.length){for(var s=a[0]+" ",o=1;o<a.length;o++){var r=s+a[o]+" ",h=e.measureText(r),l=h.width;l>i?(n.push(s),s=a[o]+" "):s=r}return n.push(s),n}},GameManager.WrapText=function(e,t,i,n,a,s){for(var o=GameManager.GetWrappedText(e,t,a),r=0;r<o.length;r++)e.fillText(o[r],i,n),n+=s},GameManager.MathFunctions={Clamp:function(e,t,i){return Math.min(Math.max(e,t),i)},RotationDifference:function(e,t){for(;e>t+Math.PI;)e-=2*Math.PI;for(;e<t-Math.PI;)e+=2*Math.PI;return t-e},Lerp:function(e,t,i){return t+e*(i-t)},DegToRad:function(e){return e*(Math.PI/180)},RadToDeg:function(e){return e*(180/Math.PI)},RandomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},Curve:function(e,t,i,n,a){var s=1-e,o=e*e,r=s*s,h=r*s,l=o*e,m={x:h*t.x,y:h*t.y};return m={x:m.x+3*r*e*i.x,y:m.y+3*r*e*i.y},m={x:m.x+3*s*o*n.x,y:m.y+3*s*o*n.y},m={x:m.x+l*a.x,y:m.y+l*a.y}}},GameManager.HexToRGBA=function(e,t,i){var n=parseInt(e.substr(1,2),16),a=parseInt(e.substr(3,2),16),s=parseInt(e.substr(5,2),16),o=t||1,r=i||1;return"rgba("+Math.round(n*r)+","+Math.round(a*r)+","+Math.round(s*r)+","+o+")"},GameManager.RequestJson=function(e,t,i){var n=new XMLHttpRequest,a=t||!1;return n.open("GET",e+"?timer="+(new Date).getMilliseconds(),a),a&&(n.onload=function(){if(200===n.status){var e=JSON.parse(n.responseText);i(e)}},n.onerror=function(){console.error(n.statusText)}),n.send(),a?void 0:200===n.status?JSON.parse(n.responseText):null}}();var H=[],W=[37,38,39,40];x.prototype=new _,x.prototype.constructor=_,T.prototype=new _,T.prototype.constructor=_;var V={title:"chris_title",intro1:"chris_intro1",intro2:"chris_intro2",intro3:"chris_intro3",encouragement1:"chris_encouragement1",encouragement2:"chris_encouragement2",encouragement3:"chris_encouragement3",encouragement4:"chris_encouragement4",encouragement5:"chris_encouragement5",energyAlert:"chris_energy_alert",pelicanInfo:"chris_pelican_info",ospreyInfo:"chris_osprey_info"},z={title:"martin_title",intro1:"martin_intro1",intro2:"martin_intro2",intro3:"martin_intro3",encouragement1:"martin_encouragement1",encouragement2:"martin_encouragement2",encouragement3:"martin_encouragement3",encouragement4:"martin_encouragement4",encouragement5:"martin_encouragement5",energyAlert:"martin_energy_alert",pelicanInfo:"martin_pelican_info",ospreyInfo:"martin_osprey_info"},X=5,j="encouragement",J=0;FishmobileAudio={PlayRandomBro:function(e,t){J=GameManager.MathFunctions.RandomInt(0,1),GameManager.audio.PlaySound(0==J?V[e]:z[e],!1,t)},PlayRandomEncouragement:function(e){J=GameManager.MathFunctions.RandomInt(1,X),FishmobileAudio.PlayRandomBro(j+J,e)}}}({},function(){return this}());