!function(e,t){function a(e,t){"use strict";var a,n,o,i,r,s={frames:1,time:.6,direction:"x",startPaused:!1,playOnce:!1,onComplete:null,reverse:!1,preventEffectReplace:!1},l=0,u=[],c=(new Date).getTime()/1e3;for(a in t)t.hasOwnProperty(a)&&(s[a]=t[a]);for(n=s.time/s.frames,o=s.startPaused,i="x"===s.direction?e.naturalWidth/s.frames:e.naturalHeight/s.frames,e.setAttribute("data-animated","true"),r=0;r<s.frames;r+=1)u[r]={sx:"x"===s.direction?i*r:0,sy:"x"===s.direction?0:i*r,sw:"x"===s.direction?i:e.naturalWidth,sh:"x"===s.direction?e.naturalHeight:i};e.animDetails={preventEffectReplace:s.preventEffectReplace,pause:function(e){o=e,c=(new Date).getTime()/1e3},reset:function(){l=0},setFrame:function(e){l=e},reverse:function(e){s.reverse=e},update:function(){var t=(new Date).getTime()/1e3;if(o)c=t;else for(;t-c>n;)if(c+=n,l+=1,l>=s.frames){if(null!==s.onComplete&&(s.onComplete(e),c=t),s.playOnce)return void(o=!0);l=0}},draw:function(t,a,n,o,i,r){var c,d,p,m=s.reverse?s.frames-l-1:l,g=r||!1,f=o,h=i,y=0,v=0;g&&(c=u[m].sw/u[m].sh,d=o/i,p=c>d?o/u[m].sw:i/u[m].sh,f=u[m].sw*p,h=u[m].sh*p,y=o>f?(o-f)/2:0,v=i>h?(i-h)/2:0),t.drawImage(e,u[m].sx,u[m].sy,u[m].sw,u[m].sh,a+y,n+v,f,h)}}}function n(e,t,a,n,o,i,r,s,l,u){"use strict";var c=o/i,d=l/u,p=c>d?l/o:u/i,m=o*p,g=i*p,f=l>m?(l-m)/2:0,h=u>g?(u-g)/2:0;e.drawImage(t,a,n,o,i,r+f,s+h,m,g)}function o(){"use strict";var e=document.getElementById("GameSounds"),t={},a={},n=1,o=!1,i={init:function(){return void 0},loadSound:function(a,n,o,i,r){var s="./Sounds/OGG/"+n+".ogg",l="./Sounds/WAV/"+n+".wav",u="./Sounds/MP3/"+n+".mp3",c=document.createElement("audio"),d=document.createElement("source"),p=document.createElement("source"),m=document.createElement("source");console.log("Loading sound: - "+n),m.setAttribute("type","audio/mpeg"),d.setAttribute("type","audio/ogg"),p.setAttribute("type","audio/wav"),m.src=u,d.src=s,p.src=l,c.appendChild(m),c.appendChild(d),c.appendChild(p),e.appendChild(c),c.setAttribute("preload","metadata"),c.load(),t[a]={elem:c,volume:i,looping:!1,type:o},void 0!==r&&null!==r&&r()},playSound:function(e,a,o){if(void 0===t[e]||null===t[e])return void console.log("playSound-> sound doesn't exist: "+e);if(V.support.android&&!V.support.chrome&&"dialog"!==t[e].type)return void(void 0!==o&&null!==o&&o());t[e].callback=o,t[e].isPlaying=!0;var i=function(){void 0!==t[e].callback&&null!==t[e].callback&&t[e].callback(),t[e].isPlaying=!1};t[e].looping=t[e].elem.loop=a||!1,t[e].elem.volume=V.MathFunctions.clamp(t[e].volume*n,0,1),void 0!==t[e].elem.onended?t[e].elem.onended=i:($(t[e].elem).unbind("ended"),t[e].elem.addEventListener("ended",i)),t[e].elem.play()},stopSound:function(e){if(void 0===t[e]||null===t[e])return void console.log("stopSound-> sound doesn't exist "+e);try{t[e].elem.pause(),t[e].elem.currentTime=0}catch(a){console.log(a.message)}},stopAllNonLoopSounds:function(){var e;for(e in t)t.hasOwnProperty(e)&&(t[e].looping||V.audio.stopSound(e))},stopAllSounds:function(){var e;for(e in t)t.hasOwnProperty(e)&&V.audio.stopSound(e)},setSoundVolume:function(e,a){return void 0===t[e]||null===t[e]?void console.log("setSoundVolume-> sound doesn't exist "+e):(t[e].volume=a,void(t[e].elem.volume=V.MathFunctions.clamp(t[e].volume*n,0,1)))},setMasterVolume:function(e){var a;n=e;for(a in t)t.hasOwnProperty(a)&&(t[a].elem.volume=V.MathFunctions.clamp(t[a].volume*(o?0:n),0,1))},setSoundSpeed:function(){return void 0},mute:function(){var e;o=!0;for(e in t)t.hasOwnProperty(e)&&(t[e].elem.volume=0)},unmute:function(){var e;o=!1;for(e in t)t.hasOwnProperty(e)&&(t[e].elem.volume=V.MathFunctions.clamp(t[e].volume*n,0,1))},pause:function(){var e;for(e in t)t.hasOwnProperty(e)&&t[e].isPlaying&&(this.stopSound(e),("music"===t[e].type||"effect"===t[e].type)&&(a[e]=t[e]))},resume:function(){var e;for(e in a)a.hasOwnProperty(e)&&this.playSound(e,t[e].looping,t[e].callback);a=[]}};return i.init(),i}function i(){"use strict";function e(){console.log("Audio error...")}if(!V.support.webAudio)return new o;window.AudioContext=window.AudioContext||window.webkitAudioContext;var t,a=null,n={},i={},r={},s=1,l=!1;return t={init:function(){a=new AudioContext,a.createGain=a.createGain||a.createGainNode,a.createDelay=a.createDelay||a.createDelayNode,a.createScriptProcessor=a.createScriptProcessor||a.createJavaScriptNode,a.setTargetAtTime=a.setTargetAtTime||a.setTargetValueAtTime,r.gain=a.createGain(),r.gain.connect(a.destination)},loadSound:function(t,o,i,s,l){var u,c="./Sounds/";return c+=V.support.ogg?"OGG/"+o+".ogg":"WAV/"+o+".wav",console.log("Loading sound: - "+c),void 0!==n[t]?(console.log("sound with this name already exists"),void l()):(n[t]={ready:!1,buffer:null,volume:a.createGain(),type:i},void 0!==s&&null!==s&&(n[t].volume.gain.value=s),u=new XMLHttpRequest,u.open("GET",c,!0),u.responseType="arraybuffer",u.onload=function(){200===u.status?a.decodeAudioData(u.response,function(e){n[t].buffer=e,n[t].ready=!0,n[t].looping=!1,n[t].volume.connect(r.gain),void 0!==l&&null!==l&&l()},e):e()},void u.send())},playSound:function(e,t,o){if(void 0===n[e]||null===n[e])return void console.log("playSound-> sound doesn't exist: "+e);if(!n[e].ready)return void console.log("playSound-> sound not ready: "+e);n[e].callback=o,n[e].isPlaying=!0;var i=function(){void 0!==n[e].callback&&n[e].callback(),n[e].isPlaying=!1};n[e].source=a.createBufferSource(),n[e].source.start=n[e].source.start||n[e].source.noteOn,n[e].source.stop=n[e].source.stop||n[e].source.noteOff,n[e].source.loop=t||!1,n[e].looping=n[e].source.loop,n[e].source.buffer=n[e].buffer,n[e].source.connect(n[e].volume),void 0!==n[e].source.onended?n[e].source.onended=i:n[e].timeout=setTimeout(i,1e3*n[e].buffer.duration),n[e].source.start(0)},stopSound:function(e){if(void 0===n[e]||null===n[e])return void console.log("stopSound-> sound doesn't exist "+e);if(!n[e].ready)return void console.log("stopSound-> sound not ready");if(void 0!==n[e].source&&null!==n[e].source)try{n[e].source.stop(0),void 0!==n[e].timeout&&null!==n[e].timeout&&clearTimeout(n[e].timeout)}catch(t){console.log(t.message)}},stopAllNonLoopSounds:function(){var e;for(e in n)n.hasOwnProperty(e)&&(n[e].looping||V.audio.stopSound(e))},stopAllSounds:function(){var e;for(e in n)n.hasOwnProperty(e)&&V.audio.stopSound(e)},setSoundVolume:function(e,t){return void 0===n[e]||null===n[e]?void console.log("setSoundVolume-> sound doesn't exist"):void(n[e].volume.gain.value=t)},setMasterVolume:function(e){s=e,r.gain.gain.value=l?0:e},setSoundSpeed:function(e,t){t!==n[e].source.playbackRate.value&&(n[e].source.playbackRate.value=t)},mute:function(){l=!0,r.gain.gain.value=0},unmute:function(){l=!1,r.gain.gain.value=s},pause:function(){var e;for(e in n)n.hasOwnProperty(e)&&n[e].isPlaying&&(this.stopSound(e),("music"===n[e].type||"effect"===n[e].type)&&(i[e]=n[e]))},resume:function(){var e;for(e in i)i.hasOwnProperty(e)&&this.playSound(e,n[e].looping,n[e].callback);i=[]}},t.init(),t}function r(){"use strict";var e,t,a,n=navigator.userAgent.toLowerCase(),o={performanceMode:"normal",canvas:!1,touch:!!window.hasOwnProperty("ontouchstart"),iPod:n.search("ipod")>-1,iPhone:n.search("iphone")>-1,iPad:n.search("ipad")>-1,safari:n.search("safari")>-1,ie:n.search("msie")>-1,firefox:n.search("firefox")>-1,android:n.search("android")>-1,chrome:n.search("chrome")>-1,silk:n.search("silk")>-1,iOS:!1,mobile:!1,desktop:!1,multitouch:!1,ogg:!0,m4a:!0,mp3:!0,webAudio:!1};o.iOS=o.iPod||o.iPhone||o.iPad,o.mobile=o.iOS||o.android||o.silk,o.desktop=!o.mobile,o.iOS?o.performanceMode="low":o.mobile&&(o.performanceMode="low"),o.touch&&(o.android?parseInt(n.slice(n.indexOf("android")+8),10)>2&&(o.multitouch=!0):o.multitouch=!0),e=document.createElement("audio"),!e.canPlayType||e.canPlayType&&""!==e.canPlayType('audio/ogg; codecs="vorbis"')||(o.ogg=!1,(o.ie||!e.canPlayType||""===e.canPlayType("audio/mp4"))&&(o.m4a=!1));try{t=void 0!==window.AudioContext?new AudioContext:new window.webkitAudioContext,t.createBufferSource(),o.webAudio=!0}catch(i){console.log("No support for HTML5 Web Audio API, use Audio tag instead.")}a=document.createElement("canvas");try{o.canvas=!!a.getContext("2d")}catch(i){o.canvas=!!a.getContext}return o}function s(){"use strict";return!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect}function l(e){"use strict";return"low"===e?{svgClass:"performanceMode",floorClass:"perspective",drawDistance:400,drawMaxAngle:.85,drawGradient:!1,drawAllProps:!1,maxRenderProps:100,horizon:262,frameTime:50}:"high"===e?{svgClass:"superMode",floorClass:"perspective",drawDistance:800,drawMaxAngle:1.4,drawGradient:!0,drawAllProps:!0,maxRenderProps:999,horizon:250,frameTime:26}:{svgClass:"",floorClass:"perspective",drawDistance:800,drawMaxAngle:1,drawGradient:!0,drawAllProps:!1,maxRenderProps:500,horizon:250,frameTime:33}}function u(e){"use strict";e.parentNode.appendChild(e)}function c(){"use strict";V.support.mobile&&$("#debugBox").remove(),V.debugWatch=[{name:"Race Leader",value:"CreatureGame.raceStatus.leader"},{name:"ZachProgress",value:"racingZach.getProgress();"},{name:"Racer Weight",value:"CreatureGame.RacerWeight"},{name:"DT",value:"CreatureGame.dt"},{name:"difference",value:"debugDifficultyValue"},{name:"Prop Count",value:"debugDrawCount"},{name:"UpdateCount",value:'debugUpdateCount + "/" + CreatureGame.levelInfo.PropLocations.length'}]}function d(){"use strict";return void 0}function p(e){"use strict";z(20,450,171,100,e,{text:"",sound:"click",up:"./Images/Menu UI/quit_off.png",down:"./Images/Menu UI/quit_on.png",event:function(){V.help.close(),V.sceneManager.changeScene("labScene")}}),z(220,450,171,100,e,{text:"",sound:"click",up:"./Images/Menu UI/restart_off.png",down:"./Images/Menu UI/restart_on.png",event:function(){V.help.close(),V.sceneManager.reset()}}),z(420,450,171,100,e,{text:"",sound:"click",up:"./Images/Menu UI/resume_off.png",down:"./Images/Menu UI/resume_on.png",event:function(){V.help.close()}})}function m(){"use strict";var e=!1,t=0,a=[],n={screen:$("#lab_help_screen_svg")[0],helpToggle:$("#help_toggle_button")[0],openButton:$("#help_button_open")[0],closeButton:$("#help_button_close")[0],contentId:"#lab_help"},o=$("#helpPageButtons")[0];return n.currentButtonGroup=n.openButton,n.open=function(){e||(u(n.screen),$("#help_content").children().hide(),$(n.contentId).show(),a=$(n.contentId).children(".helpPage"),t=0,a.length>1?(n.showPage(t),$(o).show()):$(o).hide(),$(n.screen).show(),e=!0,n.currentButtonGroup=n.closeButton,u(n.helpToggle),u(n.currentButtonGroup))},n.showPage=function(e){$(a).hide(),$(a[e]).show(),$("#pageCountText")[0].textContent="Page "+(e+1)+"/"+a.length},n.nextPage=function(){t<a.length-1&&(t+=1,n.showPage(t))},n.previousPage=function(){t>0&&(t-=1,n.showPage(t))},n.close=function(){$(n.screen).hide(),e=!1,n.currentButtonGroup=n.openButton,u(n.helpToggle),u(n.currentButtonGroup)},F({item:n.helpToggle,down:function(){$(n.currentButtonGroup).children("image")[1].setAttribute("style","")},up:function(){$(n.currentButtonGroup).children("image")[1].setAttribute("style","display:none;"),e?n.close():n.open()}}),z(770,488,62,61,o,{text:"",sound:"click",up:"./Images/Menu UI/left_off.png",down:"./Images/Menu UI/left_on.png",event:n.previousPage}),z(845,488,62,61,o,{text:"",sound:"click",up:"./Images/Menu UI/right_off.png",down:"./Images/Menu UI/right_on.png",event:n.nextPage}),p($("#race_pause")[0]),n}function g(){"use strict";document.body.onkeydown=function(e){it[e.keyCode]=!0,192===e.keyCode&&$("#debugBox").toggle(),rt.indexOf(e.keyCode)>-1&&(e.preventDefault(),e.stopPropagation())},document.body.onkeyup=function(e){it[e.keyCode]=!1,rt.indexOf(e.keyCode)>-1&&(e.preventDefault(),e.stopPropagation())}}function f(e){"use strict";return void 0!==it[e]&&null!==it[e]?it[e]:!1}function h(){"use strict";return Rt.controls.left||f(37)||f(65)}function y(){"use strict";return Rt.controls.right||f(39)||f(68)}function v(e){"use strict";var t,a;for(t in e)e.hasOwnProperty(t)&&(ut[t]=0,a=W.read(t+"_best_time"),null!==a&&(ut[t]=parseInt(a,10)))}function _(e,t){"use strict";ut[e]=t,W.write(e+"_best_time",t)}function w(){"use strict";function e(){var e=4===$(".powerSlot[data-speedpower]").length;W=e?"":"ADD ABILITY",O=e?null:document.getElementById("image_addbutton")}function t(){function e(){t=l,d.animDetails.reset(),p.animDetails.reset(),u=!1}var t,n,o=.466,i=320,r=D,s=!0,l=null,u=!1,c=!1,d=document.getElementById("image_avivaTalkLeft"),p=document.getElementById("image_avivaTalkRight"),m=document.getElementById("image_avivaTurnHead"),g=document.getElementById("image_avivaReactLeft"),f=document.getElementById("image_avivaReactRight"),h={x:430,y:220,w:i*o,h:i};return d.animDetails.pause(!0),p.animDetails.pause(!0),t=d,a(m,{frames:6,direction:"x",time:.7,startPaused:!1,playOnce:!0,onComplete:e}),a(g,{frames:8,direction:"x",time:1,startPaused:!0,playOnce:!0,onComplete:e}),a(f,{frames:8,direction:"x",time:1,startPaused:!0,playOnce:!0,onComplete:e}),j=function(){return c},n={update:function(){r===D||B!==D||u||(0!==D||s?0!==D&&s&&(l=p,t=m,t.animDetails.reset(),t.animDetails.reverse(!1),t.animDetails.pause(!1),s=!1):(l=d,t=m,t.animDetails.reset(),t.animDetails.reverse(!0),t.animDetails.pause(!1),s=!0),r=D),void 0!==t.animDetails&&t.animDetails.update()},draw:function(e){void 0!==t.animDetails?t.animDetails.draw(e,h.x,h.y,h.w,h.h):e.drawImage(t,h.x,h.y,h.w,h.h)},talk:function(e){d.animDetails.pause(!e),p.animDetails.pause(!e),c=e},react:function(){u||(l=t,t=t===p?f:g,t.animDetails.reset(),t.animDetails.pause(!1),u=!0)}}}function o(){var e=$(".powerSlot");V.RacerWeight=0,V.CurrentPowers=[],e.each(function(e,t){if(t.hasAttribute("data-speedpower")){var a=t.getAttribute("data-speedpower");I=H.movement[a]||H.special[a],V.CurrentPowers.push(a),V.RacerWeight+=I.stats.Weight.value}}),V.RacerWeight=V.MathFunctions.clamp(V.RacerWeight,.01,1),V.RacerWeight>.8&&Mn.trigger("racer_overweight"),e.each(function(e,t){var a,n,o=$(t).children(".slotfg")[0];null!==o&&void 0!==o&&(t.hasAttribute("data-speedpower")?(a=t.getAttribute("data-speedpower"),n=H.movement[a]||H.special[a],n.effect.height>10&&V.RacerWeight>.8?o.setAttribute("style","fill:red"):o.setAttribute("style","")):o.setAttribute("style",""))})}function i(){o(),V.CurrentLevelInfo=T[E],V.CurrentLevelName=E,V.sceneManager.changeScene("racingScene")}function r(){B===dt&&k===!1?(k=!0,Mn.markTutorialFlashComplete("go"),Mn.stopAllSounds(),V.audio.stopAllNonLoopSounds(),V.audio.playSound("lets_race",!1,function(){i(),$(b).hide(),$(m).show(),$(g).children(".upimg")[0].setAttributeNS(q,"href","./Images/LabAssets/right_off.png")})):(Mn.trigger("levels_next"),Mn.trigger("powers_intro"),D=dt,$(f).show(),$(b).show(),$(m).hide(),$(g).children(".upimg")[0].setAttributeNS(q,"href","./Images/LabAssets/right_go.png"),$("#powerSlots").fadeIn(),Mn.markTutorialFlashComplete("next"))}function s(){D=ct,$(f).hide(),$(b).hide(),$(m).show(),$(g).children(".upimg")[0].setAttributeNS(q,"href","./Images/LabAssets/right_off.png")}function l(){var t,a=$(".powerSlot:not([data-speedpower])"),n=a[0],i=n;V.audio.playSound("click"),Mn.markTutorialFlashComplete("addButton"),null!==i&&null!==N&&void 0!==i&&void 0!==N&&(t=N.id.substr(6),i.setAttribute("data-speedpower",t),$(i).children(".slotIcon")[0].setAttributeNS(q,"href",document.getElementById("image_icon_"+t).src),$(i).children(".slotIcon")[0].setAttribute("style",""),$(i).children(".slotempty")[0].setAttribute("style","display:none;"),j()||Mn.trigger("powers_add"),4===a.length&&Mn.trigger("powers_full"),n.TouchEventInfo.down(null,n),e(),o())}function u(t,a){V.audio.playSound("click"),$(S).attr("class","powerSlot"),$(a).attr("class","powerSlot selected");var n,o=a.getAttribute("data-speedpower");null!==o?(A.changeTo(o,!1),e()):(null!==N&&(n=N.id.substr(6),A.changeTo(n),e()),j()||Mn.trigger("select_empty"))}function c(){return void 0}function d(e,t){I=t.parentNode.getAttribute("data-speedpower"),t.parentNode.removeAttribute("data-speedpower"),$(t.parentNode).children(".slotIcon")[0].setAttribute("style","display: none;"),$(t.parentNode).children(".slotempty")[0].setAttribute("style",""),j()||Mn.trigger("powers_remove"),t.parentNode.TouchEventInfo.down(e,t.parentNode),A.changeTo(I),o()}var p,m,g,f,h,y,_,w,b,x,A,I,S,P,M,C,k=!1,T=V.requestJson("./Levels/levels.json"),E=null,D=0,B=0,R=document.getElementById("lab_screen_svg"),N=null,L=null,O=null,W="ADD ABILITY",J=null,Z=!1,Q=0,K=[],X=[],et=[];p={name:"labScene",preloadItems:{images:[{name:"wide_bg",src:"./Images/LabAssets/wide_background.jpg"},{name:"start_race_button_off",src:"./Images/LabAssets/button_off.png"},{name:"start_race_button_on",src:"./Images/LabAssets/button_on.png"},{name:"help_button_off",src:"./Images/LabAssets/help.png"},{name:"help_button_on",src:"./Images/LabAssets/help_press.png"},{name:"left_arrow_off",src:"./Images/LabAssets/arrow_left.png"},{name:"left_arrow_on",src:"./Images/LabAssets/arrow_left_press.png"},{name:"right_arrow_off",src:"./Images/LabAssets/arrow_right.png"},{name:"right_arrow_on",src:"./Images/LabAssets/arrow_right_press.png"},{name:"racer_screen",src:"./Images/LabAssets/racer_screen.png"},{name:"addbutton",src:"./Images/LabAssets/icon_add.png"},{name:"removebutton",src:"./Images/LabAssets/icon_remove.png"},{name:"level_info",src:"./Images/LabAssets/level_info.png"},{name:"racer_base",src:"./Images/Racers/base_racer.png"},{name:"avivaTalkLeft",src:"./Images/Animations/Aviva_TalkLeft_233x500.png",anim:{frames:3,direction:"x",time:.3}},{name:"avivaTalkRight",src:"./Images/Animations/Aviva_TalkRight_233x500.png",anim:{frames:3,direction:"x",time:.3}},{name:"avivaTurnHead",src:"./Images/Animations/Aviva_TurnHead_233x500.png"},{name:"avivaReactLeft",src:"./Images/Animations/Aviva_Laugh_Left233x510.png"},{name:"avivaReactRight",src:"./Images/Animations/Aviva_Laugh_Right233x510.png"}],sounds:[{name:"labintro",path:"labintro",type:"dialog"},{name:"powersintro",path:"powersintro",type:"dialog"},{name:"labtutorial_snow",path:"lab_tuts_levelconditions",type:"dialog"},{name:"labtutorial_next",path:"lab_tuts_hitnext",type:"dialog"},{name:"labtutorial_powers",path:"lab_tuts_powers",type:"dialog"},{name:"labtutorial_remove",path:"lab_tuts_remove",type:"dialog"},{name:"labtutorial_begin",path:"lab_tuts_begin",type:"dialog"},{name:"lab_tuts_powerstats",path:"lab_tuts_powerstats",type:"dialog"},{name:"lab_description_weight",path:"lab_description_weight",type:"dialog"},{name:"lab_description_cost",path:"lab_description_cost",type:"dialog"},{name:"lab_description_duration",path:"lab_description_duration",type:"dialog"},{name:"lab_tuts_movement_attachments",path:"lab_tuts_movement_attachments",type:"dialog"},{name:"lab_tuts_defensive_attachments",path:"lab_tuts_defensive_attachments",type:"dialog"},{name:"lab_tuts_emptyslot",path:"lab_tuts_emptyslot",type:"dialog"},{name:"racer_too_heavy",path:"racer_too_heavy",type:"dialog"},{name:"attachment_removed",path:"attachment_removed",type:"dialog"},{name:"lets_race",path:"lets_race",type:"dialog"},{name:"add_1",path:"added",type:"dialog"},{name:"add_2",path:"you_got_it",type:"dialog"},{name:"add_3",path:"racer_looks_good",type:"dialog"},{name:"aviva_react_1",path:"aviva_react_1",type:"effect"},{name:"aviva_react_2",path:"aviva_react_2",type:"effect"},{name:"aviva_react_3",path:"aviva_react_3",type:"effect"},{name:"aviva_react_4",path:"aviva_react_4",type:"effect"},{name:"activate_Cheetah2",path:"Cheetah2",type:"effect"},{name:"activate_otter",path:"otter",type:"effect"},{name:"activate_hummingbird",path:"hummingbird",type:"effect"},{name:"activate_falcon2",path:"falcon2",type:"effect"},{name:"activate_dolphin",path:"dolphin",type:"effect"},{name:"activate_skunk",path:"skunk",type:"effect"},{name:"activate_bison",path:"bison",type:"effect"},{name:"music_loop_menu01",path:"menu01",type:"music"},{name:"music_loop_race01",path:"race01",type:"music"},{name:"music_loop_race02",path:"race02",type:"music"},{name:"music_loop_race03",path:"race03",type:"music"},{name:"setup_intro",path:"setup_intro",type:"dialog"}]},init:function(){var e,a=$("#help_button_open > image");v(T),a[0].setAttributeNS(q,"href","./Images/LabAssets/help.png"),a[1].setAttributeNS(q,"href","./Images/LabAssets/help_press.png"),V.help.contentId="#lab_help",R.setAttribute("style",""),V.audio.setSoundVolume("music_loop_menu01",V.InitialSettings.BackgroundMusicVolume),V.audio.playSound("music_loop_menu01",!0);for(e in H.movement)H.movement.hasOwnProperty(e)&&null===N&&(N=document.getElementById("image_"+e));k=!1,D=0,B=0,J=V.labAviva=t(),$(f).hide(),Mn.trigger("setup_intro"),Mn.trigger("levels_intro")},uninit:function(){R.setAttribute("style","display:none"),V.audio.stopSound("music_loop_menu01",!0),Mn.stopAllSounds()},update:function(){D>B?B+=V.dt*gt:B>D&&(B-=V.dt*gt),B=V.MathFunctions.clamp(B,ct,dt),Z||0===Q||(Q*=.8,Math.abs(Q)<1&&(Q=0)),null!==N&&N.animDetails.update(),J.update(),Mn.updateTutorialFlash(D===ct?"left":"right")},draw:function(t){var a,o,i,r,s,l,u,c,d,p,m,g=V.MathFunctions.clamp(B-Q/2,ct,dt),f=!1;for(document.getElementById("lab_screen_svg").transform.baseVal.getItem(0).matrix.e=-g,t.setTransform(1,0,0,1,0,0),t.fillStyle="black",t.fillRect(0,0,988,556),t.setTransform(1,0,0,1,-g,0),t.drawImage(document.getElementById("image_wide_bg"),0,0,1427,556),t.fillStyle="#1B1B27",t.fillRect(710,330,197,20),t.fillStyle=V.RacerWeight<=.8?"#4870B6":"red",t.fillRect(710,330,197*V.RacerWeight,20),t.fillStyle="white",t.font="24px DINE",t.fillText("Weight",640,348),t.drawImage(document.getElementById("image_terrain_"+E),80,169,287,155),t.drawImage(document.getElementById("image_level_info"),70,359,312,116),t.textAlign="start",t.fillStyle="#75F8E6",t.font="28px DINE",t.fillText("DIFFICULTY",100,420),t.fillText("BEST TIME",100,450),a=ut[E],o=parseInt(a/60,10),i=parseInt(a-60*o,10),r=10>i?":0":":",t.fillText(o+r+i,230,450),V.frontContext.beginPath(),h=0;lt>h;h+=1)V.frontContext.moveTo(237+20*h,410),T[E].difficulty>h?G(230+20*h,410,7,"#75F8E6","#75F8E6",2):(f===!1&&(f=!0,V.frontContext.fill(),V.frontContext.stroke(),V.frontContext.beginPath()),G(230+20*h,410,7,"#001225","#75F8E6",2));V.frontContext.fill(),V.frontContext.stroke(),null===O&&e(),null!==O&&t.drawImage(O,1120,295,33,33),t.textAlign="start",t.fillStyle="white",t.strokeStyle="black",t.font="28px DINE",t.fillText(W,1170,320),null!==N&&N.animDetails.draw(t,1058,151,275,145,!0),B>pt?(y=$(".powerSlot.selected")[0],_=y.getAttribute("data-speedpower"),null!==_?n(t,document.getElementById("image_racer_"+_),0,0,450,260,488,35,495,246):n(t,document.getElementById("image_racer_base"),0,0,450,260,488,35,495,246)):mt>B&&(w=document.getElementById("image_terrain_large_"+E),n(t,document.getElementById("image_terrain_large_"+E),0,0,w.naturalWidth,w.naturalHeight,468,35,495,286)),J.draw(t),u=null!==L?L:{Weight:{value:0,display:!0},Cost:{value:0,display:!0},Duration:{value:0,display:!0}},s=1055,l=425;for(p in u)u.hasOwnProperty(p)&&u[p].display&&(t.textAlign="start",t.fillStyle="white",t.strokeStyle="black",t.font="24px DINE",t.fillText(p,s,l),l+=28,t.fillStyle="black",t.fillRect(1180,l-45,180,15),t.fillStyle="#4870B6",t.fillRect(1180,l-45,180*(u[p].value/st[p]),15));d=0;for(p in u)if(u.hasOwnProperty(p))for(c in ft)if(ft[c]===p){m=50*u[p].value,d=m>d?m:d;break}t.fillStyle="white",t.fillText("Top Speed",1055,380),t.fillStyle="#4870B6",t.fillText(d+Tt+"mph",1180,380)}},F({item:$("#desc_weight")[0],down:function(){j()||Mn.trigger("description_weight")}}),F({item:$("#desc_cost")[0],down:function(){j()||Mn.trigger("description_cost")}}),F({item:$("#desc_duration")[0],down:function(){j()||Mn.trigger("description_duration")}}),b=document.createElementNS(Y,"image"),b.setAttributeNS(q,"href","./Images/LabAssets/icon_go.png"),b.setAttribute("x","17"),b.setAttribute("y","26"),b.setAttribute("width","50"),b.setAttribute("height","50"),x=b.cloneNode(!0),x.setAttributeNS(q,"href","./Images/LabAssets/icon_terrain.png"),x.setAttribute("x","35"),m=b.cloneNode(!0),m.setAttributeNS(q,"href","./Images/LabAssets/icon_powers.png"),g=z(860,463,100,100,R,{text:"",sound:"click",up:"./Images/LabAssets/right_off.png",down:"./Images/LabAssets/right_press.png",event:r}),f=z(753,463,100,100,R,{text:"",sound:"click",up:"./Images/LabAssets/left_off.png",down:"./Images/LabAssets/left_press.png",event:s}),g.appendChild(b),g.appendChild(m),f.appendChild(x),$(b).hide();for(C in T)T.hasOwnProperty(C)&&(K.push(C),p.preloadItems.images.push({name:"terrain_"+C,src:"./Images/LabAssets/MapImages/"+T[C].image}),p.preloadItems.images.push({name:"terrain_large_"+C,src:"./Images/LabAssets/MapImages/"+T[C].image_large}));U(98,100,250,70,R,{entries:K,title:"Terrain",titleAlign:"right",onchange:function(e){E=e,V.CurrentLevel=T[e].levelfile}});for(C in H.movement)H.movement.hasOwnProperty(C)&&(I=H.movement[C],X.push(C),p.preloadItems.images.push({name:C,src:"./Images/Animations/"+I.images.animation,anim:I.images.animationDetails}),p.preloadItems.images.push({name:"icon_"+C,src:"./Images/LabAssets/AnimalIcons/"+I.images.icon}),p.preloadItems.images.push({name:"racer_"+C,src:"./Images/Racers/"+I.images.racer}));for(C in H.special)H.special.hasOwnProperty(C)&&(I=H.special[C],et.push(C),p.preloadItems.images.push({name:C,src:"./Images/Animations/"+I.images.animation,anim:I.images.animationDetails}),p.preloadItems.images.push({name:"icon_"+C,src:"./Images/LabAssets/AnimalIcons/"+I.images.icon}),p.preloadItems.images.push({name:"racer_"+C,src:"./Images/Racers/"+I.images.racer}));for(A=U(1072,71,250,70,R,{entries:X,page2Entries:et,title:"",onchange:function(t,a){try{N=document.getElementById("image_"+t),L=a?H.special[t].stats:H.movement[t].stats}catch(n){L=null}e()},tabs:["Movement","Special"],swipeAreaCallback:l}),e(),S=$(".powerSlot"),h=0;h<S.length;h+=1)F({item:S[h],down:u,up:c}),F({item:$(S[h]).children(".removeButton")[0],down:d});return F({item:$("#avivaButton")[0],down:function(){J.react()}}),P=$("#lab_tutorial_highlights")[0],P.parentNode.appendChild(P),M=document.createElementNS(Y,"path"),M.setAttribute("d","m239,0 775,0 0,370 -430,0 0,-162 -120,0 0,337 121,0 0,-73 172,0 0,75 -733,0 0,-194 378,0 0,-245"),M.setAttribute("fill","rgba(0,255,255,0.0)"),R.appendChild(M),F({item:M,down:function(){Z=!0},move:function(e,t){Z&&(Q+=t,Q=V.MathFunctions.clamp(Q,-200,200),-200===Q&&D===ct?(r(),Z=!1):200===Q&&(s(),Z=!1))},up:function(){Z=!1}}),p}function b(e,t,a,n){"use strict";var o,i,r,s,l=e,u=l[0],c=0,d=a||function(){return void 0},p={avgTotalLength:0,avgLengthByIndex:[],lengthsByIndex:[]};for(o=0;o<l.length;o+=1)c=l[o].index>c?l[o].index:c,void 0===p.lengthsByIndex[l[o].index]&&(p.lengthsByIndex[l[o].index]=[]),l[o].segmentLength=l[o].path.getTotalLength(),p.lengthsByIndex[l[o].index].push(l[o].segmentLength);for(o=0;o<p.lengthsByIndex.length;o+=1){for(r=0,i=0;i<p.lengthsByIndex[o].length;i+=1)r+=p.lengthsByIndex[o][i];p.avgLengthByIndex[o]=r/p.lengthsByIndex[o].length,p.avgTotalLength+=p.avgLengthByIndex[o]}this.getPointAtTime=function(e){if(void 0===u)return{x:0,y:0};if("racing"!==V.raceStatus.state&&(e=V.MathFunctions.clamp(e,0,1)),e>1&&(e-=1,u.index===c?(V.EndGame(n),d()):u=this.changeToPath(u.index+1)),void 0===u)return{x:0,y:0};if(0>e&&(e+=1,u=this.changeToPath(u.index-1)),void 0===u)return{x:0,y:0};var t=u.segmentLength;return u.path.getPointAtLength(t*e)},this.getLookAheadPointAtTime=function(e){"racing"!==V.raceStatus.state&&(e=V.MathFunctions.clamp(e,0,1));var t=u;return e>1&&(e-=1,t=this.changeToPath(u.index+1)),0>e&&(e+=1,t=this.changeToPath(u.index-1)),void 0===t?{x:0,y:0}:(s=t.segmentLength,t.path.getPointAtLength(s*e))},this.getMaxTime=function(){return void 0===u?0:u.segmentLength},this.changeToPath=function(e){e=V.MathFunctions.clamp(e,0,c);var a=0,n=[];for(o=0;o<l.length;o+=1)l[o].index===e&&n.push(l[o]);return n.length>1?a=null===t||void 0===t?Math.floor(Math.random()*n.length):t(n):n.length>0&&(a=0),n[a]},this.getRaceLength=function(){return p.avgTotalLength},this.getRaceProgress=function(e){var t,a=0,n=0;for(t=0;c>=t;t+=1)t===u.index?(a+=e,n+=u.segmentLength):(t<u.index&&(a+=p.avgLengthByIndex[t]),n+=p.avgLengthByIndex[t]);return a/n}}function x(e){"use strict";function t(e,t,a){t&&(Ct.setAttribute("style",""),Ct.setAttribute("transform","translate("+a.x+","+a.y+")"),V.currentPowerUp.type=e)}function a(){Ct.setAttribute("style","display:none"),V.currentPowerUp.type=kt.PowerUpTypes.None}function n(a,n,o){var i=V.hasPowerUp(o),r=i?n.imageEnabled:n.imageDisabled;return At=At||i,null===a?a=z(n.x,n.y,n.width,n.height,e,{text:"",sound:"click",up:r,down:r,event:t.bind(null,o,i,{x:n.x,y:n.y})}):($(a).children(".upimg")[0].setAttributeNS(q,"href",r),$(a).children(".downimg")[0].setAttributeNS(q,"href",r)),a}At=!1,V.currentPowerUp.type=kt.PowerUpTypes.None,It=n(It,_t,kt.PowerUpTypes.EnergyBonus),St=n(St,wt,kt.PowerUpTypes.TurboBoost),Pt=n(Pt,bt,kt.PowerUpTypes.FalconDistractor),Mt=n(Mt,xt,kt.PowerUpTypes.RhinoProtector),null===Ct&&(Ct=z(vt.x,vt.y,vt.width,vt.height,e,{text:"",sound:"click",up:vt.image,down:vt.image,event:a})),Ct.setAttribute("style","display:none")}function A(){"use strict";var e,t,a=!1,n=$("#racing_power_up_screen")[0],o=$("#power_up_page_buttons")[0],i=null;return n.open=function(e){x(o),!a&&At&&(u(n),$(n).show(),i=e,V.pause(),a=!0)},n.close=function(){a&&($(n).hide(),null!==i&&void 0!==i&&i(),V.resume(),a=!1)},e=document.createElementNS(Y,"image"),e.setAttributeNS(q,"href",ht.image),e.setAttribute("x",ht.x.toString()),e.setAttribute("y",ht.y.toString()),e.setAttribute("width",ht.width.toString()),e.setAttribute("height",ht.height.toString()),t=z(yt.x,yt.y,yt.width,yt.height,o,{text:"",sound:"click",up:yt.upimg,down:yt.downimg,event:n.close}),t.appendChild(e),n}function I(e,t,a){"use strict";this.type=void 0!==e?e:kt.PowerUpTypes.None,this.onUse=void 0!==t?t:function(){},this.onComplete=void 0!==a?a:function(){};var n=!1,o=0;switch(e){case kt.PowerUpTypes.TurboBoost:o=kt.TurboBoostDuration;break;case kt.PowerUpTypes.FalconDistractor:o=kt.FalconDistractorDuration;break;case kt.PowerUpTypes.RhinoProtector:o=kt.RhinoProtectorDuration;break;default:o=0}this.use=function(){this.onUse(),n=!0},this.complete=function(){this.onComplete(),this.type=kt.PowerUpTypes.None,n=!1},this.update=function(){n&&o>=0&&this.type!==kt.PowerUpTypes.FalconDistractor&&(o=Math.max(0,o-V.dt),0===o&&this.complete())}}function S(e){"use strict";var t=[],a=e;this.addValue=function(e){t.push(e),t.length>a&&t.shift()},this.getAverage=function(){var e,a=0;for(e=0;e<t.length;e+=1)a+=t[e];return t.length>0&&(a/=t.length),a},this.clear=function(){t=[]}}function P(e,t){"use strict";for(ea=0;Xt>ea;ea+=1)for(e.push([]),ta=0;Xt>ta;ta+=1)e[ea].push([]);for(ea=0;ea<t.length;ea+=1)tt=V.MathFunctions.clamp(Math.floor(t[ea][1]/Kt),0,Xt-1),at=V.MathFunctions.clamp(Math.floor(t[ea][2]/Kt),0,Xt-1),e[tt][at].push(ea)}function M(){"use strict";void 0===V.miniMap&&(V.miniMap=$("#path_svg")[0],V.miniMap.mapZoom=1),V.miniMap.zachPos=$("#zachRepresentation")[0].transform.baseVal.getItem(0).matrix,V.miniMap.playerPos=$("#playerRepresentation")[0].transform.baseVal.getItem(0).matrix,V.miniMap.scale=V.miniMap.transform.baseVal.getItem(0).matrix,V.miniMap.translate=V.miniMap.transform.baseVal.getItem(1).matrix,et=[V.miniMap.zachPos.e-V.miniMap.playerPos.e,V.miniMap.zachPos.f-V.miniMap.playerPos.f],ma=Math.sqrt(Math.pow(et[0],2)+Math.pow(et[1],2))||1,V.miniMap.mapZoom=V.MathFunctions.clamp(75/Math.abs(ma),.001,.6),V.miniMap.scale.a=V.miniMap.mapZoom,V.miniMap.scale.d=V.miniMap.mapZoom,V.miniMap.translate.e=-V.miniMap.zachPos.e+et[0]/2,V.miniMap.translate.f=-V.miniMap.zachPos.f+et[1]/2}function C(){"use strict";nt=$("#rewardSlot .button")[0],null!==nt.fg&&void 0!==nt.fg&&nt.fg.setAttributeNS(q,"href",document.getElementById("image_powerup_empty").getAttribute("src"))}function k(e,t,a){"use strict";return J=e[0],Z=e[1],Q=e[2],K=t,X=a||1,"rgba("+Math.round(J*X)+","+Math.round(Z*X)+","+Math.round(Q*X)+","+K+")"}function T(){"use strict";var e,t=[],a=[],o="white",i=0,r=null,s=[],l=[],u=new Date,c=null,d=null,p=null,m=[],g=260,f=.65,h=[Math.ceil(1024*f),Math.ceil(449*f)],y=null,v=["music_loop_race01","music_loop_race02","music_loop_race03"],w=290,b=373,x=-15,A=[[828,496],[928,436],[828,376],[928,316]],S=[[1,0],[2,0],[2,1],[3,2],[3,1]],T={state:"idle",countdown:4,countSounds:3,lastPassSound:new Date,playerProgress:0,zachProgress:0,leader:"zach"},D=0,B=0,R=1.5,N=!1,L=0,U=[],O={x:0,y:0},j={x:0,y:0},J=!1,Z={x:-300,y:-150,width:300,height:150,moveRight:!0,passes:0},Q=[],K=[{name:"chris_cheer1_128x225",animName:"npc_chrisCheer",aspect:.5688,found:!1,active:!1,callback:function(){Mn.trigger("move")
}},{name:"flag",animName:"npc_flag",aspect:1.209,found:!0,active:!0,callback:function(){return void 0}}];return V.raceStatus=T,Zt=new E,jt=function(e,t){i=t,o=e},Jt=function(){R=1.5},F({item:document.getElementById("controlLeft"),down:function(e,t){Rt.controls.left=!0,t.setAttribute("fill","url(#leftButtonGrad)")},up:function(e,t){Rt.controls.left=!1,t.setAttribute("fill","none")}}),F({item:document.getElementById("controlRight"),down:function(e,t){Rt.controls.right=!0,t.setAttribute("fill","url(#rightButtonGrad)")},up:function(e,t){Rt.controls.right=!1,t.setAttribute("fill","none")}}),V.playEffect=function(e){if(ot=document.getElementById("image_effect_"+e),m.indexOf(ot)<0)m.push(ot);else if(void 0!==ot.animDetails.preventEffectReplace&&ot.animDetails.preventEffectReplace)return;ot.animDetails.reset(),ot.animDetails.pause(!1),ot.AnimMode="show"},z(514,410,171,100,$("#endgame")[0],{text:"",sound:"click",up:"./Images/EndGame/button_back.png",down:"./Images/EndGame/button_back_press.png",event:function(){V.sceneManager.changeScene("labScene")}}),z(303,410,171,100,$("#endgame")[0],{text:"",sound:"click",up:"./Images/EndGame/button_again.png",down:"./Images/EndGame/button_again_press.png",event:function(){V.sceneManager.reset()}}),V.PowerUpSelected=function(){function t(){Rt.Fuel.available=Math.min(Rt.Fuel.total,Rt.Fuel.available+kt.EnergyBonusAmount)}function a(){C()}function n(){Nt.turbo=kt.TurboBoostSpeedIncrement,Rt.resetTime()}function o(){Nt.turbo=0,C()}function i(){V.audio.playSound("falcon_dive"),J=!0,Z.x=-Z.width,Z.y=-Z.height,Z.moveRight=!0,Z.passes=0}function r(){J=!1,C()}function s(){O={x:0,y:0},j={x:0,y:0},Rt.protectorActive=!0}function l(){Rt.protectorActive=!1,C()}function u(){V.currentPowerUp.use()}function c(){console.log("Power up use failed.")}if(V.currentPowerUp.type!==kt.PowerUpTypes.None)switch(e=$("#rewardSlot .button")[0],e.fg=$("#rewardSlot image")[0],V.currentPowerUp.type){case kt.PowerUpTypes.EnergyBonus:V.currentPowerUp=new I(V.currentPowerUp.type,t,a),e.fg.setAttributeNS(q,"href",document.getElementById("image_energy_button_off").getAttribute("src")),e.pressedImage="image_energy_button_on";break;case kt.PowerUpTypes.TurboBoost:V.currentPowerUp=new I(V.currentPowerUp.type,n,o),e.fg.setAttributeNS(q,"href",document.getElementById("image_boost_button_off").getAttribute("src")),e.pressedImage="image_boost_button_on";break;case kt.PowerUpTypes.FalconDistractor:V.currentPowerUp=new I(V.currentPowerUp.type,i,r),e.fg.setAttributeNS(q,"href",document.getElementById("image_falcon_button_off").getAttribute("src")),e.pressedImage="image_falcon_button_on";break;case kt.PowerUpTypes.RhinoProtector:V.currentPowerUp=new I(V.currentPowerUp.type,s,l),e.fg.setAttributeNS(q,"href",document.getElementById("image_rhino_button_off").getAttribute("src")),e.pressedImage="image_rhino_button_on"}F({item:e,down:function(){if(V.currentPowerUp.type!==kt.PowerUpTypes.None&&"racing"===T.state){if(V.currentPowerUp.type===kt.PowerUpTypes.EnergyBonus&&Rt.Fuel.available===Rt.Fuel.total)return;V.usePowerUp(V.currentPowerUp.type,u,c),e.fg.setAttributeNS(q,"href",document.getElementById(e.pressedImage).getAttribute("src"))}}})},V.EndGame=function(e){var a,n,o,i,r=!1,s=!0,l=!0;if(T.state=e?"playerWin":"zachWin",e){for((void 0===ut[V.CurrentLevelName]||0===parseInt(ut[V.CurrentLevelName],10)||D<ut[V.CurrentLevelName])&&_(V.CurrentLevelName,D),ea=0;ea<V.CurrentPowers.length;ea+=1)Oa=H.special[V.CurrentPowers[ea]]||H.movement[V.CurrentPowers[ea]],Rt.Fuel.available>=Oa.stats.Cost.value&&(r=!0),"mammal"!==Oa.stats.Classification&&(s=!1);r&&V.event(V.GUID_REMAINING_ENERGY),s&&V.CurrentPowers.length>=Qt&&V.event(V.GUID_WIN_WITH_ONLY_MAMMAL_PARTS),Rt.hitZackBot||V.event(V.GUID_DODGE_ALL_ZACK_BOTS);for(n in ut)if(ut.hasOwnProperty(n)&&(void 0===ut[n]||0===ut[n])){l=!1;break}o=W.read("firstTimeBeatZachEveryLevel"),l&&null===o&&(W.write("firstTimeBeatZachEveryLevel",!0),V.event(V.GUID_BEAT_ZACK_EVERY_LEVEL)),i=W.read("firstTimeBeatZach"),null===i?(W.write("firstTimeBeatZach",!0),V.event(V.GUID_BEAT_ZACK_FIRST_TIME)):V.event(V.GUID_BEAT_ZACK)}for(a=0,ea=0;ea<t.length;ea+=1)a+=t[ea];a/=t.length,20>a&&W.write("shouldUseLowQuality","1"),$(e?"#loseBanner":"#winBanner").hide(),$(e?"#endgame, #winBanner":"#endgame, #loseBanner").show(),V.levelComplete()},{name:"racingScene",getPreloadItems:function(){var e,t,a={images:[{name:"prototype_sky",src:"./Images/prototype_sky.jpg"},{name:"mountain_sky",src:"./Images/mountain_sky.jpg"},{name:"snowy_sky",src:"./Images/snowy_sky.jpg"},{name:"controls",src:"./Images/controls-01.png"},{name:"consolebg",src:"./Images/CockpitUI/console_bg.png"},{name:"minimap",src:"./Images/CockpitUI/minimap.png"},{name:"joystick",src:"./Images/CockpitUI/joystick.png"},{name:"horn",src:"./Images/PowerUps/horn.png"},{name:"boost_button_off",src:"./Images/CockpitUI/boost_powerup_off.png"},{name:"boost_button_on",src:"./Images/CockpitUI/boost_powerup_on.png"},{name:"energy_button_off",src:"./Images/CockpitUI/energy_powerup_off.png"},{name:"energy_button_on",src:"./Images/CockpitUI/energy_powerup_on.png"},{name:"falcon_button_off",src:"./Images/CockpitUI/falcon_powerup_off.png"},{name:"falcon_button_on",src:"./Images/CockpitUI/falcon_powerup_on.png"},{name:"rhino_button_off",src:"./Images/CockpitUI/rhino_powerup_off.png"},{name:"rhino_button_on",src:"./Images/CockpitUI/rhino_powerup_on.png"},{name:"powerup_empty",src:"./Images/CockpitUI/powerup_empty.png"},{name:"rhino_protector",src:"./Images/PowerUps/rhino.png"},{name:"falcon_distractor",src:"./Images/PowerUps/falcon.png"},{name:"anim_moveLeft",src:"./Images/CockpitUI/left_key256x198.png",anim:{frames:9,direction:"y",time:.76}},{name:"anim_moveRight",src:"./Images/CockpitUI/right_key.png",anim:{frames:9,direction:"y",time:.76}},{name:"anim_energyIcon",src:"./Images/CockpitUI/energy_icon.png",anim:{frames:4,direction:"y",time:.5}},{name:"npc_chrisCheer",src:"./Images/Animations/chris_cheer1_128x225.png",anim:{frames:10,direction:"x",time:.7}},{name:"effect_go",src:"./Images/Animations/go_animation.png",anim:{frames:5,direction:"y",time:.56,playOnce:!0,onComplete:function(e){e.AnimMode="remove"}}},{name:"effect_skunk",src:"./Images/Animations/skunk_effect.png",anim:{frames:6,direction:"y",time:.45,playOnce:!0,onComplete:function(e){e.AnimMode="fadeout"}}},{name:"effect_rocksplode",src:"./Images/Animations/rock_explode450x250.png",anim:{frames:6,direction:"y",time:.42,playOnce:!0,onComplete:function(e){e.AnimMode="remove"}}},{name:"effect_botsplode",src:"./Images/Animations/zachbot_explode450x250.png",anim:{frames:4,direction:"y",time:.3,playOnce:!0,onComplete:function(e){e.AnimMode="remove"}}},{name:"effect_logsplode",src:"./Images/Animations/log_explode450x250.png",anim:{frames:7,direction:"y",time:.49,playOnce:!0,onComplete:function(e){e.AnimMode="remove"}}},{name:"effect_water",src:"./Images/Animations/particles_water.png",anim:{frames:8,direction:"y",time:.5,playOnce:!0,preventEffectReplace:!0,onComplete:function(e){e.AnimMode="remove"}}},{name:"effect_mud",src:"./Images/Animations/particles_mud.png",anim:{frames:8,direction:"y",time:.5,playOnce:!0,preventEffectReplace:!0,onComplete:function(e){e.AnimMode="remove"}}},{name:"effect_snow",src:"./Images/Animations/particles_snow.png",anim:{frames:8,direction:"y",time:.5,playOnce:!0,preventEffectReplace:!0,onComplete:function(e){e.AnimMode="remove"}}},{name:"banner_lose",src:"./Images/EndGame/Lose_988x556.png"},{name:"banner_win",src:"./Images/EndGame/Win_988x556.png"},{name:"npc_flag",src:"./Images/Animations/flag_animation.png",anim:{frames:3,direction:"x",time:.4}}],sounds:[{name:"race_bg",path:"badracingmusic",type:"music"},{name:"playerpass",path:"pass2",type:"effect"},{name:"zachpass",path:"pass1",type:"effect"},{name:"cool",path:"thisiscool",type:"dialog"},{name:"carsound",path:"carsound",type:"effect"},{name:"offroad",path:"offroad",type:"effect"},{name:"smart",path:"smart",type:"dialog"},{name:"winsound",path:"winsound",type:"dialog"},{name:"losesound",path:"losesound",type:"dialog"},{name:"take_lead_1",path:"see_ya_zach",type:"dialog"},{name:"take_lead_2",path:"youre_winning",type:"dialog"},{name:"take_lead_3",path:"woo",type:"dialog"},{name:"lose_lead",path:"zach_leading",type:"dialog"},{name:"tutorial_move",path:"tutorial_move",type:"dialog"},{name:"tutorial_power",path:"tutorial_power",type:"dialog"},{name:"tutorial_power_reminder",path:"tutorial_power_reminder",type:"dialog"},{name:"tutorial_region",path:"tutorial_region",type:"dialog"},{name:"tutorial_defense",path:"tutorial_defense",type:"dialog"},{name:"tutorial_offroad",path:"tutorial_wall",type:"dialog"},{name:"did_you_pick_321GO",path:"did_you_pick_321GO",type:"dialog"},{name:"3",path:"3",type:"dialog"},{name:"2",path:"2",type:"dialog"},{name:"1",path:"1",type:"dialog"},{name:"GO",path:"GO",type:"dialog"},{name:"watch_out_bots",path:"watch_out_bots",type:"dialog"},{name:"falcon_dive",path:"falcon2",type:"effect"},{name:"bot_hit",path:"oddwoosh"}]};V.levelInfo=r=V.requestJson("./Levels/"+V.CurrentLevel),s=[],P(s,r.PropLocations);for(e in r.Props)r.Props.hasOwnProperty(e)&&a.images.push({name:r.Props[e].Image,src:"./Images/Props/"+r.Props[e].ImageSource});for(ea=0;ea<r.StampPreload.length;ea+=1)a.images.push({name:r.StampPreload[ea].match(/.*(?=\.)/gi)[0],src:"./Images/FloorStamps/"+r.StampPreload[ea]});for(ea=0;ea<r.FloorStamps.length;ea+=1)r.FloorStamps[ta].width>256&&r.FloorStamps[ta].height===r.FloorStamps[ta].width&&(r.FloorStamps[ta].width=256,r.FloorStamps[ta].height=256);return t=Zt.getPreloadItems(),a.images=a.images.concat(t.images),a},init:function(){function e(e,t){var a,n;Mn.timeSincePower=0,"racing"===V.raceStatus.state&&(Nt.getProgress()<=0||t!==c)&&(f=t.getAttribute("data-index"),n=Nt.setActivePower(V.CurrentPowers[f]),$(".powerBg").each(function(e,t){var a=H.special[V.CurrentPowers[e]]||H.movement[V.CurrentPowers[e]]||null;t.isDisabled=null!==a&&Rt.Fuel.available<a.stats.Cost.value,t.setAttribute("fill",t.isDisabled?"#775555":"#555555"),$(t.parentNode).children("image")[0].setAttribute("opacity",t.isDisabled?"0.2":"1")}),n?(jt("rgb(100,255,255)",.5),c=t,Mn.powerNotificationRequired=!1,t.bg.setAttribute("style","stroke: #55BBBB;"),t.fg.setAttribute("opacity","1"),U.indexOf(f)<0&&U.push(f),U.length>=4&&(a=W.read("firstTimeUsedEveryPower"),null===a&&(W.write("firstTimeUsedEveryPower",!0),V.event(V.GUID_USED_ALL_CREATURE_PARTS_FIRST_TIME)))):(t.bg.setAttribute("style","stroke: #995555;"),t.fg.setAttribute("opacity","0.2")))}function a(e,t){t.bg.setAttribute("style","")}function n(e,t){var a=H.special[V.CurrentPowers[e]]||H.movement[V.CurrentPowers[e]]||null;t.isDisabled=null!==a&&Rt.Fuel.available<a.stats.Cost.value,t.setAttribute("fill",t.isDisabled?"#775555":"#555555")}C(),V.powerUpScreen.open(V.PowerUpSelected),jt("white",1);var o,i,s,l,u,m,g,f,h=$("#help_button_open > image");if(h[0].setAttributeNS(q,"href","./Images/CockpitUI/pause_off.png"),h[1].setAttributeNS(q,"href","./Images/CockpitUI/pause_press.png"),t=[],V.help.contentId="#race_pause",T.state="init",T.countdown=3.5,D=0,B=0,L=0,U=[],Rt.maxStrafingDistance=r.MapDetails.strafeDistance,V.clearColor=r.MapDetails.clearColor,void 0!==r.PathBranches){for(i=document.getElementById("levelPaths");void 0!==i.childNodes&&i.childNodes.length>0;)i.removeChild(i.childNodes[0]);for(ea=0;ea<r.PathBranches.length;ea+=1)("string"==typeof r.PathBranches[ea].index||r.PathBranches[ea].index instanceof String)&&(r.PathBranches[ea].index=parseInt(r.PathBranches[ea].index,10)),o=document.createElementNS(Y,"path"),o.setAttribute("d",r.PathBranches[ea].path),o.setAttribute("class","motionPath"),o.setAttribute("stroke","#22325B"),o.setAttribute("stroke-width",(2*Rt.maxStrafingDistance/4+20).toString()),o.setAttribute("fill","none"),o.setAttribute("style","pointer-events:none;"),i.appendChild(o),r.PathBranches[ea].path=o}for(ea=0;ea<r.PropLocations.length;ea+=1)for(s=r.PropLocations[ea][0],ta=0;ta<K.length;ta+=1)s===K[ta].name&&(r.Props[s].Image=K[ta].animName,r.Props[s].Aspect=K[ta].aspect,K[ta].found=!0,Q.push({x:r.PropLocations[ea][1],y:r.PropLocations[ea][2],def:K[ta]}));for(ea=0;Qt>ea;ea+=1)l=document.getElementById("powerButton"+ea),ea<V.CurrentPowers.length?(l.setAttribute("style",""),u=$("#powerButton"+ea+" .button")[0],u.setAttribute("data-index",ea),u.bg=$(l).children(".powerBg")[0],u.bg.isDisabled=!1,u.fg=$("#powerButton"+ea+" image")[0],u.fg.setAttributeNS(q,"href",document.getElementById("image_icon_"+V.CurrentPowers[ea]).getAttribute("src")),$(".powerBg").each(n),F({item:u,down:e,up:a})):l.setAttribute("style","display:none;");V.MathFunctions.projection=V.createProjectionMatrix(),Rt.reset(r),Zt.reset(r),Nt.reset(),T.countSounds=3,m=document.getElementById("racing_screen_svg"),m.setAttribute("style",""),y=v[V.MathFunctions.randomInt(0,v.length-1)],void 0!==y&&null!==y&&(V.audio.setSoundVolume(y,V.InitialSettings.BackgroundMusicVolume),V.audio.playSound(y,!0)),V.audio.playSound("carsound",!0),V.audio.setSoundVolume("carsound",.45),V.audio.setSoundSpeed("carsound",1),$(V.frontCanvas).hide(),V.frontContext.setTransform(1,0,0,1,0,0),d=document.getElementById("image_"+V.CurrentLevelInfo.sky+"_sky"),V.frontContext.drawImage(d,0,0),g=V.frontContext.getImageData(0,0,988,556),f=4e3,p="rgba("+g.data[f]+","+g.data[f+1]+","+g.data[f+2]+",1)",V.frontContext.clearRect(0,0,988,556),$(V.frontCanvas).show(),$("#endgame, #winBanner, #loseBanner").hide(),V.audio.playSound("did_you_pick_321GO",!1,function(){T.state="countdown"})},uninit:function(){var e=document.getElementById("racing_screen_svg");e.setAttribute("style","display:none;"),V.audio.stopSound(y),V.audio.stopSound("carsound"),V.audio.stopSound("offroad")},update:function(){if("none"===$("#lab_help_screen_svg")[0].style.display){for(V.currentPowerUp.update(),i=Math.max(i-V.dt,0),M(),ea=0;ea<m.length;ea+=1)if(void 0!==m[ea]||null!==m[ea])switch(m[ea].animDetails.update(),m[ea].AnimMode){case"show":m[ea].alpha=1;break;case"fadeout":m[ea].alpha-=.8*V.dt,m[ea].alpha<0&&(m[ea]=null);break;case"remove":m[ea]=null}for(;m.indexOf(null)>-1;)m.splice(m.indexOf(null),1);switch(V.audio.setSoundSpeed("carsound",.8+("racing"===T.state?Rt.currentVelocity/80:0)),T.state){case"init":break;case"countdown":T.countdown-=V.dt,T.countdown<=0&&(T.countdown=1,T.showGo=!0,T.state="racing",V.playEffect("go"),V.audio.playSound("GO"),Mn.timeSinceMovement=0,Mn.timeSincePower=0),T.countdown<T.countSounds&&(T.countSounds=T.countSounds-1,T.countSounds<3&&V.audio.playSound(Math.round(T.countdown).toString()));break;case"racing":if(Mn.update(),Rt.update(),Zt.update(),T.playerProgress=Rt.animation.getRaceProgress(Rt.currentTime),T.zachProgress=Zt.getProgress(),D+=V.dt,a.push(Math.round(1/V.dt)),T.playerProgress>=.5&&!Rt.reachedHalfway&&(Rt.reachedHalfway=!0,V.event(V.GUID_REACH_HALF_WAY_MARK)),a.length>20){for(Ka=0,ea=0;ea<a.length;ea+=1)Ka+=a[ea];t.push(Ka/a.length),a=[]}Xa=T.playerProgress>T.zachProgress?"player":"zach",Xa!==T.leader&&(T.leader=Xa,en=new Date,en-T.lastPassSound>2e3&&(T.lastPassSound=en,V.audio.playSound("player"===Xa?"take_lead_"+Math.ceil(3*Math.random()):"lose_lead"))),T.countdown>0&&(T.countdown-=V.dt,T.countdown<0&&(T.showGo=!1)),R>0&&(R=V.MathFunctions.clamp(R-.5*V.dt,0,2));break;case"playerWin":case"zachWin":case"idle":}for(ea=0;ea<r.Hazards.length;ea+=1)tn=r.Hazards[ea],an=Math.pow(tn[2]-Rt.position.x,2)+Math.pow(tn[3]-Rt.position.y,2),nn=r.Hazards[ea][1]*r.Hazards[ea][1]*16,nn>an&&Rt.onCollision(tn)&&"impact"===Rt.hazards[tn[0]].type&&r.Hazards.splice(ea,1);for(ea=0;ea<K.length;ea+=1)on=K[ea],on.found&&on.active&&document.getElementById("image_"+on.animName).animDetails.update();for(ea=0;ea<Q.length;ea+=1)rn=Q[ea],rn.def.active||Math.pow(rn.x-Rt.position.x,2)+Math.pow(rn.y-Rt.position.y,2)<4e4&&(Q[ea].def.active=!0,Q[ea].def.callback());N||(document.getElementById("image_anim_moveLeft").animDetails.update(),document.getElementById("image_anim_moveRight").animDetails.update()),document.getElementById("powerConsole").setAttribute("transform","translate(0,"+B+")"),Rt.Fuel.available<4?document.getElementById("image_anim_energyIcon").animDetails.update():document.getElementById("image_anim_energyIcon").animDetails.reset(),J&&(sn=!1,Z.moveRight?(Z.x+=Ft.x*V.dt,Z.x>=V.FrameSize.x&&(Z.moveRight=!1,Z.passes=Z.passes+1,sn=!0)):(Z.x-=Ft.x*V.dt,Z.x<=-Z.width&&(Z.moveRight=!0,Z.passes=Z.passes+1,sn=!0)),Z.passes>=kt.FalconDistractorPasses?V.currentPowerUp.complete():sn&&(Zt.onFalconDistractor(),V.audio.playSound("falcon_dive")),Z.x=V.MathFunctions.clamp(Z.x,-Z.width,V.FrameSize.x),ln=Math.sin((Z.x+Z.width)/Ot*Math.PI),Z.y=Ut+ln*Gt),Rt.protectorActive&&(O.y+=zt*Wt*V.dt,O.y>zt&&(O.y-=zt),O.x+=Math.PI*Wt*V.dt,O.x>zt&&(O.x-=zt),un=1+Math.sin(O.y)/2,j.y=Vt*un,j.x=Yt+Ht*Math.cos(O.x))}},draw:function(e){function t(e,t,a,n,o,i){return i.visible=!1,i.x=0,i.y=0,i.w=0,i.h=0,i.a=0,i.sortvalue=0,pa=[e-Rt.position.x,t-Rt.position.y],ma=Math.sqrt(Math.pow(pa[0],2)+Math.pow(pa[1],2)),ma>V.performance.drawDistance&&!da?i:(pa[0]/=ma,pa[1]/=ma,ga=Math.atan2(pa[0],pa[1]),Math.abs(V.MathFunctions.rotationDifference(-ga,Rt.position.rotation))>V.performance.drawMaxAngle?i:(ga+=Rt.position.rotation,fa=[-Math.sin(ga)*ma,-Math.cos(ga)*ma],ha=da?1:4.6*(V.performance.drawDistance/800)- -fa[1]/170,ha=V.MathFunctions.clamp(ha,0,1),.01>ha?i:(ya=o||0,ba=V.MathFunctions.TransformPoint(fa[0],20+Lt.posY,fa[1],1,V.MathFunctions.projection),xa=V.MathFunctions.TransformPoint(fa[0],20+Lt.posY+a,fa[1],1,V.MathFunctions.projection),ba[1]<0?i:(ba[0]*=w,ba[0]+=494,ba[1]*=b,wa=Math.abs(ba[1]-xa[1])/(20+Lt.posY),ba[1]+=x,va=wa*a*20,_a=va*n,ba[1]+=250,i.visible=!0,i.img=null,i.x=ba[0]-_a/2,i.y=ba[1]-va-ya*Math.abs(500+fa[1]),i.w=_a,i.h=va,i.a=ha,i.sortvalue=fa[1],i))))}for(da=V.performance.drawAllProps,ya=0,Aa=[],Za=!0,g=V.performance.horizon+.7*Lt.posY,Ja=g+Lt.lookY,e.setTransform(1,0,0,1,0,0),e.clearRect(0,Ja,988,556-Ja),V.floorContext.setTransform(1,0,0,1,0,0),V.floorContext.fillStyle=V.clearColor,V.floorContext.fillRect(0,0,988,556),ta=0;ta<r.FloorStamps.length;ta+=1)oa=r.FloorStamps[ta],V.floorContext.setTransform(1,0,0,1,0,0),V.floorContext.translate(V.floorCanvas.width/2,V.floorCanvas.height),V.floorContext.rotate(-Rt.position.rotation+Math.PI),V.floorContext.translate(-Rt.position.x+oa.x,-Rt.position.y+oa.y),V.floorContext.rotate(oa.rotation*(Math.PI/180)),V.floorContext.translate(-oa.width/2,-oa.height/2),ia=document.getElementById("image_"+oa.imageId),V.floorContext.drawImage(ia,0,0,Math.floor(oa.width),Math.floor(oa.height));for(ra=300*-Rt.position.rotation;ra>h[0]/2;)ra-=h[0];for(;ra<-h[0]/2;)ra+=h[0];if(e.fillStyle=p,e.fillRect(0,0,988,Ja),e.setTransform(1,0,0,1,ra,g-h[1]),e.drawImage(d,0,Math.floor(Lt.lookY),Math.floor(h[0]+1),Math.floor(h[1])),e.setTransform(1,0,0,1,ra+h[0],g-h[1]),e.drawImage(d,0,Math.floor(Lt.lookY),Math.floor(h[0]+1),Math.floor(h[1])),e.setTransform(1,0,0,1,ra-h[0],g-h[1]),e.drawImage(d,0,Math.floor(Lt.lookY),Math.floor(h[0]+1),Math.floor(h[1])),e.setTransform(1,0,0,1,0,0),V.performance.drawGradient){for(sa=15,la=new Date,la-u>500&&(u=la,l.length>=sa&&l.shift(),l.push(V.floorContext.getImageData(494,80,1,1).data)),ua=[0,0,0],ea=0;sa>ea;ea+=1)ea<l.length&&(ua[0]+=l[ea][0],ua[1]+=l[ea][1],ua[2]+=l[ea][2]);ua[0]/=l.length,ua[1]/=l.length,ua[2]/=l.length,ca=e.createLinearGradient(0,g+Lt.lookY,0,g+Lt.lookY+40),ca.addColorStop(0,k(ua,1,1)),ca.addColorStop(.3,k(ua,1,1)),ca.addColorStop(1,k(ua,0,1)),e.fillStyle=ca,e.fillRect(0,g+Lt.lookY-5,988,556-(g+Lt.lookY-5))}for(Sa=[[Rt.position.x,Rt.position.y],[Rt.position.x+Math.cos(Rt.position.rotation+qt)*V.performance.drawDistance,Rt.position.y+Math.sin(Rt.position.rotation+qt)*V.performance.drawDistance],[Rt.position.x+Math.cos(Rt.position.rotation+qt+V.performance.drawMaxAngle)*V.performance.drawDistance,Rt.position.y+Math.sin(Rt.position.rotation+qt+V.performance.drawMaxAngle)*V.performance.drawDistance],[Rt.position.x+Math.cos(Rt.position.rotation+qt-V.performance.drawMaxAngle)*V.performance.drawDistance,Rt.position.y+Math.sin(Rt.position.rotation+qt-V.performance.drawMaxAngle)*V.performance.drawDistance]],Pa=Sa[0][0],Ma=Sa[0][1],Ca=Sa[0][0],ka=Sa[0][1],ea=1;ea<Sa.length;ea+=1)Pa=Math.min(Sa[ea][0],Pa),Ma=Math.min(Sa[ea][1],Ma),Ca=Math.max(Sa[ea][0],Ca),ka=Math.max(Sa[ea][1],ka);for(Pa=V.MathFunctions.clamp(Math.floor(Pa/Kt),0,Xt-1),Ma=V.MathFunctions.clamp(Math.floor(Ma/Kt),0,Xt-1),Ca=V.MathFunctions.clamp(Math.floor(Ca/Kt),0,Xt-1),ka=V.MathFunctions.clamp(Math.floor(ka/Kt),0,Xt-1),aa=Pa;Ca+1>aa;aa+=1)for(na=Ma;ka+1>na;na+=1)for(ea=0;ea<s[aa][na].length;ea+=1)Ta=r.PropLocations[s[aa][na][ea]],(void 0===Ta.drawResult||null===Ta.drawResult)&&(Ta.drawResult={visible:!1,x:0,y:0,w:0,h:0,a:0,sortvalue:0}),Ia=r.Props[Ta[0]],t(Ta[1],Ta[2],Ia.HeightScale,Ia.Aspect,0,Ta.drawResult),Ta.drawResult.visible&&(Ta.drawResult.img=document.getElementById("image_"+Ia.Image),Ta.drawResult.x=Math.floor(Ta.drawResult.x),Ta.drawResult.y=Math.floor(Ta.drawResult.y),Ta.drawResult.h=Math.floor(Ta.drawResult.h),Ta.drawResult.w=Math.floor(Ta.drawResult.w),Aa.push(Ta.drawResult));for(Zt.draw(e,t,Aa),Aa.sort(function(e,t){return e.sortvalue>t.sortvalue?1:-1}),ea=V.performance.maxRenderProps>Aa.length?0:Aa.length-V.performance.maxRenderProps;ea<Aa.length;ea+=1)e.globalAlpha=Aa[ea].a,void 0!==Aa[ea].flipH&&Aa[ea].flipH===!0?(e.setTransform(-1,0,0,1,Aa[ea].x+Aa[ea].w,Aa[ea].y+Lt.lookY),void 0!==Aa[ea].img.animDetails?Aa[ea].img.animDetails.draw(e,0,0,Aa[ea].w,Aa[ea].h):e.drawImage(Aa[ea].img,0,0,Aa[ea].w,Aa[ea].h)):void 0!==Aa[ea].img.animDetails?Aa[ea].img.animDetails.draw(e,Aa[ea].x,Aa[ea].y+Lt.lookY,Aa[ea].w,Aa[ea].h):e.drawImage(Aa[ea].img,Aa[ea].x,Aa[ea].y+Lt.lookY,Aa[ea].w,Aa[ea].h),e.setTransform(1,0,0,1,0,0);for(e.globalAlpha=1,J&&(Z.moveRight===!1?(e.setTransform(-1,0,0,1,Z.x+Z.width,Z.y+Lt.lookY),document.getElementById("image_falcon").animDetails.draw(e,0,0,Z.width,Z.height),e.setTransform(1,0,0,1,0,0)):document.getElementById("image_falcon").animDetails.draw(e,Z.x,Z.y,Z.width,Z.height,!1)),ea=0;ea<m.length;ea+=1)e.globalAlpha=m[ea].alpha,m[ea].animDetails.draw(e,0,0,988,556);for(e.globalAlpha=1,i>0&&(e.fillStyle=o,e.globalAlpha=i,e.fillRect(0,0,988,556),e.globalAlpha=1),Rt.protectorActive&&e.drawImage(document.getElementById("image_horn"),Math.floor(j.x),Math.floor(j.y)),e.drawImage(document.getElementById("image_consolebg"),47,447),document.getElementById("image_anim_energyIcon").animDetails.draw(e,74,507,50,50),Ea="image_racer_"+Nt.getCurrentRacerName(),J?Ea="image_falcon_distractor":Rt.protectorActive&&(Ea="image_rhino_protector"),n(e,document.getElementById(Ea),0,0,450,250,583,462,158,76),N||(e.globalAlpha=R,e.fillStyle="rgba(181,271,267,0.2)",e.strokeStyle="#5BABA7",e.lineWidth=5,e.fillRect(244,40,500,300),e.strokeRect(244,40,500,300),document.getElementById("image_anim_moveLeft").animDetails.draw(e,244,150,99,128,!1),document.getElementById("image_anim_moveRight").animDetails.draw(e,645,150,99,128,!1),e.globalAlpha=1),e.font="120pt DINE",e.fillStyle="white",e.textAlign="center",e.strokeStyle="black",e.lineWidth=5,T.showGo?(e.fillStyle="#84db9d",e.fillText("GO",494,250),e.strokeText("GO",494,250)):T.countdown>0&&T.countdown<3&&(e.fillText(Math.ceil(T.countdown).toString(),494,250),e.strokeText(Math.ceil(T.countdown).toString(),494,250)),e.fillStyle="#22325B",e.fillRect(4,155,86,21),e.fillStyle="#0EDB6B",e.fillRect(4,155,86*T.playerProgress,21),e.fillStyle="#912921",e.fillRect(4+86*T.zachProgress-2.5,155,5,21),e.drawImage(document.getElementById("image_minimap"),0,0),Da=zt/Rt.Fuel.total,L+=zt*V.dt,L>zt&&(L-=zt),V.frontContext.beginPath(),ea=0;ea<Rt.Fuel.total;ea+=1)Ba=L+Da*ea,Ra=(Math.sin(Ba)+1)/2*75,Na="rgba("+Math.round(135+Ra)+","+Math.round(217+Ra)+",255, 1)",V.frontContext.moveTo(148+20.5*ea,536),ea<Rt.Fuel.available?G(138+20.5*ea,536,10,Na,"#D6D6D6",2):(Za&&(V.frontContext.fill(),V.frontContext.stroke(),V.frontContext.beginPath(),Za=!1),G(138+20.5*ea,536,10,"#001226","#D6D6D6",2));for(V.frontContext.fill(),V.frontContext.stroke(),V.frontContext.beginPath(),ea=0;ea<Nt.fuelBurnEffectCount;ea+=1)ea>=Rt.Fuel.available&&(V.frontContext.moveTo(148+20.5*ea,536),G(138+20.5*ea,536,10,"rgba("+Math.floor(255*(Nt.fuelBurnEffectCount-ea))+",18,38,1)","#D6D6D6",2));if(V.frontContext.fill(),V.frontContext.stroke(),e.textAlign="end",e.fillStyle="#001226",e.font="26px badaboom",e.fillText(parseInt(Rt.currentVelocity,10).toString(),465,505),La=parseInt(D/60,10),Fa=parseInt(D-60*La,10),za=10>Fa?":0":":",e.fillText(La+za+Fa,385,505),e.font="20px badaboom",e.fillText("MPH",495,505),e.textAlign="start",V.CurrentPowers.length>0){for(e.strokeStyle="#22325B",e.lineWidth=40,e.beginPath(),e.arc(838,556+B,50,Math.PI,1.5*Math.PI),e.stroke(),ea=0;ea<S.length;ea+=1)S[ea][0]<V.CurrentPowers.length&&(e.beginPath(),e.moveTo(A[S[ea][0]][0],A[S[ea][0]][1]+B),e.lineTo(A[S[ea][1]][0],A[S[ea][1]][1]+B),e.stroke());for(ea=0;ea<V.CurrentPowers.length;ea+=1)Ua=$("#powerButton"+ea)[0],$a=$(Ua).children(".powerBg")[0],Ga=$(Ua).children("image")[0],Oa=H.special[V.CurrentPowers[ea]]||H.movement[V.CurrentPowers[ea]],Rt.Fuel.available<Oa.stats.Cost.value?$a.isDisabled||($a.isDisabled=!0,$a.setAttribute("fill","#775555"),Ga.setAttribute("opacity","0.2")):$a.isDisabled&&($a.isDisabled=!1,$a.setAttribute("fill","#555555"),Ga.setAttribute("opacity","1"));null!==c&&(Ha=Nt.getProgress(),Wa=Math.PI+qt,Va=Wa+zt*Ha,Ya=c.getAttribute("data-index"),$a=$("#powerButton"+Ya+" .powerBg")[0],qa=document.getElementById("activeGradient"),null!==qa&&void 0!==qa&&(Qa=0,.5>1-Ha?(Qa=V.MathFunctions.lerp(2*(1-Ha),100,0),document.getElementById("activeGradStop1").setAttribute("stop-color","#00edff")):(Qa=V.MathFunctions.lerp(2*(1-Ha-.5),0,100),document.getElementById("activeGradStop1").setAttribute("stop-color","#dd2222")),qa.setAttribute("r",Qa+"%")),null!==$a&&void 0!==$a&&(Ha>0?$a.setAttribute("fill","url(#activeGradient)"):($a.setAttribute("fill",$a.isDisabled?"#775555":"#555555"),c.fg.setAttribute("opacity",$a.isDisabled?"0.2":"1"))),ja=c.parentNode.transform.baseVal.getItem(0).matrix,e.strokeStyle=.25>Ha?"rgba(200, 20, 20, 0.8)":"rgba(0, 195, 255, 0.8)",e.lineWidth=15,e.beginPath(),e.arc(ja.e,ja.f,parseInt(c.getAttribute("r"),10),Wa,Va),e.stroke())}}}}function E(){"use strict";function e(e){Mn.trigger("zachbot");var t={},a=100,n=e,o=[An.x,An.y],i=document.getElementById("image_zach_bot"),r=document.getElementById("zachBotsRepresentation"),s=document.createElementNS(Y,"circle"),l=null,u=0,c=0,d=0;return s.setAttribute("cx","0"),s.setAttribute("cy","0"),s.setAttribute("r","5"),s.setAttribute("fill","yellow"),s.setAttribute("stroke","none"),r.appendChild(s),{update:function(){0>a||(o[0]+=n[0]*gn*V.dt,o[1]+=n[1]*gn*V.dt,a-=1,l=[o[0]-Rt.position.x,o[1]-Rt.position.y],u=Math.sqrt(Math.pow(l[0],2)+Math.pow(l[1],2)),xn>u&&(l[0]/=u,l[1]/=u,c=-Math.atan2(l[0],l[1]),d=Math.abs(V.MathFunctions.rotationDifference(c,Rt.position.rotation)),1>d&&(Rt.onCollision(["zachbot",0,o[0],o[1]]),V.audio.playSound("bot_hit")),a=-1),null!==s&&s.setAttribute("transform","translate("+o[0]/4+","+o[1]/4+")"))},draw:function(e,n,r){0>a||(t=n(o[0],o[1],hn.h,hn.a,fn,t),t.visible&&(t.img=i,r.push(t)))},isDead:function(){return null!==s&&0>a&&r.removeChild(s),0>a}}}var t,a,n,o,i,r,s,l,u,c,d,p,m,g,f,h=null,y=null,v={},_=0,w=[],x=0,A=0,I=vn,S=null,P=0,M=0,C=[0,0],k={winEvent:function(){V.raceStatus.state="zachWin",V.audio.stopAllNonLoopSounds(),V.audio.stopSound("carsound"),V.audio.stopSound("offroad"),V.audio.playSound("losesound")},getProgress:function(){return y.getRaceProgress(_)},reset:function(e){void 0!==e.PathBranches&&(y=new b(e.PathBranches,null,k.winEvent,!1));var t=y.getPointAtTime(0);An={x:4*t.x,y:4*t.y,h:1.5,aspect:400/300,rotation:0,flipImage:!1},k.updateMap(),x=0,_=0,P=0},getPreloadItems:function(){var e={images:[{name:"zach_back_straight",src:"./Images/Animations/zach_back_straight.png",anim:{direction:"y",frames:3,time:.2}},{name:"zach_back_angle1L",src:"./Images/Animations/zach_back_angled.png",anim:{direction:"y",frames:3,time:.2}},{name:"zach_back_angle2L",src:"./Images/Animations/zach_back_moar_angled.png",anim:{direction:"y",frames:3,time:.2}},{name:"zach_straight",src:"./Images/Animations/zach_straight.png",anim:{direction:"y",frames:3,time:.2}},{name:"zach_angle1L",src:"./Images/Animations/zach_angled.png",anim:{direction:"y",frames:3,time:.2}},{name:"zach_angle2L",src:"./Images/Animations/zach_moar_angled.png",anim:{direction:"y",frames:3,time:.2}},{name:"zach_bot",src:"./Images/Zach/zachbot.png"}]};return e},updateMap:function(){null===S&&(S=document.getElementById("zachRepresentation")),S.setAttribute("transform","translate("+An.x/4+","+An.y/4+") rotate("+An.rotation*(180/Math.PI)+")"),document.getElementById("zachCircle").setAttribute("fill","red")},update:function(){for(t=y.getRaceProgress(_),a=Rt.animation.getRaceProgress(Rt.currentTime),n=y.getRaceLength(),o=(t-a)*n,I-=V.dt,i=!(t>wn&&.6>I),0>I&&(I=vn,t>wn&&"zach"===V.raceStatus.leader&&(r=[Rt.position.x-An.x,Rt.position.y-An.y],s=Math.pow(r[0],2)+Math.pow(r[1],2),_n>s&&(r[0]/=s,r[1]/=s,w.push(e(r))))),l=0;l<w.length;l+=1)w[l].update(),w[l].isDead()&&w.splice(l,1);if(null!==y){if(k.calculateSpeed(o),_+=V.dt*x,u=y.getMaxTime(),c=y.getPointAtTime(_/u),An.x=4*c.x,An.y=4*c.y,_>u&&(_-=u,u=y.getMaxTime(),c=y.getPointAtTime(_/u),An.x=4*c.x,An.y=4*c.y),u>=_+bn){for(d=y.getPointAtTime((_+bn)/u),p=[d.x-c.x,d.y-c.y],m=Math.sqrt(Math.pow(p[0],2)+Math.pow(p[1],2)),C=[-p[1]/m,p[0]/m],An.rotation=-Math.atan2(p[0],p[1]),g=Rt.position.rotation;g>An.rotation+Math.PI;)g-=2*Math.PI;for(;g<An.rotation-Math.PI;)g+=2*Math.PI;f=An.rotation-g,Math.abs(f)<.3?h=document.getElementById(i?"image_zach_back_straight":"image_zach_straight"):Math.abs(f)<.6?0>f?(h=document.getElementById(i?"image_zach_back_angle1L":"image_zach_angle1L"),An.flipImage=!1):(h=document.getElementById(i?"image_zach_back_angle1L":"image_zach_angle1L"),An.flipImage=!0):0>f?(h=document.getElementById(i?"image_zach_back_angle2L":"image_zach_angle2L"),An.flipImage=!1):(h=document.getElementById(i?"image_zach_back_angle2L":"image_zach_angle2L"),An.flipImage=!0)}P+=x*V.dt*.02,M=Math.sin(P)*Rt.maxStrafingDistance*.4,An.x+=C[0]*M,An.y+=C[1]*M,h.animDetails.update(),k.updateMap()}},draw:function(e,t,a){for(null!==h&&(v=t(An.x,An.y,An.h,An.aspect,0,v),v.visible&&(v.img=h,v.flipH=An.flipImage,a.push(v))),l=0;l<w.length;l+=1)w[l].draw(e,t,a)},onSkunkAttack:function(){r=[Rt.position.x-An.x,Rt.position.y-An.y],s=Math.pow(r[0],2)+Math.pow(r[1],2),_n>s&&(x*=cn)},onFalconDistractor:function(){x*=cn},calculateSpeed:function(e){var t,a,n,o=Rt.hazards.none;for(l=0;l<V.levelInfo.Hazards.length;l+=1)"impact"!==Rt.hazards[V.levelInfo.Hazards[l][0]].type&&(t=Math.sqrt(Math.pow(V.levelInfo.Hazards[l][2]-An.x,2)+Math.pow(V.levelInfo.Hazards[l][3]-An.y,2)),t<4*V.levelInfo.Hazards[l][1]&&(o=Rt.hazards[V.levelInfo.Hazards[l][0]]));A=Tt+O[o.boost||"Run"]*Dt,A*=0>e?e>-dn?1:e>-pn?1.03:1.1:dn>e?1:pn>e?.9:.5,a=1,a-=.06*V.RacerWeight,n=(A+Math.cos(P)*mn)*a,n>x?x+=V.dt*yn:x>n&&(x-=V.dt*yn)}};return k}function D(){"use strict";var e={},t=null,a=0,o="idle",i=1,r=1,s=[50,490,700,45],l=[{duration:2,aviva_frame:0,channel_frame:-1,asset_change:!1},{duration:.1,aviva_frame:1,channel_frame:-1,asset_change:!1},{duration:.1,aviva_frame:2,channel_frame:-1,asset_change:!1},{duration:.1,aviva_frame:3,channel_frame:0,asset_change:!1},{duration:.1,aviva_frame:0,channel_frame:1,asset_change:!0}],u=["image_loading_racer_cheetah","image_loading_racer_falcon","image_loading_racer_pronghorn","image_loading_racer_skunk","image_loading_racer_tortoise"],c=0,d=0,p=Math.floor(Math.random()*u.length);this.addScene=function(t){e[t.name]=t},this.reset=function(){if(null!==t){var e=t.name;t.uninit(),this.changeScene(e)}},this.changeScene=function(n){function s(){o="delay",i=1,r=i}if($("#splashImage").hide(),$("#svgCanvas").hide(),o="loading",a=0,this.draw(V.frontContext),null!==t&&t.uninit(),V.audio.stopAllSounds(),t=e[n],void 0!==t.getPreloadItems){var l=t.getPreloadItems();V.PreLoadFromList(l.images,l.sounds,function(){s()},function(e){a=e})}else void 0!==t.preloadItems&&null!==t.preloadItems?V.PreLoadFromList(t.preloadItems.images,t.preloadItems.sounds,function(){s()
},function(e){a=e}):s()},this.update=function(){if("idle"===o&&t.update(),"delay"===o&&(i-=V.dt,0>i&&(t.init(),o="idle",$("#svgCanvas").show())),"loading"===o||"delay"===o){if(d+=1.5*V.dt,d>l[c].duration&&(d=0,c+=1,c>=l.length&&(c=0),l[c].asset_change))for(var e=p;e===p;)p=Math.floor(Math.random()*u.length);document.getElementById("image_loadingAvivaAnim").animDetails.setFrame(l[c].aviva_frame),l[c].channel_frame>-1&&document.getElementById("image_staticAnim").animDetails.setFrame(l[c].channel_frame)}},this.draw=function(e){if("loading"===o||"delay"===o){V.frontContext.setTransform(1,0,0,1,0,0),V.frontContext.fillStyle="black",V.frontContext.fillRect(0,0,988,556),e.drawImage(document.getElementById("image_loadingBackground"),0,0,988,566);var d=document.getElementById(u[p]);n(e,d,0,0,d.naturalWidth,d.naturalHeight,160,45,476,268),l[c].channel_frame>-1&&document.getElementById("image_staticAnim").animDetails.draw(e,149,35,496,288),document.getElementById("image_loadingAvivaAnim").animDetails.draw(e,675,75,285,500),"delay"===o&&(e.globalAlpha=i/r),V.frontContext.fillStyle="#222222",e.strokeStyle="black",e.lineWidth=2,V.frontContext.fillRect(s[0],s[1],s[2],s[3]),V.frontContext.strokeRect(s[0],s[1],s[2],s[3]),V.frontContext.fillStyle="#005500",V.frontContext.textAlign="center",V.frontContext.font="26pt Calibri",V.frontContext.fillText("Loading...",s[0]+s[2]/2,523),V.frontContext.fillStyle="green",V.frontContext.fillRect(s[0],s[1],s[2]*a,s[3]),e.save(),e.beginPath(),e.moveTo(s[0],s[1]),e.lineTo(s[0]+s[2]*a,s[1]),e.lineTo(s[0]+s[2]*a,s[1]+s[3]),e.lineTo(s[0],s[1]+s[3]),e.closePath(),e.clip(),V.frontContext.fillStyle="white",V.frontContext.fillText("Loading...",s[0]+s[2]/2,523),e.restore(),e.globalAlpha=1}else"idle"===o&&t.draw(e);V.support.desktop&&$("#debugWatchBox").is(":visible")&&(V.frontContext.setTransform(1,0,0,1,0,0),V.frontContext.fillStyle="white",V.font="10pt badaboom",V.frontContext.fillText(Math.round(1/V.dt)+"fps",800,40))}}function B(){"use strict";function e(){var e;for(e=0;e<i.preloadItems.alternateSounds.length;e+=1)V.audio.loadSound(i.preloadItems.alternateSounds[e].name,i.preloadItems.alternateSounds[e].path,i.preloadItems.alternateSounds[e].type,1)}var t={x:V.FrameSize.x-200,y:0,width:200,height:200,image:"image_logo"},a={x:0,y:0,width:V.FrameSize.x,height:V.FrameSize.y,image:"image_splash"},n={x:V.FrameSize.x-154,y:V.FrameSize.y-120,width:154,height:120,imageEnabled:"./Images/Play_Button.png",imageDisabled:"./Images/Play_Button_Pressed.png"},o={x:350,y:100,fontSize:72,text:"Creature Mobile"},i={name:"splashScene",preloadItems:{images:[{name:"splash",src:"./Images/Splash.png"},{name:"logo",src:"./Images/Logo.png"}],alternateSounds:[{name:"setup_intro",path:"setup_intro",type:"dialog"},{name:"click",path:"click",type:"effect"},{name:"labintro",path:"labintro",type:"dialog"},{name:"powersintro",path:"powersintro",type:"dialog"},{name:"labtutorial_snow",path:"lab_tuts_levelconditions",type:"dialog"},{name:"labtutorial_next",path:"lab_tuts_hitnext",type:"dialog"},{name:"labtutorial_powers",path:"lab_tuts_powers",type:"dialog"},{name:"labtutorial_remove",path:"lab_tuts_remove",type:"dialog"},{name:"labtutorial_begin",path:"lab_tuts_begin",type:"dialog"},{name:"lab_tuts_powerstats",path:"lab_tuts_powerstats",type:"dialog"},{name:"lab_description_weight",path:"lab_description_weight",type:"dialog"},{name:"lab_description_cost",path:"lab_description_cost",type:"dialog"},{name:"lab_description_duration",path:"lab_description_duration",type:"dialog"},{name:"lab_tuts_movement_attachments",path:"lab_tuts_movement_attachments",type:"dialog"},{name:"lab_tuts_defensive_attachments",path:"lab_tuts_defensive_attachments",type:"dialog"},{name:"lab_tuts_emptyslot",path:"lab_tuts_emptyslot",type:"dialog"},{name:"racer_too_heavy",path:"racer_too_heavy",type:"dialog"},{name:"attachment_removed",path:"attachment_removed",type:"dialog"},{name:"lets_race",path:"lets_race",type:"dialog"},{name:"add_1",path:"added",type:"dialog"},{name:"add_2",path:"you_got_it",type:"dialog"},{name:"add_3",path:"racer_looks_good",type:"dialog"},{name:"aviva_react_1",path:"aviva_react_1",type:"effect"},{name:"aviva_react_2",path:"aviva_react_2",type:"effect"},{name:"aviva_react_3",path:"aviva_react_3",type:"effect"},{name:"aviva_react_4",path:"aviva_react_4",type:"effect"},{name:"race_bg",path:"badracingmusic",type:"music"},{name:"playerpass",path:"pass2",type:"effect"},{name:"zachpass",path:"pass1",type:"effect"},{name:"cool",path:"thisiscool",type:"dialog"},{name:"carsound",path:"carsound",type:"effect"},{name:"offroad",path:"offroad",type:"effect"},{name:"smart",path:"smart",type:"dialog"},{name:"winsound",path:"winsound",type:"dialog"},{name:"losesound",path:"losesound",type:"dialog"},{name:"take_lead_1",path:"see_ya_zach",type:"dialog"},{name:"take_lead_2",path:"youre_winning",type:"dialog"},{name:"take_lead_3",path:"woo",type:"dialog"},{name:"lose_lead",path:"zach_leading",type:"dialog"},{name:"tutorial_move",path:"tutorial_move",type:"dialog"},{name:"tutorial_power",path:"tutorial_power",type:"dialog"},{name:"tutorial_power_reminder",path:"tutorial_power_reminder",type:"dialog"},{name:"tutorial_region",path:"tutorial_region",type:"dialog"},{name:"tutorial_defense",path:"tutorial_defense",type:"dialog"},{name:"tutorial_offroad",path:"tutorial_wall",type:"dialog"},{name:"did_you_pick_321GO",path:"did_you_pick_321GO",type:"dialog"},{name:"3",path:"3",type:"dialog"},{name:"2",path:"2",type:"dialog"},{name:"1",path:"1",type:"dialog"},{name:"GO",path:"GO",type:"dialog"},{name:"watch_out_bots",path:"watch_out_bots",type:"dialog"},{name:"falcon_dive",path:"falcon2",type:"effect"},{name:"bot_hit",path:"oddwoosh"},{name:"activate_Cheetah2",path:"Cheetah2",type:"effect"},{name:"activate_otter",path:"otter",type:"effect"},{name:"activate_hummingbird",path:"hummingbird",type:"effect"},{name:"activate_falcon2",path:"falcon2",type:"effect"},{name:"activate_dolphin",path:"dolphin",type:"effect"},{name:"activate_skunk",path:"skunk",type:"effect"},{name:"activate_bison",path:"bison",type:"effect"}]},init:function(){var t,a=document.getElementById("svgCanvas"),i=document.createElementNS(Y,"text");i.setAttribute("x",o.x.toString()),i.setAttribute("y",o.y.toString()),i.setAttribute("font-size",o.fontSize+"px"),i.setAttribute("fill","white"),i.setAttribute("stroke","black"),i.setAttribute("stroke-width","2.0"),i.setAttribute("style","font-family: badaboom"),i.textContent=o.text,a.appendChild(i),t=z(n.x,n.y,n.width,n.height,a,{sound:"click",up:n.imageEnabled,down:n.imageDisabled,event:function(){V.support.webAudio||e(),V.sceneManager.changeScene("labScene"),$(t).hide(),$(i).hide()}}),$(document.getElementById("help_toggle_button")).hide()},uninit:function(){$(document.getElementById("help_toggle_button")).show()},update:function(){return void 0},draw:function(e){e.drawImage(document.getElementById(a.image),a.x,a.y,a.width,a.height),e.drawImage(document.getElementById(t.image),t.x,t.y,t.width,t.height)}};return i}function R(e,t){"use strict";function a(){n=setTimeout(a,e),t()}if(!isNaN(e)&&void 0!==t&&null!==t){var n=null;return{start:function(){a()},stop:function(){clearTimeout(n)}}}}function N(e){"use strict";$(e).unbind("contextmenu"),$(e).unbind("mousedown"),$(e).unbind("mouseup"),$(e).unbind("mousemove"),$(e).unbind("mouseleave"),$(e).unbind("click"),$(e).unbind("touchstart"),$(e).unbind("touchend"),$(e).unbind("touchmove")}function L(){"use strict";V.support.iOS&&(document.ontouchmove=function(e){e.preventDefault()})}function F(e){"use strict";var t,a={item:null,down:function(){return void 0},up:function(){return void 0},move:function(){return void 0},stopEvent:!0,allowMultiple:!1,allowUpWithoutDown:!0},n=!1,o=!1,i=null,r=null;for(t in e)e.hasOwnProperty(t)&&(a[t]=e[t]);void 0!==a.item&&null!==a.item&&(N(e.item),a.item.TouchEventInfo=a,$(a.item).on("contextmenu",function(){return!1}),V.support.desktop&&($(a.item).on("mousedown",function(e){(!o&&!n||a.allowMultiple)&&(o=!0,a.down(e,this),a.stopEvent&&e.stopPropagation())}),$(a.item).on("mouseup",function(e){(o||a.allowUpWithoutDown)&&(o=!1,a.up(e,this),a.stopEvent&&e.stopPropagation())}),$(a.item).on("mouseleave",function(e){o&&(o=!1,a.up(e,this),a.stopEvent&&e.stopPropagation())}),$(a.item).on("mousemove",function(e){if(null!==i){var t=e.pageX-i.pageX,n=e.pageY-i.pageY;(0!==t||0!==n)&&a.move(e,t,n,this)}i=e,a.stopEvent&&e.stopPropagation()})),V.support.mobile&&($(a.item).on("click",function(e){e.preventDefault()}),$(a.item).on("touchstart",function(e){e.preventDefault(),(!o&&!n||a.allowMultiple)&&(n=!0,a.down(e,this),r=null,a.stopEvent&&e.stopPropagation())}),$(a.item).on("touchend",function(e){e.preventDefault(),(n||a.allowUpWithoutDown)&&(n=!1,a.up(e,this),a.stopEvent&&e.stopPropagation())}),$(a.item).on("touchmove",function(e){var t,n,o=e.originalEvent;o.preventDefault();try{null!==r&&(t=o.touches[0].pageX-r[0],n=o.touches[0].pageY-r[1],(0!==t||0!==n)&&a.move(o,t,n,this)),r=[o.touches[0].pageX,o.touches[0].pageY]}catch(i){}a.stopEvent&&o.stopPropagation()})))}function z(e,t,a,n,o,i){"use strict";var r,s,l,u={up:"",down:"",event:function(){return void 0},sound:null,text:null,extraRadius:0,allowUpWithoutDown:!0},c=document.createElementNS(Y,"g"),d=document.createElementNS(Y,"image"),p=document.createElementNS(Y,"image");for(r in i)i.hasOwnProperty(r)&&(u[r]=i[r]);return c.className.baseVal="gameButton",d.setAttributeNS(q,"href",u.up),p.setAttributeNS(q,"href",u.down),d.setAttribute("preserveAspectRatio","none"),p.setAttribute("preserveAspectRatio","none"),c.setAttribute("transform","translate("+e+","+t+")"),d.setAttribute("x","0"),d.setAttribute("class","upimg"),d.setAttribute("y","0"),d.setAttribute("width",a),d.setAttribute("height",n),p.setAttribute("x","0"),p.setAttribute("class","downimg"),p.setAttribute("y","0"),p.setAttribute("width",a),p.setAttribute("height",n),u.extraRadius>0&&(s=document.createElementNS(Y,"circle"),s.setAttribute("fill","rgba(0,0,0,0)"),s.setAttribute("r",u.extraRadius.toString()),s.setAttribute("cx",(a/2).toString()),s.setAttribute("cy",(n/2).toString()),c.appendChild(s)),l=null,null!==u.text&&(l=document.createElementNS(Y,"text"),l.setAttribute("x",(a/2).toString()),l.setAttribute("y","40"),l.setAttribute("font-size","30"),l.setAttribute("fill","white"),l.setAttribute("stroke","black"),l.setAttribute("stroke-width","0.5"),l.setAttribute("text-anchor","middle"),l.textContent=u.text),F({item:c,down:function(){d.setAttribute("style","display:none;"),p.setAttribute("style","")},up:function(){p.setAttribute("style","display:none;"),d.setAttribute("style",""),null!==u.sound&&V.audio.playSound(u.sound),u.event()},allowUpWithoutDown:u.allowUpWithoutDown}),o.appendChild(c),c.appendChild(p),c.appendChild(d),l&&c.appendChild(l),c.setText=function(e){l.textContent=e},c}function U(e,t,a,n,o,i){"use strict";function r(){var e,t,a=[],n=$(".powerSlot");for(_=0;_<w.entries.length;_+=1){for(t=!1,e=0;e<n.length&&!t;e+=1)w.entries[_]===n[e].getAttribute("data-speedpower")&&(t=!0);t||a.push(w.entries[_])}return a}function s(){P||(Mn.markTutorialFlashComplete(A?"animalPicker":"levelPicker"),j()||Mn.trigger(A?"powers_cycle":"levels_oncycle"),V.audio.playSound("click"),v=r(),v.length<1||(b-=1,0>b&&(b=v.length-1),A?(y=H.special[v[b]]||H.movement[v[b]],p.textContent=y.displayName):p.textContent=v[b],w.onchange(v[b],w.entries!==i.entries)))}function l(){P||(Mn.markTutorialFlashComplete(A?"animalPicker":"levelPicker"),j()||Mn.trigger(A?"powers_cycle":"levels_oncycle"),V.audio.playSound("click"),v=r(),v.length<1||(b+=1,b>v.length-1&&(b=0),A?(y=H.special[v[b]]||H.movement[v[b]],p.textContent=y.displayName):p.textContent=v[b],w.onchange(v[b],w.entries!==i.entries)))}var u,c,d,p,m,g,f,h,y,v,_,w={entries:[],title:"",titleAlign:"",onchange:function(){return void 0},swipeAreaCallback:function(){return void 0}},b=0,x=null,A=!1,I=null,S=0,P=!1;for(u in i)i.hasOwnProperty(u)&&(w[u]=i[u]);return c=w.entries,d=document.createElementNS(Y,"g"),d.setAttribute("transform","translate("+e+","+t+")"),p=document.createElementNS(Y,"text"),p.setAttribute("x",(a/2).toString()),p.setAttribute("y",(n/2+14).toString()),p.setAttribute("font-size","24px"),p.setAttribute("text-anchor","middle"),p.setAttribute("fill","black"),p.setAttribute("stroke","none"),p.setAttribute("transform","translate(0,0)"),""!==w.title&&(m=document.createElementNS(Y,"text"),m.setAttribute("x","20"),m.setAttribute("y","20"),m.setAttribute("font-size","24px"),m.setAttribute("fill","white"),m.setAttribute("stroke","black"),m.setAttribute("stroke-width","0.5"),m.setAttribute("style","font-family: badaboom"),m.textContent=w.title,"right"===w.titleAlign&&(m.setAttribute("text-anchor","end"),m.setAttribute("x",(a-32).toString())),d.appendChild(m)),void 0!==w.tabs&&w.tabs.length>1&&(x=w.page2Entries,A=!0,I=document.getElementById("power_select_background"),g=document.createElementNS(Y,"rect"),g.setAttribute("x","0"),g.setAttribute("y","-45"),g.setAttribute("width","125"),g.setAttribute("height","64"),g.setAttribute("fill","rgba(0,0,255,0)"),g.setAttribute("stroke","none"),f=document.createElementNS(Y,"rect"),f.setAttribute("x","125"),f.setAttribute("y","-45"),f.setAttribute("width","125"),f.setAttribute("height","64"),f.setAttribute("fill","rgba(255,0,0,0)"),f.setAttribute("stroke","none"),d.appendChild(g),d.appendChild(f),F({item:g,down:function(){j()||Mn.trigger("left_tab"),V.audio.playSound("click"),I.setAttributeNS(q,"href","./Images/LabAssets/creature_select_move.png"),w.entries=c,d.changeTo(w.entries[0])}}),F({item:f,down:function(){j()||Mn.trigger("right_tab"),Mn.markTutorialFlashComplete("animalTabs"),V.audio.playSound("click"),I.setAttributeNS(q,"href","./Images/LabAssets/creature_select_defend.png"),w.entries=x,d.changeTo(w.entries[0])}})),A?(y=H.special[w.entries[0]]||H.movement[w.entries[0]],p.textContent=y.displayName):p.textContent=w.entries[0],d.appendChild(p),o.appendChild(d),h=document.createElementNS(Y,"rect"),h.setAttribute("x","-20"),h.setAttribute("y","18"),h.setAttribute("width","290"),h.setAttribute("height","260"),h.setAttribute("fill","rgba(0,255,255,0.0)"),d.appendChild(h),F({item:h,down:function(){S=0,P=!0,p.transform.baseVal.getItem(0).matrix.e=0},move:function(e,t){P&&(S+=t,S=V.MathFunctions.clamp(S,-80,80),p.transform.baseVal.getItem(0).matrix.e=S/3)},up:function(){console.log(S),P=!1,p.transform.baseVal.getItem(0).matrix.e=0,S>15?s():-15>S?l():w.swipeAreaCallback()}}),z(-18,13,30,57,d,{up:"./Images/LabAssets/arrow_left.png",down:"./Images/LabAssets/arrow_left_press.png",event:s,extraRadius:40,allowUpWithoutDown:!1}),z(235,13,30,57,d,{up:"./Images/LabAssets/arrow_right.png",down:"./Images/LabAssets/arrow_right_press.png",event:l,extraRadius:40,allowUpWithoutDown:!1}),w.onchange(w.entries[b],w.entries!==i.entries),d.changeTo=function(e,t){if(t){for(_=0;_<c.length;_+=1)if(c[_]===e)return b=_,w.entries=c,I.setAttributeNS(q,"href","./Images/LabAssets/creature_select_move.png"),A?(y=H.special[c[b]]||H.movement[c[b]],p.textContent=y.displayName):p.textContent=c[b],void w.onchange(c[b],w.entries!==i.entries);for(_=0;_<x.length;_+=1)if(x[_]===e)return b=_,w.entries=x,I.setAttributeNS(q,"href","./Images/LabAssets/creature_select_defend.png"),A?(y=H.special[x[b]]||H.movement[x[b]],p.textContent=y.displayName):p.textContent=x[b],void w.onchange(x[b],w.entries!==i.entries)}else{var a=r();for(_=0;_<w.entries.length;_+=1)if(a[_]===e)return b=_,A?(y=H.special[a[b]]||H.movement[a[b]],p.textContent=y.displayName):p.textContent=a[b],void w.onchange(a[b],w.entries!==i.entries)}b=0,v=r(),A?(y=H.special[v[b]]||H.movement[v[b]]||{displayName:"None Available"},p.textContent=y.displayName):p.textContent=v[b]||"None Available",w.onchange(v[b],w.entries!==i.entries)},d}function G(e,t,a,n,o,i){"use strict";V.frontContext.lineWidth=i||1,V.frontContext.arc(e,t,a,0,2*Math.PI),void 0!==n&&(V.frontContext.fillStyle=n||"#000000"),void 0!==o&&(V.frontContext.strokeStyle=o||"#000000")}t.GameWrap=e;var O={Run:0,Snow:-.2,Swim:-.2,Mud:-.1,Offroad:-.4},H={movement:{cheetah:{displayName:"Cheetah",images:{animation:"cheetah_run512x256.png",icon:"slot_icon_cheetah.png",animationDetails:{direction:"y",frames:10},racer:"cheetah.png"},stats:{Weight:{value:.2,display:!0},Run:{value:.5,display:!1},Snow:{value:-.2,display:!1},Swim:{value:-.2,display:!1},Mud:{value:-.2,display:!1},Offroad:{value:-.4,display:!1},Fly:{value:0,display:!1},Jump:{value:.1,display:!1},Defense:{value:0,display:!1},Cost:{value:3,display:!0},Duration:{value:5,display:!0},Special:{value:0,display:!1},Classification:"mammal"},effect:{activateSound:"Cheetah2",height:0,onSetActive:function(){"use strict";return void 0},onComplete:function(){"use strict";return void 0},onCollision:function(){"use strict";return void 0}}},hare:{displayName:"Snowshoe Hare",images:{animation:"snowshoehare_run512x256.png",icon:"slot_icon_snowhare.png",animationDetails:{direction:"y",frames:8},racer:"hare.png"},stats:{Weight:{value:.1,display:!0},Run:{value:.1,display:!1},Snow:{value:.1,display:!1},Swim:{value:-.2,display:!1},Mud:{value:-.1,display:!1},Offroad:{value:-.4,display:!1},Fly:{value:0,display:!1},Jump:{value:.4,display:!1},Defense:{value:0,display:!1},Cost:{value:3,display:!0},Duration:{value:15,display:!0},Special:{value:0,display:!1},Classification:"mammal"},effect:{height:-2,onSetActive:function(){"use strict";return void 0},onComplete:function(){"use strict";return void 0},onCollision:function(){"use strict";Lt.Jump()}}},otter:{displayName:"Otter",images:{animation:"otter_swim512x188.png",icon:"slot_icon_otter.png",animationDetails:{direction:"y",frames:10},racer:"otter.png"},stats:{Weight:{value:.2,display:!0},Run:{value:0,display:!1},Snow:{value:-.1,display:!1},Swim:{value:.1,display:!1},Mud:{value:0,display:!1},Offroad:{value:-.4,display:!1},Fly:{value:0,display:!1},Jump:{value:0,display:!1},Defense:{value:0,display:!1},Cost:{value:2,display:!0},Duration:{value:10,display:!0},Special:{value:0,display:!1},Classification:"mammal"},effect:{activateSound:"otter",height:-2,onSetActive:function(){"use strict";return void 0},onComplete:function(){"use strict";return void 0},onCollision:function(){"use strict";return void 0}}},hummingbird:{displayName:"Hummingbird",images:{animation:"hummingbird_fly512x256.png",icon:"slot_icon_hummingbird.png",animationDetails:{direction:"y",frames:6},racer:"hummingbird.png"},stats:{Weight:{value:.1,display:!0},Run:{value:-.1,display:!1},Snow:{value:-.1,display:!1},Swim:{value:-.1,display:!1},Mud:{value:0,display:!1},Offroad:{value:-.4,display:!1},Fly:{value:.3,display:!1},Jump:{value:0,display:!1},Defense:{value:0,display:!1},Cost:{value:3,display:!0},Duration:{value:20,display:!0},Special:{value:0,display:!1},Classification:"bird"},effect:{height:15,activateSound:"hummingbird",onSetActive:function(){"use strict";return void 0},onComplete:function(){"use strict";return void 0},onCollision:function(){"use strict";return void 0}}},falcon:{displayName:"Falcon",images:{animation:"falcon_glide512x256.png",icon:"slot_icon_falcon.png",animationDetails:{direction:"y",frames:6},racer:"falcon.png"},stats:{Weight:{value:.2,display:!0},Run:{value:0,display:!1},Snow:{value:0,display:!1},Swim:{value:0,display:!1},Mud:{value:0,display:!1},Offroad:{value:-.4,display:!1},Fly:{value:.5,display:!1},Jump:{value:0,display:!1},Defense:{value:0,display:!1},Cost:{value:4,display:!0},Duration:{value:10,display:!0},Special:{value:0,display:!1},Classification:"bird"},effect:{activateSound:"falcon2",height:40,onSetActive:function(){"use strict";return void 0},onComplete:function(){"use strict";return void 0},onCollision:function(){"use strict";return void 0}}},antelope:{displayName:"Pronghorn Antelope",images:{animation:"pronghorn_run512x256.png",icon:"slot_icon_pronghorn.png",animationDetails:{direction:"y",frames:7},racer:"pronghorn.png"},stats:{Weight:{value:.3,display:!0},Run:{value:.4,display:!1},Snow:{value:-.2,display:!1},Swim:{value:-.2,display:!1},Mud:{value:-.2,display:!1},Offroad:{value:-.4,display:!1},Fly:{value:0,display:!1},Jump:{value:0,display:!1},Defense:{value:0,display:!1},Cost:{value:4,display:!0},Duration:{value:15,display:!0},Special:{value:0,display:!1},Classification:"mammal"},effect:{height:3,onSetActive:function(){"use strict";return void 0},onComplete:function(){"use strict";return void 0},onCollision:function(){"use strict";return void 0}}},roadrunner:{displayName:"Roadrunner",images:{animation:"roadrunner_run512x200.png",icon:"slot_icon_roadrunner.png",animationDetails:{direction:"y",frames:8},racer:"roadrunner.png"},stats:{Weight:{value:.2,display:!0},Run:{value:.3,display:!1},Snow:{value:-.3,display:!1},Swim:{value:-.3,display:!1},Mud:{value:0,display:!1},Offroad:{value:-.4,display:!1},Fly:{value:0,display:!1},Jump:{value:0,display:!1},Defense:{value:0,display:!1},Cost:{value:3,display:!0},Duration:{value:15,display:!0},Special:{value:0,display:!1},Classification:"bird"},effect:{height:-2,onSetActive:function(){"use strict";return void 0},onComplete:function(){"use strict";return void 0},onCollision:function(){"use strict";Lt.Jump()}}},dolphin:{displayName:"Dolphin",images:{animation:"dolphin_swim512x235.png",icon:"slot_icon_dolphin.png",animationDetails:{direction:"y",frames:6},racer:"dolphin.png"},stats:{Weight:{value:.3,display:!0},Run:{value:-.5,display:!1},Snow:{value:-.4,display:!1},Swim:{value:.3,display:!1},Mud:{value:-.4,display:!1},Offroad:{value:-.4,display:!1},Fly:{value:0,display:!1},Jump:{value:0,display:!1},Defense:{value:0,display:!1},Cost:{value:3,display:!0},Duration:{value:20,display:!0},Special:{value:0,display:!1},Classification:"mammal"},effect:{activateSound:"dolphin",height:-4,onSetActive:function(){"use strict";return void 0},onComplete:function(){"use strict";return void 0},onCollision:function(){"use strict";return void 0}}}},special:{skunk:{displayName:"Skunk",images:{animation:"skunk_spray512x195.png",icon:"slot_icon_skunk.png",animationDetails:{direction:"y",frames:12},racer:"skunk.png"},stats:{Weight:{value:.1,display:!0},Run:{value:0,display:!1},Snow:{value:-.2,display:!1},Swim:{value:-.2,display:!1},Mud:{value:-.2,display:!1},Offroad:{value:-.4,display:!1},Fly:{value:0,display:!1},Jump:{value:0,display:!1},Defense:{value:.3,display:!1},Cost:{value:2,display:!0},Duration:{value:0,display:!0},Special:{value:0,display:!1},Classification:"mammal"},effect:{activateSound:"skunk",height:-1,onSetActive:function(){"use strict";V.playEffect("skunk"),Zt.onSkunkAttack()},onComplete:function(){"use strict";return void 0},onCollision:function(){"use strict";return void 0}}},tortoise:{displayName:"Tortoise",images:{animation:"tortoise_walk512x256.png",icon:"slot_icon_tortoise.png",animationDetails:{direction:"y",frames:10},racer:"tortoise.png"},stats:{Weight:{value:.3,display:!0},Run:{value:0,display:!1},Snow:{value:-.2,display:!1},Swim:{value:-.2,display:!1},Mud:{value:-.2,display:!1},Offroad:{value:-.4,display:!1},Fly:{value:0,display:!1},Jump:{value:0,display:!1},Defense:{value:.5,display:!1},Cost:{value:4,display:!0},Duration:{value:30,display:!0},Special:{value:0,display:!1},Classification:"reptile"},effect:{height:0,onSetActive:function(){"use strict";return void 0},onComplete:function(){"use strict";return void 0},onCollision:function(e){"use strict";"zachbot"===e&&V.playEffect("botsplode")}}},bison:{displayName:"Bison",images:{animation:"bison_toss_512x256.png",icon:"slot_icon_bison.png",animationDetails:{direction:"y",frames:7},racer:"bison.png"},stats:{Weight:{value:.4,display:!0},Run:{value:0,display:!1},Snow:{value:-.2,display:!1},Swim:{value:-.2,display:!1},Mud:{value:-.2,display:!1},Offroad:{value:-.4,display:!1},Fly:{value:0,display:!1},Jump:{value:0,display:!1},Defense:{value:.4,display:!1},Cost:{value:3,display:!0},Duration:{value:20,display:!0},Special:{value:0,display:!1},Classification:"mammal"},effect:{height:6,activateSound:"bison",onSetActive:function(){"use strict";return void 0},onComplete:function(){"use strict";return void 0},onCollision:function(e){"use strict";switch(e){case"rock":V.playEffect("rocksplode");break;case"log":V.playEffect("logsplode");break;case"zachbot":V.playEffect("botsplode")}}}}}},W={write:function(e,t){"use strict";document.cookie=e+"="+t},read:function(e){"use strict";try{return document.cookie.match(new RegExp(e+"=([^;]+)"))[1]}catch(t){return null}},remove:function(e){"use strict";document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}},V={MAIN_ELEMENT:"gameView",GUID_GAME:"198080c8-4fab-4b22-9770-9019a75e4c4f",GUID_BEAT_ZACK_FIRST_TIME:"f68fd647-3a17-40f6-acdd-2f6a824010e6",GUID_BEAT_ZACK_EVERY_LEVEL:"10f1d871-36d4-4e98-999c-e617cf462c53",GUID_USED_ALL_CREATURE_PARTS_FIRST_TIME:"bac3c6e5-54aa-442b-a4cc-08d312f71cc4",GUID_BEAT_ZACK:"9998f5c5-6782-4f48-ae0a-ca58638ca830",GUID_DODGE_ALL_ZACK_BOTS:"2ad1ca67-ba33-4a92-bfb0-6aaf859c1629",GUID_REMAINING_ENERGY:"677f3050-98ca-43dd-9a22-20892c202dad",GUID_WIN_WITH_ONLY_MAMMAL_PARTS:"39723a0d-6509-40ca-9d77-71d0d64a817c",GUID_REACH_HALF_WAY_MARK:"3bf7d865-ae4a-40e8-8545-36d60fae2de6",InitialSettings:{MasterVolume:1,BackgroundMusicVolume:.4,disableLocalAudio:!1},FrameSize:{x:988,y:556},pauseElement:{},isPaused:!1,CurrentLevel:"testlevel",time:new Date,dt:0,clearColor:"#000000",averageFps:0},Y="http://www.w3.org/2000/svg",q="http://www.w3.org/1999/xlink";V.event=function(e){"use strict";void 0!==V.minigame&&null!==V.minigame&&V.minigame.event(e)},V.hasPowerUp=function(e){"use strict";return void 0!==V.minigame&&null!==V.minigame?V.minigame.hasPowerUp(e):!1},V.usePowerUp=function(e,t,a){"use strict";if(void 0!==V.minigame&&null!==V.minigame){var n={};n[e]=1,V.minigame.usePowerUps(n,t,a)}},V.levelComplete=function(){"use strict";void 0!==V.minigame&&null!==V.minigame&&V.minigame.levelComplete()},function(){"use strict";function e(){function e(){setTimeout(function(){var e=$("#"+V.MAIN_ELEMENT)[0].getClientRects(),t=e[0].width/e[0].height,a=V.FrameSize.x/V.FrameSize.y,n=t>a?e[0].height/V.FrameSize.y:e[0].width/V.FrameSize.x;$("#GameCenter")[0].setAttribute("style","transform: scale("+n+"); -webkit-transform: scale("+n+")")},500)}var t,a=s();if(!a)return void(location.href="./svg_not_supported.html");window.console||(console=window.console={},console.log=console.warn=console.error=function(){return void 0}),window.Array&&!window.Array.isArray&&(window.Array.isArray=function(e){return e instanceof Array});try{V.minigame=new PBS.KIDS.KartKingdom.minigame(V.GUID_GAME,V.MAIN_ELEMENT,V.pause,V.resume)}catch(n){V.minigame=null,console.log("Unable to create minigame instance.")}V.support=r(),V.performance=l(V.support.performanceMode),V.audio=i(),V.help=m(),V.powerUpScreen=A(),V.currentPowerUp=new I(kt.PowerUpTypes.None),L(),c(),$("#svgCanvas")[0].setAttribute("class",V.performance.svgClass),$("#FloorCanvas")[0].setAttribute("class",V.performance.floorClass),document.body.onorientationchange=e,window.onresize=e,e(),V.pauseElement=document.createElementNS(Y,"rect"),V.pauseElement.setAttribute("x","0"),V.pauseElement.setAttribute("y","0"),V.pauseElement.setAttribute("width",V.FrameSize.x.toString()),V.pauseElement.setAttribute("height",V.FrameSize.y.toString()),V.pauseElement.setAttribute("fill","rgba(0,0,0,0)"),V.pauseElement.setAttribute("style","display:none"),V.frontCanvas=document.getElementById("GameCanvas"),V.frontContext=V.frontCanvas.getContext("2d"),V.floorCanvas=document.getElementById("FloorCanvas"),V.floorContext=V.floorCanvas.getContext("2d"),V.sceneManager=new D,V.sceneManager.addScene(T()),V.sceneManager.addScene(w()),V.sceneManager.addScene(B()),V.timer=R(V.performance.frameTime,function(){var e=new Date;V.dt=(e-V.time)/1e3,V.time=e,V.isPaused||(V.sceneManager.update(),V.sceneManager.draw(V.frontContext)),d(),V.support.iOS&&window.scrollTo(0,0)}),t={images:[{name:"loadingBackground",src:"./Images/AvivaLoading2.png"},{name:"loadingAvivaAnim",src:"./Images/Animations/Aviva_loading_285x500.png",anim:{frames:4,direction:"x",time:.4,startPaused:!0}},{name:"staticAnim",src:"./Images/Animations/channel_change248x144.png",anim:{frames:2,direction:"y",time:.2,startPaused:!0}},{name:"loading_racer_cheetah",src:"./Images/Racers/cheetah.png"},{name:"loading_racer_falcon",src:"./Images/Racers/falcon.png"},{name:"loading_racer_pronghorn",src:"./Images/Racers/pronghorn.png"},{name:"loading_racer_skunk",src:"./Images/Racers/skunk.png"},{name:"loading_racer_tortoise",src:"./Images/Racers/tortoise.png"}],sounds:[{name:"click",path:"click",type:"effect"}]},V.PreLoadFromList(t.images,t.sounds,function(){V.sceneManager.changeScene("splashScene"),g(),V.timer.start()})}function t(){if(void 0!==V.audio||null!==V.audio){var e=document.visibilityState;"visible"===e?V.audio.unmute():"hidden"===e&&V.audio.mute()}}window.onload=e,document.addEventListener("visibilitychange",t,!1),V.PreLoadFromList=function(e,t,n,o){function i(){if(void 0!==o&&null!==o){var a=(f+h)/(e.length+t.length);o(a)}f===e.length&&h===t.length&&n()}function r(){f+=1,i()}function s(){h+=1,i()}var l,u,c,d,p,m,g,f=0,h=0;if((void 0===e||null===e)&&(e=[]),void 0!==t&&null!==t&&V.support.webAudio||(t=[]),e.length+t.length===0)return void n();for(l=document.getElementById("GameImages"),p=function(){void 0!==this.anim&&a(this,this.anim),r()},m=function(e){console.error("Failed to load image: "+e.originalTarget.src),r()},u=0;u<e.length;u+=1)c="image_"+e[u].name,null!==document.getElementById(c)?r():(d=new Image,d.onload=p,d.onerror=m,d.src=e[u].src,l.appendChild(d),d.setAttribute("id",c),d.anim=e[u].anim);for(g=0;g<t.length;g+=1)V.audio.loadSound(t[g].name,t[g].path,t[g].type,1,s)},V.pause=function(){V.audio.pause(),V.isPaused=!0,document.getElementById("svgCanvas").appendChild(V.pauseElement)},V.resume=function(){var e=document.getElementById("svgCanvas");V.pauseElement.parentNode===e&&e.removeChild(V.pauseElement),V.isPaused=!1,V.audio.resume()},V.createProjectionMatrix=function(){var e=60,t=500,a=1,n=1/Math.tan(.5*e*(Math.PI/180)),o=-(t/(t-a)),i=-(t*a/(t-a));return[n,0,0,0,0,n,0,0,0,0,o,i,0,0,-1,0]},V.MathFunctions={TransformPoint:function(e,t,a,n,o){var i=e*o[0]+t*o[1]+a*o[2]+n*o[3],r=e*o[4]+t*o[5]+a*o[6]+n*o[7],s=e*o[8]+t*o[9]+a*o[10]+n*o[11],l=e*o[12]+t*o[13]+a*o[14]+n*o[15];return i/=l,r/=l,s/=l,[i,r,s]},TransformMatrix:function(e,t){var a,n,o=[];for(a=0;4>a;a+=1)for(n=0;4>n;n+=1)o[n+4*a]=e[4*a]*t[n]+e[4*a+1]*t[4+n]+e[4*a+2]*t[8+n]+e[4*a+3]*t[12+n];return o},clamp:function(e,t,a){return Math.min(Math.max(e,t),a)},rotationDifference:function(e,t){for(;e>t+Math.PI;)e-=2*Math.PI;for(;e<t-Math.PI;)e+=2*Math.PI;return t-e},lerp:function(e,t,a){return t+e*(a-t)},randomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}},V.hexToRGBA=function(e,t,a){var n=parseInt(e.substr(1,2),16),o=parseInt(e.substr(3,2),16),i=parseInt(e.substr(5,2),16),r=t||1,s=a||1;return"rgba("+Math.round(n*s)+","+Math.round(o*s)+","+Math.round(i*s)+","+r+")"},V.requestJson=function(e,t,a){var n=new XMLHttpRequest,o=t||!1;return n.open("GET",e+"?timer="+(new Date).getMilliseconds(),o),o&&(n.onload=function(){if(200===n.status){var e=JSON.parse(n.responseText);a(e)}},n.onerror=function(){console.error(n.statusText)}),n.send(),o?void 0:200===n.status?JSON.parse(n.responseText):null}}();var j,J,Z,Q,K,X,et,tt,at,nt,ot,it=[],rt=[37,38,39,40],st={Weight:.5,Cost:5,Duration:30},lt=6,ut={},ct=0,dt=439,pt=263.4,mt=439*.4,gt=1e3,ft=["Run","Swim","Snow","Mud"],ht={x:17,y:26,width:50,height:50,image:"./Images/LabAssets/icon_go.png"},yt={x:790,y:390,width:100,height:100,upimg:"./Images/LabAssets/right_go.png",downimg:"./Images/LabAssets/right_press.png"},vt={x:0,y:0,width:150,height:150,image:"./Images/PowerUps/power_up_selector.png"},_t={x:149,y:230,width:150,height:150,imageEnabled:"./Images/PowerUps/energy_bonus_power_up.png",imageDisabled:"./Images/PowerUps/energy_bonus_power_up_disabled.png"},wt={x:329,y:230,width:150,height:150,imageEnabled:"./Images/PowerUps/turbo_boost_power_up.png",imageDisabled:"./Images/PowerUps/turbo_boost_power_up_disabled.png"},bt={x:509,y:230,width:150,height:150,imageEnabled:"./Images/PowerUps/falcon_distractor_power_up.png",imageDisabled:"./Images/PowerUps/falcon_distractor_power_up_disabled.png"},xt={x:689,y:230,width:150,height:150,imageEnabled:"./Images/PowerUps/rhino_protector_power_up.png",imageDisabled:"./Images/PowerUps/rhino_protector_power_up_disabled.png"},At=!1,It=null,St=null,Pt=null,Mt=null,Ct=null,kt={PowerUpTypes:{None:"None",EnergyBonus:"wk_energy_bonus",TurboBoost:"wk_turbo_boost",FalconDistractor:"wk_falcon_distractor",RhinoProtector:"wk_rhino_protector"},EnergyBonusAmount:5,TurboBoostSpeedIncrement:10,TurboBoostDuration:8,FalconDistractorPasses:4,FalconDistractorDuration:0,RhinoProtectorDuration:15},Tt=35,Et=10,Dt=50,Bt=10,Rt={position:{x:0,y:0,rotation:0,rotationTarget:0},controls:{up:!1,down:!1,left:!1,right:!1},Fuel:{total:20,available:20},elapsedTime:0,currentTime:0,maxTime:1e3,maxVelocity:30,currentVelocity:0,initialVelocity:0,animation:{},currentStrafingDistance:0,maxStrafingDistance:45,strafeSpeed:1.5,strafingVelocity:60,rotationQueue:{},freeCam:!1,hazards:{},hazardInfo:{},currentHazard:{},colliding:!1,hitZackBot:!1,reachedHalfway:!1,protectorActive:!1,winEvent:function(){"use strict";
console.log("Player has reached the end of the race."),V.raceStatus.state="playerWin",V.audio.stopAllNonLoopSounds(),V.audio.stopSound("carsound"),V.audio.stopSound("offroad"),V.audio.playSound("winsound")},toggleFreeCam:function(){"use strict";Rt.freeCam=!Rt.freeCam},reset:function(e){"use strict";Rt.currentTime=0,Rt.controls.up=!1,Rt.controls.down=!1,Rt.controls.left=!1,Rt.controls.right=!1,Rt.Fuel.available=20,Rt.currentVelocity=0,Rt.resetTime(),Rt.currentStrafingDistance=0,Rt.hitZackBot=!1,Rt.reachedHalfway=!1;var t,a,n=[{path:document.getElementById("motionPath"),index:0}];Rt.animation=void 0!==e.PathBranches?new b(e.PathBranches,this.pathSelectCallback,Rt.winEvent,!0):new b(n,this.pathSelectCallback),Rt.rotationQueue=new S(5),t=Rt.animation.getPointAtTime(0),a=Rt.animation.getPointAtTime(Rt.maxVelocity/Rt.animation.getMaxTime()),Rt.position.x=4*t.x,Rt.position.y=4*t.y,Rt.position.rotation=-Math.atan2(a.x-t.x,a.y-t.y),Rt.updateMiniMap(),Rt.hazards=V.requestJson("./Levels/hazarddefs.json"),Rt.currentHazard=Rt.hazards.none},resetTime:function(){"use strict";Rt.elapsedTime=0,Rt.initialVelocity=Rt.currentVelocity},update:function(){"use strict";Rt.elapsedTime+=V.dt;var e,t,a,n,o,i,r,s,l,u,c,d,p,m,g=Rt.elapsedTime,v=Rt.currentHazard.acceleration*g*g/2,_=Rt.initialVelocity+v,w=Tt+Nt.getSpeedBoost(Rt.currentHazard);w>=_?Rt.currentVelocity=_:Rt.currentVelocity>w&&Rt.currentVelocity>Et&&(Rt.currentVelocity-=Rt.currentVelocity*V.dt/2),h()&&(Rt.freeCam?Rt.position.rotation-=.1:Rt.currentStrafingDistance<Rt.maxStrafingDistance&&(Rt.currentStrafingDistance+=Rt.strafingVelocity*V.dt*Rt.strafeSpeed)),f(38)||Rt.controls.up?Rt.freeCam&&(e=0,t=1,0!==Rt.position.rotation&&(e=Math.cos(Rt.position.rotation+Math.PI/2),t=Math.sin(Rt.position.rotation+Math.PI/2)),Rt.position.x+=e*V.dt*200,Rt.position.y+=t*V.dt*200):Rt.rotationQueue.clear(),y()&&(Rt.freeCam?Rt.position.rotation+=.1:Rt.currentStrafingDistance>-Rt.maxStrafingDistance&&(Rt.currentStrafingDistance-=Rt.strafingVelocity*V.dt*Rt.strafeSpeed)),f(40)||Rt.controls.down||Rt.rotationQueue.clear(),c=Rt.animation.getMaxTime(),d=Rt.animation.getPointAtTime(Rt.currentTime/c),"racing"===V.raceStatus.state&&(Rt.currentTime>c&&(Rt.currentTime-=c,c=Rt.animation.getMaxTime(),d=Rt.animation.getPointAtTime(Rt.currentTime/c)),Rt.currentTime<0&&(c=Rt.animation.getMaxTime(),Rt.currentTime+=c,d=Rt.animation.getPointAtTime(Rt.currentTime/c)),Rt.freeCam||(p=V.MathFunctions.clamp((Rt.currentTime+Rt.maxVelocity)/c,0,1),m=Rt.animation.getLookAheadPointAtTime(p),e=m.x-d.x,t=m.y-d.y,a=Math.sqrt(e*e+t*t),e/=a,t/=a,0!==a&&(Rt.position.rotationTarget=-Math.atan2(e,t),n=-Math.atan2(e,t)-Rt.position.rotation,n=V.MathFunctions.clamp(n,-.1,.1),Rt.rotationQueue.addValue(n),Rt.currentStrafingDistance+=Rt.rotationQueue.getAverage()*Rt.maxStrafingDistance*2,Rt.currentStrafingDistance=V.MathFunctions.clamp(Rt.currentStrafingDistance,-Rt.maxStrafingDistance,Rt.maxStrafingDistance)),o=V.MathFunctions.rotationDifference(Rt.position.rotation,Rt.position.rotationTarget),Math.abs(o)<.1?Rt.position.rotation=Rt.position.rotationTarget:o>0?Rt.position.rotation+=V.dt:Rt.position.rotation-=V.dt,Rt.position.x=4*d.x,Rt.position.y=4*d.y,i=-Math.cos(Rt.position.rotation+Math.PI),r=-Math.sin(Rt.position.rotation+Math.PI),Rt.position.x+=i*Rt.currentStrafingDistance,Rt.position.y+=r*Rt.currentStrafingDistance,Rt.colliding?(s=Rt.hazardInfo[2]-Rt.position.x,l=Rt.hazardInfo[3]-Rt.position.y,u=Math.sqrt(s*s+l*l),u>4*Rt.hazardInfo[1]&&(Rt.colliding=!1,Rt.currentHazard=Rt.hazards.none,Rt.hazardInfo=null,Rt.resetTime())):Math.abs(Rt.currentStrafingDistance)>=Rt.maxStrafingDistance?"offroad"!==Rt.currentHazard.name&&(Mn.trigger("offroad"),V.audio.playSound("offroad",!0),Rt.currentHazard=Rt.hazards.offroad,Rt.resetTime()):(V.audio.stopSound("offroad"),"none"!==Rt.currentHazard.name&&(Rt.currentHazard=Rt.hazards.none,Rt.resetTime())),Rt.currentTime+=Rt.currentVelocity*V.dt),Rt.updateMiniMap(),Lt.update(),Nt.update())},updateMiniMap:function(){"use strict";var e=document.getElementById("playerRepresentation");e.setAttribute("transform","translate("+Rt.position.x/4+","+Rt.position.y/4+") rotate("+Rt.position.rotation*(180/Math.PI)+")")},pathSelectCallback:function(e){"use strict";var t,a,n,o,i,r,s,l,u,c,d,p,m,g=e[0].path.getPointAtLength(e[0].path.getTotalLength()/10),f=e[1].path.getPointAtLength(e[1].path.getTotalLength()/10),v=Rt.position.rotation;return y()&&(v+=.35),h()&&(v-=.35),n=Math.cos(v+Math.PI/2)-Math.cos(v+Math.PI)*Rt.currentStrafingDistance,o=Math.sin(v+Math.PI/2)-Math.sin(v+Math.PI)*Rt.currentStrafingDistance,i=g.x-Rt.position.x,r=g.y-Rt.position.y,s=f.x-Rt.position.x,l=f.y-Rt.position.y,u=n*i+o*r,c=n*s+o*l,d=Math.sqrt(n*n+o*o),p=Math.sqrt(i*i+r*r),m=Math.sqrt(s*s+l*l),t=Math.acos(u/(d*p)),a=Math.acos(c/(d*m)),a>t?0:1},onCollision:function(e){"use strict";var t,a=Nt.isFlying(),n=!1;if(Rt.currentVelocity>10&&!a)switch(Rt.hazards[e[0]].name){case"water":case"mud":case"snow":V.playEffect(Rt.hazards[e[0]].name)}if(!Rt.colliding||"impact"===Rt.hazards[e[0]].type){Rt.currentHazard=Rt.hazards[e[0]],Rt.hazardInfo=e;for(t in Rt.currentHazard.immunities)if(Rt.currentHazard.immunities.hasOwnProperty(t)&&null!==Nt.currentPower&&Nt.currentPower.name===Rt.currentHazard.immunities[t]){"impact"===Rt.currentHazard.type&&Lt.Shake(.3,{frequency:4,amplitude:12}),Nt.onCollision(Rt.currentHazard.name),Rt.currentHazard=Rt.hazards.none,n=!0;break}if(a&&(n=!0),!n)if(Rt.protectorActive)switch(Rt.currentHazard.name){case"rock":V.playEffect("rocksplode");break;case"log":V.playEffect("logsplode");break;case"zachbot":V.playEffect("botsplode")}else"impact"===Rt.currentHazard.type?(Mn.trigger("defense"),Rt.currentVelocity>0&&(Rt.currentVelocity=Math.max(Rt.currentVelocity-10,0)),"zachbot"!==Rt.currentHazard.name?V.audio.playSound("bot_hit"):Rt.hitZackBot=!0,Lt.Shake(.3,{frequency:7,amplitude:30}),jt("red",.3)):Mn.trigger("terrain"),Rt.resetTime(),Rt.colliding=!0;return!0}return!1}},Nt={fuelBurnEffectCount:0,currentPower:null,elapsedTime:0,turbo:0,getCurrentRacerName:function(){"use strict";return void 0!==Nt.currentPower&&null!==Nt.currentPower?Nt.currentPower.name:"base"},setActivePower:function(e){"use strict";if(void 0!==Nt.currentPower&&null!==Nt.currentPower&&Nt.currentPower.effect.onComplete(),Nt.currentPower=H.movement[e]||H.special[e],Nt.currentPower.name=e,void 0!==Nt.currentPower&&null!==Nt.currentPower){if(Rt.Fuel.available>=Nt.currentPower.stats.Cost.value){if(Nt.fuelBurnEffectCount=Rt.Fuel.available,Rt.Fuel.available-=Nt.currentPower.stats.Cost.value,Nt.currentPower.effect.onSetActive(),Nt.elapsedTime=0,Rt.resetTime(),void 0!==Nt.currentPower.effect.activateSound&&null!==Nt.currentPower.effect.activateSound){var t="activate_"+Nt.currentPower.effect.activateSound;V.audio.playSound("click",!1,function(){V.audio.playSound(t)})}else V.audio.playSound("click");return!0}Nt.currentPower=null}return!1},onCollision:function(e){"use strict";void 0!==Nt.currentPower&&null!==Nt.currentPower&&Nt.currentPower.effect.onCollision(e)},getSpeedBoost:function(e){"use strict";var t,a=Math.pow(V.RacerWeight,2)*-Bt;return null!==Nt.currentPower&&Nt.currentPower.effect.height>=Bt?a+Nt.turbo:void 0!==Nt.currentPower&&null!==Nt.currentPower&&null!==e?(t=Nt.currentPower.stats[e.boost||"Run"].value*Dt,t+a+Nt.turbo):O[e.boost||"Run"]*Dt+a+Nt.turbo},getCurrentHeight:function(){"use strict";return void 0!==Nt.currentPower&&null!==Nt.currentPower?Nt.currentPower.effect.height:0},update:function(){"use strict";void 0!==Nt.currentPower&&null!==Nt.currentPower&&(Nt.elapsedTime+=V.dt,Nt.elapsedTime>=Nt.currentPower.stats.Duration.value&&-1!==Nt.currentPower.stats.Duration.value&&(Nt.currentPower.effect.onComplete(),Nt.currentPower=null,Rt.resetTime())),Nt.fuelBurnEffectCount>0&&(Nt.fuelBurnEffectCount-=2*V.dt)},getProgress:function(){"use strict";return void 0!==Nt.currentPower&&null!==Nt.currentPower?-1===Nt.currentPower.stats.Duration.value?1:1-Nt.elapsedTime/Nt.currentPower.stats.Duration.value:0},isFlying:function(){"use strict";return null!==Nt.currentPower&&Nt.currentPower.effect.height>=10&&V.RacerWeight<=.8},reset:function(){"use strict";Nt.currentPower=null,Nt.elapsedTime=0}},Lt={angle:0,lookY:0,posY:0,amplitude:10,maxAmplitude:50,frequency:2,animationStarted:!1,currentHazard:{},duration:0,elapsedTime:0,jumping:!1,jumpHeight:0,maxJumpHeight:15,defaultGroundRotation:85,rotationMultiplier:6,Shake:function(e,t){"use strict";Lt.animationStarted||(Lt.angle=0,Lt.animationStarted=!0,Lt.duration=e,Lt.currentHazard=t)},Jump:function(){"use strict";Lt.jumping=!0,Lt.jumpHeight=0},update:function(){"use strict";Lt.amplitude<.1&&(Lt.amplitude=0),Lt.animationStarted?Lt.duration>0?(Lt.amplitude=Lt.currentHazard.amplitude,Lt.frequency=Lt.currentHazard.frequency,Lt.duration-=V.dt):(Lt.animationStarted=!1,Lt.amplitude=0,Lt.frequency=0):"none"===Rt.currentHazard.name&&null!==Nt.currentPower&&"hare"===Nt.currentPower.name?(Lt.amplitude=7.5,Lt.frequency=2.5):(Lt.amplitude=(Rt.currentHazard.amplitude-Lt.amplitude)*V.dt*4,Lt.frequency=Rt.currentHazard.frequency),Lt.angle+=V.dt*Math.PI*2*Lt.frequency,Lt.angle>2*Math.PI&&(Lt.angle-=2*Math.PI),Lt.amplitude=Math.min(Lt.amplitude,Lt.maxAmplitude),Lt.lookY=Math.floor(Lt.amplitude*Math.sin(Lt.angle)),Lt.jumping?(Lt.jumpHeight<Lt.maxJumpHeight?Lt.jumpHeight+=Lt.maxJumpHeight*V.dt*8:Lt.jumping=!1,Lt.jumpHeight=V.MathFunctions.clamp(Lt.jumpHeight,0,Lt.maxJumpHeight),Lt.posY=Nt.getCurrentHeight()+Lt.jumpHeight):Lt.jumpHeight>0?(Lt.jumpHeight-=Lt.maxJumpHeight*V.dt*8,Lt.jumpHeight=V.MathFunctions.clamp(Lt.jumpHeight,0,Lt.maxJumpHeight),Lt.posY=Nt.getCurrentHeight()+Lt.jumpHeight):V.RacerWeight<=.8&&(Lt.posY+=(Nt.getCurrentHeight()-Lt.posY)*V.dt*2),Math.abs(Lt.posY)<1e-4&&(Lt.posY=0);var e=Lt.defaultGroundRotation+Lt.rotationMultiplier*Lt.lookY/Lt.maxAmplitude,t=e-Lt.posY/30,a=Lt.lookY+2*Lt.posY;V.floorCanvas.style.webkitTransform="perspective(500px) translate(0px,"+a+"px) rotateX("+t+"deg) scale(1.8, 1.8)",V.floorCanvas.style.transform="perspective(500px) translate(0px,"+a+"px) rotateX("+t+"deg) scale(1.8, 1.8)"}},Ft={x:494,y:278},zt=2*Math.PI,Ut=-150,$t=139,Gt=$t-Ut,Ot=1288,Ht=25,Wt=2,Vt=30,Yt=393,qt=Math.PI/2,jt=null,Jt=null,Zt=null,Qt=4,Kt=300,Xt=Math.ceil(4096/Kt),ea=0,ta=0,aa=0,na=0,oa=null,ia=null,ra=null,sa=null,la=null,ua=null,ca=null,da=null,pa=null,ma=null,ga=null,fa=null,ha=null,ya=0,va=null,_a=null,wa=null,ba=null,xa=null,Aa=null,Ia=null,Sa=null,Pa=null,Ma=null,Ca=null,ka=null,Ta=null,Ea=null,Da=null,Ba=null,Ra=null,Na=null,La=null,Fa=null,za=null,Ua=null,$a=null,Ga=null,Oa=null,Ha=null,Wa=null,Va=null,Ya=null,qa=null,ja=null,Ja=null,Za=!0,Qa=null,Ka=null,Xa=null,en=null,tn=null,an=null,nn=null,on=null,rn=null,sn=null,ln=null,un=null,cn=.5,dn=65,pn=120,mn=5,gn=90,fn=.1,hn={h:.7,a:1.11},yn=15,vn=3,_n=9e4,wn=.2,bn=5,xn=20,An={x:0,y:0,h:0,aspect:0,rotation:0,flipImage:!1},In={levelPicker:{completed:!1,pathId:0},next:{completed:!1,pathId:1},animalPicker:{completed:!1,pathId:4},animalTabs:{completed:!1,pathId:2},addButton:{completed:!1,pathId:3},go:{completed:!1,pathId:1,condition:function(){"use strict";return 4===$(".powerSlot[data-speedpower]").length}}},Sn={left:["levelPicker","next"],right:["addButton","animalPicker","animalTabs","go"],racing:[]},Pn={move:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("tutorial_move",!1,Mn.playNext)}},moveReminder:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("tutorial_move",!1,Mn.playNext),Jt(),Pn.moveReminder.triggered=!1}},power:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("tutorial_power",!1,Mn.playNext)}},powerReminder:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("tutorial_power_reminder",!1,Mn.playNext),Mn.powerNotificationRequired=!1}},offroad:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("tutorial_offroad",!1,Mn.playNext)}},defense:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("tutorial_defense",!1,Mn.playNext)}},terrain:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("tutorial_region",!1,Mn.playNext)}},zachbot:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("watch_out_bots",!1,Mn.playNext)}},levels_intro:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("labtutorial_next",!1,Mn.playNext)},avivaTalks:!0},levels_oncycle:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("labtutorial_snow",!1,Mn.playNext)},avivaTalks:!0},levels_next:{triggered:!1,trigger:function(){"use strict";setTimeout(Mn.playNext,10)},avivaTalks:!0},powers_intro:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("labtutorial_powers",!1,Mn.playNext)},avivaTalks:!0},powers_cycle:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("lab_tuts_powerstats",!1,Mn.playNext)},avivaTalks:!0},powers_full:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("labtutorial_begin",!1,Mn.playNext)},avivaTalks:!0},powers_remove:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("attachment_removed",!1,Mn.playNext)},avivaTalks:!0},powers_add:{first:!1,triggered:!1,trigger:function(){"use strict";Pn.powers_add.first?V.audio.playSound("add_"+Math.ceil(3*Math.random()),!1,Mn.playNext):V.audio.playSound("labtutorial_remove",!1,Mn.playNext),Pn.powers_add.first=!0,Pn.powers_add.triggered=!1},avivaTalks:!0},description_weight:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("lab_description_weight",!1,Mn.playNext)},avivaTalks:!0},description_cost:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("lab_description_cost",!1,Mn.playNext)},avivaTalks:!0},description_duration:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("lab_description_duration",!1,Mn.playNext)},avivaTalks:!0},left_tab:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("lab_tuts_movement_attachments",!1,Mn.playNext)},avivaTalks:!0},right_tab:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("lab_tuts_defensive_attachments",!1,Mn.playNext)},avivaTalks:!0},select_empty:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("lab_tuts_emptyslot",!1,Mn.playNext)},avivaTalks:!0},racer_overweight:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("racer_too_heavy",!1,Mn.playNext)},avivaTalks:!0},setup_intro:{triggered:!1,trigger:function(){"use strict";V.audio.playSound("setup_intro",!1,Mn.playNext)},avivaTalks:!1}},Mn={elapsedTime:0,timeSinceMovement:0,timeSincePower:0,timeBeforeNotification:30,moveNotificationRequired:!0,powerNotificationRequired:!0,tutorialQueue:[],ready:!0,flashTimer:0,showFlash:!1,markTutorialFlashComplete:function(e){"use strict";In[e].completed=!0},updateTutorialFlash:function(e){"use strict";var t,a=null;for(Mn.flashTimer+=V.dt,Mn.flashTimer>.2&&(Mn.flashTimer=0,Mn.showFlash=!Mn.showFlash),t=0;t<Sn[e].length;t+=1)if(!In[Sn[e][t]].completed){a=In[Sn[e][t]];break}if($("#lab_tutorial_highlights .tutorialVisible").each(function(e,t){(null===a||t.id!=="lab_tutorial_flash_"+a.pathId)&&(t.className.baseVal="")}),null!==a){if(void 0!==a.condition&&!a.condition())return void(document.getElementById("lab_tutorial_flash_"+a.pathId).className.baseVal="");document.getElementById("lab_tutorial_flash_"+a.pathId).className.baseVal=Mn.showFlash?"tutorialVisible":""}},trigger:function(e){"use strict";if(void 0===Pn[e])return void console.log("Tutorial event with name '"+e+"' does not exist.");if(!Pn[e].triggered)if(Mn.ready)Mn.ready=!1,Pn[e].triggered=!0,Pn[e].trigger(),console.log("playing tutorial: "+e),Pn[e].avivaTalks&&V.labAviva.talk(!0);else{var t;for(t=0;t<Mn.tutorialQueue.length;t+=1)if(Mn.tutorialQueue[t]===e)return;Mn.tutorialQueue.push(e)}},update:function(){"use strict";Mn.timeSinceMovement+=V.dt,(y()||h())&&(Mn.timeSinceMovement=0),Mn.timeSinceMovement>Mn.timeBeforeNotification&&(Mn.timeSinceMovement=0,Mn.trigger("moveReminder")),Mn.timeSincePower+=V.dt,Mn.timeSincePower>Mn.timeBeforeNotification&&(Mn.timeSincePower=0,Rt.Fuel.available>4&&Mn.trigger("powerReminder"))},playNext:function(){"use strict";V.labAviva.talk(!1),Mn.ready=!0,Mn.tutorialQueue.length>0&&(Mn.trigger(Mn.tutorialQueue[0]),Mn.tutorialQueue.splice(0,1))},stopAllSounds:function(){"use strict";Mn.tutorialQueue=[],V.audio.stopSound("labtutorial_snow"),V.audio.stopSound("labtutorial_next"),V.audio.stopSound("labtutorial_powers"),V.audio.stopSound("labtutorial_remove"),V.audio.stopSound("labtutorial_begin")}}}({},function(){return this}());