var PKG=PKG||{};
(function(b){var j,a=function(){if("undefined"==typeof j)return PBS.KIDS.Headband.reload(),!1;var a,b;j=j.replace("?","");for(var c=j.split("&"),f=0;f<c.length;f++){var h=c[f].split("=");if(2==h.length){var i=h[0],g=h[1];"refresh"==i?a=g:"destination"==i&&0<g.length&&(b=decodeURIComponent(g))}}if(0==a)return PBS.KIDS.Headband.reload(),"undefined"!=typeof GA_obj&&GA_obj.trackEvent("PBSKIDS GO Login","Logged in",window.location.href),!1;if("undefined"!=typeof b)return"undefined"!=typeof GA_obj&&GA_obj.trackEvent("PBSKIDS GO Login",
"Logged in",g),window.location.href=b,!1;window.location.reload()};PKG.prmpt=PKG.prmpt||function(b){j=b||window.location.href;PBS.KIDS.identity.prompt(a)};PKG.login=PKG.login||function(b){j=b||window.location.href;PBS.KIDS.identity.signin(a)};PKG.signup=PKG.signup||function(b){j=b||window.location.href;PBS.KIDS.identity.signup(a)};PKG.forgot=PKG.forgot||function(b){PKG.overlay("/go/apps/auth/forgot_password/"+(b||""))};PKG.overlay=PKG.overlay||function(a){PBS.KIDS.$_auth.colorbox({href:a,width:"620px",
iframe:!0,fastIframe:!1,scrolling:!1,onCleanup:function(){if(window.top.org&&window.top.org.pbskids&&window.top.org.pbskids.login&&window.top.org.pbskids.login.stopAudio){window.top.org.pbskids.login.stopAudio();}},onComplete:function(){b("body").trigger("init.go")},onClosed:function(){var b=/\/go\/apps\/auth\/account_settings\//;(/\/go\/apps\/auth\/change_password/.test(a)||b)&&PBS.KIDS.identity.upgradeToV2Cookie()},overlayClose:!1})};b("body").bind("cbox_open",function(){b("object, embed").each(function(){var a=b(this).attr("wmode");"undefined"==typeof a&&(a=b("object").find("param[name='wmode']").attr("value"));"transparent"!=
a&&("Transparent"!=a&&"opaque"!=a&&"Opaque"!=a)&&(this.style.visibility="hidden")})});b("body").bind("cbox_closed",function(){b("object, embed").each(function(){this.style.visibility="visible"})});"undefined"!=typeof b.fn.colorbox&&(b(document).ready(function(){b("body").on("click",'a[href*="/go/apps/auth/prompt"]',function(){PKG.prmpt(this.search);return!1});b("body").on("click",'a[href*="/go/apps/auth/login"]',function(){PKG.login(this.search);return!1});b("body").on("click",'a[href*="/go/apps/auth/signup"]',
function(){PKG.signup(this.search);return!1});b("body").on("click",'a[href*="/go/apps/auth"]:not([href*="logout"]):not([href*="prompt"]):not([href*="login"]):not([href*="signup"])',function(){PKG.overlay(this.href);return!1})}),b.fn.colorbox.loading=function(){b("#go-auth").children().hide();b("#cboxLoadingOverlay").show();b("#cboxLoadingGraphic").show()});"function"!==typeof Object.create&&(Object.create=function(a){function b(){}b.prototype=a;return new b});b.plugin=function(a,d){b.fn[a]=function(c){var f=
Array.prototype.slice.call(arguments,1);return this.each(function(){var h=b.data(this,a);h?h[c].apply(h,f):(h=b.data(this,a,Object.create(d)),h.init(c,this))})}};b.plugin("print",{init:function(a,d){this.options=b.extend({},this.options,a);this.elem=d;this.$elem=b(d);this._addEventListeners()},options:{autoprint:!0,content:null,directories:"no",fullscreen:"no",height:null,location:"no",menubar:"no",name:"printWindow",resizable:"no",scrollbars:"no",url:null,width:null},_addEventListeners:function(){this.$elem.bind("click.print",
b.proxy(function(){this.newWindow();return!1},this))},newWindow:function(){var a=this.options,d=window.open(this.options.url,this.options.name,"width="+this.options.width+",height="+this.options.height+",directories="+this.options.directories+",fullscreen="+this.options.fullscreen+",location="+this.options.location+",menubar="+this.options.menubar+",resizable="+this.options.resizable+",scrollbars="+this.options.scrollbars);setTimeout(function(){b(d.document.body).html(a.content);!0==a.autoprint&&
setTimeout(function(){d.print()},100)},500)}});b.plugin("gobutton",{init:function(a,d){this.options=b.extend({},this.options,a);this.elem=d;this.$elem=b(d);this._addEventListeners()},options:{bevel:{bottom:"7px",right:"7px"},speed:{down:100,up:"slow"},throughClick:!0},_addEventListeners:function(){this.$elem.bind("mouseenter",b.proxy(this.press,this));this.$elem.bind("mouseleave",b.proxy(this.release,this));!0==this.options.throughClick&&this.$elem.bind("click",b.proxy(this.throughClick,this))},press:function(){this.$elem.stop().animate({left:this.options.bevel.right,
top:this.options.bevel.bottom},this.options.speed.down)},release:function(){this.$elem.stop().animate({left:0,top:0},this.options.speed.up)},disable:function(a){a=a||!0;this.$elem.addClass("disabled");!0==a&&this.$elem.unbind().click(function(){return!1})},enable:function(){this.$elem.removeClass("disabled");this.$elem.unbind("click");this._addEventListeners()},select:function(){this.$elem.addClass("selected").css({left:this.options.bevel.right,top:this.options.bevel.bottom}).unbind("mouseenter").unbind("mouseleave")},
throughClick:function(){this.$elem.css({left:this.options.bevel.right,opacity:0.5,top:this.options.bevel.bottom}).click(function(){return!1}).unbind("mouseleave")}});b.plugin("label",{init:function(a,d){this.options=b.extend({},this.options,a);this.elem=d;this.$elem=b(d);this.options.labelText=this.options.labelText||this.$elem.prev("label");!0==this.options.useLabel?this.$elem.data("labelText",this.options.labelText.text()):this.$elem.data("labelText","");this._build();this._addEventListeners();
this.$elem.trigger("blur")},options:{hideLabel:!0,labelText:null,useLabel:!0},clear:function(){this.$elem.val("");this.$elem.removeClass("inactive").addClass("active")},empty:function(){return""==this.$elem.val()||this.$elem.val()==this.$elem.data("labelText")?!0:!1},reset:function(){this.$elem.val(this.$elem.data("labelText"));this.$elem.removeClass("active").addClass("inactive")},_build:function(){!0==this.options.hideLabel&&this.options.labelText.hide()},_addEventListeners:function(){this.$elem.focus(b.proxy(function(){!0==
this.empty()&&this.clear()},this));this.$elem.blur(b.proxy(function(){!0==this.empty()&&this.reset()},this))}})})(PBS.KIDS.jQuery_auth);
(function(b){function j(){if(b.fn.ajaxSubmit.debug){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(a):window.opera&&window.opera.postError&&window.opera.postError(a)}}b.fn.ajaxSubmit=function(a){function e(){function d(){var a=i.attr("target"),g=i.attr("action");c.setAttribute("target",h);"POST"!=c.getAttribute("method")&&c.setAttribute("method","POST");c.getAttribute("action")!=e.url&&c.setAttribute("action",e.url);e.skipEncodingOverride||
i.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});e.timeout&&setTimeout(function(){r=!0;f()},e.timeout);var k=[];try{if(e.extraData)for(var j in e.extraData)k.push(b('<input type="hidden" name="'+j+'" value="'+e.extraData[j]+'" />').appendTo(c)[0]);l.appendTo("body");l.data("form-plugin-onload",f);c.submit()}finally{c.setAttribute("action",g),a?c.setAttribute("target",a):i.removeAttr("target"),b(k).remove()}}function f(){if(!s){var a=!0;try{if(r)throw"timeout";var d,c;c=n.contentWindow?
n.contentWindow.document:n.contentDocument?n.contentDocument:n.document;var g="xml"==e.dataType||c.XMLDocument||b.isXMLDoc(c);j("isXml="+g);if(!g&&(null==c.body||""==c.body.innerHTML)){if(--t){j("requeing onLoad callback, DOM not available");setTimeout(f,250);return}j("Could not access iframe DOM after 100 tries.");return}j("response detected");s=!0;k.responseText=c.body?c.body.innerHTML:null;k.responseXML=c.XMLDocument?c.XMLDocument:c;k.getResponseHeader=function(a){return{"content-type":e.dataType}[a]};
if("json"==e.dataType||"script"==e.dataType){var h=c.getElementsByTagName("textarea")[0];if(h)k.responseText=h.value;else{var i=c.getElementsByTagName("pre")[0];i&&(k.responseText=i.innerHTML)}}else if("xml"==e.dataType&&!k.responseXML&&null!=k.responseText){c=k;var q=k.responseText,g=void 0;window.ActiveXObject?(g=new ActiveXObject("Microsoft.XMLDOM"),g.async="false",g.loadXML(q)):g=(new DOMParser).parseFromString(q,"text/xml");c.responseXML=g&&g.documentElement&&"parsererror"!=g.documentElement.tagName?
g:null}d=b.httpData(k,e.dataType)}catch(m){j("error caught:",m),a=!1,k.error=m,b.handleError(e,k,"error",m)}a&&(e.success(d,"success"),p&&b.event.trigger("ajaxSuccess",[k,e]));p&&b.event.trigger("ajaxComplete",[k,e]);p&&!--b.active&&b.event.trigger("ajaxStop");e.complete&&e.complete(k,a?"success":"error");setTimeout(function(){l.removeData("form-plugin-onload");l.remove();k.responseXML=null},100)}}var c=i[0];if(b(":input[name=submit]",c).length)alert('Error: Form elements must not be named "submit".');
else{var e=b.extend({},b.ajaxSettings,a),g=b.extend(!0,{},b.extend(!0,{},b.ajaxSettings),e),h="jqFormIO"+(new Date).getTime(),l=b('<iframe id="'+h+'" name="'+h+'" src="'+e.iframeSrc+'" onload="(PBS.KIDS.jQuery_auth(this).data(\'form-plugin-onload\'))()" />'),n=l[0];l.css({position:"absolute",top:"-1000px",left:"-1000px"});var k={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=
1;l.attr("src",e.iframeSrc)}},p=e.global;p&&!b.active++&&b.event.trigger("ajaxStart");p&&b.event.trigger("ajaxSend",[k,e]);if(g.beforeSend&&!1===g.beforeSend(k,g))g.global&&b.active--;else if(!k.aborted){var s=!1,r=0;if(g=c.clk){var m=g.name;m&&!g.disabled&&(e.extraData=e.extraData||{},e.extraData[m]=g.value,"image"==g.type&&(e.extraData[m+".x"]=c.clk_x,e.extraData[m+".y"]=c.clk_y))}e.forceSync?d():setTimeout(d,10);var t=100}}}if(!this.length)return j("ajaxSubmit: skipping submit process - no element selected"),
this;"function"==typeof a&&(a={success:a});var d=b.trim(this.attr("action"));d&&(d=(d.match(/^([^#]+)/)||[])[1]);d=d||window.location.href||"";a=b.extend({url:d,type:this.attr("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},a||{});d={};this.trigger("form-pre-serialize",[this,a,d]);if(d.veto)return j("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(a.beforeSerialize&&!1===a.beforeSerialize(this,a))return j("ajaxSubmit: submit aborted via beforeSerialize callback"),
this;var c=this.formToArray(a.semantic);if(a.data){a.extraData=a.data;for(var f in a.data)if(a.data[f]instanceof Array)for(var h in a.data[f])c.push({name:f,value:a.data[f][h]});else c.push({name:f,value:a.data[f]})}if(a.beforeSubmit&&!1===a.beforeSubmit(c,this,a))return j("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[c,this,a,d]);if(d.veto)return j("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;f=b.param(c);"GET"==a.type.toUpperCase()?
(a.url+=(0<=a.url.indexOf("?")?"&":"?")+f,a.data=null):a.data=f;var i=this,g=[];a.resetForm&&g.push(function(){i.resetForm()});a.clearForm&&g.push(function(){i.clearForm()});if(!a.dataType&&a.target){var l=a.success||function(){};g.push(function(e){var c=a.replaceTarget?"replaceWith":"html";b(a.target)[c](e).each(l,arguments)})}else a.success&&g.push(a.success);a.success=function(b,e,c){for(var d=0,f=g.length;d<f;d++)g[d].apply(a,[b,e,c||i,i])};f=b("input:file",this).fieldValue();h=!1;for(d=0;d<f.length;d++)f[d]&&
(h=!0);f.length&&!1!==a.iframe||a.iframe||h?a.closeKeepAlive?b.get(a.closeKeepAlive,e):e():b.ajax(a);this.trigger("form-submit-notify",[this,a]);return this};b.fn.ajaxForm=function(a){return this.ajaxFormUnbind().bind("submit.form-plugin",function(e){e.preventDefault();b(this).ajaxSubmit(a)}).bind("click.form-plugin",function(a){var d=a.target,c=b(d);if(!c.is(":submit,input:image")){d=c.closest(":submit");if(0==d.length)return;d=d[0]}var f=this;f.clk=d;"image"==d.type&&(void 0!=a.offsetX?(f.clk_x=
a.offsetX,f.clk_y=a.offsetY):"function"==typeof b.fn.offset?(c=c.offset(),f.clk_x=a.pageX-c.left,f.clk_y=a.pageY-c.top):(f.clk_x=a.pageX-d.offsetLeft,f.clk_y=a.pageY-d.offsetTop));setTimeout(function(){f.clk=f.clk_x=f.clk_y=null},100)})};b.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};b.fn.formToArray=function(a){var e=[];if(0==this.length)return e;var d=this[0],c=a?d.getElementsByTagName("*"):d.elements;if(!c)return e;for(var f=0,h=c.length;f<h;f++){var i=
c[f],g=i.name;if(g)if(a&&d.clk&&"image"==i.type)!i.disabled&&d.clk==i&&(e.push({name:g,value:b(i).val()}),e.push({name:g+".x",value:d.clk_x},{name:g+".y",value:d.clk_y}));else if((i=b.fieldValue(i,!0))&&i.constructor==Array)for(var j=0,q=i.length;j<q;j++)e.push({name:g,value:i[j]});else null!==i&&"undefined"!=typeof i&&e.push({name:g,value:i})}if(!a&&d.clk&&(a=b(d.clk),c=a[0],(g=c.name)&&!c.disabled&&"image"==c.type))e.push({name:g,value:a.val()}),e.push({name:g+".x",value:d.clk_x},{name:g+".y",value:d.clk_y});
return e};b.fn.formSerialize=function(a){return b.param(this.formToArray(a))};b.fn.fieldSerialize=function(a){var e=[];this.each(function(){var d=this.name;if(d){var c=b.fieldValue(this,a);if(c&&c.constructor==Array)for(var f=0,h=c.length;f<h;f++)e.push({name:d,value:c[f]});else null!==c&&"undefined"!=typeof c&&e.push({name:this.name,value:c})}});return b.param(e)};b.fn.fieldValue=function(a){for(var e=[],d=0,c=this.length;d<c;d++){var f=b.fieldValue(this[d],a);null===f||("undefined"==typeof f||f.constructor==
Array&&!f.length)||(f.constructor==Array?b.merge(e,f):e.push(f))}return e};b.fieldValue=function(a,b){var d=a.name,c=a.type,f=a.tagName.toLowerCase();"undefined"==typeof b&&(b=!0);if(b&&(!d||a.disabled||"reset"==c||"button"==c||("checkbox"==c||"radio"==c)&&!a.checked||("submit"==c||"image"==c)&&a.form&&a.form.clk!=a||"select"==f&&-1==a.selectedIndex))return null;if("select"==f){var h=a.selectedIndex;if(0>h)return null;for(var d=[],f=a.options,i=(c="select-one"==c)?h+1:f.length,h=c?h:0;h<i;h++){var g=
f[h];if(g.selected){var j=g.value;j||(j=g.attributes&&g.attributes.value&&!g.attributes.value.specified?g.text:g.value);if(c)return j;d.push(j)}}return d}return a.value};b.fn.clearForm=function(){return this.each(function(){b("input,select,textarea",this).clearFields()})};b.fn.clearFields=b.fn.clearInputs=function(){return this.each(function(){var a=this.type,b=this.tagName.toLowerCase();"text"==a||"password"==a||"textarea"==b?this.value="":"checkbox"==a||"radio"==a?this.checked=!1:"select"==b&&(this.selectedIndex=
-1)})};b.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})};b.fn.enable=function(a){void 0==a&&(a=!0);return this.each(function(){this.disabled=!a})};b.fn.selected=function(a){void 0==a&&(a=!0);return this.each(function(){var e=this.type;"checkbox"==e||"radio"==e?this.checked=a:"option"==this.tagName.toLowerCase()&&(e=b(this).parent("select"),a&&(e[0]&&"select-one"==e[0].type)&&e.find("option").selected(!1),
this.selected=a)})}})(PBS.KIDS.jQuery_auth);PKG.loaded=!0;
