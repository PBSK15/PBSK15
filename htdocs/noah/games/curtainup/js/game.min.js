/*! Built with IMPACT - impactjs.com */

(function(window){"use strict";Math.map=function(x,istart,istop,ostart,ostop){return ostart+(ostop-ostart)*((x-istart)/(istop-istart));};Math.limit=function(x,min,max){return Math.min(max,Math.max(min,x));};Math.roundAt=function(x,precision){if(!precision)return Math.round(x);precision=Math.pow(10,precision||0);return Math.round(x*precision)/precision;};Math.toInt=function(x){return(x|0);};Math.toRad=function(x){return((x*Math.PI)/180);};Math.toDeg=function(x){return((x*180)/Math.PI);};Object.defineProperty(Array.prototype,'erase',{value:function(item){var i=this.indexOf(item);if(i>=0)this.splice(i,1);return this;}});Object.defineProperty(Array.prototype,'random',{value:function(){return this[0|(Math.random()*this.length)];}});Function.prototype.bind=Function.prototype.bind||function(object){var t=this;return function(){return t.apply(object,arguments);};};window.ig={main:null,debug:null,version:'1.23',global:window,modules:{},resources:[],ready:false,baked:false,nocache:'',ua:{},prefix:(window.ImpactPrefix||''),lib:'js/lib/',_current:null,_loadQueue:[],_waitForOnload:0,$:function(selector){return selector[0]=='#'?document.getElementById(selector.substr(1)):document.getElementsByTagName(selector);},$new:document.createElement.bind(document),copy:function(object){var c,i;if(!object||typeof(object)!='object'||object instanceof HTMLElement||object instanceof ig.Class){return object;}
else if(Array.isArray(object)){c=object.slice(0);for(i=0;i<c.length;i++){if(c[i]&&typeof(c[i])=='object'){c[i]=ig.copy(c[i]);}}
return c;}
else{c={};for(i in object){c[i]=ig.copy(object[i]);}
return c;}},merge:function(original,extended){for(var key in extended){var ext=extended[key];if(typeof(ext)!='object'||ext instanceof HTMLElement||ext instanceof ig.Class||ext===null){original[key]=ext;}
else{if(!original[key]||typeof(original[key])!='object'){original[key]=(ext instanceof Array)?[]:{};}
ig.merge(original[key],ext);}}
return original;},ksort:function(obj){if(!obj||typeof(obj)!='object'){return[];}
var keys=[],values=[];for(var k in obj){keys.push(k);}
keys.sort();for(var i=0;i<keys.length;i++){values.push(obj[keys[i]]);}
return values;},setVendorAttribute:function(el,attr,val){var uc=attr[0].toUpperCase()+attr.substr(1);el[attr]=val||el['ms'+uc]||el['moz'+uc]||el['webkit'+uc]||el['o'+uc];},getVendorAttribute:function(el,attr){var uc=attr[0].toUpperCase()+attr.substr(1);return el[attr]||el['ms'+uc]||el['moz'+uc]||el['webkit'+uc]||el['o'+uc];},normalizeVendorAttribute:function(el,attr){var prefixedVal=ig.getVendorAttribute(el,attr);if(!el[attr]&&prefixedVal){el[attr]=prefixedVal;}},module:function(name){if(ig._current){throw("Module '"+ig._current.name+"' defines nothing");}
if(ig.modules[name]&&ig.modules[name].body){throw("Module '"+name+"' is already defined");}
ig._current={name:name,requires:[],loaded:false,body:null};ig.modules[name]=ig._current;ig._loadQueue.push(ig._current);return ig;},requires:function(){ig._current.requires=Array.prototype.slice.call(arguments);return ig;},external:function(){var externalRequires=Array.prototype.slice.call(arguments);for(var i=0;i<externalRequires.length;i++){if(!ig.modules[name])ig._loadScript(externalRequires[i]);}
return ig;},defines:function(body){ig._current.body=body;ig._current=null;ig._initDOMReady();},addResource:function(resource){ig.resources.push(resource);},setNocache:function(set){ig.nocache=set?'?'+Date.now():'';},log:function(msg){if(this.debug&&window.console&&console.log){console.log(msg);}},assert:function(condition,msg){},show:function(name,number){},mark:function(msg,color){},_loadScript:function(name,requiredFrom){ig.modules[name]={name:name,requires:[],loaded:false,body:null};ig._waitForOnload++;var path=ig.prefix+ig.lib+name.replace(/\./g,'/')+'.js'+ig.nocache;var script=ig.$new('script');script.type='text/javascript';script.onload=function(){ig._waitForOnload--;ig._execModules();};script.onerror=function(){throw('Failed to load module '+name+' at '+path+' '+'required from '+requiredFrom);};script.src=path;ig.$('head')[0].appendChild(script);},_execModules:function(){var i,j,m,modulesLoaded=false;for(i=0;i<ig._loadQueue.length;i++){m=ig._loadQueue[i];var dependenciesLoaded=true;for(j=0;j<m.requires.length;j++){var name=m.requires[j];if(!ig.modules[name]){dependenciesLoaded=false;ig._loadScript(name,m.name);}
else if(!ig.modules[name].loaded){dependenciesLoaded=false;}}
if(dependenciesLoaded&&m.body){ig._loadQueue.splice(i,1);m.loaded=true;m.body();modulesLoaded=true;i--;}}
if(modulesLoaded){ig._execModules();}
else if(!ig.baked&&ig._waitForOnload===0&&ig._loadQueue.length!==0){var unresolved=[];for(i=0;i<ig._loadQueue.length;i++){var unloaded=[];var requires=ig._loadQueue[i].requires;for(j=0;j<requires.length;j++){m=ig.modules[requires[j]];if(!m||!m.loaded){unloaded.push(requires[j]);}}
unresolved.push(ig._loadQueue[i].name+' (requires: '+unloaded.join(', ')+')');}
throw('Unresolved (circular?) dependencies. '+"Most likely there's a name/path mismatch for one of the listed modules:\n"+
unresolved.join('\n'));}},_DOMReady:function(){if(!ig.modules['dom.ready'].loaded){if(!document.body){return setTimeout(ig._DOMReady,13);}
ig.modules['dom.ready'].loaded=true;ig._waitForOnload--;ig._execModules();}
return 0;},_boot:function(){if(document.location.href.match(/\?nocache/)){ig.setNocache(true);}
ig.ua.pixelRatio=window.devicePixelRatio||1;ig.ua.viewport={width:window.innerWidth,height:window.innerHeight};ig.ua.screen={width:window.screen.availWidth*ig.ua.pixelRatio,height:window.screen.availHeight*ig.ua.pixelRatio};ig.ua.iPhone=/iPhone/i.test(navigator.userAgent);ig.ua.iPhone4=(ig.ua.iPhone&&ig.ua.pixelRatio==2);ig.ua.iPad=/iPad/i.test(navigator.userAgent);ig.ua.android=/android/i.test(navigator.userAgent);ig.ua.kindle=/Silk/i.test(navigator.userAgent);ig.ua.iOS=ig.ua.iPhone||ig.ua.iPad;ig.ua.mobile=ig.ua.iOS||ig.ua.android||ig.ua.winPhone||ig.ua.kindle||/mobile/i.test(navigator.userAgent);ig.ua.touchDevice=(('ontouchstart'in window)||(window.navigator.msMaxTouchPoints));},_initDOMReady:function(){if(ig.modules['dom.ready']){ig._execModules();return;}
ig._boot();ig.modules['dom.ready']={requires:[],loaded:false,body:null};ig._waitForOnload++;document.addEventListener('DOMContentLoaded',ig._DOMReady,false);window.addEventListener('load',ig._DOMReady,false);}};var initializing=false,fnTest=/xyz/.test(function(){xyz;})?/\bparent\b/:/.*/;window.ig.Class=function(){};var inject=function(prop){var proto=this.prototype;var parent={};for(var name in prop){if(typeof(prop[name])=="function"&&typeof(proto[name])=="function"&&fnTest.test(prop[name])){parent[name]=proto[name];proto[name]=(function(name,fn){return function(){this.parent=parent[name];return fn.apply(this,arguments);};})(name,prop[name]);}
else{proto[name]=prop[name];}}};window.ig.Class.extend=function(prop){var parent=this.prototype;initializing=true;var prototype=new this();initializing=false;for(var name in prop){if(typeof(prop[name])=="function"&&typeof(parent[name])=="function"&&fnTest.test(prop[name])){prototype[name]=(function(name,fn){return function(){this.parent=parent[name];return fn.apply(this,arguments);};})(name,prop[name]);}
else{prototype[name]=prop[name];}}
function Class(){if(!initializing){if(this.staticInstantiate){var obj=this.staticInstantiate.apply(this,arguments);if(obj){return obj;}}
for(var p in this){if(typeof(this[p])=='object'){this[p]=ig.copy(this[p]);}}
if(this.init){this.init.apply(this,arguments);}}
return this;}
Class.prototype=prototype;Class.prototype.constructor=Class;Class.extend=window.ig.Class.extend;Class.inject=inject;return Class;};})(window);

// lib/impact/system.js
ig.baked=true;ig.module('impact.system').defines(function(){"use strict";ig.System=ig.Class.extend({fps:30,width:320,height:240,tick:0,delegate:null,stages:[],numStages:0,init:function(fps,width,height){if(!window.createjs){throw("CreateJS is not included");}
this.resize(width,height);this.fps=fps;createjs.Ticker.timingMode=createjs.Ticker.RAF_SYNCHED;createjs.Ticker.setFPS(fps);createjs.Ticker.addEventListener("tick",this.run.bind(this));},addStage:function(stage,name){stage.canvas.width=this.width;stage.canvas.height=this.height;this.stages.push(stage);this.numStages=this.stages.length;return stage;},resize:function(width,height){this.width=width;this.height=height;for(var i=0;i<this.numStages;i++){this.stages[i].canvas.width=this.width;this.stages[i].canvas.height=this.height;}},setGame:function(gameClass){ig.main=new(gameClass)();this.delegate=ig.main;},run:function(event){this.tick=event.delta/1000;if(this.delegate){this.delegate.run();ig.input.clearPressed();}
for(var i=0;i<this.numStages;i++){this.stages[i].update(event);}}});});

// lib/impact/input.js
ig.baked=true;ig.module('impact.input').defines(function(){"use strict";ig.KEY={'MOUSE1':-1,'MOUSE2':-3,'MWHEEL_UP':-4,'MWHEEL_DOWN':-5,'BACKSPACE':8,'TAB':9,'ENTER':13,'PAUSE':19,'CAPS':20,'ESC':27,'SPACE':32,'PAGE_UP':33,'PAGE_DOWN':34,'END':35,'HOME':36,'LEFT_ARROW':37,'UP_ARROW':38,'RIGHT_ARROW':39,'DOWN_ARROW':40,'INSERT':45,'DELETE':46,'_0':48,'_1':49,'_2':50,'_3':51,'_4':52,'_5':53,'_6':54,'_7':55,'_8':56,'_9':57,'A':65,'B':66,'C':67,'D':68,'E':69,'F':70,'G':71,'H':72,'I':73,'J':74,'K':75,'L':76,'M':77,'N':78,'O':79,'P':80,'Q':81,'R':82,'S':83,'T':84,'U':85,'V':86,'W':87,'X':88,'Y':89,'Z':90,'NUMPAD_0':96,'NUMPAD_1':97,'NUMPAD_2':98,'NUMPAD_3':99,'NUMPAD_4':100,'NUMPAD_5':101,'NUMPAD_6':102,'NUMPAD_7':103,'NUMPAD_8':104,'NUMPAD_9':105,'MULTIPLY':106,'ADD':107,'SUBSTRACT':109,'DECIMAL':110,'DIVIDE':111,'F1':112,'F2':113,'F3':114,'F4':115,'F5':116,'F6':117,'F7':118,'F8':119,'F9':120,'F10':121,'F11':122,'F12':123,'SHIFT':16,'CTRL':17,'ALT':18,'PLUS':187,'COMMA':188,'MINUS':189,'PERIOD':190};ig.Input=ig.Class.extend({bindings:{},actions:{},presses:{},locks:{},delayedKeyup:{},isUsingMouse:false,isUsingKeyboard:false,isUsingAccelerometer:false,mouse:{x:0,y:0},accel:{x:0,y:0,z:0},initMouse:function(stage,click,mousemove,mousedown,mouseup){if(this.isUsingMouse){return;}
this.isUsingMouse=true;stage.on("stagemousedown",this.keydown.bind(this));stage.on("stagemouseup",this.keyup.bind(this));stage.on("stagemousemove",this.mousemove.bind(this));if(ig.ua.mobile&&cjs.Touch.isSupported()){cjs.Touch.enable(stage);stage.enableDOMEvents(false);}},initKeyboard:function(){if(this.isUsingKeyboard){return;}
this.isUsingKeyboard=true;window.addEventListener('keydown',this.keydown.bind(this),false);window.addEventListener('keyup',this.keyup.bind(this),false);},initAccelerometer:function(){if(this.isUsingAccelerometer){return;}
window.addEventListener('devicemotion',this.devicemotion.bind(this),false);},mousemove:function(event){this.mouse.x=event.stageX;this.mouse.y=event.stageY;},keydown:function(event){var nativeEvent=event.nativeEvent;var tag=nativeEvent.target.tagName;if(tag=='INPUT'||tag=='TEXTAREA'){return;}
var code=nativeEvent.type=='keydown'?nativeEvent.keyCode:(nativeEvent.button==2?ig.KEY.MOUSE2:ig.KEY.MOUSE1);if(event.type=='stagemousedown'){this.mousemove(event);}
var action=this.bindings[code];if(action){this.actions[action]=true;if(!this.locks[action]){this.presses[action]=true;this.locks[action]=true;}}},keyup:function(event){var nativeEvent=event.nativeEvent;var tag=nativeEvent.target.tagName;if(tag=='INPUT'||tag=='TEXTAREA'){return;}
var code=nativeEvent.type=='keyup'?nativeEvent.keyCode:(nativeEvent.button==2?ig.KEY.MOUSE2:ig.KEY.MOUSE1);var action=this.bindings[code];if(action){this.delayedKeyup[action]=true;}},devicemotion:function(event){this.accel=event.accelerationIncludingGravity;},bind:function(key,action){if(key<0){this.initMouse();}
else if(key>0){this.initKeyboard();}
this.bindings[key]=action;},unbind:function(key){var action=this.bindings[key];this.delayedKeyup[action]=true;this.bindings[key]=null;},unbindAll:function(){this.bindings={};this.actions={};this.presses={};this.locks={};this.delayedKeyup={};},state:function(action){return this.actions[action];},pressed:function(action){return this.presses[action];},released:function(action){return!!this.delayedKeyup[action];},clearPressed:function(){for(var action in this.delayedKeyup){this.actions[action]=false;this.locks[action]=false;}
this.delayedKeyup={};this.presses={};}});});

// lib/impact/impact.js
ig.baked=true;ig.module('impact.impact').requires('dom.ready','impact.system','impact.input').defines(function(){"use strict";ig.main=function(gameClass,fps,width,height){ig.system=new ig.System(fps,width,height);ig.input=new ig.Input();ig.ready=true;ig.system.setGame(gameClass);};});

// lib/impact/main.js
ig.baked=true;ig.module('impact.main').requires('impact.impact').defines(function(){"use strict";ig.Main=ig.Class.extend({staticInstantiate:function(){ig.main=this;return null;},run:function(event){this.update();},update:function(){}});});

// lib/display/pick-dropdowns.js
ig.baked=true;ig.module('display.pick-dropdowns').requires('impact.main').defines(function(){ig.PickDropdowns=ig.Class.extend({container:null,string:null,titleCont:null,musicCont:null,doneBtn:null,activeTitle:null,activeMusic:null,introVO:null,currentSound:null,noah:null,init:function(){this.container=new cjs.Container();this.string=new cjs.Sprite(ig.SHEETS.MAIN,"AlertSignString").set({regX:8,regY:214,mouseEnabled:false});this.titleCont=new cjs.Container().set({regX:208,regY:17});this.titleCont.addChild(new cjs.Sprite(ig.SHEETS.MAIN,"PickTitleBox").set({mouseEnabled:false}));this.buildTitles();this.musicCont=new cjs.Container().set({regX:208,regY:17,scaleX:0,visible:false});this.musicCont.addChild(new cjs.Sprite(ig.SHEETS.MAIN,"PickMusicBox").set({mouseEnabled:false}));this.buildMusic();this.string.x=this.musicCont.x=this.titleCont.x=Math.round(ig.system.width/2);this.string.y=this.musicCont.y=this.titleCont.y=40;this.container.addChild(this.titleCont);this.container.addChild(this.musicCont);this.container.addChild(this.string);ig.LAYERS.FRONT.addChild(this.container);this.doneBtn=new cjs.Sprite(ig.SHEETS.MAIN,"DoneBtn").set({visible:false,alpha:0,cursor:"pointer",regX:54,regY:31,x:ig.system.width/2,y:526});this.container.addChild(this.doneBtn);this.noah=new CurtainUpAnims.PickNoahs.picknoahs().set({mouseEnabled:false,mouseChildren:false,visible:false,y:300});ig.LAYERS.FRONT.addChild(this.noah);this.container.visible=false;this.container.y=-300;this.container.on("mouseover",this.mouseHandler,this);this.container.on("mouseout",this.mouseHandler,this);this.container.on("click",this.mouseHandler,this);},buildTitles:function(){var list=ig.GameConfig.titles;for(var i=0;i<list.length;i++){var s=new cjs.Sprite(ig.SHEETS.PICKS,list[i].id);s.hitArea=new cjs.Shape(new cjs.Graphics().f("#000").r(0,0,277,42));s.cursor="pointer";s.userdata=list[i];s.x=74;s.y=i*42+86;this.titleCont.addChild(s);}},buildMusic:function(){var list=ig.GameConfig.musics;for(var i=0;i<list.length;i++){var c=new cjs.Container();c.x=74;c.y=i*42+86;var s=new cjs.Sprite(ig.SHEETS.PICKS,list[i].id);s.hitArea=new cjs.Shape(new cjs.Graphics().f("#000").r(0,0,277,42));s.cursor="pointer";s.userdata=list[i];c.addChild(s);var spk=new cjs.Sprite(ig.SHEETS.MAIN,"SpeakerAnim");spk.x=220;spk.y=7;spk.stop();spk.mouseEnabled=false;spk.framerate=30;s.spk=spk;c.addChild(spk);this.musicCont.addChild(c);}},bringIn:function(step){switch(step){case ig.STEPS.PICK_TITLE:if(!this.container.visible){this.noah.gotoAndPlay("start");this.introVO=cjs.Sound.play("vo_nowchooseatitle");cjs.Tween.get(this.container).set({visible:true}).to({y:0},1200,cjs.Ease.elasticOut);cjs.Tween.get(this.titleCont).wait(200).to({rotation:-5},100,cjs.Ease.none).to({rotation:5},300,cjs.Ease.none).to({rotation:0},600,cjs.Ease.backOut);cjs.Tween.get(this.doneBtn).wait(1200).set({visible:true}).to({alpha:1},400,cjs.Ease.quadInOut);cjs.Tween.get(this.noah).set({visible:true}).to({y:0},600,cjs.Ease.cubicOut);}else{cjs.Tween.get(this.musicCont).to({scaleX:0},300,cjs.Ease.backIn).set({visible:false});cjs.Tween.get(this.titleCont).wait(300).set({visible:true}).to({scaleX:1},300,cjs.Ease.backOut);}
break;case ig.STEPS.PICK_MUSIC:this.introVO=cjs.Sound.play("vo_nowchoosethemusic");cjs.Tween.get(this.titleCont).to({scaleX:0},300,cjs.Ease.backIn).set({visible:false});cjs.Tween.get(this.musicCont).wait(300).set({visible:true}).to({scaleX:1},300,cjs.Ease.backOut);break;}},hide:function(){this.doneBtn.alpha=0;this.doneBtn.visible=false;cjs.Tween.get(this.container).to({y:-300},600,cjs.Ease.backIn).set({visible:false});cjs.Tween.get(this.musicCont).wait(600).set({scaleX:0,visible:false});cjs.Tween.get(this.titleCont).wait(600).set({visible:true,scaleX:1});cjs.Tween.get(this.noah).to({y:300},600,cjs.Ease.cubicIn).set({visible:false});},clear:function(){if(this.activeTitle){this.activeTitle.gotoAndStop(this.activeTitle.userdata.id);this.activeTitle=null;}
if(this.activeMusic){this.activeMusic.gotoAndStop(this.activeMusic.userdata.id);this.activeMusic=null;}},setActiveTitle:function(item){var children=this.titleCont.children;var n=children.length;for(var i=0;i<n;i++){var c=children[i];if(!c.userdata){continue;}
c.gotoAndStop(item===c?c.userdata.id+"-on":c.userdata.id);}
this.activeTitle=item;if(ig.ua.mobile){this.playSound(item.userdata.sound);}},setActiveMusic:function(item){var children=this.musicCont.children;var n=children.length;for(var i=0;i<n;i++){var c=children[i];if(!c.children){continue;}
c=c.getChildAt(0);if(!c.userdata){continue;}
c.gotoAndStop(item===c?c.userdata.id+"-on":c.userdata.id);if(item!==c){c.spk.gotoAndStop("SpeakerAnim");}}
this.activeMusic=item;if(ig.ua.mobile){this.playSound(item.userdata.sound);this.noah.gotoAndStop(this.activeMusic.userdata.id);this.activeMusic.spk.play();}},playSound:function(id){this.stopSound(id);this.currentSound=cjs.Sound.play(id);this.currentSound.spriteID=id;},stopSound:function(id,force){if(this.currentSound&&(this.currentSound.spriteID!==id||force)){this.currentSound.stop();}},mouseHandler:function(e){var item=e.target;if(item===this.activeTitle||item===this.activeMusic){return;}
switch(e.type){case"mouseover":if(item.userdata){if((this.introVO&&this.introVO.playState===cjs.Sound.PLAY_FINISHED)||this.musicCont.visible){this.playSound(item.userdata.sound);}
item.gotoAndStop(item.userdata.id+"-over");if(this.musicCont.visible){item.spk.play();this.noah.gotoAndStop(item.userdata.id);}}else{item.scaleX=item.scaleY=1.05;}
break;case"mouseout":if(item.userdata){this.stopSound(item.userdata.sound);item.gotoAndStop(item.userdata.id);if(item.spk){item.spk.gotoAndStop("SpeakerAnim");}
this.noah.gotoAndStop("idle");}
item.scaleX=item.scaleY=1;break;case"click":if(item.userdata){if(this.titleCont.contains(item)){this.setActiveTitle(item);}else{this.setActiveMusic(item);}}else if(item===this.doneBtn){this.stopSound(null,true);if(ig.main.currentStep===ig.STEPS.PICK_TITLE&&this.activeTitle){ig.main.nextStep();}else if(ig.main.currentStep===ig.STEPS.PICK_MUSIC&&this.activeMusic){ig.main.nextStep();}}
break;}}});});

// lib/display/end-screen.js
ig.baked=true;ig.module('display.end-screen').requires('impact.main').defines(function(){ig.EndScreen=ig.Class.extend({container:null,title:null,watchAgainBtn:null,newPlayBtn:null,quitBtn:null,currentSound:null,init:function(){this.container=new cjs.Container();var mx=124;var my=79;this.container.addChild(new cjs.Bitmap(ig.main.mainQueue.getResult("EndBox")).set({x:mx,y:my,mouseEnabled:false}));this.title=new cjs.Sprite(ig.SHEETS.PICKS,"OutToLunch").set({x:mx+218,y:my+19,mouseEnabled:false});this.container.addChild(this.title);this.watchAgainBtn=new cjs.Sprite(ig.SHEETS.MAIN,"WatchAgainBtn").set({sid:"WatchAgainBtn",regX:100,regY:27,x:mx+357,y:my+182,cursor:"pointer"});this.newPlayBtn=new cjs.Sprite(ig.SHEETS.MAIN,"NewPlayBtn").set({sid:"NewPlayBtn",regX:80,regY:27,x:mx+357,y:my+263,cursor:"pointer"});this.quitBtn=new cjs.Sprite(ig.SHEETS.MAIN,"QuitBtn").set({sid:"QuitBtn",regX:38,regY:18,x:mx+643,y:my+395,cursor:"pointer"});this.container.addChild(this.watchAgainBtn);this.container.addChild(this.newPlayBtn);this.container.addChild(this.quitBtn);this.container.visible=false;ig.LAYERS.BLACK.addChild(this.container);this.container.on("click",this.btnHandler,this);this.container.on("mouseover",this.btnHandler,this);this.container.on("mouseout",this.btnHandler,this);this.container.on("mousedown",this.btnHandler,this);this.container.on("pressup",this.btnHandler,this);},setUserData:function(){this.title.gotoAndStop(ig.main.pickDrops.activeTitle.userdata.id);},btnHandler:function(e){var btn=e.target;if(!btn)return;switch(e.type){case"click":if(btn===this.watchAgainBtn){ig.main.playFinishedScene();}else if(btn===this.newPlayBtn){ig.main.startNewGame();}else if(btn===this.quitBtn){window.location.href=ig.GameConfig.quitBtnURL;}
break;case"mouseover":btn.gotoAndStop(btn.sid+"-over");if(this.currentSound){this.currentSound.stop();}
if(btn===this.watchAgainBtn){this.currentSound=cjs.Sound.play("vo_watchagain");}else if(btn===this.newPlayBtn){this.currentSound=cjs.Sound.play("vo_newplay");}
break;case"mouseout":btn.gotoAndStop(btn.sid);break;case"mousedown":btn.scaleX=0.9;btn.scaleY=0.9;break;case"pressup":btn.scaleX=1;btn.scaleY=1;break;}},destroy:function(){ig.LAYERS.BLACK.removeChild(this.container);}});});

// lib/display/theater.js
ig.baked=true;ig.module('display.theater').requires('impact.main').defines(function(){ig.Theater=ig.Class.extend({container:null,signContainer:null,signParts:null,string:null,you:null,title:null,crowd:null,coco:null,init:function(){this.container=new cjs.Container();this.container.mousechildren=false;this.container.visible=false;this.signContainer=new cjs.Container();this.string=new cjs.Sprite(ig.SHEETS.MAIN,"AlertSignString").set({regX:8,regY:214});this.signContainer.addChild(this.string);this.signParts=new cjs.Container();this.signParts.addChild(new cjs.Sprite(ig.SHEETS.MAIN,"DirectedSign").set({regX:201,regY:26}));this.signContainer.addChild(this.signParts);this.you=new cjs.Sprite(ig.SHEETS.MAIN,"You").set({x:18,y:119,alpha:0});this.signParts.addChild(this.you);this.title=new cjs.Sprite(ig.SHEETS.PICKS).set({x:-139,y:52});this.signParts.addChild(this.title);this.signContainer.x=Math.round(ig.system.width/2);this.string.y=this.signParts.y=130;this.container.addChild(this.signContainer);this.signContainer.visible=false;this.signContainer.y=-300;this.crowd=new CurtainUpAnims.ends.Crowd().set({x:480,y:600});this.container.addChild(this.crowd);this.coco=new CurtainUpAnims.ends.CocoEndPlay().set({x:480,y:260});this.coco.stop();this.container.addChild(this.coco);ig.LAYERS.FRONT.addChild(this.container);},reset:function(){this.container.visible=false;},setup:function(){this.container.visible=true;this.title.gotoAndStop(ig.main.pickDrops.activeTitle.userdata.id);},animateIn:function(callback){cjs.Sound.play("sfx_applause_short");this.crowd.gotoAndStop(1);cjs.Sound.play(ig.main.pickDrops.activeMusic.userdata.sound);cjs.Tween.get(this.signContainer).set({visible:true}).to({y:8},200,cjs.Ease.none).to({y:0},300,cjs.Ease.none);cjs.Tween.get(this.signParts).wait(200).to({rotation:-4},100,cjs.Ease.none).to({rotation:4},100,cjs.Ease.none).to({rotation:0},400,cjs.Ease.quadOut);cjs.Tween.get(this.you).wait(800).to({alpha:1},500,cjs.Ease.quadInout);cjs.Tween.get(this).wait(5000).call(this.hideSign,null,this);cjs.Tween.get(this).wait(6400).call(callback);},hideSign:function(){this.crowd.gotoAndStop(0);ig.main.curtains.watchOpen();cjs.Tween.get(this.signContainer).to({y:-300},500,cjs.Ease.backIn).set({visible:false});},end:function(callback){cjs.Sound.play("sfx_crowd_cheer");this.crowd.gotoAndStop(1);ig.main.curtains.close();this.coco.onComplete=callback;cjs.Tween.get(this).wait(1000).call(this.coco.gotoAndPlay,[1],this.coco);}});});

// lib/display/prompts.js
ig.baked=true;ig.module('display.prompts').requires('impact.main').defines(function(){ig.Prompts=ig.Class.extend({container:null,string:null,signContainer:null,textSprite:null,isOut:false,init:function(){this.container=new cjs.Container();this.container.mousechildren=false;this.string=new cjs.Sprite(ig.SHEETS.MAIN,"AlertSignString").set({regX:8,regY:214});this.signContainer=new cjs.Container().set({regX:110,regY:63});this.signContainer.addChild(new cjs.Sprite(ig.SHEETS.MAIN,"AlertSign"));this.textSprite=new cjs.Sprite(ig.SHEETS.MAIN,"DoneBtn");this.textSprite.x=110;this.textSprite.y=123;this.signContainer.addChild(this.textSprite);this.string.x=this.signContainer.x=Math.round(ig.system.width/2);this.string.y=this.signContainer.y=100;this.container.addChild(this.signContainer);this.container.addChild(this.string);ig.LAYERS.FRONT.addChild(this.container);this.container.visible=false;this.container.y=-300;},prompt:function(prompt){if(this.isOut)return;var bb;switch(prompt){case"backdrop":cjs.Sound.play("vo_youneedtopickabackgroundfirst");this.textSprite.gotoAndStop("PromptBackdrop");break;case"props":cjs.Sound.play("vo_youneedtopicksomepropsfirst");this.textSprite.gotoAndStop("PromptProp");break;case"characters":cjs.Sound.play("vo_youneedtopicksomecharactersfirst");this.textSprite.gotoAndStop("PromptCharacter");break;}
bb=this.textSprite.getBounds();this.textSprite.regX=Math.round(bb.width/2);this.textSprite.regY=Math.round(bb.height/2);this.animateDown();},animateDown:function(){cjs.Tween.get(this.container).set({visible:true}).to({y:8},200,cjs.Ease.none).to({y:0},300,cjs.Ease.none);cjs.Tween.get(this.signContainer).wait(200).to({rotation:-4},100,cjs.Ease.none).to({rotation:4},100,cjs.Ease.none).to({rotation:0},400,cjs.Ease.quadOut);cjs.Tween.get(this).wait(1500).call(this.animateUp,null,this);this.isOut=true;},animateUp:function(){cjs.Tween.get(this.container).to({y:-300},500,cjs.Ease.backIn).set({visible:false});this.isOut=false;}});});

// lib/display/panels.js
ig.baked=true;ig.module('display.panels').requires('impact.main').defines(function(){ig.Panel=ig.Class.extend({active:false,container:null,leftButton:null,rightButton:null,currentPageIndex:0,hitShape:null,pages:[],manifest:[],_queue:null,spinner:null,init:function(){this.createContainer();this.createPanelAppearance();this.createMiscVisuals();},createContainer:function(){this.container=new cjs.Container();this.container.x=ig.system.width/2-365;this.container.y=ig.system.height+50;},createPanelAppearance:function(){},createMiscVisuals:function(){var hit=new createjs.Shape();hit.graphics.beginFill("#000").drawRect(-10,0,50,50);var btn=new cjs.Sprite(ig.SHEETS.MAIN,"PanelButton");btn.on("click",this.arrowClickHandler,this);btn.hitArea=hit;new createjs.ButtonHelper(btn,"PanelButton","PanelButtonOver","PanelButtonOver");var bb=btn.getBounds();btn.regX=bb.width/2;btn.regY=bb.height/2;btn.scaleX=-1;btn.x=35;btn.y=65;this.leftButton=btn;this.container.addChild(this.leftButton);btn=new cjs.Sprite(ig.SHEETS.MAIN,"PanelButton");btn.on("click",this.arrowClickHandler,this);btn.hitArea=hit;new createjs.ButtonHelper(btn,"PanelButton","PanelButtonOver","PanelButtonOver");bb=btn.getBounds();btn.regX=bb.width/2;btn.regY=bb.height/2;btn.x=695;btn.y=65;this.rightButton=btn;this.container.addChild(this.rightButton);this.spinner=new cjs.Sprite(ig.SHEETS.MAIN,"SpinnerAnim");this.spinner.framerate=6;this.spinner.x=340;this.spinner.y=60;this.container.addChild(this.spinner);},loadAssets:function(callback){this._queue=new createjs.LoadQueue(true);this._queue.setMaxConnections(3);this._queue.installPlugin(cjs.Sound);this._queue.on("fileload",this.onFileLoad,this);this._queue.on("complete",this.onLoadComplete,this);if(callback){this._queue.on("complete",callback);}},buildContents:function(){this.container.removeChild(this.spinner);},tickLoadingText:function(e){this.tickCount+=ig.system.tick;if(this.tickCount>0.3){if(this.dotCount>2){this.dotCount=0;this.string="Loading";}else{this.dotCount++;this.string+=".";}
this.loadingText.text=this.string;this.tickCount-=0.3;}},addPage:function(x,y){var page=new cjs.Container().set({x:x,y:y,visible:false,cursor:"pointer"});page.on("mouseover",this.onChoiceMouse,this);page.on("mouseout",this.onChoiceMouse,this);page.on("mousedown",this.onChoiceMouse,this);page.on("pressup",this.onChoiceMouse,this);this.pages.push(page);this.container.addChild(page);return page;},onChoiceMouse:function(e){switch(e.type){case"mouseover":e.target.scaleX=1.05;e.target.scaleY=1.05;break;case"mouseout":e.target.scaleX=1;e.target.scaleY=1;break;case"mousedown":ig.main.animationCheck();e.target.scaleX=0.9;e.target.scaleY=0.9;break;case"pressup":e.target.scaleX=1;e.target.scaleY=1;break;}},arrowClickHandler:function(e){if(e.currentTarget===this.leftButton){this.currentPageIndex--;}else if(e.currentTarget===this.rightButton){this.currentPageIndex++;}
if(this.currentPageIndex<0){this.currentPageIndex=this.pages.length-1;}else if(this.currentPageIndex>=this.pages.length){this.currentPageIndex=0;}
for(var i=0;i<this.pages.length;i++){this.pages[i].visible=i===this.currentPageIndex;}},setVisibilty:function(bool){this.rightButton.visible=this.leftButton.visible=bool||this.active;if(this.pages.length){this.pages[this.currentPageIndex].visible=bool||this.active;}},onLoadComplete:function(){this._queue.removeAllEventListeners();this.buildContents();},onFileLoad:function(e){var item=e.item;var type=item.type;var result;if(ig.main.isAudioLimited){return;}
if(type==cjs.LoadQueue.JSON){switch(item.id){case"propSoundData":result=this._queue.getResult("propSoundData");this._queue.loadManifest([{src:"media/audio/"+result.urls[0],data:{channels:1,audioSprite:result.audioSprite}}]);break;case"characterSoundData":result=this._queue.getResult("characterSoundData");this._queue.loadManifest([{src:"media/audio/"+result.urls[0],data:{channels:2,audioSprite:result.audioSprite}}]);break;}}},});ig.Panel.Backgrounds=ig.Panel.extend({createPanelAppearance:function(){var s=new cjs.Shape(new cjs.Graphics().f("#87B7B7").rr(0,0,730,160,10).ef().f("#87B7B7").rr(88,-34,168,55,10).ef());this.hitShape=new cjs.Shape().set({x:88,y:-34,cursor:"pointer"});this.hitShape.hitArea=new cjs.Shape(new cjs.Graphics().f("#f00").r(0,0,168,36).ef());var title=new cjs.Sprite(ig.SHEETS.MAIN,"BackgroundsTitle");title.x=125;title.y=-28;var panelShapes=new cjs.Container();panelShapes.addChild(s);panelShapes.addChild(title);panelShapes.cache(0,-34,730,190);this.container.addChild(panelShapes);this.container.addChild(this.hitShape);},loadAssets:function(callback){if(callback){callback();}
this.buildContents();},buildContents:function(){this.parent();var list=ig.GameConfig.backgrounds;var c=0,r=0,mc=5,mr=ig.ua.mobile?1:2,sX=49,sY=ig.ua.mobile?48:22,p=this.addPage(72,15);p.visible=true;for(var i=0;i<list.length;i++){if(r>=mr){c=0;r=0;p=this.addPage(72,15);}
var t=new cjs.Bitmap("media/images/backgrounds/"+list[i].thumb);t.backdropUrl="media/images/backgrounds/"+list[i].full;t.x=c*122+sX;t.y=r*60+sY;t.regX=48;t.regY=22;p.addChild(t);c++;if(c>=mc){c=0;r++;}}},onChoiceMouse:function(e){this.parent(e);if(e.type==="mousedown"){ig.main.scene.changeBackdrop(e.target.backdropUrl);}}});ig.Panel.Props=ig.Panel.extend({createPanelAppearance:function(){var s=new cjs.Shape(new cjs.Graphics().f("#48956D").rr(0,0,730,160,10).ef().f("#48956D").rr(288,-34,168,55,10).ef());this.hitShape=new cjs.Shape().set({x:288,y:-34,cursor:"pointer"});this.hitShape.hitArea=new cjs.Shape(new cjs.Graphics().f("#f00").r(0,0,168,36).ef());var title=new cjs.Sprite(ig.SHEETS.MAIN,"PropsTitle");title.x=348;title.y=-28;var panelShapes=new cjs.Container();panelShapes.addChild(s);panelShapes.addChild(title);panelShapes.cache(0,-34,730,190);this.container.addChild(panelShapes);this.container.addChild(this.hitShape);},loadAssets:function(callback){this.parent(callback);this._queue.loadManifest([{id:"propSoundData",src:"media/audio/propsounds.json"},{id:"propThumbsSheet",src:"media/images/prop-thumbs.png"},{id:"propThumbsData",src:"media/images/prop-thumbs.json"},{id:"propsSheet",src:"media/images/props.png"},{id:"propsData",src:"media/images/props.json"}]);},buildContents:function(){this.parent();var data=this._queue.getResult("propsData");data.images=[this._queue.getResult("propsSheet")];ig.SHEETS.PROPS=new cjs.SpriteSheet(data);data=this._queue.getResult("propThumbsData");data.images=[this._queue.getResult("propThumbsSheet")];ig.SHEETS.PROP_THUMBS=new cjs.SpriteSheet(data);var list=ig.GameConfig.props;var c=0,r=0,mc=10,mr=ig.ua.mobile?1:2,sY=ig.ua.mobile?24:0,p=this.addPage(92,40),w=600,h=120;p.visible=true;var cSpacing=w/mc;var rowSpacing=h/mr;for(var i=0;i<list.length;i++){if(r>=mr){c=0;r=0;p=this.addPage(92,40);}
var propData=list[i];var t=new cjs.Sprite(ig.SHEETS.PROP_THUMBS,propData.id);t.userdata=propData;t.x=c*cSpacing;t.y=r*rowSpacing+sY;var b=t.getBounds();t.regX=Math.floor(b.width/2);t.regY=Math.floor(b.height/2);p.addChild(t);c++;if(c>=mc){c=0;r++;}}},onChoiceMouse:function(e){this.parent(e);if(e.type==="mousedown"){cjs.Sound.play(e.target.userdata.sound);ig.main.scene.addProp(this.createNewProp(e.target.userdata));}},createNewProp:function(data){var prop=new cjs.Sprite(ig.SHEETS.PROPS,data.id);prop.userdata=data;var bb=prop.getBounds();prop.regX=Math.floor(bb.width/2);prop.regY=Math.floor(bb.height/2);return prop;}});ig.Panel.Characters=ig.Panel.extend({createPanelAppearance:function(){var s=new cjs.Shape(new cjs.Graphics().f("#5D7B7B").rr(0,0,730,160,10).ef().f("#5D7B7B").rr(492,-34,168,55,10).ef());this.hitShape=new cjs.Shape().set({x:492,y:-34,cursor:"pointer"});this.hitShape.hitArea=new cjs.Shape(new cjs.Graphics().f("#f00").r(0,0,168,36).ef());var title=new cjs.Sprite(ig.SHEETS.MAIN,"CharactersTitle");title.x=535;title.y=-28;var panelShapes=new cjs.Container();panelShapes.addChild(s);panelShapes.addChild(title);panelShapes.cache(0,-34,730,190);this.container.addChild(panelShapes);this.container.addChild(this.hitShape);},loadAssets:function(callback){this.parent(callback);this._queue.loadManifest([{id:"characterSoundData",src:"media/audio/characterclips.json"},{id:"charactersThumbsSheet",src:"media/images/character-thumbs.png"},{id:"charactersThumbsData",src:"media/images/character-thumbs.json"},{id:"charactersSheet",src:"media/images/characters.png"},{id:"charactersData",src:"media/images/characters.json"},{id:"animCharacters",src:"js/animations/characters.js"}]);},buildContents:function(){this.parent();var data=this._queue.getResult("charactersData");data.images=[this._queue.getResult("charactersSheet")];ig.SHEETS.CHARACTERS=new cjs.SpriteSheet(data);data=this._queue.getResult("charactersThumbsData");data.images=[this._queue.getResult("charactersThumbsSheet")];ig.SHEETS.CHARACTER_THUMBS=new cjs.SpriteSheet(data);var pageList=ig.GameConfig.characters;for(var i=0;i<pageList.length;i++){var page=this.addPage(90,40);page.visible=i===0;var list=pageList[i];var c,addedWidth=0,j=0,n=0;for(j=0;j<list.length;j++){var data=list[j];c=new cjs.Sprite(ig.SHEETS.CHARACTER_THUMBS,data.id);var bb=c.getBounds();c.regX=Math.floor(bb.width/2);c.regY=Math.floor(bb.height/2);c.userdata=data;page.addChild(c);addedWidth+=bb.width;n++;}
var spacing=(580-addedWidth)/n;var _x=0;for(j=0;j<n;j++){c=page.getChildAt(j);c.x=_x+c.regX;c.y=30;_x=c.x+c.regX+spacing;}}},onChoiceMouse:function(e){this.parent(e);if(e.type==="mousedown"){ig.main.scene.addCharacter(this.createNewCharacter(e.target.userdata));}},createNewCharacter:function(data){var character=new CurtainUpAnims.characters[data.id]();character.userdata=data;character.mouseChildren=false;return character;}});});

// lib/display/ui.js
ig.baked=true;ig.module('display.ui').requires('impact.main').defines(function(){ig.UI=ig.Class.extend({btns:null,panels:null,nextBtn:null,clearBtn:null,watchBtn:null,soundBtn:null,btnGlow:null,backBtn:null,backgroundsPanel:null,propsPanel:null,charactersPanel:null,activePanel:null,init:function(){this.buildBtns();this.buildPanels();},buildBtns:function(){this.btns=new cjs.Container();ig.LAYERS.PANELS.addChild(this.btns);this.btnGlow=new cjs.Sprite(ig.SHEETS.MAIN,"BtnGlow").set({regX:46,regY:30,visible:false,mouseEnabled:false});this.btns.addChild(this.btnGlow);this.watchBtn=new cjs.Sprite(ig.SHEETS.MAIN,"WatchBtn").set({x:ig.system.width+200,y:538,regX:35,regY:21,visible:false});this.btns.addChild(this.watchBtn);this.nextBtn=new cjs.Sprite(ig.SHEETS.MAIN,"NextBtn").set({x:ig.system.width+200,y:491,regX:35,regY:20,visible:false});this.btns.addChild(this.nextBtn);this.soundBtn=new cjs.Sprite(ig.SHEETS.MAIN,"SoundOnBtn").set({x:-200,y:491,regX:35,regY:21,visible:false});this.btns.addChild(this.soundBtn);this.clearBtn=new cjs.Sprite(ig.SHEETS.MAIN,"ClearBtn").set({x:-200,y:536,regX:35,regY:18,visible:false});this.btns.addChild(this.clearBtn);this.backBtn=new cjs.Sprite(ig.SHEETS.MAIN,"BackBtn").set({x:-200,y:508,regX:33,regY:17,visible:false});this.btns.addChild(this.backBtn);this.btns.on("click",this.btnHandler,this);this.btns.on("mouseover",this.btnHandler,this);this.btns.on("mouseout",this.btnHandler,this);this.btns.on("mousedown",this.btnHandler,this);this.btns.on("pressup",this.btnHandler,this);this.btns.cursor="pointer";this.btns.visible=false;},buildPanels:function(){this.panels=new cjs.Container();ig.LAYERS.PANELS.addChild(this.panels);this.backgroundsPanel=new ig.Panel.Backgrounds();this.backgroundsPanel.container.visible=false;this.panels.addChild(this.backgroundsPanel.container);this.propsPanel=new ig.Panel.Props();this.propsPanel.container.visible=false;this.panels.addChild(this.propsPanel.container);this.charactersPanel=new ig.Panel.Characters();this.charactersPanel.container.visible=false;this.panels.addChild(this.charactersPanel.container);this.backgroundsPanel.hitShape.on("click",this.panelTabHandler,this);this.propsPanel.hitShape.on("click",this.panelTabHandler,this);this.charactersPanel.hitShape.on("click",this.panelTabHandler,this);},startLoadPanels:function(){this.backgroundsPanel.loadAssets(this._loadProps.bind(this));},_loadProps:function(){this.propsPanel.loadAssets(this._loadCharacters.bind(this));},_loadCharacters:function(){this.charactersPanel.loadAssets();},disable:function(){this.btns.mouseEnabled=this.btns.mouseChildren=false;this.panels.mouseEnabled=this.panels.mouseChildren=false;},enable:function(){ig.LAYERS.SCENE.mouseEnabled=true;this.btns.mouseEnabled=this.btns.mouseChildren=true;this.panels.mouseEnabled=this.panels.mouseChildren=true;},showPanel:function(step){this.panels.mouseChildren=false;switch(step){case ig.STEPS.BACKGROUNDS:this.backgroundsPanel.setVisibilty(true);this.activePanel=this.backgroundsPanel.container;break;case ig.STEPS.PROPS:this.propsPanel.setVisibilty(true);this.activePanel=this.propsPanel.container;break;case ig.STEPS.CHARACTERS:this.charactersPanel.setVisibilty(true);this.activePanel=this.charactersPanel.container;break;}
cjs.Tween.get(this.activePanel).wait(1000).set({visible:true}).to({y:ig.system.height-150},600,cjs.Ease.cubicOut).call(this.checkPanels,null,this);},showAll:function(){cjs.Tween.get(this.backgroundsPanel.container).set({visible:true}).to({y:ig.system.height-150},600,cjs.Ease.cubicInOut);cjs.Tween.get(this.propsPanel.container).set({visible:true}).to({y:ig.system.height-150},600,cjs.Ease.cubicInOut);cjs.Tween.get(this.charactersPanel.container).set({visible:true}).to({y:ig.system.height-150},600,cjs.Ease.cubicInOut);},showAllPanels:function(){this.activePanel=this.backgroundsPanel.container;this.panels.mouseChildren=false;this.panels.setChildIndex(this.charactersPanel.container,0);this.panels.setChildIndex(this.propsPanel.container,1);this.panels.setChildIndex(this.backgroundsPanel.container,2);cjs.Tween.get(this.backgroundsPanel.container).wait(1600).set({visible:true}).to({y:ig.system.height-150},600,cjs.Ease.cubicOut);cjs.Tween.get(this.propsPanel.container).wait(1300).set({visible:true}).to({y:ig.system.height-150},600,cjs.Ease.cubicOut);cjs.Tween.get(this.charactersPanel.container).wait(1000).set({visible:true}).to({y:ig.system.height-150},600,cjs.Ease.cubicOut);cjs.Tween.get(this).wait(2200).call(this.checkPanels,null,this);},hidePanels:function(){cjs.Tween.get(this.backgroundsPanel.container).to({y:ig.system.height+50},600,cjs.Ease.cubicInOut).set({visible:false});cjs.Tween.get(this.propsPanel.container).to({y:ig.system.height+50},600,cjs.Ease.cubicInOut).set({visible:false});cjs.Tween.get(this.charactersPanel.container).to({y:ig.system.height+50},600,cjs.Ease.cubicInOut).set({visible:false});},panelTabHandler:function(e){if(cjs.Tween.hasActiveTweens(this.backgroundsPanel.container)||cjs.Tween.hasActiveTweens(this.propsPanel.container)||cjs.Tween.hasActiveTweens(this.charactersPanel.container)){return;}
var panel=e.currentTarget.parent;if(panel===this.activePanel)return;this.setDepthFor(panel);},setDepthFor:function(panel){this.panels.swapChildren(panel,this.activePanel);this.activePanel=panel;this.checkPanels();},showButtons:function(){this.btns.visible=this.btns.mouseChildren=true;this.btnGlow.visible=false;var t=400,e=cjs.Ease.cubicInOut;switch(ig.main.currentStep){case ig.STEPS.CHARACTERS:cjs.Tween.get(this.watchBtn).set({visible:true}).to({x:898},t,e);case ig.STEPS.PROPS:case ig.STEPS.BACKGROUNDS:cjs.Tween.get(this.soundBtn).set({visible:true}).to({x:63},t,e);cjs.Tween.get(this.clearBtn).set({visible:true}).to({x:63},t,e);cjs.Tween.get(this.nextBtn).set({visible:true}).to({x:898},t,e);cjs.Tween.get(this.backBtn).to({x:-200},t,e).set({visible:false});break;case ig.STEPS.PICK_MUSIC:case ig.STEPS.PICK_TITLE:cjs.Tween.get(this.soundBtn).to({x:-200},t,e).set({visible:false});cjs.Tween.get(this.clearBtn).to({x:-200},t,e).set({visible:false});cjs.Tween.get(this.watchBtn).to({x:ig.system.width+200},t,e).set({visible:false});cjs.Tween.get(this.nextBtn).to({x:ig.system.width+200},t,e).set({visible:false});cjs.Tween.get(this.backBtn).set({visible:true}).to({x:64},t,e);break;case ig.STEPS.PLAY:cjs.Tween.get(this.soundBtn).to({x:-200},t,e).set({visible:false});cjs.Tween.get(this.clearBtn).to({x:-200},t,e).set({visible:false});cjs.Tween.get(this.watchBtn).to({x:ig.system.width+200},t,e).set({visible:false});cjs.Tween.get(this.nextBtn).to({x:ig.system.width+200},t,e).set({visible:false});cjs.Tween.get(this.backBtn).to({x:-200},t,e).set({visible:false});break;}},checkPanels:function(){this.backgroundsPanel.active=this.backgroundsPanel.container===this.activePanel;this.propsPanel.active=this.propsPanel.container===this.activePanel;this.charactersPanel.active=this.charactersPanel.container===this.activePanel;this.backgroundsPanel.setVisibilty();this.propsPanel.setVisibilty();this.charactersPanel.setVisibilty();this.panels.mouseChildren=true;},btnHandler:function(e){var btn=e.target;if(!btn)return;switch(e.type){case"click":this.handleClick(btn);break;case"mouseover":var bb=btn.getBounds();this.btnGlow.x=btn.x;this.btnGlow.y=btn.y;this.btnGlow.scaleX=(bb.width+8)/92;this.btnGlow.scaleY=(bb.height+8)/60;this.btnGlow.visible=true;break;case"mouseout":this.btnGlow.visible=false;break;case"mousedown":btn.scaleX=0.9;btn.scaleY=0.9;break;case"pressup":btn.scaleX=1;btn.scaleY=1;break;}},handleClick:function(btn){switch(btn){case this.nextBtn:ig.main.nextStep();break;case this.clearBtn:ig.main.scene.clear();break;case this.watchBtn:if(!ig.main.checkStepRequirements()){return;}
this.disable();ig.main.scene.play(this.enable.bind(this));break;case this.backBtn:ig.main.backStep();break;case this.soundBtn:cjs.Sound.setMute(!cjs.Sound.getMute());this.soundBtn.gotoAndStop(cjs.Sound.getMute()?"SoundOffBtn":"SoundOnBtn");break;}}});});

// lib/display/scene.js
ig.baked=true;ig.module('display.scene').requires('impact.main').defines(function(){ig.SceneManager=ig.Class.extend({backdropContainer:null,objectContainer:null,backdrop:null,bottom:null,LINE_PADDING:10,activeItem:null,dragOffsetX:0,dragOffsetY:0,dragStartX:0,dragStartY:0,isMouseLocked:false,outline:null,isDragging:false,currentHeight:0,toolBox:null,scaleDownBtn:null,scaleUpBtn:null,rotateRightBtn:null,rotateLeftBtn:null,flipBtn:null,trashBtn:null,btnGlow:null,toolBoxTextbox:null,ignoreMouse:false,bindedMouseHandler:null,props:[],characters:[],didItemMove:false,isDefaultBackdrop:true,currentCharacter:null,playIndex:-1,playCallback:null,addedPosX:0,addedPosY:0,init:function(){this.backdropContainer=ig.LAYERS.SCENE.addChild(new cjs.Container());this.objectContainer=ig.LAYERS.SCENE.addChild(new cjs.Container());this.buildBackdrop();this.bindedMouseHandler=this.onMouseEvent.bind(this);},buildGraphics:function(){this.createToolBox();this.outline=new cjs.Shape();this.outline.mouseEnabled=false;this.spinner=new cjs.Sprite(ig.SHEETS.MAIN,"SpinnerAnim");this.spinner.framerate=6;this.spinner.x=ig.system.width/2-27;this.spinner.y=ig.system.height/2-64;this.backdropContainer.addChild(this.spinner);},buildBackdrop:function(){this.backdrop=new cjs.Bitmap("media/images/backgrounds/background01.jpg");this.bottom=new cjs.Shape();this.bottom.graphics.f("#252525").r(0,0,ig.system.width,145).f("3E3E3E").r(0,0,ig.system.width,30);this.bottom.y=455;this.backdropContainer.addChild(this.backdrop);this.backdropContainer.addChild(this.bottom);},clearAll:function(){this.isDefaultBackdrop=true;this.backdropContainer.removeAllChildren();this.buildBackdrop();this.objectContainer.removeAllChildren();this.props=[];this.characters=[];},play:function(callback){ig.LAYERS.SCENE.mouseEnabled=false;this.playCallback=callback;this.characters.sort(function(a,b){return a.x-b.x;});this.playIndex=-1;this.playNext();},onPreviewComplete:function(){if(!this.playCallback)return;this.playCallback();this.playCallback=null;},playNext:function(){this.playIndex++;if(this.currentCharacter){this.currentCharacter.onAnimationComplete=null;this.currentCharacter=null;}
if(this.playIndex<this.characters.length){this.currentCharacter=this.characters[this.playIndex];this.currentCharacter.onAnimationComplete=this.playNext.bind(this);this.currentCharacter.play();}else{this.onPreviewComplete();}},changeBackdrop:function(id){this.isDefaultBackdrop=false;this.backdropContainer.removeChild(this.backdrop);this.backdrop=new cjs.Bitmap(id);this.backdropContainer.addChildAt(this.backdrop,0);this.backdropContainer.addChildAt(this.spinner,0);},commitObject:function(displayobject){this.objectContainer.addChild(displayobject);},addProp:function(prop){this.props.push(prop);this.addNewItem(prop);},addCharacter:function(character){this.characters.push(character);this.addNewItem(character);},addNewItem:function(item){this.addedPosX=item.x=ig.input.mouse.x;this.addedPosY=item.y=ig.input.mouse.y;this.dragOffsetX=0;this.dragOffsetY=0;this.isMouseLocked=true;item.addEventListener("mousedown",this.bindedMouseHandler);item.addEventListener("pressmove",this.bindedMouseHandler);item.addEventListener("pressup",this.bindedMouseHandler);item.addEventListener("click",this.bindedMouseHandler);this.activateItem(item);},activateItem:function(item){if(this.activeItem){this.commitActiveItem();}
ig.LAYERS.EDIT.addChild(item);this.activeItem=item;this.updateOutline();ig.LAYERS.EDIT.addChild(this.outline);ig.LAYERS.EDIT.addChild(this.toolBox);},onMouseEvent:function(e){if(this.isMouseLocked){return;}
if(e.target!==this.activeItem){this.activateItem(e.target);}
switch(e.type){case"mousedown":this.didItemMove=false;this.toolBox.visible=false;this.dragOffsetX=this.activeItem.x-e.stageX;this.dragOffsetY=this.activeItem.y-e.stageY;this.dragStartX=this.activeItem.x;this.dragStartY=this.activeItem.y;break;case"pressmove":this.isDragging=true;this.activeItem.x=ig.input.mouse.x+this.dragOffsetX;this.activeItem.y=ig.input.mouse.y+this.dragOffsetY;break;case"pressup":this.setToolBox();this.toolBox.visible=true;this.isDragging=false;this.didItemMove=this.dragStartX!=this.activeItem.x||this.dragStartY!=this.activeItem.y;if(!this.didItemMove&&this.activeItem instanceof cjs.MovieClip){this.activeItem.gotoAndPlay(1);}else if(!this.didItemMove&&this.activeItem.userdata.sound){cjs.Sound.play(this.activeItem.userdata.sound);}
break;case"click":break;}
this.ignoreMouse=true;},onToolboxMouseEvent:function(e){if(!this.toolBox.visible)return;var btn=e.target;switch(e.type){case"mouseover":this.btnGlow.visible=true;this.btnGlow.x=btn.x;this.btnGlow.y=btn.y;break;case"mouseout":this.btnGlow.visible=false;break;case"mousedown":btn.scaleX=btn.scaleX<0?-0.9:0.9;btn.scaleY=0.9;break;case"pressup":btn.scaleX=btn.scaleX<0?-1:1;btn.scaleY=1;break;case"click":if(btn===this.trashBtn){this.btnGlow.visible=false;btn.scaleX=btn.scaleX<0?-1:1;btn.scaleY=1;}
this.performEditAction(btn);break;}
this.ignoreMouse=true;},performEditAction:function(btn){switch(btn){case this.scaleUpBtn:this.activeItem.scaleX*=1.1;this.activeItem.scaleY*=1.1;break;case this.scaleDownBtn:this.activeItem.scaleX*=0.9;this.activeItem.scaleY*=0.9;break;case this.rotateLeftBtn:this.activeItem.rotation-=15;break;case this.rotateRightBtn:this.activeItem.rotation+=15;break;case this.flipBtn:this.activeItem.scaleX*=-1;break;case this.trashBtn:this.trashItem();break;}
if(this.activeItem){this.updateOutline();this.outline.rotation=this.activeItem.rotation;}},trashItem:function(){this.props.erase(this.activeItem);this.characters.erase(this.activeItem);this.activeItem.removeEventListener("mousedown",this.bindedMouseHandler);this.activeItem.removeEventListener("pressmove",this.bindedMouseHandler);this.activeItem.removeEventListener("pressup",this.bindedMouseHandler);this.activeItem.removeEventListener("click",this.bindedMouseHandler);ig.LAYERS.EDIT.removeChild(this.activeItem);ig.LAYERS.EDIT.removeChild(this.outline);this.activeItem=null;this.toolBox.visible=false;},commitActiveItem:function(){this.commitObject(this.activeItem);this.activeItem=null;ig.LAYERS.EDIT.removeChild(this.outline);this.toolBox.visible=false;},updateOutline:function(){var save=this.activeItem.rotation;this.activeItem.rotation=0;var bb=this.activeItem.getTransformedBounds();this.activeItem.rotation=save;var w=bb.width+this.LINE_PADDING*2;var h=bb.height+this.LINE_PADDING*2;this.outline.graphics.c().ss(3).s("#ffff33").drawDashedRect(0,0,w,h,5);var xOffset=this.activeItem.x-(bb.x+bb.width/2);var yOffset=this.activeItem.y-(bb.y+bb.height/2);this.outline.regX=w/2+xOffset;this.outline.regY=h/2+yOffset;this.currentHeight=h;},clear:function(){if(this.activeItem){this.commitActiveItem();}
if(ig.main.ui.propsPanel.active){this.clearArrayItems(this.props);}else if(ig.main.ui.charactersPanel.active){this.clearArrayItems(this.characters);}else if(ig.main.ui.backgroundsPanel.active){this.isDefaultBackdrop=true;this.backdropContainer.removeAllChildren();this.buildBackdrop();}},clearArrayItems:function(arr){var n=arr.length;for(var i=0;i<n;i++){this.objectContainer.removeChild(arr[i]);}
arr.length=0;},update:function(){if(!this.activeItem){return;}
if(this.isMouseLocked){this.activeItem.x=ig.input.mouse.x+this.dragOffsetX;this.activeItem.y=ig.input.mouse.y+this.dragOffsetY;if(ig.input.released("left_mouse")&&(Math.abs(this.addedPosX-this.activeItem.x)>15||455>this.activeItem.y)){this.setToolBox();this.isMouseLocked=false;this.toolBox.visible=true;}}else if(!this.ignoreMouse){if(ig.input.released("left_mouse")){this.commitActiveItem();}}else{this.ignoreMouse=false;}
if(!this.activeItem){return;}
if(this.activeItem.y>462){this.activeItem.y=462;}
this.outline.x=this.activeItem.x;this.outline.y=this.activeItem.y;this.outline.rotation=this.activeItem.rotation;},setToolBox:function(){this.toolBoxTextbox.text=this.activeItem.userdata.caption;this.toolBox.x=this.activeItem.x;if(this.activeItem.y<230){this.toolBox.y=this.activeItem.y+this.currentHeight/2+55;}else{this.toolBox.y=this.activeItem.y-this.currentHeight/2-55;}
var pad=20;if(this.toolBox.x-154<pad){this.toolBox.x=pad+154;}else if(this.toolBox.x+154>ig.system.width-pad){this.toolBox.x=ig.system.width-pad-154;}
if(this.toolBox.y-47<pad){this.toolBox.y=pad+47;}else if(this.toolBox.y+47>462){this.toolBox.y=462-pad-47;}},createToolBox:function(){this.toolBox=new cjs.Container();this.toolBox.visible=false;this.toolBox.x=450;this.toolBox.y=300;var shape=new cjs.Shape();shape.mouseEnabled=false;shape.graphics.f("#000").r(0,0,308,94);shape.regX=154;shape.regY=47;this.toolBox.addChild(shape);var dProps={y:-18,regX:22,regY:22,cursor:"pointer"};this.scaleDownBtn=new cjs.Sprite(ig.SHEETS.MAIN,"ScaleDownBtn").set(dProps).set({x:-123});this.scaleUpBtn=new cjs.Sprite(ig.SHEETS.MAIN,"ScaleUpBtn").set(dProps).set({x:-74});this.rotateRightBtn=new cjs.Sprite(ig.SHEETS.MAIN,"RotateBtn").set(dProps).set({x:-24,scaleX:-1});this.rotateLeftBtn=new cjs.Sprite(ig.SHEETS.MAIN,"RotateBtn").set(dProps).set({x:24});this.flipBtn=new cjs.Sprite(ig.SHEETS.MAIN,"FlipBtn").set(dProps).set({x:73});this.trashBtn=new cjs.Sprite(ig.SHEETS.MAIN,"DeleteBtn").set(dProps).set({x:122});this.btnGlow=new cjs.Sprite(ig.SHEETS.MAIN,"ToolBtnGlow").set(dProps).set({x:0,y:0,regX:29,regY:29,visible:false,mouseEnabled:false});this.toolBox.addChild(this.btnGlow);this.toolBox.addChild(this.scaleDownBtn);this.toolBox.addChild(this.scaleUpBtn);this.toolBox.addChild(this.rotateRightBtn);this.toolBox.addChild(this.rotateLeftBtn);this.toolBox.addChild(this.flipBtn);this.toolBox.addChild(this.trashBtn);this.toolBoxTextbox=new cjs.Text("Textbox","bold 17px Helvetica","#FF9933").set({y:12,textAlign:"center",mouseEnabled:false});this.toolBox.addChild(this.toolBoxTextbox);ig.LAYERS.EDIT.addChild(this.toolBox);this.toolBox.on("mouseover",this.onToolboxMouseEvent,this);this.toolBox.on("mouseout",this.onToolboxMouseEvent,this);this.toolBox.on("mousedown",this.onToolboxMouseEvent,this);this.toolBox.on("pressup",this.onToolboxMouseEvent,this);this.toolBox.on("click",this.onToolboxMouseEvent,this);}});});

// lib/display/curtains.js
ig.baked=true;ig.module('display.curtains').requires('impact.main').defines(function(){ig.Curtains=ig.Class.extend({top:null,centerL:null,centerR:null,left:null,right:null,init:function(){this.top=new cjs.Bitmap("media/images/curtain-top.png").set({x:480,y:37,regX:470,regY:55,scaleX:1.024});this.centerL=new cjs.Bitmap("media/images/curtain-center.png").set({x:0,y:5});this.centerR=new cjs.Bitmap("media/images/curtain-center.png").set({x:960,y:5,scaleX:-1});this.left=new cjs.Bitmap("media/images/curtain-left.png").set({x:-141,y:-18,visible:false});this.right=new cjs.Bitmap("media/images/curtain-right.png").set({x:1095,y:-18,regX:139,visible:false});var layer=ig.LAYERS.CURTAINS;layer.addChild(this.centerR);layer.addChild(this.centerL);layer.addChild(this.left);layer.addChild(this.right);layer.addChild(this.top);},animateSides:function(direction,time){if(isNaN(time)){time=400;}
if(direction=="in"){cjs.Tween.get(this.left).set({visible:true}).to({x:-4},time,cjs.Ease.cubicInOut);cjs.Tween.get(this.right).set({visible:true}).to({x:959},time,cjs.Ease.cubicInOut);}},setForWatchPlay:function(){this.top.y=5;this.left.x=-130;this.right.x=1090;},watchOpen:function(){var time=1100;cjs.Tween.get(this.centerL).to({x:-470},time,cjs.Ease.quadIn).set({visible:false});cjs.Tween.get(this.centerR).to({x:1430},time,cjs.Ease.quadIn).set({visible:false});cjs.Tween.get(this.left).set({visible:true}).to({x:-34},time,cjs.Ease.cubicInOut);cjs.Tween.get(this.right).set({visible:true}).to({x:989},time,cjs.Ease.cubicInOut);},open:function(time){if(isNaN(time)){time=1100;}
cjs.Tween.get(this.centerL).to({x:-470},time,cjs.Ease.quadIn).set({visible:false});cjs.Tween.get(this.centerR).to({x:1430},time,cjs.Ease.quadIn).set({visible:false});},close:function(time){if(isNaN(time)){time=1100;}
cjs.Tween.get(this.top).set({visible:true}).to({y:37},time,cjs.Ease.quadOut);cjs.Tween.get(this.left).set({visible:true}).to({x:-4},time,cjs.Ease.quadOut);cjs.Tween.get(this.right).set({visible:true}).to({x:959},time,cjs.Ease.quadOut);this.centerL.x=0;this.centerR.x=960;this.centerR.y=this.centerL.y=-470;cjs.Tween.get(this.centerL).set({visible:true}).to({y:5},time,cjs.Ease.quadOut);cjs.Tween.get(this.centerR).set({visible:true}).to({y:5},time,cjs.Ease.quadOut);},clear:function(time){if(isNaN(time)){time=400;}
cjs.Tween.get(this.top).to({y:-62},time,cjs.Ease.quadIn).set({visible:false});cjs.Tween.get(this.left).to({x:-130},time,cjs.Ease.quadIn).set({visible:false});cjs.Tween.get(this.right).to({x:1090},time,cjs.Ease.quadIn).set({visible:false});},update:function(){}});});

// lib/display/preloader.js
ig.baked=true;ig.module('display.preloader').requires('impact.main').defines(function(){ig.Preloader=ig.Class.extend({sheet:null,sprite:null,textfield:null,tween:null,queue:null,baseString:"Loading",string:"",tickCount:0,dotCount:0,init:function(){this.string=this.baseString;this.sheet=new cjs.SpriteSheet({images:[ig.main.preQueue.getResult("loadersheet")],frames:{width:64,height:104},animations:{idle:[0],run:[1,2,3,"fall"],fall:[4]}});this.sheet.framerate=12;this.sprite=new cjs.Sprite(this.sheet,"idle");this.sprite.x=100;ig.LAYERS.PRELOADER.addChild(this.sprite);this.textfield=new createjs.Text(this.string,"bold 32px Arial","#FFFFCC");this.textfield.x=ig.system.width/2-65;this.textfield.y=ig.system.height/2;this.textfield.textAlign="left";this.textfield.textBaseline="alphabetic";ig.LAYERS.PRELOADER.addChild(this.textfield);var baseY=ig.system.height/2-80;this.sprite.y=baseY;this.tween=cjs.Tween.get(this.sprite,{loop:true}).to({y:baseY-60},300).call(this.sprite.gotoAndPlay,["run"]).wait(200).to({y:baseY},800).call(this.sprite.gotoAndPlay,["idle"]);},update:function(){this.sprite.x=ig.system.width/2+100;this.tickCount+=ig.system.tick;if(this.tickCount>0.3){if(this.dotCount>2){this.dotCount=0;this.string=this.baseString;}else{this.dotCount++;this.string+=".";}
this.textfield.text=this.string;this.tickCount-=0.3;}}});});

// lib/utils/hittest.js
ig.baked=true;ig.module('utils.hittest').requires('impact.impact').defines(function(){"use strict";ig.HitCheck=function(displayObject){var bb=displayObject.getTransformedBounds();var tx=bb.x;var ty=bb.y;var parent=displayObject.parent;while(parent){tx+=parent.x;ty+=parent.y;parent=parent.parent;}
return!(ig.input.mouse.x<tx||ig.input.mouse.y<ty||ig.input.mouse.x>tx+bb.width||ig.input.mouse.y>ty+bb.height);};});

// lib/game/game.js
ig.baked=true;ig.module('game.game').requires('display.pick-dropdowns','display.end-screen','display.theater','display.prompts','display.panels','display.ui','display.scene','display.curtains','display.preloader','utils.hittest','impact.main').defines(function(){ig.STEPS={BACKGROUNDS:0,PROPS:1,CHARACTERS:2,PICK_TITLE:3,PICK_MUSIC:4,PLAY:5};ig.SHEETS={};ig.LAYERS={};ig.CurtainUp=ig.Main.extend({stage:null,blackScreen:null,ui:null,pickDrops:null,prompts:null,theater:null,endScreen:null,curtains:null,preloader:null,scene:null,preQueue:null,mainQueue:null,currentStep:-1,skipBtnHandler:null,firstTouchHandler:null,_seenIntros:false,isAudioLimited:false,init:function(){ig.debug=false;window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||function(callback){window.setTimeout(callback,1000/60);};this.isAudioLimited=ig.ua.mobile&&!cjs.WebAudioPlugin.isSupported();this.initializeCanvases();this.loadPreloads();},initializeCanvases:function(){ig.log("Initialize Stage");this.stage=ig.system.addStage(new createjs.Stage("canvas"));if(ig.ua.mobile&&cjs.Touch.isSupported()){cjs.Touch.enable(this.stage);this.stage.enableDOMEvents(false);this.stage.snapToPixelEnabled=true;}else{this.stage.enableMouseOver(30);}
this.stage.preventSelection=false;ig.input.initMouse(this.stage);ig.input.bind(ig.KEY.MOUSE1,"left_mouse");this.background=new createjs.Shape();this.background.graphics.f("#000000").r(0,0,ig.system.width,ig.system.height);this.stage.addChild(this.background);this.skipBtnHandler=this.skipAnimation.bind(this);},loadPreloads:function(){createjs.LoadQueue.loadTimeout=60000;ig.log("Load Pre Queue");this.preQueue=new createjs.LoadQueue();this.preQueue.setMaxConnections(4);this.preQueueComplete=this.onPreQueueComplete.bind(this);this.preQueue.addEventListener("complete",this.preQueueComplete);this.preQueue.loadManifest([{id:"Frame",src:"media/images/frame.png"},{id:"StageFloor",src:"media/images/floor-default.png"},{id:"CurtainTop",src:"media/images/curtain-top.png"},{id:"CurtainLeft",src:"media/images/curtain-left.png"},{id:"CurtainCenter",src:"media/images/curtain-center.png"},{id:"CurtainRight",src:"media/images/curtain-right.png"},{id:"loadersheet",src:"media/images/loadersheet.png"}]);if(this.isAudioLimited){this.preQueue.loadFile({id:"singleTrackData",src:"media/audio/singletrack.json"});}else{this.preQueue.loadManifest([{id:"voSoundData",src:"media/audio/voclips.json"},{id:"sfxSoundData",src:"media/audio/sfxclips.json"}]);}
if(ig.ua.mobile){this.preQueue.loadFile({id:"TitleImage",src:"media/images/titlescreen.png"});}},onPreQueueComplete:function(){ig.log("onPreQueueComplete");this.preQueue.removeEventListener("complete",this.preQueueComplete);this.preQueueComplete=null;this.initLayers();if(ig.ua.mobile){this.firstTouchHandler=this.mobileTouch.bind(this);ig.LAYERS.PRELOADER.addChild(new cjs.Bitmap(this.preQueue.getResult("TitleImage")));ig.LAYERS.PRELOADER.addEventListener("click",this.firstTouchHandler);}else{this.initSound();this.setupLoadScene();this.loadStartUpAssets();}},mobileTouch:function(){ig.LAYERS.PRELOADER.removeEventListener("click",this.firstTouchHandler);ig.LAYERS.PRELOADER.removeChildAt(0);this.firstTouchHandler=null;this.initSound();this.setupLoadScene();this.loadStartUpAssets();},initSound:function(){ig.log("Initialize sounds");if(cjs.WebAudioPlugin.isSupported()){cjs.WebAudioPlugin.playEmptySound();}
if(!cjs.Sound.initializeDefaultPlugins()){ig.log("Sound Problem!!!");return;}
cjs.Sound.alternateExtensions=["ogg","mp3"];cjs.Sound.defaultInterruptBehavior=cjs.Sound.INTERRUPT_EARLY;},initLayers:function(){ig.LAYERS.SCENE=this.stage.addChild(new cjs.Container());ig.LAYERS.PANELS=this.stage.addChild(new cjs.Container());ig.LAYERS.EDIT=this.stage.addChild(new cjs.Container());ig.LAYERS.BACK=this.stage.addChild(new cjs.Container());ig.LAYERS.CURTAINS=this.stage.addChild(new cjs.Container());ig.LAYERS.FRONT=this.stage.addChild(new cjs.Container());ig.LAYERS.PRELOADER=this.stage.addChild(new cjs.Container());this.blackScreen=new cjs.Shape(new cjs.Graphics().f("#000").r(0,0,ig.system.width,ig.system.height)).set({visible:false});ig.LAYERS.BLACK=this.stage.addChild(new cjs.Container());ig.LAYERS.BLACK.addChild(this.blackScreen);ig.LAYERS.FRAME=this.stage.addChild(new cjs.Bitmap(this.preQueue.getResult("Frame"))).set({mouseEnabled:false,mouseChildren:false});if(ig.debug){ig.LAYERS.DEBUG=this.stage.addChild(new cjs.Container());}},setupLoadScene:function(){this.curtains=new ig.Curtains();this.preloader=new ig.Preloader();this.scene=new ig.SceneManager();},loadStartUpAssets:function(){ig.log("Load Startup Asset");this.fileLoadHandler=this.handleFileLoad.bind(this);this.mainLoadHandler=this.onStartUpAssetsComplete.bind(this);this.mainQueue=new createjs.LoadQueue(true);this.mainQueue.setMaxConnections(4);this.mainQueue.installPlugin(cjs.Sound);var soundData;if(this.isAudioLimited){soundData=this.preQueue.getResult("singleTrackData");this.mainQueue.loadManifest([{src:"media/audio/"+soundData.urls[0],data:{channels:1,audioSprite:soundData.audioSprite}}]);}else{soundData=this.preQueue.getResult("voSoundData");this.mainQueue.loadManifest([{src:"media/audio/"+soundData.urls[0],data:{channels:1,audioSprite:soundData.audioSprite}}]);soundData=this.preQueue.getResult("sfxSoundData");this.mainQueue.loadManifest([{src:"media/audio/"+soundData.urls[0],data:{channels:2,audioSprite:soundData.audioSprite}}]);var list=["music_bounce","music_chachacha","music_coolcat","music_dangerahead","music_easypeasy","music_fiestafun","music_spookysounds","music_trickymouse","sound_gameintro1a","title_bellylaughs","title_circussillies","title_funnyfarm","title_junglejumble","title_lookoutbelow","title_outtolunch","title_sailaway","title_theskysthelimit"];for(var i=0;i<list.length;i++){var fName=list[i];this.mainQueue.loadFile({id:fName,src:"media/audio/"+fName+".ogg"});}}
this.mainQueue.loadManifest([{id:"IntroSheet",src:"media/images/intro.png"},{id:"IntroSheetData",src:"media/images/intro.json"},{id:"IntroBackground",src:"media/images/intro-bg.png"},{id:"IntroAnimJS",src:"js/animations/main-intro.js"},{id:"mainSheet",src:"media/images/mainsheet.png"},{id:"mainSheetData",src:"media/images/mainsheet.json"},{id:"SectionIntrosAnimJS",src:"js/animations/section-intros.js"},{id:"sectionIntrosSheet",src:"media/images/section-intros.png"},{id:"sectionIntrosData",src:"media/images/section-intros.json"},{id:"animPickNoahs",src:"js/animations/picknoahs.js"},{id:"pickNoahSheet",src:"media/images/pick-noah.png"},{id:"pickNoahData",src:"media/images/pick-noah.json"},{id:"titleMusicPicksSheet",src:"media/images/title-music-picks.png"},{id:"titleMusicPicksData",src:"media/images/title-music-picks.json"},{id:"animEnd",src:"js/animations/end-animations.js"},{id:"endAnimationsSheet",src:"media/images/end-animations.png"},{id:"endAnimationsData",src:"media/images/end-animations.json"},{id:"EndBox",src:"media/images/end-box.png"}]);this.mainQueue.addEventListener("fileload",this.fileLoadHandler);this.mainQueue.addEventListener("complete",this.mainLoadHandler);var list=ig.GameConfig.backgrounds;var manifest=[];for(var i=0;i<list.length;i++){manifest.push({src:"media/images/backgrounds/"+list[i].thumb});}
this.mainQueue.loadManifest(manifest);this.preloader.queue=this.mainQueue;},onStartUpAssetsComplete:function(){ig.log("onIntroQueueComplete");this.mainQueue.removeEventListener("complete",this.mainLoadHandler);this.mainLoadHandler=null;var data=this.mainQueue.getResult("mainSheetData");data.images=[this.mainQueue.getResult("mainSheet")];var f1=data.animations.SpeakerAnim01[0];var f2=data.animations.SpeakerAnim02[0];var f3=data.animations.SpeakerAnim03[0];var f4=data.animations.SpeakerAnim04[0];data.animations["SpeakerAnim"]={frames:[f1,f2,f2,f2,f2,f3,f3,f3,f4,f4,f4,f4,f1,f1,f1,f1,f1,f1,f1]};data.animations["SpinnerAnim"]={frames:[data.animations.spinner0001[0],data.animations.spinner0002[0],data.animations.spinner0003[0],data.animations.spinner0004[0]]};ig.SHEETS.MAIN=new createjs.SpriteSheet(data);data=this.mainQueue.getResult("IntroSheetData");data.images=[this.mainQueue.getResult("IntroSheet")];ig.SHEETS.INTRO=new cjs.SpriteSheet(data);data=this.mainQueue.getResult("titleMusicPicksData");data.images=[this.mainQueue.getResult("titleMusicPicksSheet")];ig.SHEETS.PICKS=new cjs.SpriteSheet(data);data=this.mainQueue.getResult("sectionIntrosData");data.images=[this.mainQueue.getResult("sectionIntrosSheet")];ig.SHEETS.SECTION_INTROS=new cjs.SpriteSheet(data);data=this.mainQueue.getResult("pickNoahData");data.images=[this.mainQueue.getResult("pickNoahSheet")];ig.SHEETS.PICK_NOAH=new cjs.SpriteSheet(data);data=this.mainQueue.getResult("endAnimationsData");data.images=[this.mainQueue.getResult("endAnimationsSheet")];ig.SHEETS.END_ANIMS=new cjs.SpriteSheet(data);ig.LAYERS.PRELOADER.visible=false;this.gotoIntroAnimation();},buildEverything:function(){this.ui=new ig.UI();this.pickDrops=new ig.PickDropdowns();this.prompts=new ig.Prompts();this.theater=new ig.Theater();this.endScreen=new ig.EndScreen();this.scene.buildGraphics();},gotoIntroAnimation:function(){this.currentAnim=new CurtainUpAnims.MainIntro.IntroAnimation().set({mouseChildren:false,mouseEnabled:false,onAnimationComplete:this.onIntroAnimationComplete.bind(this)});ig.LAYERS.FRONT.addChild(this.currentAnim);var playBtn=new cjs.Sprite(ig.SHEETS.MAIN,"SkipBtn").set({name:"playBtn",x:ig.system.width-120,y:ig.system.height-80,cursor:"pointer"});ig.LAYERS.FRONT.addChild(playBtn);playBtn.on("click",this.skipIntro,this);window.requestAnimationFrame(this.startIntro.bind(this));},startIntro:function(){this.currentAnim.play();this.curtains.animateSides("in",0);},skipIntro:function(e){this.onIntroAnimationComplete();},onIntroAnimationComplete:function(){cjs.Sound.stop();var playBtn=ig.LAYERS.FRONT.getChildByName("playBtn");playBtn.removeAllEventListeners();this.currentAnim=null;ig.LAYERS.FRONT.removeAllChildren();ig.LAYERS.PRELOADER.visible=false;ig.log("Destroy Main Intro Assets");CurtainUpAnims.MainIntro=null;this.buildEverything();this.ui.startLoadPanels();window.requestAnimationFrame(this.startNewGame.bind(this));},onAssetsComplete:function(){ig.log("Assets Complete");this.mainQueue.removeEventListener("complete",this.mainLoadHandler);this.mainLoadHandler=null;},startNewGame:function(){cjs.Tween.get(this.blackScreen).to({alpha:0},1000).set({visible:false});this.endScreen.container.visible=false;this.theater.container.visible=false;this.currentStep=-1;this.scene.clearAll();this.pickDrops.clear();this.nextStep();},nextStep:function(){if(!this.checkStepRequirements()){this.promptRequirements();return;}
this.currentStep++;switch(this.currentStep){case ig.STEPS.BACKGROUNDS:ig.LAYERS.SCENE.mouseEnabled=true;this.curtains.open();if(!this._seenIntros){this.curtains.animateSides("in",0);this.playSectionIntro(new CurtainUpAnims.Intros.BackgroundsIntro());}else{this.curtains.clear();this.ui.showButtons();}
this.ui.showPanel(this.currentStep);break;case ig.STEPS.PROPS:ig.LAYERS.SCENE.mouseEnabled=true;if(!this._seenIntros){this.playSectionIntro(new CurtainUpAnims.Intros.PropsIntro());}else{this.ui.showButtons();}
this.ui.showPanel(this.currentStep);break;case ig.STEPS.CHARACTERS:ig.LAYERS.SCENE.mouseEnabled=true;if(!this._seenIntros){this.playSectionIntro(new CurtainUpAnims.Intros.CharactersIntro());}else{this.ui.showButtons();}
this.ui.showPanel(this.currentStep);this.pickDrops.hide();break;case ig.STEPS.PICK_TITLE:ig.LAYERS.SCENE.mouseEnabled=false;this._seenIntros=true;this.pickDrops.bringIn(ig.STEPS.PICK_TITLE);this.ui.showButtons();this.ui.hidePanels();break;case ig.STEPS.PICK_MUSIC:ig.LAYERS.SCENE.mouseEnabled=false;this.pickDrops.bringIn(ig.STEPS.PICK_MUSIC);this.ui.showButtons();break;case ig.STEPS.PLAY:ig.LAYERS.SCENE.mouseEnabled=false;this.ui.showButtons();this.pickDrops.hide();cjs.Tween.get(this).wait(1000).call(this.curtains.close,null,this.curtains);this.blackScreen.alpha=0;cjs.Tween.get(this.blackScreen).set({visible:true}).wait(2000).to({alpha:1},1000).call(this.playFinishedScene,null,this);break;}},backStep:function(){this.currentStep--;switch(this.currentStep){case ig.STEPS.CHARACTERS:ig.LAYERS.SCENE.mouseEnabled=true;this.ui.showAll();this.pickDrops.hide();this.ui.showButtons();break;case ig.STEPS.PICK_TITLE:this.pickDrops.bringIn(ig.STEPS.PICK_TITLE);break;}},playSectionIntro:function(anim){this.currentAnim=anim;this.currentAnim.addEventListener("click",this.skipBtnHandler);this.currentAnim.onAnimationComplete=this.onSectionIntroComplete.bind(this);ig.LAYERS.BACK.addChild(this.currentAnim);},onSectionIntroComplete:function(){ig.LAYERS.BACK.removeChild(this.currentAnim);this.currentAnim.removeEventListener("click",this.skipBtnHandler);this.currentAnim=null;this.curtains.clear();this.ui.showButtons();},skipAnimation:function(e){if(!e||e.target.currentAnimation==="SkipBtn"){cjs.Sound.stop();this.onSectionIntroComplete();}},checkStepRequirements:function(){if(this.currentStep>=ig.STEPS.BACKGROUNDS&&this.scene.isDefaultBackdrop){return false;}
if(this.currentStep>=ig.STEPS.PROPS&&this.scene.props.length===0){return false;}
if(this.currentStep>=ig.STEPS.CHARACTERS&&this.scene.characters.length===0){return false;}
return true;},promptRequirements:function(){if(this.currentStep>=ig.STEPS.BACKGROUNDS&&this.scene.isDefaultBackdrop){this.prompts.prompt("backdrop");return;}
if(this.currentStep>=ig.STEPS.PROPS&&this.scene.props.length===0){this.prompts.prompt("props");return;}
if(this.currentStep>=ig.STEPS.CHARACTERS&&this.scene.characters.length===0){this.prompts.prompt("characters");return;}},playFinishedScene:function(){this.endScreen.container.visible=false;this.theater.container.visible=false;this.theater.setup();this.curtains.setForWatchPlay();cjs.Tween.get(this.blackScreen).to({alpha:0},1000).set({visible:false}).call(this.theater.animateIn,[this.playScene.bind(this)],this.theater);},playScene:function(){ig.log("playScene");ig.main.scene.play(this.onSceneEnd.bind(this));},onSceneEnd:function(){ig.log("onSceneEnd");this.theater.end(this.showEndScreen.bind(this));},showEndScreen:function(){ig.log("show end screen");this.endScreen.setUserData();cjs.Tween.get(this.blackScreen).set({visible:true}).to({alpha:1},1000);cjs.Tween.get(this.endScreen.container).wait(1000).set({visible:true});},animationCheck:function(){if(this.currentAnim){this.skipAnimation();}},update:function(){if(this.preloader&&ig.LAYERS.PRELOADER.visible){this.preloader.update();}
if(this.scene){this.scene.update();}},handleFileLoad:function(e){var item=e.item;var type=item.type;var result;console.log("Loaded: "+item.src);},});ig.deploy=function(){ig.main(ig.CurtainUp,30,960,600);};});