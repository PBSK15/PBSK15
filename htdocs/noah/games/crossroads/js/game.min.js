/*! Built with IMPACT - impactjs.com */

(function(window){"use strict";Math.map=function(x,istart,istop,ostart,ostop){return ostart+(ostop-ostart)*((x-istart)/(istop-istart));};Math.limit=function(x,min,max){return Math.min(max,Math.max(min,x));};Math.roundAt=function(x,precision){if(!precision)return Math.round(x);precision=Math.pow(10,precision||0);return Math.round(x*precision)/precision;};Math.toInt=function(x){return(x|0);};Math.toRad=function(x){return((x*Math.PI)/180);};Math.toDeg=function(x){return((x*180)/Math.PI);};Math.getRandomArbitrary=function(min,max){return Math.random()*(max-min)+min;};Math.range=function(min,max){return Math.floor(Math.random()*(max-min+1))+min;};Object.defineProperty(Array.prototype,'erase',{value:function(item){var i=this.indexOf(item);if(i>=0)this.splice(i,1);return this;}});Object.defineProperty(Array.prototype,'random',{value:function(){return this[0|(Math.random()*this.length)];}});Object.defineProperty(Array.prototype,'shuffle',{value:function(){var i=this.length,j,temp;if(i===0)return this;while(--i){j=Math.floor(Math.random()*(i+1));temp=this[i];this[i]=this[j];this[j]=temp;}
return this;}});Object.defineProperty(Array.prototype,'clone',{value:function(){return this.slice(0);}});Function.prototype.bind=Function.prototype.bind||function(object){var t=this;return function(){return t.apply(object,arguments);};};window.ig={main:null,debug:null,version:'1.23',global:window,modules:{},resources:[],ready:false,baked:false,nocache:'',ua:{},prefix:(window.ImpactPrefix||''),lib:'js/lib/',_current:null,_loadQueue:[],_waitForOnload:0,$:function(selector){return selector[0]=='#'?document.getElementById(selector.substr(1)):document.getElementsByTagName(selector);},$new:document.createElement.bind(document),copy:function(object){var c,i;if(!object||typeof(object)!='object'||object instanceof HTMLElement||object instanceof ig.Class){return object;}
else if(Array.isArray(object)){c=object.slice(0);for(i=0;i<c.length;i++){if(c[i]&&typeof(c[i])=='object'){c[i]=ig.copy(c[i]);}}
return c;}
else{c={};for(i in object){c[i]=ig.copy(object[i]);}
return c;}},merge:function(original,extended){for(var key in extended){var ext=extended[key];if(typeof(ext)!='object'||ext instanceof HTMLElement||ext instanceof ig.Class||ext===null){original[key]=ext;}
else{if(!original[key]||typeof(original[key])!='object'){original[key]=(ext instanceof Array)?[]:{};}
ig.merge(original[key],ext);}}
return original;},ksort:function(obj){if(!obj||typeof(obj)!='object'){return[];}
var keys=[],values=[];for(var k in obj){keys.push(k);}
keys.sort();for(var i=0;i<keys.length;i++){values.push(obj[keys[i]]);}
return values;},setVendorAttribute:function(el,attr,val){var uc=attr[0].toUpperCase()+attr.substr(1);el[attr]=val||el['ms'+uc]||el['moz'+uc]||el['webkit'+uc]||el['o'+uc];},getVendorAttribute:function(el,attr){var uc=attr[0].toUpperCase()+attr.substr(1);return el[attr]||el['ms'+uc]||el['moz'+uc]||el['webkit'+uc]||el['o'+uc];},normalizeVendorAttribute:function(el,attr){var prefixedVal=ig.getVendorAttribute(el,attr);if(!el[attr]&&prefixedVal){el[attr]=prefixedVal;}},module:function(name){if(ig._current){throw("Module '"+ig._current.name+"' defines nothing");}
if(ig.modules[name]&&ig.modules[name].body){throw("Module '"+name+"' is already defined");}
ig._current={name:name,requires:[],loaded:false,body:null};ig.modules[name]=ig._current;ig._loadQueue.push(ig._current);return ig;},requires:function(){ig._current.requires=Array.prototype.slice.call(arguments);return ig;},external:function(){var externalRequires=Array.prototype.slice.call(arguments);for(var i=0;i<externalRequires.length;i++){if(!ig.modules[name])ig._loadScript(externalRequires[i]);}
return ig;},defines:function(body){ig._current.body=body;ig._current=null;ig._initDOMReady();},addResource:function(resource){ig.resources.push(resource);},setNocache:function(set){ig.nocache=set?'?'+Date.now():'';},log:function(msg){if(this.debug&&window.console&&console.log){console.log(msg);}},assert:function(condition,msg){},show:function(name,number){},mark:function(msg,color){},_loadScript:function(name,requiredFrom){ig.modules[name]={name:name,requires:[],loaded:false,body:null};ig._waitForOnload++;var path=ig.prefix+ig.lib+name.replace(/\./g,'/')+'.js'+ig.nocache;var script=ig.$new('script');script.type='text/javascript';script.onload=function(){ig._waitForOnload--;ig._execModules();};script.onerror=function(){throw('Failed to load module '+name+' at '+path+' '+'required from '+requiredFrom);};script.src=path;ig.$('head')[0].appendChild(script);},_execModules:function(){var i,j,m,modulesLoaded=false;for(i=0;i<ig._loadQueue.length;i++){m=ig._loadQueue[i];var dependenciesLoaded=true;for(j=0;j<m.requires.length;j++){var name=m.requires[j];if(!ig.modules[name]){dependenciesLoaded=false;ig._loadScript(name,m.name);}
else if(!ig.modules[name].loaded){dependenciesLoaded=false;}}
if(dependenciesLoaded&&m.body){ig._loadQueue.splice(i,1);m.loaded=true;m.body();modulesLoaded=true;i--;}}
if(modulesLoaded){ig._execModules();}
else if(!ig.baked&&ig._waitForOnload===0&&ig._loadQueue.length!==0){var unresolved=[];for(i=0;i<ig._loadQueue.length;i++){var unloaded=[];var requires=ig._loadQueue[i].requires;for(j=0;j<requires.length;j++){m=ig.modules[requires[j]];if(!m||!m.loaded){unloaded.push(requires[j]);}}
unresolved.push(ig._loadQueue[i].name+' (requires: '+unloaded.join(', ')+')');}
throw('Unresolved (circular?) dependencies. '+"Most likely there's a name/path mismatch for one of the listed modules:\n"+
unresolved.join('\n'));}},_DOMReady:function(){if(!ig.modules['dom.ready'].loaded){if(!document.body){return setTimeout(ig._DOMReady,13);}
ig.modules['dom.ready'].loaded=true;ig._waitForOnload--;ig._execModules();}
return 0;},_boot:function(){if(document.location.href.match(/\?nocache/)){ig.setNocache(true);}
ig.ua.pixelRatio=window.devicePixelRatio||1;ig.ua.viewport={width:window.innerWidth,height:window.innerHeight};ig.ua.screen={width:window.screen.availWidth*ig.ua.pixelRatio,height:window.screen.availHeight*ig.ua.pixelRatio};ig.ua.small=!(window.innerWidth>=768&&window.innerHeight>=768);ig.ua.iPhone=/iPhone/i.test(navigator.userAgent);ig.ua.iPod=/iPod/i.test(navigator.userAgent);ig.ua.iPad=/iPad/i.test(navigator.userAgent);ig.ua.android=/android/i.test(navigator.userAgent);ig.ua.kindle=/Silk/i.test(navigator.userAgent);ig.ua.iOS=ig.ua.iPhone||ig.ua.iPad||ig.ua.iPod;ig.ua.mobile=ig.ua.iOS||ig.ua.android||ig.ua.winPhone||ig.ua.kindle||/mobile/i.test(navigator.userAgent);ig.ua.touchDevice=(('ontouchstart'in window)||(window.navigator.msMaxTouchPoints));ig.ua.IE=false;if(navigator.appName=='Microsoft Internet Explorer'){var ua=navigator.userAgent;var re=new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");if(re.exec(ua)!==null){ig.ua.IE=true;}}},_initDOMReady:function(){if(ig.modules['dom.ready']){ig._execModules();return;}
ig._boot();ig.modules['dom.ready']={requires:[],loaded:false,body:null};ig._waitForOnload++;document.addEventListener('DOMContentLoaded',ig._DOMReady,false);window.addEventListener('load',ig._DOMReady,false);}};var initializing=false,fnTest=/xyz/.test(function(){xyz;})?/\bparent\b/:/.*/;window.ig.Class=function(){};var inject=function(prop){var proto=this.prototype;var parent={};for(var name in prop){if(typeof(prop[name])=="function"&&typeof(proto[name])=="function"&&fnTest.test(prop[name])){parent[name]=proto[name];proto[name]=(function(name,fn){return function(){this.parent=parent[name];return fn.apply(this,arguments);};})(name,prop[name]);}
else{proto[name]=prop[name];}}};window.ig.Class.extend=function(prop){var parent=this.prototype;initializing=true;var prototype=new this();initializing=false;for(var name in prop){if(typeof(prop[name])=="function"&&typeof(parent[name])=="function"&&fnTest.test(prop[name])){prototype[name]=(function(name,fn){return function(){this.parent=parent[name];return fn.apply(this,arguments);};})(name,prop[name]);}
else{prototype[name]=prop[name];}}
function Class(){if(!initializing){if(this.staticInstantiate){var obj=this.staticInstantiate.apply(this,arguments);if(obj){return obj;}}
for(var p in this){if(typeof(this[p])=='object'){this[p]=ig.copy(this[p]);}}
if(this.init){this.init.apply(this,arguments);}}
return this;}
Class.prototype=prototype;Class.prototype.constructor=Class;Class.extend=window.ig.Class.extend;Class.inject=inject;return Class;};})(window);

// lib/impact/system.js
ig.baked=true;ig.module('impact.system').defines(function(){"use strict";ig.System=ig.Class.extend({containerDiv:null,minSupportedWidth:1024,maxSupportedWidth:1426,width:1024,height:500,tick:0,delegate:null,stages:[],_last:{w:0,h:0},init:function(width,height,containerDiv){this.width=width;this.height=height;if(!window.cjs){throw("CreateJS is not included");}
this.containerDiv=containerDiv;this.resize();cjs.Ticker.timingMode=createjs.Ticker.RAF;cjs.Ticker.addEventListener("tick",this.run.bind(this));},addStage:function(stage){stage.canvas.width=this.width;stage.canvas.height=this.height;if(stage.isWebGL)
stage.updateViewport(this.width,this.height);this.stages.push(stage);return stage;},setGame:function(GameClass){ig.main=new(GameClass)();this.delegate=ig.main;},resize:function(){var wWidth=window.innerWidth;var wHeight=window.innerHeight;var wrapper=this.containerDiv;wrapper.style.maxWidth="";wrapper.style.maxHeight="";wrapper.style.margin="";wrapper.style.marginTop="";var maxWidth=wWidth;var maxHeight=wHeight;var hScale=(wHeight/this.height);if(wWidth>this.maxSupportedWidth*hScale){this.width=this.maxSupportedWidth;}else if(wWidth<this.minSupportedWidth*hScale){this.width=this.minSupportedWidth;}else{this.width=Math.floor(wWidth/hScale);}
if(wWidth>this.width*(wHeight/this.height)){maxWidth=Math.floor((wHeight/this.height)*this.width);wrapper.style.maxWidth=maxWidth+"px";wrapper.style.margin="0 auto";}else{maxHeight=Math.floor((wWidth/this.width)*this.height);wrapper.style.maxHeight=maxHeight+"px";wrapper.style.marginTop=(wHeight-maxHeight)/2+"px";}
this.containerDiv.style.width=maxWidth+"px";this.containerDiv.style.height=maxHeight+"px";var stages=this.stages;var numStages=stages.length;if(numStages){for(var i=0;i<numStages;i++){var s=stages[i];if(s.canvas){s.canvas.width=this.width;s.canvas.height=this.height;if(s.isWebGL)
s.updateViewport(this.width,this.height);s.update();}}}},run:function(event){this.tick=event.delta/1000;if(this.tick>3){return;}
if(this.delegate){this.delegate.update(event);ig.input.clearPressed();}
var stages=this.stages;var numStages=stages.length;for(var i=0;i<numStages;i++){var s=stages[i];if(!s.stopUpdate){s.update(event);}}
if(this._last.w!==window.innerWidth||this._last.h!==window.innerHeight){this.resize(window.innerWidth,window.innerHeight);this._last.w=window.innerWidth;this._last.h=window.innerHeight;}}});});

// lib/impact/input.js
ig.baked=true;ig.module('impact.input').defines(function(){"use strict";ig.KEY={'MOUSE1':-1,'MOUSE2':-3,'MWHEEL_UP':-4,'MWHEEL_DOWN':-5,'BACKSPACE':8,'TAB':9,'ENTER':13,'PAUSE':19,'CAPS':20,'ESC':27,'SPACE':32,'PAGE_UP':33,'PAGE_DOWN':34,'END':35,'HOME':36,'LEFT_ARROW':37,'UP_ARROW':38,'RIGHT_ARROW':39,'DOWN_ARROW':40,'INSERT':45,'DELETE':46,'_0':48,'_1':49,'_2':50,'_3':51,'_4':52,'_5':53,'_6':54,'_7':55,'_8':56,'_9':57,'A':65,'B':66,'C':67,'D':68,'E':69,'F':70,'G':71,'H':72,'I':73,'J':74,'K':75,'L':76,'M':77,'N':78,'O':79,'P':80,'Q':81,'R':82,'S':83,'T':84,'U':85,'V':86,'W':87,'X':88,'Y':89,'Z':90,'NUMPAD_0':96,'NUMPAD_1':97,'NUMPAD_2':98,'NUMPAD_3':99,'NUMPAD_4':100,'NUMPAD_5':101,'NUMPAD_6':102,'NUMPAD_7':103,'NUMPAD_8':104,'NUMPAD_9':105,'MULTIPLY':106,'ADD':107,'SUBSTRACT':109,'DECIMAL':110,'DIVIDE':111,'F1':112,'F2':113,'F3':114,'F4':115,'F5':116,'F6':117,'F7':118,'F8':119,'F9':120,'F10':121,'F11':122,'F12':123,'SHIFT':16,'CTRL':17,'ALT':18,'PLUS':187,'COMMA':188,'MINUS':189,'PERIOD':190};ig.Input=ig.Class.extend({bindings:{},actions:{},presses:{},locks:{},delayedKeyup:{},isUsingMouse:false,isUsingKeyboard:false,mouse:{x:0,y:0},accel:{x:0,y:0,z:0},numTouches:0,initMouse:function(stage){if(this.isUsingMouse){return;}
this.isUsingMouse=true;stage.on("stagemousedown",this.keydown.bind(this));stage.on("stagemouseup",this.keyup.bind(this));stage.on("stagemousemove",this.mousemove.bind(this));},initKeyboard:function(){if(this.isUsingKeyboard){return;}
this.isUsingKeyboard=true;window.addEventListener('keydown',this.keydown.bind(this),false);window.addEventListener('keyup',this.keyup.bind(this),false);},mousemove:function(event){if(!event.primary){return;}
this.mouse.x=event.stageX;this.mouse.y=event.stageY;},keydown:function(event){var nativeEvent=event.nativeEvent||event;var tag=nativeEvent.target.tagName;if(tag=='INPUT'||tag=='TEXTAREA'){return;}
var code=nativeEvent.type=='keydown'?nativeEvent.keyCode:(nativeEvent.button==2?ig.KEY.MOUSE2:ig.KEY.MOUSE1);if(event.type=='stagemousedown'){if(nativeEvent.touches){this.numTouches=nativeEvent.touches.length;}
if(event.primary)
this.mousemove(event);else
return;}
var action=this.bindings[code];if(action){this.actions[action]=true;if(!this.locks[action]){this.presses[action]=true;this.locks[action]=true;}
if(code!==ig.KEY.MOUSE1&&code!==ig.KEY.MOUSE2){event.stopPropagation();event.preventDefault();}}},keyup:function(event){var nativeEvent=event.nativeEvent||event;var tag=nativeEvent.target.tagName;if(tag=='INPUT'||tag=='TEXTAREA'){return;}
var code=nativeEvent.type=='keyup'?nativeEvent.keyCode:(nativeEvent.button==2?ig.KEY.MOUSE2:ig.KEY.MOUSE1);if(nativeEvent.touches){this.numTouches=nativeEvent.touches.length;if(!event.primary){return;}}
var action=this.bindings[code];if(action){this.delayedKeyup[action]=true;if(code!==ig.KEY.MOUSE1&&code!==ig.KEY.MOUSE2){event.stopPropagation();event.preventDefault();}}},bind:function(key,action){if(key<0){this.initMouse();}
else if(key>0){this.initKeyboard();}
this.bindings[key]=action;},unbind:function(key){var action=this.bindings[key];this.delayedKeyup[action]=true;this.bindings[key]=null;},unbindAll:function(){this.bindings={};this.actions={};this.presses={};this.locks={};this.delayedKeyup={};},state:function(action){return this.actions[action];},pressed:function(action){return this.presses[action];},released:function(action){return!!this.delayedKeyup[action];},clearPressed:function(){for(var action in this.delayedKeyup){this.actions[action]=false;this.locks[action]=false;}
this.delayedKeyup={};this.presses={};}});});

// lib/impact/impact.js
ig.baked=true;ig.module('impact.impact').requires('dom.ready','impact.system','impact.input').defines(function(){"use strict";ig.ready=true;ig.init=function(gameClass,width,height,containerDiv){ig.system=new ig.System(width,height,containerDiv);ig.input=new ig.Input();ig.system.setGame(gameClass);};});

// lib/game/textbox-builder.js
ig.baked=true;ig.module('game.textbox-builder').defines(function(){ig.TextBoxBuilder=ig.Class.extend({H_PADDING:40,V_PADDING:32,_pool:[],_alerts:[],_boxes:[],_specific:{},init:function(){if(ig.TextBoxes!==null){console.error("You do not instantiate this class!");return;}
ig.TextBoxes=this;},build:function(){this.makeBlankBubble();this.makeNewInfoBox();},get:function(string){if(string==="!"){return this.getAlertBubble();}
if(this._pool.length===0){ig.log("Add Another Bubble");this.makeBlankBubble();}
var bubble=this._pool.shift();bubble.side="NA";var box=bubble.getChildByName("box");var shape=box.getChildAt(0);var bmpText=box.getChildAt(1);var data=this.parseBubbleStr(string);bmpText.updateBits(data.strings,data.fonts);var textBounds=bmpText.getBounds();var bw=textBounds.width+this.H_PADDING*2;var bh=textBounds.height+this.V_PADDING*2-6;shape.graphics.c().f("#fff").rr(0,0,bw,bh,30);box.cache(0,0,bw,bh);box.regX=bw-6;box.regY=bh+34;return bubble;},put:function(bubble){if(bubble.alert){this._alerts.push(bubble);}else{this._pool.push(bubble);}},parseBubbleStr:function(bubbleString){var strings=[];var fonts=[];var parts=bubbleString.split("|");var lineLength=0;var i=0,ii=0,nn=0,n=parts.length;for(i=0;i<n;i++){var part=parts[i].split("::");fonts.push(this._getFont(part[0]));var str=part[1];if(i===0||str.charAt(0)==="¿"){str=this._checkCase(str);}
var words=str.split(" ");nn=words.length;str="";for(ii=0;ii<nn;ii++){var word=words[ii];if(lineLength+word.length>29){lineLength=word.length;str+="\n"+word;}else{str+=word;lineLength+=word.length+1;}
if(ii<nn-1){str+=" ";}}
strings.push(str);}
return{strings:strings,fonts:fonts};},makeBlankBubble:function(){var bubble=new cjs.Container();bubble.side="R";var tail=new cjs.Sprite(ig.Sheets.lib.ui,"SpeechBubbleTail").set({regY:40});var box=new cjs.Container();box.name="box";var roundRect=new cjs.Shape();roundRect.graphics.f("#fff").rr(0,0,100,100,30);box.addChild(roundRect);var bmpText=new cjs.BitmapTextExtended([],[]);bmpText.name="bmpText";if(ig.LowRes){bmpText.x=this.H_PADDING-4;bmpText.y=this.V_PADDING-3;bmpText.letterSpacing=2;}else{bmpText.x=this.H_PADDING;bmpText.y=this.V_PADDING;bmpText.letterSpacing=-1;}
bmpText.lineHeight=33;box.addChild(bmpText);box.regX=6;box.regY=136;bubble.addChild(tail);bubble.addChild(box);box.cache(0,0,100,100);this._pool.push(bubble);},_getFont:function(code){switch(code){case"MO":return ig.Sheets.lib.MAIDEN_ORANGE;case"BS":return ig.Sheets.lib.BODEGA_SANS;}},_checkCase:function(str){if(str.charAt(0)==="¿"){return"¿"+str.charAt(1).toUpperCase()+str.slice(2);}else{return str.charAt(0).toUpperCase()+str.slice(1);}},getInfoBox:function(id,withXbtn){var data=ig.config.infoboxes[id];if(this._boxes.length===0){this.makeNewInfoBox();}
var box=this._boxes.shift();var cachedShapes=box.getChildAt(0);var xBtn=box.getChildAt(1);cachedShapes.removeAllChildren();var sprite=false;if(data.sprite){sprite=new cjs.Sprite(ig.Sheets.lib[data.spritesheet],data.sprite);sprite.x=data.gx;sprite.y=data.gy;}
var bmpText=new cjs.BitmapText(data.string,ig.Sheets.lib.MAIDEN_ORANGE).set({letterSpacing:ig.LowRes?2:-1,lineHeight:34,x:data.tx,y:data.ty});var b=bmpText.getBounds();var bw=bmpText.x+b.width+30;var bh=bmpText.y+b.height+30;if(bh<data.minHeight)
bh=data.minHeight;var poly=new cjs.Shape();var shd=new cjs.Shape().set({x:-4,y:4,alpha:0.15});if(data.tailOnTop){poly.graphics.f("#fff").mt(0,0).lt(data.tail[0],0).lt(data.tail[1],-data.tailHeight).lt(data.tail[2],0).lt(bw,0).lt(bw,bh).lt(0,bh).cp();shd.graphics.f("000").mt(0,0).lt(data.tail[0],0).lt(data.tail[1],-data.tailHeight).lt(data.tail[2],0).lt(bw,0).lt(bw,bh).lt(0,bh).cp();}else{poly.graphics.f("#fff").mt(0,0).lt(0,bh).lt(data.tail[0],bh).lt(data.tail[1],bh+data.tailHeight).lt(data.tail[2],bh).lt(bw,bh).lt(bw,0).cp();shd.graphics.f("000").mt(0,0).lt(0,bh).lt(data.tail[0],bh).lt(data.tail[1],bh+data.tailHeight).lt(data.tail[2],bh).lt(bw,bh).lt(bw,0).cp();}
cachedShapes.addChild(shd,poly,bmpText);if(sprite){cachedShapes.addChild(sprite);}
if(data.tailOnTop){cachedShapes.regX=data.tail[1];cachedShapes.regY=-data.tailHeight;cachedShapes.cache(-4,-data.tailHeight,bw,data.tailHeight+bh+4);xBtn.x=-cachedShapes.regX+bw;xBtn.y=data.tailHeight;}else{cachedShapes.regX=data.tail[1];cachedShapes.regY=bh+data.tailHeight;if(sprite&&(sprite.x<-4||sprite.y<0)){cachedShapes.cache(sprite.x,sprite.y,bw+Math.abs(sprite.x),cachedShapes.regY+4+Math.abs(sprite.y));}else{cachedShapes.cache(-4,0,bw,cachedShapes.regY+4);}
xBtn.x=-cachedShapes.regX+bw;xBtn.y=-cachedShapes.regY;}
xBtn.visible=!!withXbtn;return box;},putInfoBox:function(box){this._boxes.push(box);},makeNewInfoBox:function(){var box=new cjs.Container();var cachedShapes=new cjs.Container().set({mouseChildren:false,mouseEnabled:false});var xBtn=new cjs.Sprite(ig.Sheets.lib.btns,"xBtn").set({regX:43,regY:39,cursor:"pointer"});if(ig.ua.mobile){xBtn.on("mousedown",this.xBtnHandler,this);xBtn.on("pressup",this.xBtnHandler,this);}else{xBtn.on("mouseover",this.xBtnHandler,this);xBtn.on("mouseout",this.xBtnHandler,this);}
box.addChild(cachedShapes,xBtn);this._boxes.push(box);},xBtnHandler:function(e){var btn=e.target;if(!btn)return;var ease=cjs.Ease.backOut;switch(e.type){case"mouseover":cjs.Sound.play("sfxrollover");cjs.Tween.get(btn,{override:true}).to({scaleX:1.05,scaleY:1.05},200,ease);break;case"mouseout":cjs.Tween.get(btn,{override:true}).to({scaleX:1,scaleY:1},200,ease);break;case"mousedown":btn.scaleX=btn.scaleY=0.9;break;case"pressup":btn.scaleX=btn.scaleY=1;break;}},getAlertBubble:function(){if(this._alerts.length){return this._alerts.pop();}
var bubble=new cjs.Container();bubble.alert=true;bubble.side="R";var tail=new cjs.Sprite(ig.Sheets.lib.ui,"SpeechBubbleTail").set({regY:40});var box=new cjs.Container();box.name="box";var roundRect=new cjs.Shape();roundRect.graphics.f("#fff").rr(0,0,82,106,30);box.addChild(roundRect);var exclam=new cjs.Sprite(ig.Sheets.lib.ui,"alerticon").set({x:36,y:27});box.addChild(exclam);box.regX=6;box.regY=136;bubble.addChild(tail);bubble.addChild(box);box.cache(0,0,82,106);return bubble;}});ig.TextBoxes=null;new ig.TextBoxBuilder();});

// lib/impact/main.js
ig.baked=true;ig.module('impact.main').requires('impact.impact').defines(function(){"use strict";ig.Main=ig.Class.extend({staticInstantiate:function(){ig.main=this;return null;},update:function(event){}});});

// lib/display/preloader.js
ig.baked=true;ig.module('display.preloader').requires('impact.main').defines(function(){ig.Preloader=ig.Class.extend({queue:null,noah:null,edges:null,background:null,shown:false,_mask:null,init:function(){},build:function(queue){var layer=ig.LAYERS.PRELOADER;layer.set({mouseChildren:false,mouseEnabled:false});this._mask=new cjs.Shape(new cjs.Graphics().dc(0,0,900)).set({y:384,scaleX:0,scaleY:0});layer.mask=this._mask;var q=queue;this.background=new cjs.Shape().set({regX:712,regY:384});this.background.graphics.f("#ffffd2").r(0,0,1424,768);layer.addChild(this.background);layer.addChild(new cjs.Bitmap(q.getResult("ldrEdge")).set({y:-384,regX:712,regY:66,scaleX:-1,scaleY:-1}));layer.addChild(new cjs.Bitmap(q.getResult("ldrEdge")).set({y:384,regX:712,regY:66}));layer.addChild(new cjs.Bitmap(q.getResult("ldrText")).set({y:83,regX:57}));layer.addChild(new cjs.Sprite(ig.Sheets.lib.Loading,"Loading").set({regX:84,regY:180}));},show:function(){this.shown=true;cjs.Tween.get(this._mask).set({visible:true,tickEnabled:true},ig.LAYERS.PRELOADER).to({scaleX:1,scaleY:1},500,cjs.Ease.cubicOut);},hide:function(){this.shown=false;cjs.Tween.get(this._mask).to({scaleX:0,scaleY:0},500,cjs.Ease.cubicIn).set({visible:false,tickEnabled:false},ig.LAYERS.PRELOADER);},update:function(){if(!this.shown)
return;this._mask.x=ig.system.width*0.5;}});});

// lib/controllers/sheets.js
ig.baked=true;ig.module('controllers.sheets').defines(function(){ig.SheetsController=ig.Class.extend({lib:{},init:function(){if(ig.Sheets!==null){console.error("You do not instantiate this class!");return;}
ig.Sheets=this;},add:function(name,image,data){data.images=[image];this.lib[name]=new createjs.SpriteSheet(data);},destroy:function(name){var lib=this.lib;if(lib[name]){ig.log("Destroying Sheet: "+name);lib[name]=null;delete lib[name];}},addExtraPadding:function(data,padding){var frames=data.frames;for(var i=0;i<frames.length;i++){var frame=frames[i];frame[0]-=padding;frame[1]-=padding;frame[2]+=padding*2;frame[3]+=padding*2;}},memory:function(){function nextPow(x){return Math.pow(2,Math.ceil(Math.log(x)/Math.log(2)));}
var totalBits=0;var totalMaxBits=0;var totalSheets=0;console.log("/////////////////////////////////////////");console.log("Calculating ig.Sheets Memory Footprint!!!");for(var key in this.lib){var ss=this.lib[key];if(!ss)continue;var img=ss._images[0];var bits=img.width*img.height*32;var maxBits=nextPow(img.width)*nextPow(img.height)*32;totalBits+=bits;totalMaxBits+=maxBits;totalSheets++;console.log(key+": "+(Math.round((bits/8/1024/1024)*100)/100)+"MB"+" : "+(Math.round((maxBits/8/1024/1024)*100)/100)+"MB");}
console.log("Total Num of Sheets: "+totalSheets);console.log("Total Estimate of Memory from Sheets: "+(Math.round((totalBits/8/1024/1024)*100)/100)+"MB");console.log("Total Max of Memory from Sheets: "+(Math.round((totalMaxBits/8/1024/1024)*100)/100)+"MB");console.log("/////////////////////////////////////////");}});ig.Sheets=null;new ig.SheetsController();});

// lib/display/view.js
ig.baked=true;ig.module('display.view').defines(function(){ig.View=ig.Class.extend({init:function(){},reset:function(){},start:function(){this.setActive(true);},update:function(){},animateIn:function(){},animateOut:function(){},setActive:function(active){},kill:function(){this.setActive(false);}});});

// lib/game/views/pretitle.js
ig.baked=true;ig.module('game.views.pretitle').requires('display.view').defines(function(){ig.View.PreTitle=ig.View.extend({container:null,init:function(){this.container=new cjs.Container().set({name:"title",mouseChildren:false});this.container.addChild(new cjs.Bitmap(ig.Assets.TitleBG).set({regX:713,regY:384}));}});});

// lib/game/views/title.js
ig.baked=true;ig.module('game.views.title').requires('display.view').defines(function(){ig.View.Title=ig.View.extend({container:null,playBtn:null,title:null,logo:null,noah:null,coco:null,init:function(){this.container=new cjs.Container().set({name:"title"});var sheet=ig.Sheets.lib.Title;this.playBtn=new cjs.Sprite(sheet,"PlayBtn").set({y:206,regX:85,regY:86,cursor:"pointer"});this.title=new cjs.Sprite(sheet,"Title").set({mouseEnabled:false,regX:395,regY:94,x:0,y:-26});this.logo=new cjs.Sprite(sheet,"Logo").set({mouseEnabled:false,regX:130,regY:59,x:0,y:-203});this.noah=new cjs.Sprite(sheet,"Noah").set({mouseEnabled:false,x:-335,y:36});this.coco=new cjs.Sprite(sheet,"Coco").set({mouseEnabled:false,x:92,y:86});this.container.addChild(new cjs.Bitmap(ig.Assets.TitleBG).set({regX:713,regY:384}),this.playBtn,this.logo,this.title,this.noah,this.coco);},reset:function(){this.playBtn.scaleX=this.playBtn.scaleY=0;this.logo.y=-498;this.title.scaleX=this.title.scaleY=0;this.title.rotation=50;this.noah.x=-900;this.coco.x=900;},animateIn:function(){cjs.Tween.get(this.noah).to({x:-335},500,cjs.Ease.cubicOut);cjs.Tween.get(this.coco).to({x:92},500,cjs.Ease.cubicOut);cjs.Tween.get(this.title).wait(300).to({scaleX:1,scaleY:1,rotation:0},800,cjs.Ease.backOut);cjs.Tween.get(this.logo).wait(500).to({y:-203},200,cjs.Ease.cubicOut);cjs.Tween.get(this.playBtn).wait(500).to({scaleX:1,scaleY:1,alpha:1},800,cjs.Ease.backOut);return 1300;},start:function(){this.setActive(true);},setActive:function(active){if(active){this.container.on("click",this.onContainerClick,this);if(ig.ua.mobile){this.playBtn.on("mousedown",this.btnHandler,this);this.playBtn.on("pressup",this.btnHandler,this);}else{this.playBtn.on("mouseover",this.btnHandler,this);this.playBtn.on("mouseout",this.btnHandler,this);}}else{this.container.removeAllEventListeners();this.playBtn.removeAllEventListeners();}},onContainerClick:function(){this.setActive(false);if(cjs.WebAudioPlugin.isSupported()){cjs.WebAudioPlugin.playEmptySound();}
ig.main.playClicked();},btnHandler:function(e){var btn=this.playBtn;switch(e.type){case"mouseover":cjs.Sound.play("sfxrollover");cjs.Tween.get(btn,{override:true}).to({scaleX:1.1,scaleY:1.1},250,cjs.Ease.backOut);break;case"mouseout":cjs.Tween.get(btn,{override:true}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);break;case"mousedown":btn.scaleX=btn.scaleY=0.9;break;case"pressup":btn.scaleX=btn.scaleY=1;break;}},kill:function(){this.parent();}});});

// lib/display/overlay.js
ig.baked=true;ig.module('display.overlay').defines(function(){ig.Overlay=ig.Class.extend({init:function(){},start:function(){this.setActive(true);},update:function(){},setActive:function(active){},kill:function(){}});});

// lib/display/overlays/crossroads-results.js
ig.baked=true;ig.module('display.overlays.crossroads-results').requires('display.overlay').defines(function(){ig.Overlay.CrossroadsResults=ig.Overlay.extend({container:null,roundIndex:-1,init:function(){this.build();},build:function(){this.container=new cjs.Container();this.paper=new cjs.Container();this.movesTextbox=new cjs.BitmapText("0",ig.Sheets.lib.CROSSROADS_FONT).set({x:-114,y:34});ig.CenterReg(this.movesTextbox);this.timeTextbox=new cjs.BitmapText("0:00",ig.Sheets.lib.CROSSROADS_FONT).set({x:106,y:34});ig.CenterReg(this.timeTextbox);var questSheet=ig.Session.activeQuest===ig.QUESTS.POOL?ig.Sheets.lib.Pool:ig.Sheets.lib.Picnic;this.questObject=new cjs.Sprite(questSheet,ig.Session.activeObject.id+"-lg").set({x:195,y:-132});this.roundNumber=new cjs.Sprite(ig.Sheets.lib.crossroads,"n1").set({x:-314,y:-262});this.paper.addChild(new cjs.Bitmap(ig.Assets.CrossroadsEnd).set({regX:497,regY:347}),this.movesTextbox,this.timeTextbox,this.questObject,this.roundNumber);var b=this.paper.getBounds();this.paper.cache(b.x,b.y,b.width,b.height);this.replayBtn=new cjs.Sprite(ig.Sheets.lib.btns,"ReplayBtn").set({x:-131,y:224,regX:130,regY:47,cursor:"pointer",name:"replay"});this.continueBtn=this.replayBtn.clone().set({x:143,name:"continue"});this.continueBtn.gotoAndStop("ContinueBtn");this.resultsBtns=new cjs.Container();this.resultsBtns.addChild(this.continueBtn,this.replayBtn);this.noah=new cjs.Sprite(ig.Sheets.lib.crossroads,"BigNoah").set({y:Math.ceil(ig.system.height*0.5-436)});this.coco=new cjs.Sprite(ig.Sheets.lib.crossroads,"BigCoco").set({y:Math.ceil(ig.system.height*0.5-307)});this.container.addChild(this.paper,this.noah,this.coco,this.resultsBtns);this.container.visible=this.container.tickEnabled=false;ig.LAYERS.OVERLAYS.addChild(this.container);},updateOverlay:function(moves,time){var nn=(ig.Session.roundIndex+1).toString();this.roundNumber.gotoAndStop("n"+nn);this.movesTextbox.text=moves.toString();this.timeTextbox.text=this.getTimeString(time);this.questObject.gotoAndStop(ig.Session.activeObject.id+"-lg");this.paper.updateCache();if(ig.Session.roundIndex>=4){this.continueBtn.gotoAndStop("NewGameBtn");}else{this.continueBtn.gotoAndStop("ContinueBtn");}},show:function(){ig.LAYERS.OVERLAYS.tickChildren=ig.LAYERS.OVERLAYS.visible=true;this.container.visible=this.container.tickEnabled=true;this.resultsBtns.y=this.paper.y=ig.system.height;this.noah.x=-ig.system.width;this.coco.x=ig.system.width;cjs.Tween.get(this.noah).to({x:-504},800,cjs.Ease.cubicInOut);cjs.Tween.get(this.coco).to({x:275},800,cjs.Ease.cubicInOut);cjs.Tween.get(this.paper).to({y:0},600,cjs.Ease.cubicInOut);cjs.Tween.get(this.resultsBtns).to({y:0},600,cjs.Ease.cubicInOut).call(this.setListeners,[true],this).call(this.checkForLevelCompleteEvent,null,this);cjs.Tween.get(ig.LAYERS.OVERLAY_DIM).set({visible:true}).to({alpha:0.6},600,cjs.Ease.quadInOut);},hide:function(quick){this.setListeners(false);var m=quick?0:1;cjs.Tween.get(this.paper).to({y:ig.system.height},600*m,cjs.Ease.cubicIn);cjs.Tween.get(this.resultsBtns).to({y:ig.system.height},600*m,cjs.Ease.cubicIn);cjs.Tween.get(this.noah).to({x:-ig.system.width},500*m,cjs.Ease.cubicIn);cjs.Tween.get(this.coco).to({x:ig.system.width},500*m,cjs.Ease.cubicIn);cjs.Tween.get(ig.LAYERS.OVERLAY_DIM).to({alpha:0},700*m,cjs.Ease.quadInOut).set({visible:false}).set({visible:false,tickChildren:false},ig.LAYERS.OVERLAYS);},checkForLevelCompleteEvent:function(){if(this.roundIndex!==ig.Session.roundIndex){this.roundIndex=ig.Session.roundIndex;}},btnHandler:function(e){var btn=e.target;if(!btn)return;var ease=cjs.Ease.backOut;switch(e.type){case"click":cjs.Sound.play("sfxclick");this.handleClick(btn);break;case"mouseover":cjs.Sound.play("sfxrollover");if(btn.label)btn.label.gotoAndStop("MapLabelOver");cjs.Tween.get(btn,{override:true}).to({scaleX:1.05,scaleY:1.05},200,ease);break;case"mouseout":if(btn.label)btn.label.gotoAndStop("MapLabel");cjs.Tween.get(btn,{override:true}).to({scaleX:1,scaleY:1},200,ease);break;case"mousedown":btn.scaleX=btn.scaleY=0.9;break;case"pressup":btn.scaleX=btn.scaleY=1;break;}},handleClick:function(btn){var btnName=btn.name;switch(btnName){case"continue":var delay=ig.ViewControl.fadeInBlack();if(btn.currentAnimation==="ContinueBtn"){cjs.Tween.get(this).wait(delay).call(this.handleNextRound,null,this);}
else{cjs.Tween.get(this).wait(delay).call(this.handleNewGame,null,this);}
break;case"replay":ig.ViewControl.current.tryAgain();this.hide();break;}},handleNextRound:function(){ig.ViewControl.current.nextRound();this.hide(true);ig.ViewControl.fadeOutBlack();},handleNewGame:function(){ig.Session.newData();this.hide(true);ig.ViewControl.gotoView(ig.VIEWS.CROSSROADS);ig.ViewControl.fadeOutBlack();},setListeners:function(active){if(active){this.resultsBtns.on("click",this.btnHandler,this);if(ig.ua.mobile){this.resultsBtns.on("mousedown",this.btnHandler,this);this.resultsBtns.on("pressup",this.btnHandler,this);}else{this.resultsBtns.on("mouseover",this.btnHandler,this);this.resultsBtns.on("mouseout",this.btnHandler,this);}}else{this.resultsBtns.removeAllEventListeners();}},getTimeString:function(seconds){var minutes=Math.floor(seconds/60);var leftovers=Math.floor(seconds%60);leftovers=leftovers.toString();leftovers=leftovers.length>1?leftovers:"0"+leftovers;return minutes+":"+leftovers;},kill:function(){ig.LAYERS.OVERLAYS.removeChild(this.container);}});});

// lib/display/overlays/crossroads-gameover.js
ig.baked=true;ig.module('display.overlays.crossroads-gameover').requires('display.overlay').defines(function(){ig.Overlay.CrossroadsGameOver=ig.Overlay.extend({container:null,init:function(){this.build();},start:function(){this.parent();},build:function(){this.container=new cjs.Container();var bg=new cjs.Sprite(ig.Sheets.lib.ui,"SmallMenuBg").set({mouseEnabled:false,regX:204,regY:236});var outOfMoves=new cjs.Sprite(ig.Sheets.lib.crossroads,"OutOfMoves").set({mouseEnabled:false,regX:142,regY:172,y:25});var tryAgainBtn=new cjs.Sprite(ig.Sheets.lib.btns,"TryAgainBtn").set({y:102,regX:130,regY:47,cursor:"pointer",name:"tryagain"});this.container.addChild(bg,outOfMoves,tryAgainBtn);this.container.visible=false;ig.LAYERS.OVERLAYS.addChild(this.container);},updateOverlay:function(){},show:function(){ig.LAYERS.OVERLAYS.tickChildren=ig.LAYERS.OVERLAYS.visible=true;this.container.visible=true;this.container.y=ig.system.height;if(ig.ViewControl.currentID===ig.VIEWS.CROSSROADS)
cjs.Tween.get(this.container).to({y:-69},400,cjs.Ease.cubicInOut).call(this.setListeners,[true],this);else
cjs.Tween.get(this.container).to({y:0},400,cjs.Ease.cubicInOut).call(this.setListeners,[true],this);cjs.Tween.get(ig.LAYERS.OVERLAY_DIM).set({visible:true}).to({alpha:0.6},400,cjs.Ease.quadInOut);},hide:function(t){this.setListeners(false);if(isNaN(t))t=300;cjs.Tween.get(this.container).to({y:ig.system.height},t,cjs.Ease.cubicInOut).set({visible:false});cjs.Tween.get(ig.LAYERS.OVERLAY_DIM).to({alpha:0},t,cjs.Ease.quadInOut).set({visible:false}).set({visible:false,tickChildren:false},ig.LAYERS.OVERLAYS);},btnHandler:function(e){var btn=e.target;if(!btn)return;var ease=cjs.Ease.backOut;switch(e.type){case"click":cjs.Sound.play("sfxclick");this.handleClick(btn);break;case"mouseover":cjs.Sound.play("sfxrollover");if(btn.label)btn.label.gotoAndStop("MapLabelOver");cjs.Tween.get(btn,{override:true}).to({scaleX:1.05,scaleY:1.05},200,ease);break;case"mouseout":if(btn.label)btn.label.gotoAndStop("MapLabel");cjs.Tween.get(btn,{override:true}).to({scaleX:1,scaleY:1},200,ease);break;case"mousedown":btn.scaleX=btn.scaleY=0.9;break;case"pressup":btn.scaleX=btn.scaleY=1;break;}},handleClick:function(btn){var btnName=btn.name;switch(btnName){case"tryagain":this.hide();ig.ViewControl.current.restart();break;}},setListeners:function(active){if(active){this.container.on("click",this.btnHandler,this);if(ig.ua.mobile){this.container.on("mousedown",this.btnHandler,this);this.container.on("pressup",this.btnHandler,this);}else{this.container.on("mouseover",this.btnHandler,this);this.container.on("mouseout",this.btnHandler,this);}}else{this.container.removeAllEventListeners();}},kill:function(){ig.LAYERS.OVERLAYS.removeChild(this.container);}});});

// lib/display/overlays/pause.js
ig.baked=true;ig.module('display.overlays.pause').requires('display.overlay').defines(function(){ig.Overlay.Pause=ig.Overlay.extend({container:null,init:function(){this.build();this.container.visible=false;ig.LAYERS.OVERLAYS.addChild(this.container);},start:function(){this.parent();},build:function(){this.container=new cjs.Container();this.pauseContainer=new cjs.Container();var bg=new cjs.Sprite(ig.Sheets.lib.ui,"SmallMenuBg").set({mouseEnabled:false,regX:204,regY:236});var resumeBtn=new cjs.Sprite(ig.Sheets.lib.btns,"ResumeBtn").set({y:-129,regX:145,regY:47,cursor:"pointer",name:"resume"});var helpBtn=resumeBtn.clone().set({name:"help",y:0});helpBtn.gotoAndStop("HelpBtn");var newGameBtn=resumeBtn.clone().set({name:"newgame",y:129});newGameBtn.gotoAndStop("NewGameBtn");this.pauseContainer.addChild(bg,resumeBtn,helpBtn,newGameBtn);this.helpContainer=new cjs.Container().set({y:ig.system.height,tickChildren:false,visible:false});var xBtn=new cjs.Sprite(ig.Sheets.lib.btns,"xBtn").set({x:470,y:-330,regX:43,regY:40,cursor:"pointer",name:"back"});this.helpContainer.addChild(xBtn);this.container.addChild(this.pauseContainer,this.helpContainer);},setActive:function(active){if(active){this.container.on("click",this.btnHandler,this);if(ig.ua.mobile){this.container.on("mousedown",this.btnHandler,this);this.container.on("pressup",this.btnHandler,this);}else{this.container.on("mouseover",this.btnHandler,this);this.container.on("mouseout",this.btnHandler,this);}
ig.LAYERS.OVERLAY_DIM.on("click",this.onOverlayDimClick,this);}else{ig.LAYERS.OVERLAY_DIM.removeAllEventListeners();this.container.removeAllEventListeners();}},show:function(){ig.LAYERS.OVERLAYS.tickChildren=ig.LAYERS.OVERLAYS.visible=true;this.container.visible=true;this.container.y=ig.system.height;var src="";if(ig.ViewControl.currentID===ig.VIEWS.CROSSROADS){src=ig.mediaPath+ig.main.imagesPath+"crossroads/crossroads-help.png";cjs.Tween.get(this.container).to({y:0},400,cjs.Ease.cubicInOut).call(this.setActive,[true],this);}
else{src=ig.ua.mobile?ig.prefix+ig.main.imagesPath+"ui/mobile-help.png":ig.prefix+ig.main.imagesPath+"ui/desktop-help.png";cjs.Tween.get(this.container).to({y:0},400,cjs.Ease.cubicInOut).call(this.setActive,[true],this);}
var helpImage=new cjs.Bitmap(src).set({mouseEnabled:false,regX:494,regY:350});this.helpContainer.addChildAt(helpImage,0);cjs.Tween.get(ig.LAYERS.OVERLAY_DIM).set({visible:true}).to({alpha:0.6},400,cjs.Ease.quadInOut);},hide:function(t){this.helpContainer.removeChildAt(0);this.setActive(false);if(isNaN(t))t=300;cjs.Tween.get(this.container).to({y:ig.system.height},t,cjs.Ease.cubicInOut).set({visible:false});cjs.Tween.get(ig.LAYERS.OVERLAY_DIM).to({alpha:0},t,cjs.Ease.quadInOut).set({visible:false}).set({visible:false,tickChildren:false},ig.LAYERS.OVERLAYS);},btnHandler:function(e){var btn=e.target;if(!btn)return;var ease=cjs.Ease.backOut;switch(e.type){case"click":cjs.Sound.play("sfxclick");this.handleClick(btn);break;case"mouseover":cjs.Sound.play("sfxrollover");if(btn.label)btn.label.gotoAndStop("MapLabelOver");cjs.Tween.get(btn,{override:true}).to({scaleX:1.05,scaleY:1.05},200,ease);break;case"mouseout":if(btn.label)btn.label.gotoAndStop("MapLabel");cjs.Tween.get(btn,{override:true}).to({scaleX:1,scaleY:1},200,ease);break;case"mousedown":btn.scaleX=btn.scaleY=0.9;break;case"pressup":btn.scaleX=btn.scaleY=1;break;}},onOverlayDimClick:function(){if(!this.pauseContainer.mouseEnabled){ig.VO.stop();this.pauseContainer.mouseEnabled=true;cjs.Tween.get(this.helpContainer).to({y:ig.system.height},400,cjs.Ease.cubicInOut).set({tickChildren:false,visible:false});}else{ig.ViewControl.current.resume();}},handleClick:function(btn){var btnName=btn.name;switch(btnName){case"resume":this.hide();ig.ViewControl.current.resume();break;case"newgame":ig.Session.newData();this.hide(0);ig.ViewControl.gotoView(ig.VIEWS.CROSSROADS);ig.ViewControl.fadeOutBlack();break;case"help":this.pauseContainer.mouseEnabled=false;cjs.Tween.get(this.helpContainer).set({tickChildren:true,visible:true}).to({y:0},400,cjs.Ease.cubicInOut).call(this.playInstructions,null,this);break;case"back":ig.VO.stop();this.pauseContainer.mouseEnabled=true;cjs.Tween.get(this.helpContainer).to({y:ig.system.height},400,cjs.Ease.cubicInOut).set({tickChildren:false,visible:false});break;}},playInstructions:function(){if(ig.ViewControl.currentID===ig.VIEWS.CROSSROADS){ig.VO.play(["noah_136","noah_137","noah_138","noah_142"]);}else{if(ig.ua.mobile){ig.VO.play(["noah_028","nell_029","noah_030"]);}else{ig.VO.play(["noah_026","nell_027","noah_030"]);}}},kill:function(){ig.LAYERS.OVERLAYS.removeChild(this.container);}});});

// lib/game/views/crossroads.js
ig.baked=true;ig.module('game.views.crossroads').requires('display.overlays.crossroads-results','display.overlays.crossroads-gameover','display.overlays.pause','display.view').defines(function(){ig.View.Crossroads=ig.View.extend({MAX_FUELS:{car:3,scooter:3,onfoot:3},VECTORS:{NW:[-1,-1,"coco_152"],N:[0,-1,"coco_150"],NE:[1,-1,"coco_152"],E:[1,0,"coco_148"],SE:[1,1,"coco_152"],S:[0,1,"coco_151"],SW:[-1,1,"coco_152"],W:[-1,0,"coco_149"]},VEHICLES:{NONE:{value:0,id:"none"},CAR:{value:1,id:"car"},SCOOTER:{value:2,id:"scooter"},ONFOOT:{value:4,id:"onfoot"}},X_SPACING:100,Y_SPACING:81,X_OFFSET:314,Y_OFFSET:71,MAP_WIDTH:9,MAP_HEIGHT:7,container:null,_debug:null,_level:null,fuelLevels:{car:0,scooter:0,onfoot:0},noah:null,coco:null,darkScreen:null,resourceRoundIndex:-1,resourceSpots:[],numResourcesCollected:0,numResourcesInRound:0,cx:0,cy:6,ex:8,ey:2,ui:null,btns:[],arrows:[],_cVehicle:-1,popup:null,_tutorialStep:-1,statMoves:3,statTime:75,_moveChoosen:false,_paused:false,isOnRetry:false,init:function(){this.build();},build:function(){this.container=new cjs.Container().set({name:"crossroads"});this.container.x=-712;this.container.y=-384;this.mapContainer=new cjs.Container();this.resourceContainer=new cjs.Container();this.buildNoah();this.buildCoco();this.darkScreen=new cjs.Shape().set({x:0,visible:false,alpha:0});this.darkScreen.graphics.f("#000").r(0,0,1426,768);this.buildUI();this.resultsOverlay=new ig.Overlay.CrossroadsResults();this.gameoverOverlay=new ig.Overlay.CrossroadsGameOver();this.pauseOverlay=new ig.Overlay.Pause();this.container.addChild(this.mapContainer,this.resourceContainer,this.coco,this.noah,this.darkScreen,this.ui);ig.LAYERS.VIEWS.addChild(this.container);},buildNoah:function(){var ss=ig.Sheets.lib.crossroads;var questSheet=ig.Session.activeQuest===ig.QUESTS.POOL?ig.Sheets.lib.Pool:ig.Sheets.lib.Picnic;var c=new cjs.Container();c.addChild(new cjs.Sprite(ss,"dot").set({name:"vehicle",mouseEnabled:false,regX:10,regY:10}));c.addChild(new cjs.Sprite(ss,"Noah").set({name:"pip",mouseEnabled:false,regX:56,regY:143,scaleX:0,scaleY:0}));c.addChild(new cjs.Sprite(questSheet,"temp").set({name:"questObject",mouseEnabled:false,regX:58,regY:88}));var directions=["NW","N","NE","E","SE","S","SW","W"];var vectors=this.VECTORS;for(var i=0;i<8;i++){var arrowVector=vectors[directions[i]];var arrow=new cjs.Sprite(ss,"arrow").set({cursor:"pointer",regX:-40,regY:30,hitArea:new cjs.Shape(new cjs.Graphics().f("#000").r(0,0,200,80)).set({regY:10}),directional:arrowVector,visible:false,scaleX:0,scaleY:0,rotation:225+45*i});arrow._x=arrowVector[0];arrow._y=arrowVector[1];c.addChild(arrow);this.arrows.push(arrow);}
this.noah=c;},buildCoco:function(){var ss=ig.Sheets.lib.crossroads;var c=new cjs.Container().set({mouseChildren:false,mouseEnabled:false});c.addChild(new cjs.Sprite(ss,"dot").set({regX:10,regY:10}));c.addChild(new cjs.Sprite(ss,"Coco").set({name:"pip",regX:55,regY:145,scaleX:0,scaleY:0,visible:false}));c.addChild(new cjs.Sprite(ss,"CocoBottom").set({name:"pip2",regX:55,regY:-25,scaleX:0,scaleY:0,visible:false}));this.coco=c;},buildUI:function(){var ss=ig.Sheets.lib.crossroads;var c=new cjs.Container().set({x:712,y:695});c.addChild(new cjs.Bitmap(ig.Assets.CrossroadsBottomBar).set({regX:712,regY:72,mouseEnabled:false}));var vehicles=[this.VEHICLES.CAR,this.VEHICLES.SCOOTER,this.VEHICLES.ONFOOT];for(i=0;i<3;i++){var btn=new cjs.Container().set({mouseChildren:false,cursor:"pointer",vehicle:vehicles[i],name:vehicles[i].id,isVehicleBtn:true,x:255*i-255});var white=new cjs.Shape(new cjs.Graphics().f("white").r(0,0,174,20)).set({x:-88,y:18});var fill=new cjs.Shape(new cjs.Graphics().f("#98ca00").rr(0,0,184,15,2)).set({x:-93,y:20,name:"fill"});var image=new cjs.Sprite(ss,"option-"+btn.name).set({regX:114,regY:61,name:"image"});btn.addChild(white,fill,image);this.btns.push(btn);c.addChild(btn);}
this.pauseBtn=new cjs.Sprite(ig.Sheets.lib.btns,"PauseBtn").set({x:-440,cursor:"pointer",regX:48,regY:45});c.addChild(this.pauseBtn);this.restartBtn=new cjs.Sprite(ig.Sheets.lib.btns,"RestartBtn").set({x:440,cursor:"pointer",regX:48,regY:45});c.addChild(this.restartBtn);this.ui=c;},reset:function(){this.setRound();},setRound:function(){var roundData=ig.Session.getRoundData();var variant=ig.Session.getVariant();var map=this._level=variant.map;this.cx=variant.sx;this.cy=variant.sy;this.ex=variant.ex;this.ey=variant.ey;this.setupMap(roundData,map);if(this.resourceRoundIndex!==ig.Session.roundIndex){this.setAvailableResourceSpots(map);}
this.setupResources(map);this.noah.x=this.X_OFFSET+this.X_SPACING*this.cx;this.noah.y=this.Y_OFFSET+this.Y_SPACING*this.cy;this.coco.x=this.X_OFFSET+this.X_SPACING*this.ex;this.coco.y=this.Y_OFFSET+this.Y_SPACING*this.ey;this.coco.getChildByName("pip").visible=!(this.coco.getChildByName("pip2").visible=this.ey===0);var vehicle=this.noah.getChildByName("vehicle");vehicle.gotoAndStop("dot");ig.CenterReg(vehicle);this.hideArrows();var questObject=this.noah.getChildByName("questObject");questObject.gotoAndStop(ig.Session.activeObject.id+"-sm");questObject.scaleX=questObject.scaleY=1;questObject.visible=true;var noahPip=this.noah.getChildByName("pip");noahPip.scaleX=noahPip.scaleY=1;noahPip.visible=true;this.statTime=this.statMoves=0;for(var vehicleName in this.fuelLevels){this.fuelLevels[vehicleName]=this.MAX_FUELS[vehicleName];}
for(var i=0;i<3;i++){var btn=this.btns[i];btn.alpha=1;btn.visibleFuel=this.fuelLevels[btn.name];}
this.gameActive=false;this.restartBtn.alpha=0.5;this.restartBtn.mouseEnabled=false;this.resume();this.numResourcesCollected=0;},setupMap:function(roundData,mapData){this.mapContainer.removeAllChildren();this.mapContainer.addChild(new cjs.Bitmap(ig.Assets[roundData.image.id]));var verticalBarriadeID=5;var buildingID=6;for(var y=0;y<this.MAP_HEIGHT;y++){for(var x=0;x<this.MAP_WIDTH;x++){var id=mapData[y][x];if(id===verticalBarriadeID){var xPos=x*this.X_SPACING+this.X_OFFSET;var yPos=y*this.Y_SPACING+this.Y_OFFSET;if(mapData[y][x-1]===buildingID||mapData[y][x+1]===buildingID){this.mapContainer.addChild(new cjs.Sprite(ig.Sheets.lib.crossroads,"Barricade-V").set({x:xPos,y:yPos,regX:15,regY:37}));}else{this.mapContainer.addChild(new cjs.Sprite(ig.Sheets.lib.crossroads,"Barricade-H").set({x:xPos,y:yPos,regX:41,regY:17}));}}}}},showDebug:function(){this._debug=!!this._debug?this._debug.removeAllChildren():new cjs.Container();for(var i=0;i<this._level.length;i++){var yArr=this._level[i];for(var j=0;j<yArr.length;j++){var value=yArr[j];this._debug.addChild(new cjs.Text(value,"20px Arial","#ff0000").set({x:314+100*j,y:71+81*i}));}}
this.container.addChild(this._debug);},setAvailableResourceSpots:function(mapData){var availableSpots=[];for(var y=1;y<this.MAP_HEIGHT-1;y++){for(var x=1;x<this.MAP_WIDTH-1;x++){var isStartPosition=x===this.cx&&y===this.cy;var isEndPosition=x===this.ex&&y===this.ey;if(isStartPosition||isEndPosition){continue;}
var id=mapData[y][x];if(id<3){availableSpots.push([x,y]);}}}
availableSpots.shuffle();this.resourceSpots=availableSpots.splice(0,3);this.resourceRoundIndex=ig.Session.roundIndex;},setupResources:function(mapData){this.numResourcesInRound=0;this.resourceContainer.removeAllChildren();for(var i=0;i<this.resourceSpots.length;i++){var spot=this.resourceSpots[i];var xPos=spot[0]*this.X_SPACING+this.X_OFFSET;var yPos=spot[1]*this.Y_SPACING+this.Y_OFFSET;var resource=new cjs.Sprite(ig.Sheets.lib.crossroads,"ResourceCheese").set({regX:40,regY:40,scaleX:0.5,scaleY:0.5,x:xPos,y:yPos});this.resourceContainer.addChild(resource);var rs=ig.Session.numResourcesSpawned+i;if(rs>0&&rs%ig.config.noahResourceFreq===0){resource.gotoAndStop("ResourceNoah");}
this.numResourcesInRound++;var tween=cjs.Tween.get(resource,{loop:true}).to({regY:50},600,cjs.Ease.quadInOut).to({regY:40},600,cjs.Ease.quadInOut);tween.setPosition(200*i);}},nextRound:function(){ig.Session.numResourcesSpawned+=this.numResourcesInRound;ig.Session.nextRound();this.reset();},start:function(){var noahPip=this.noah.getChildByName("pip");cjs.Tween.get(noahPip).set({visible:true}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);var cocoPip=this.coco.getChildByName("pip");cjs.Tween.get(cocoPip).wait(100).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);var cocoPip2=this.coco.getChildByName("pip2");cjs.Tween.get(cocoPip2).wait(100).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);if(ig.Session.tutorials.CROSSROADS){ig.VO.play("noah_134");this.startGame();}else{ig.VO.play("noah_134",this.startTutorial.bind(this));}},startGame:function(){ig.VO.play("noah_140");this.ui.removeAllEventListeners();this.noah.removeAllEventListeners();this.restartBtn.alpha=0.5;this.restartBtn.mouseEnabled=false;this.ui.on("click",this.uiMouseHandler,this);if(ig.ua.mobile){this.ui.on("mousedown",this.uiMouseHandler,this);this.ui.on("pressup",this.uiMouseHandler,this);}else{this.ui.on("mouseover",this.uiMouseHandler,this);this.ui.on("mouseout",this.uiMouseHandler,this);}
this.noah.on("click",this.arrowMouseHandler,this);if(ig.ua.mobile){this.noah.on("mousedown",this.arrowMouseHandler,this);this.noah.on("pressup",this.arrowMouseHandler,this);}else{this.noah.on("mouseover",this.arrowMouseHandler,this);this.noah.on("mouseout",this.arrowMouseHandler,this);}},readyForNext:function(){this._moveChoosen=false;if(this.cx===this.ex&&this.cy===this.ey){this.gameActive=false;this.win();}else if(this.isFuelAvailable()){this.showArrows();}else{this.gameover();}},showArrows:function(){if(!this.gameActive){return;}
var fuel=this.fuelLevels[this._cVehicle.id];if(fuel<=0){switch(this._cVehicle){case this.VEHICLES.CAR:ig.VO.play("noah_144");break;case this.VEHICLES.SCOOTER:ig.VO.play("noah_145");break;case this.VEHICLES.ONFOOT:ig.VO.play("noah_146");break;}
this.hideArrows();return;}
this.hideNoah();for(var i=0;i<8;i++){var arrow=this.arrows[i];var _x=this.cx+arrow._x;var _y=this.cy+arrow._y;if(_x<0||_x>8||_y<0||_y>6){arrow.mouseEnabled=false;}else{var value=this._level[_y][_x];if(this._cVehicle===this.VEHICLES.ONFOOT&&(value===3||value===4)){if(value===3){arrow.mouseEnabled=(this.cx<_x&&this.cy>_y)||(this.cx>_x&&this.cy<_y);}else{arrow.mouseEnabled=(this.cx<_x&&this.cy<_y)||(this.cx>_x&&this.cy>_y);}}else{arrow.mouseEnabled=value<=this._cVehicle.value;}}
if(arrow.mouseEnabled)
cjs.Tween.get(arrow,{override:true}).set({visible:true,alpha:1}).to({scaleX:0.72,scaleY:0.72},250,cjs.Ease.backOut);else
cjs.Tween.get(arrow,{override:true}).to({scaleX:0,scaleY:0},100,cjs.Ease.backIn).set({visible:false});}},hideArrows:function(exception){for(var i=0;i<8;i++){var arrow=this.arrows[i];arrow.mouseEnabled=false;if(arrow===exception){continue;}
cjs.Tween.get(arrow,{override:true}).to({scaleX:0,scaleY:0},100,cjs.Ease.backIn).set({visible:false});}},hideNoah:function(){var noahPip=this.noah.getChildByName("pip");cjs.Tween.get(noahPip).to({scaleX:0,scaleY:0},100,cjs.Ease.backIn).set({visible:false});var questObject=this.noah.getChildByName("questObject");cjs.Tween.get(questObject).to({scaleX:0,scaleY:0},100,cjs.Ease.backIn).set({visible:false});},changeVehicle:function(name){if(!ig.Session.tutorials.CROSSROADS){ig.Session.tutorials.CROSSROADS=true;this.stepTutorial();}
this.gameActive=true;var vehicle=this.noah.getChildByName("vehicle");vehicle.gotoAndStop(name);ig.CenterReg(vehicle);if(name==="car"){this._cVehicle=this.VEHICLES.CAR;}else if(name==="scooter"){this._cVehicle=this.VEHICLES.SCOOTER;}else if(name==="onfoot"){this._cVehicle=this.VEHICLES.ONFOOT;}
for(var i=0;i<3;i++){var btn=this.btns[i];var sprite=btn.getChildByName("image");sprite.gotoAndStop(btn.name===name?"option-"+btn.name+"-selected":"option-"+btn.name);}
vehicle.scaleX=vehicle.scaleY=0;cjs.Tween.get(vehicle).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);this.showArrows();},isFuelAvailable:function(){for(var type in this.fuelLevels){if(this.fuelLevels[type]>0){return true;}}
return false;},chooseArrow:function(arrow){this.hideArrows(arrow);this._moveChoosen=true;var voID=arrow.directional[2];ig.VO.play(voID);cjs.Tween.get(this).wait(1000).call(this.moveTo,[arrow.directional],this);},moveTo:function(direction){this.statMoves++;this.cx+=direction[0]*2;this.cy+=direction[1]*2;switch(this._cVehicle){case this.VEHICLES.CAR:cjs.Sound.play("sfxcar",{volume:0.5});break;case this.VEHICLES.SCOOTER:cjs.Sound.play("sfxscooter",{volume:0.7});break;case this.VEHICLES.ONFOOT:cjs.Sound.play("sfxfootstep",{loop:2});break;}
var speed=this._cVehicle.value*250+300;this.hideArrows();this.useFuel();cjs.Tween.get(this.noah).wait(100).to({x:314+100*this.cx,y:71+81*this.cy},speed,cjs.Ease.sineInOut).call(this.readyForNext,null,this);this.restartBtn.alpha=1;this.restartBtn.mouseEnabled=true;},useFuel:function(){this.updateFuels=true;var btn=this.ui.getChildByName(this._cVehicle.id);var fuelLevel=--this.fuelLevels[btn.name];cjs.Tween.get(btn).to({visibleFuel:fuelLevel,alpha:fuelLevel<=0?0.6:1},300,cjs.Ease.linear);},pause:function(){this._paused=true;this.container.tickEnabled=false;ig.MusicControl.pause(true);this.pauseOverlay.show();},resume:function(){this._paused=false;this.pauseOverlay.hide();this.container.tickEnabled=true;ig.MusicControl.resume(true);this.ui.mouseEnabled=true;},restart:function(){this.reset();cjs.Tween.get(this.resultsOverlay).to({y:ig.system.height*1.5},200,cjs.Ease.cubicIn);this.start();},tryAgain:function(){this.lastTime=this.statTime;this.lastMoves=this.statMoves;this.isOnRetry=true;this.restart();},win:function(){if(this.numResourcesCollected>=this.numResourcesInRound){ig.log("All Three Event");}
if(ig.Session.roundIndex>=4){ig.log("Beat Last Round");}
ig.VO.play("coco_154");this._paused=true;this.resultsOverlay.updateOverlay(this.statMoves,this.statTime);cjs.Tween.get({}).wait(500).call(this.resultsOverlay.show,null,this.resultsOverlay);},gameover:function(){this._paused=true;this.gameoverOverlay.updateOverlay();this.gameoverOverlay.show();},containerClickHandler:function(){if(this.popup&&!cjs.Tween.hasActiveTweens(this.popup)&&this.popup.scaleX>0){this.hidePopup();}},uiMouseHandler:function(e){var target=e.target;if(!target)return;if(this._moveChoosen||this._paused)
return;switch(e.type){case"click":cjs.Sound.play("sfxclick");if(target===this.pauseBtn){this.pause();}else if(target===this.restartBtn){this.restart();}else if(target.isVehicleBtn){this.changeVehicle(target.name.toLowerCase());}
break;case"mouseover":cjs.Sound.play("sfxrollover");cjs.Tween.get(target,{override:true}).to({scaleX:1.1,scaleY:1.1},250,cjs.Ease.backOut);break;case"mouseout":cjs.Tween.get(target,{override:true}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);break;case"mousedown":target.scaleX=target.scaleY=0.9;break;case"pressup":target.scaleX=target.scaleY=1;break;}},arrowMouseHandler:function(e){var target=e.target;if(!target||!target.mouseEnabled)return;switch(e.type){case"click":cjs.Sound.play("sfxclick");this.chooseArrow(target);break;case"mouseover":cjs.Sound.play("sfxrollover");cjs.Tween.get(target,{override:true}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);break;case"mouseout":cjs.Tween.get(target,{override:true}).to({scaleX:0.72,scaleY:0.72},250,cjs.Ease.backOut);break;case"mousedown":target.scaleX=target.scaleY=0.9;break;case"pressup":target.scaleX=target.scaleY=1;break;}},startTutorial:function(){this.container.on("click",this.containerClickHandler,this);cjs.Tween.get(this.darkScreen).set({visible:true}).to({alpha:0.4},500,cjs.Ease.quadInOut).call(this.stepTutorial,null,this);},stepTutorial:function(){this._tutorialStep++;switch(this._tutorialStep){case 0:ig.VO.play("noah_136");this.popup=ig.TextBoxes.getInfoBox("crossroads1",true);this.popup.set({x:-228,y:-53,scaleX:0,scaleY:0});this.ui.addChild(this.popup);cjs.Tween.get(this.popup,{override:true}).set({visible:true}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);break;case 1:this.ui.removeChild(this.popup);ig.TextBoxes.putInfoBox(this.popup);ig.VO.play("noah_137");this.popup=ig.TextBoxes.getInfoBox("crossroads2",true);this.popup.set({x:1,y:-57,scaleX:0,scaleY:0});this.ui.addChild(this.popup);cjs.Tween.get(this.popup,{override:true}).set({visible:true}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);break;case 2:this.ui.removeChild(this.popup);ig.TextBoxes.putInfoBox(this.popup);ig.VO.play("noah_138");this.popup=ig.TextBoxes.getInfoBox("crossroads3",true);this.popup.set({x:324,y:-42,scaleX:0,scaleY:0});this.ui.addChild(this.popup);cjs.Tween.get(this.popup,{override:true}).set({visible:true}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);break;case 3:this.ui.removeChild(this.popup);ig.TextBoxes.putInfoBox(this.popup);cjs.Tween.get(this.darkScreen).to({alpha:0},500,cjs.Ease.quadInOut).set({visible:false}).call(this.startGame,null,this);break;case 4:ig.VO.play("noah_142");var pt=this.container.localToLocal(this.noah.x,this.noah.y,this.ui);this.popup=ig.TextBoxes.getInfoBox("crossroads4",true);this.popup.set({x:pt.x+20,y:pt.y-20,scaleX:0,scaleY:0});this.ui.addChild(this.popup);cjs.Tween.get(this.popup,{override:true}).set({visible:true}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);break;}},hidePopup:function(){cjs.Tween.get(this.popup,{override:true}).to({scaleX:0,scaleY:0},250,cjs.Ease.backIn).set({visible:false}).call(this.stepTutorial,null,this);},collectResource:function(resourceDisplayObject){this.container.addChild(resourceDisplayObject);if(resourceDisplayObject.currentAnimation==="ResourceNoah"){ig.log("Noah Pickup Event");}
else{ig.log("Cheese Pickup Event");}
this.numResourcesCollected++;var tx=(resourceDisplayObject.x*3+this.noah.x)/4;var ty=(resourceDisplayObject.y*3+this.noah.y)/4;cjs.Tween.get(resourceDisplayObject).to({x:tx,y:ty,alpha:0},200,cjs.Ease.cubicOut).call(this.container.removeChild,[resourceDisplayObject],this.container);},update:function(){if(this._paused){return;}
if(this.gameActive){this.statTime+=ig.system.tick;}
var resources=this.resourceContainer.children;for(var i=0;i<resources.length;i++){var resource=resources[i];if((resource.x===this.noah.x&&Math.abs(resource.y-this.noah.y)<60)||(resource.y===this.noah.y&&Math.abs(resource.x-this.noah.x)<60)){this.collectResource(resource);break;}}
if(this.updateFuels){for(var i=0;i<3;i++){var btn=this.btns[i];var fill=btn.getChildByName("fill");var fuelPercent=btn.visibleFuel/this.MAX_FUELS[btn.name];fill.graphics.c().f("#98ca00").rr(0,0,184*fuelPercent,15,2);}}},kill:function(){this.ui.removeAllEventListeners();this.noah.removeAllEventListeners();this.container.removeAllEventListeners();ig.LAYERS.VIEWS.removeChild(this.container);}});});

// lib/controllers/views.js
ig.baked=true;ig.module('controllers.views').requires('game.views.pretitle','game.views.title','game.views.crossroads').defines(function(){ig.ViewController=ig.Class.extend({current:null,currentID:-1,preloader:null,init:function(){if(ig.ViewControl!==null){console.error("You do not instantiate this class!");return;}
ig.ViewControl=this;},update:function(){if(this.current){this.current.update();}
if(this.preloader){this.preloader.update();}},gotoLoadScreen:function(){this.preloader.show();},fadeInBlack:function(){cjs.Tween.get(ig.LAYERS.BLACK,{override:true}).set({visible:true}).to({alpha:1},250,cjs.Ease.quadInOut);return 250;},fadeOutBlack:function(){cjs.Tween.get(ig.LAYERS.BLACK,{override:true}).wait(100).to({alpha:0},250,cjs.Ease.quadInOut).set({visible:false});return 300;},gotoView:function(view){var viewsLayer=ig.LAYERS.VIEWS;this.isTransitioning=true;var t;if(this.preloader&&this.preloader.shown){if(this.current){this.current.kill();}
this.preloader.hide();}else if(this.current){ig.VO.stop();this.last=this.current;this.lastID=this.currentID;this.current=null;this.last.setActive(false);t=this.last.animateOut();cjs.Tween.get(this).wait(t).call(this.last.kill,null,this.last).call(this.gotoView,[view],this);return;}
this.currentID=view;switch(view){case ig.VIEWS.PRETITLE:this.current=new ig.View.PreTitle();break;case ig.VIEWS.TITLE:ig.MusicControl.set("mainLoop");this.current=new ig.View.Title();break;case ig.VIEWS.CROSSROADS:ig.MusicControl.set("driveLoop");this.current=new ig.View.Crossroads();break;}
viewsLayer.removeAllChildren();if(!this.current){ig.log("No View Provided");return;}
this.current.reset();viewsLayer.addChild(this.current.container);t=this.current.animateIn();cjs.Tween.get(this).wait(t).call(this.current.start,null,this.current).set({isTransitioning:false,last:null},this);}});ig.ViewControl=null;new ig.ViewController();});

// lib/controllers/session.js
ig.baked=true;ig.module('controllers.session').defines(function(){ig.SessionController=ig.Class.extend({GOAL_TO_FIND:5,tutorials:{CROSSROADS:false},activeQuest:"",activeObject:null,mapList:[],questObjects:[],questObjectIds:[],roundIndex:-1,numResourcesSpawned:0,init:function(){if(ig.Session!==null){console.error("You do not instantiate this class!");return;}
ig.Session=this;},newData:function(){this.activeQuest=Math.random()>0.5?ig.QUESTS.POOL:ig.QUESTS.PICNIC;this.setObjectList();this.setMapList();this.numResourcesSpawned=0;this.roundIndex=-1;this.nextRound();},nextRound:function(){this.activeObject=this.questObjects[++this.roundIndex];},addSuccess:function(){this.numObjectsFound++;},getVariant:function(){return this.mapList[this.roundIndex];},getRoundData:function(){return ig.config.crossroads[this.roundIndex];},getCurrentObjectData:function(id){return this.activeObject.data[id];},getObjectData:function(id,prop){var objects=ig.config.quests[this.activeQuest].objects;var n=objects.length;for(var i=0;i<n;i++){if(id===objects[i].id){return objects[i][prop];}}
return null;},getActiveObjectData:function(indentifier){var prop=indentifier.substring(indentifier.indexOf(":")+1,indentifier.indexOf("}"));return this.activeObject.data[prop];},getCurrentObjectLocation:function(){return this.activeObject.location;},getCurrentObjectId:function(){return this.questObjectIds[this.numObjectsFound];},setObjectList:function(){this.questObjects=[];this.questObjectIds=[];var quest=this.activeQuest;var _unusedObjects=ig.config.quests[quest].objects.slice();_unusedObjects.shuffle();_unusedObjects.shuffle();this.questObjects=_unusedObjects.slice(0,this.GOAL_TO_FIND);for(var i=0;i<this.questObjects.length;i++){var object=this.questObjects[i];this.questObjectIds.push(object.id);}},setMapList:function(){this.mapList=[];for(var i=0;i<ig.config.crossroads.length;i++){this.mapList.push(ig.config.crossroads[i].variants.random());}}});ig.Session=null;new ig.SessionController();});

// lib/controllers/music.js
ig.baked=true;ig.module('controllers.music').defines(function(){ig.MusicController=ig.Class.extend({current:null,currentID:"",isHardPaused:false,init:function(){if(ig.MusicControl!==null){console.error("You do not instantiate this class!");return;}
ig.MusicControl=this;},set:function(id){if(id===this.currentID)
return;if(this.current)
this.current.stop();this.current=cjs.Sound.play(id,{loop:-1,volume:0.6});this.currentID=id;},stop:function(){this.currentID="";if(this.current)
this.current.stop();},pause:function(hardPause){if(this.current)
this.current.setPaused(true);if(hardPause)
this.isHardPaused=true;},resume:function(hardResume){if(hardResume||!this.isHardPaused){if(this.current)
this.current.setPaused(false);this.isHardPaused=false;}},fadeOut:function(){this.currentID="";if(this.current){cjs.Tween.get(this.current).to({volume:0},500);}
this.current=null;}});ig.MusicControl=null;new ig.MusicController();});

// lib/controllers/visibility.js
ig.baked=true;ig.module('controllers.visibility').defines(function(){ig.VisibilityController=ig.Class.extend({_bindedHandler:null,hidden:null,visibilitychange:null,i:0,init:function(){if(ig.Visibility!==null){console.error("You do not instantiate this class!");return;}
ig.Visibility=this;},addListeners:function(){ig.log("Visibility Listeners Active");this._bindedHandler=this.onPageVisibilityChange.bind(this);window.addEventListener("pagehide",this._bindedHandler);window.addEventListener("pageshow",this._bindedHandler);window.addEventListener('focus',this._bindedHandler);window.addEventListener('blur',this._bindedHandler);if(typeof document.hidden!=="undefined"){this.hidden="hidden";this.visibilityChange="visibilitychange";}else if(typeof document.mozHidden!=="undefined"){this.hidden="mozHidden";this.visibilityChange="mozvisibilitychange";}else if(typeof document.msHidden!=="undefined"){this.hidden="msHidden";this.visibilityChange="msvisibilitychange";}else if(typeof document.webkitHidden!=="undefined"){this.hidden="webkitHidden";this.visibilityChange="webkitvisibilitychange";}
if(this.visibilityChange&&this.hidden){document.addEventListener(this.visibilityChange,this._bindedHandler);window.addEventListener(this.visibilityChange,this._bindedHandler);}},removeListeners:function(){if(!this._bindedHandler)
return;window.removeEventListener("pagehide",this._bindedHandler);window.removeEventListener("pageshow",this._bindedHandler);window.removeEventListener('focus',this._bindedHandler);window.removeEventListener('blur',this._bindedHandler);if(this.visibilityChange&&this.hidden){document.removeEventListener(this.visibilityChange,this._bindedHandler);}},onPageVisibilityChange:function(event){if(!event)
return;if(cjs.Sound.activePlugin===cjs.FlashAudioPlugin)
return;switch(event.type){case this.visibilityChange:case"visibilitychange":cjs.Sound.setMute(!!document[this.hidden]);if(document[this.hidden]){ig.MusicControl.pause();}else{ig.MusicControl.resume();}
break;case"pagehide":case"blur":ig.MusicControl.pause();cjs.Sound.setMute(true);break;case"pageshow":case"focus":ig.MusicControl.resume();cjs.Sound.setMute(false);break;}}});ig.Visibility=null;new ig.VisibilityController();});

// lib/controllers/vo.js
ig.baked=true;ig.module('controllers.vo').defines(function(){ig.VoiceOverController=ig.Class.extend({_soundInstance:null,_sequence:[],_index:0,_callback:null,character:"",init:function(){if(ig.VO!==null){console.error("You do not instantiate this class!");return;}
ig.VO=this;},play:function(idOrSeq,callback){if(this._soundInstance){this._soundInstance.stop();}
if(typeof idOrSeq==="string"){this._sequence=[idOrSeq];}else{this._sequence=idOrSeq;}
this._index=-1;this._callback=callback;this._next();},stop:function(){if(this._soundInstance){this._soundInstance.stop();this._soundInstance=null;}
this._callback=null;this.character="";},_next:function(){this._index++;if(this._soundInstance){this._soundInstance.removeAllEventListeners();}
var seq=this._sequence[this._index];if(seq){var id,delay=0;if(typeof seq==="string"){id=seq;}else{id=seq.id;delay=seq.delay;}
if(id.indexOf("{object")>-1){id=ig.Session.getActiveObjectData(id);}else if(id.indexOf("{neighbor")>-1){id=ig.main.game.neighbor.data.id+"_"+id.substring(id.indexOf(":")+1,id.indexOf("}"));}
this.character=id.split("_")[0];this._soundInstance=cjs.Sound.play(id,{delay:delay});if(this._soundInstance&&this._soundInstance.playState!==cjs.Sound.PLAY_FAILED){this._soundInstance.on("complete",this._onSoundComplete,this);}else{this._next();}}else if(this._callback){this.character="";this._callback();this._callback=null;}},_onSoundComplete:function(){this.character="";this._next();}});ig.VO=null;new ig.VoiceOverController();});

// lib/game/main.js
ig.baked=true;ig.module('game.main').requires('game.textbox-builder','display.preloader','controllers.sheets','controllers.views','controllers.session','controllers.music','controllers.visibility','controllers.vo','impact.main').defines(function(){ig.QUESTS={POOL:"pool",PICNIC:"picnic"};ig.LAYERS={};ig.VIEWS={PRETITLE:0,TITLE:1,CROSSROADS:2,ENDING:3};ig.Assets={};ig.CrossroadsKK=ig.Main.extend({stage:null,imagesPath:"images/",fontsPath:"fonts/",isAudioLimited:false,_seenIntro:false,round:-1,init:function(){ig.debug=false;this.isAudioLimited=ig.ua.mobile&&!cjs.WebAudioPlugin.isSupported();if(this.isAudioLimited){this.showUnsupported();return;}
cjs.Sound.EXTENSION_MAP.mp3="mpeg";cjs.LoadQueue.loadTimeout=60000;ig.Visibility.addListeners();this.initializeCanvases();this.initLayers();this.initSound();this.loadTitleImage();},initLayers:function(){ig.LAYERS.VIEWS=new cjs.Container();ig.LAYERS.OVERLAYS=new cjs.Container();ig.LAYERS.PRELOADER=new cjs.Container();ig.LAYERS.BLACK=this.stage.addChild(new cjs.Shape()).set({regX:713,regY:384,alpha:0,visible:false});ig.LAYERS.BLACK.graphics.f("#000").r(0,0,1426,768);ig.LAYERS.OVERLAY_DIM=this.stage.addChild(new cjs.Shape()).set({regX:713,regY:384,alpha:0,visible:false});ig.LAYERS.OVERLAY_DIM.graphics.f("#000").r(0,0,1426,768);this.stage.addChild(ig.LAYERS.VIEWS,ig.LAYERS.OVERLAY_DIM,ig.LAYERS.OVERLAYS,ig.LAYERS.PRELOADER,ig.LAYERS.BLACK);if(ig.debug){ig.LAYERS.DEBUG=this.stage.addChild(new cjs.Container());var s=new cjs.Shape();s.graphics.f("#000000").r(0,0,20,14);ig.LAYERS.DEBUG.addChild(s);this.fpsTextbox=new cjs.Text("fps","12px Arial","#FFFFFF").set({x:2});ig.LAYERS.DEBUG.addChild(this.fpsTextbox);}},showUnsupported:function(){this.stage=ig.system.addStage(new cjs.Stage("gameCanvas"));this.unsupportedImage=new cjs.Bitmap("media/images/unsupported.jpg").set({regX:713,regY:384});this.stage.addChild(this.unsupportedImage);},initializeCanvases:function(){ig.log("Initialize Stages");this.stage=ig.system.addStage(new cjs.Stage("gameCanvas"));if(ig.ua.mobile&&cjs.Touch.isSupported()){cjs.Touch.enable(this.stage);this.stage.enableDOMEvents(false);this.stage.snapToPixelEnabled=true;}else{this.stage.enableMouseOver(30);}
this.stage.preventSelection=false;ig.input.initMouse(this.stage);ig.input.initKeyboard();ig.input.bind(ig.KEY.MOUSE1,'mouse');ig.input.bind(ig.KEY.LEFT_ARROW,'left');ig.input.bind(ig.KEY.UP_ARROW,'up');ig.input.bind(ig.KEY.RIGHT_ARROW,'right');ig.input.bind(ig.KEY.DOWN_ARROW,'down');ig.input.bind(ig.KEY.SPACE,'up');ig.input.bind(ig.KEY.SHIFT,'shift');},loadTitleImage:function(){var titleBGLoader=new cjs.ImageLoader(ig.mediaPath+this.imagesPath+"title-bg.jpg");titleBGLoader.on("complete",this.onTitleBGLoadEvent,this);titleBGLoader.load();},onTitleBGLoadEvent:function(e){var loader=e.target;loader.removeAllEventListeners();ig.Assets.TitleBG=e.result;loader.destroy();ig.ViewControl.gotoView(ig.VIEWS.PRETITLE);this.loadPreload();},loadPreload:function(){ig.log("-----------Pre Queue------------");var preQueue=new cjs.LoadQueue(true,ig.mediaPath);preQueue.setMaxConnections(4);preQueue.installPlugin(cjs.Sound);preQueue.on("complete",this.onPreQueueComplete,this);preQueue.on("fileload",this.handleFileLoad,this);preQueue.loadManifest({path:this.imagesPath,manifest:[{id:"ldrEdge",src:"loader/loader-edge.png"},{id:"ldrText",src:"loader/loader-text.png"},{id:"LoadingSSData",src:"loader/loading.json"},{id:"LoadingSSImage",src:"loader/loading.png"},{id:"TitleSSData",src:"titlesheet.json"},{id:"TitleSSImage",src:"titlesheet.png"}]},false);preQueue.loadFile({id:"audioSpriteData",src:"audio/vo/audiosprites.min.json"});preQueue.loadFile({id:"mainLoop",src:"audio/music/main-loop.ogg"});},onPreQueueComplete:function(e){ig.log("^^^^^^^^^^^ Complete ^^^^^^^^^^^");var queue=e.target;ig.Sheets.add("Loading",queue.getResult("LoadingSSImage"),queue.getResult("LoadingSSData"));ig.Sheets.add("Title",queue.getResult("TitleSSImage"),queue.getResult("TitleSSData"));this.soundData=queue.getResult("audioSpriteData");ig.Assets.LoaderEdge=queue.getResult("ldrEdge");ig.Assets.LoaderText=queue.getResult("ldrText");ig.ViewControl.preloader=new ig.Preloader();ig.ViewControl.preloader.build(queue);queue.removeAllEventListeners();queue.destroy();ig.ViewControl.gotoView(ig.VIEWS.TITLE);this.loadStartUpAssets();},initSound:function(){ig.log("Initialize sounds");cjs.FlashAudioPlugin.swfPath="media/";if(!cjs.Sound.registerPlugins([cjs.WebAudioPlugin,cjs.FlashAudioPlugin,cjs.HTMLAudioPlugin])){ig.log("Sound Problem!!!");return;}
cjs.Sound.alternateExtensions=["ogg","mp3"];cjs.Sound.defaultInterruptBehavior=cjs.Sound.INTERRUPT_EARLY;},loadStartUpAssets:function(){ig.log("-----------Main Queue------------");var mainQueue=new createjs.LoadQueue(true,ig.mediaPath);mainQueue.stopOnError=true;mainQueue.setMaxConnections(8);mainQueue.installPlugin(cjs.Sound);mainQueue.on("fileload",this.handleFileLoad,this);mainQueue.on("error",function(e){ig.log(e);});mainQueue.on("complete",this.onStartUpAssetsComplete,this);mainQueue.loadManifest({path:this.imagesPath+"ui/",manifest:[{id:"uiSheet",src:"ui.png"},{id:"uiSheetData",src:"ui.json"},{id:"btnsSheet",src:"btns.png"},{id:"btnsSheetData",src:"btns.json"}]});mainQueue.loadManifest({path:this.imagesPath,manifest:[{id:"PicnicObjectSSData",src:"picnic-objects.json"},{id:"PicnicObjectSSImage",src:"picnic-objects.png"},{id:"PoolObjectSSData",src:"pool-objects.json"},{id:"PoolObjectSSImage",src:"pool-objects.png"}]});mainQueue.loadManifest({path:this.fontsPath,manifest:[{id:"maidenorangeSheet",src:"maidenorange.png"},{id:"maidenorangeData",src:"maidenorange.json"},{id:"bodegasansSheet",src:"bodegasans.png"},{id:"bodegasansData",src:"bodegasans.json"},{id:"bodegasans94Sheet",src:"bodegasans94.png"},{id:"bodegasans94Data",src:"bodegasans94.json"},{id:"crossroadsFontSheet",src:"crossroads-font.png"},{id:"crossroadsFontData",src:"crossroads-font.json"}]});var crossroadsManifest=[{id:"crossroadsImage",src:"crossroads.png"},{id:"crossroadsData",src:"crossroads.json"},{id:"crossroadsBar",src:"crossroads-bar.png"},{id:"crossroadsEnd",src:"crossroads-end.png"}];for(var i=0;i<ig.config.crossroads.length;i++){crossroadsManifest.push(ig.config.crossroads[i].image);}
mainQueue.loadManifest({path:this.imagesPath+"crossroads/",manifest:crossroadsManifest});mainQueue.loadManifest({path:"audio/sfx/",manifest:[{id:"sfxcar",src:"sfxcar.ogg"},{id:"sfxclick",src:"sfxclick.ogg"},{id:"sfxcorrect",src:"sfxcorrect.ogg"},{id:"sfxfootstep",src:"sfxfootstep.ogg"},{id:"sfxscooter",src:"sfxscooter.ogg"}]});mainQueue.loadManifest({path:"audio/music/",manifest:[{id:"driveLoop",src:"crossroads-loop.ogg"}]});this.addVOToManifest(mainQueue,"crossroads-vo");},onStartUpAssetsComplete:function(e){ig.log("^^^^^^^^^^^ Complete ^^^^^^^^^^^");var queue=e.target;queue.removeAllEventListeners();queue.destroy();ig.Sheets.add("Picnic",queue.getResult("PicnicObjectSSImage"),queue.getResult("PicnicObjectSSData"));ig.Sheets.add("Pool",queue.getResult("PoolObjectSSImage"),queue.getResult("PoolObjectSSData"));var data=queue.getResult("uiSheetData");img=queue.getResult("uiSheet");ig.Sheets.add("ui",img,data);data=queue.getResult("crossroadsData");img=queue.getResult("crossroadsImage");ig.Sheets.add("crossroads",img,data);data=queue.getResult("crossroadsFontData");img=queue.getResult("crossroadsFontSheet");ig.Sheets.add("CROSSROADS_FONT",img,data);data=queue.getResult("btnsSheetData");img=queue.getResult("btnsSheet");ig.Sheets.add("btns",img,data);data=queue.getResult("maidenorangeData");img=queue.getResult("maidenorangeSheet");ig.Sheets.add("MAIDEN_ORANGE",img,data);data=queue.getResult("bodegasansData");img=queue.getResult("bodegasansSheet");ig.Sheets.add("BODEGA_SANS",img,data);data=queue.getResult("bodegasans94Data");img=queue.getResult("bodegasans94Sheet");ig.Sheets.add("BODEGA_SANS_94",img,data);ig.Sheets.lib.BODEGA_SANS.yOffset=-3;ig.Sheets.lib.BODEGA_SANS_94.yOffset=-3;for(var i=0;i<ig.config.crossroads.length;i++){var id=ig.config.crossroads[i].image.id;ig.Assets[id]=queue.getResult(id);}
ig.Assets.CrossroadsBottomBar=queue.getResult("crossroadsBar");ig.Assets.CrossroadsEnd=queue.getResult("crossroadsEnd");this.isAssetsReady=true;if(ig.ViewControl.preloader.shown){this.playClicked();}},playClicked:function(){if(this.isAssetsReady){this.gotoGame();}else{ig.ViewControl.gotoLoadScreen();}},gotoGame:function(){ig.Session.newData();cjs.Sound.play("sfxclick");ig.ViewControl.gotoView(ig.VIEWS.CROSSROADS);},update:function(){if(ig.debug&&this.fpsTextbox){this.fpsTextbox.text=Math.round(cjs.Ticker.getMeasuredFPS());}
if(ig.ViewControl){ig.ViewControl.update();}
if(ig.LAYERS.BLACK){ig.LAYERS.BLACK.x=ig.LAYERS.OVERLAY_DIM.x=ig.LAYERS.OVERLAYS.x=ig.LAYERS.VIEWS.x=ig.LAYERS.PRELOADER.x=ig.system.width*0.5;ig.LAYERS.BLACK.y=ig.LAYERS.OVERLAY_DIM.y=ig.LAYERS.OVERLAYS.y=ig.LAYERS.VIEWS.y=ig.LAYERS.PRELOADER.y=ig.system.height*0.5;}
if(this.unsupportedImage){this.unsupportedImage.x=ig.system.width*0.5;this.unsupportedImage.y=ig.system.height*0.5;}},addVOToManifest:function(queue,key){var sData=this.soundData[key];queue.loadManifest([{src:"audio/vo/"+sData.src,data:{channels:1,audioSprite:sData.data.audioSprite}}]);},removeVOSounds:function(key){var sData=this.soundData[key];cjs.Sound.removeSound("audio/vo/"+sData.src);},handleFileLoad:function(e){var item=e.item;ig.log("Loaded: "+item.src);}});ig.CenterReg=function(bmp){var b=bmp.getBounds();bmp.regX=Math.round(b.width*0.5);bmp.regY=Math.round(b.height*0.5);};});ig.pauseGame=function(){if(ig.ViewControl&&ig.ViewControl.current&&ig.ViewControl.current.pause){ig.ViewControl.current.pause();}};ig.resumeGame=function(){if(ig.ViewControl&&ig.ViewControl.current&&ig.ViewControl.current.resume){ig.ViewControl.current.resume();}};ig.deploy=function(containerID,mediaPath,guids){ig.guids=guids;ig.mediaPath=mediaPath||"";var x=setInterval(function(){if(ig.ready&&ig.CrossroadsKK){ig.init(ig.CrossroadsKK,1426,768,document.getElementById(containerID));clearInterval(x);}},250);};