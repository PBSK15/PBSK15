/*! Built with IMPACT - impactjs.com */

(function(window){"use strict";Math.map=function(x,istart,istop,ostart,ostop){return ostart+(ostop-ostart)*((x-istart)/(istop-istart));};Math.limit=function(x,min,max){return Math.min(max,Math.max(min,x));};Math.roundAt=function(x,precision){if(!precision)return Math.round(x);precision=Math.pow(10,precision||0);return Math.round(x*precision)/precision;};Math.toInt=function(x){return(x|0);};Math.toRad=function(x){return((x*Math.PI)/180);};Math.toDeg=function(x){return((x*180)/Math.PI);};Math.getRandomArbitrary=function(min,max){return Math.random()*(max-min)+min;};Math.range=function(min,max){return Math.floor(Math.random()*(max-min+1))+min;};Object.defineProperty(Array.prototype,'erase',{value:function(item){var i=this.indexOf(item);if(i>=0)this.splice(i,1);return this;}});Object.defineProperty(Array.prototype,'random',{value:function(){return this[0|(Math.random()*this.length)];}});Object.defineProperty(Array.prototype,'shuffle',{value:function(){var i=this.length,j,temp;if(i===0)return this;while(--i){j=Math.floor(Math.random()*(i+1));temp=this[i];this[i]=this[j];this[j]=temp;}
return this;}});Object.defineProperty(Array.prototype,'clone',{value:function(){return this.slice(0);}});Function.prototype.bind=Function.prototype.bind||function(object){var t=this;return function(){return t.apply(object,arguments);};};window.ig={main:null,debug:null,version:'1.23',global:window,modules:{},resources:[],ready:false,baked:false,nocache:'',ua:{},prefix:(window.ImpactPrefix||''),lib:'js/lib/',_current:null,_loadQueue:[],_waitForOnload:0,$:function(selector){return selector[0]=='#'?document.getElementById(selector.substr(1)):document.getElementsByTagName(selector);},$new:document.createElement.bind(document),copy:function(object){var c,i;if(!object||typeof(object)!='object'||object instanceof HTMLElement||object instanceof ig.Class){return object;}
else if(Array.isArray(object)){c=object.slice(0);for(i=0;i<c.length;i++){if(c[i]&&typeof(c[i])=='object'){c[i]=ig.copy(c[i]);}}
return c;}
else{c={};for(i in object){c[i]=ig.copy(object[i]);}
return c;}},merge:function(original,extended){for(var key in extended){var ext=extended[key];if(typeof(ext)!='object'||ext instanceof HTMLElement||ext instanceof ig.Class||ext===null){original[key]=ext;}
else{if(!original[key]||typeof(original[key])!='object'){original[key]=(ext instanceof Array)?[]:{};}
ig.merge(original[key],ext);}}
return original;},ksort:function(obj){if(!obj||typeof(obj)!='object'){return[];}
var keys=[],values=[];for(var k in obj){keys.push(k);}
keys.sort();for(var i=0;i<keys.length;i++){values.push(obj[keys[i]]);}
return values;},setVendorAttribute:function(el,attr,val){var uc=attr[0].toUpperCase()+attr.substr(1);el[attr]=val||el['ms'+uc]||el['moz'+uc]||el['webkit'+uc]||el['o'+uc];},getVendorAttribute:function(el,attr){var uc=attr[0].toUpperCase()+attr.substr(1);return el[attr]||el['ms'+uc]||el['moz'+uc]||el['webkit'+uc]||el['o'+uc];},normalizeVendorAttribute:function(el,attr){var prefixedVal=ig.getVendorAttribute(el,attr);if(!el[attr]&&prefixedVal){el[attr]=prefixedVal;}},module:function(name){if(ig._current){throw("Module '"+ig._current.name+"' defines nothing");}
if(ig.modules[name]&&ig.modules[name].body){throw("Module '"+name+"' is already defined");}
ig._current={name:name,requires:[],loaded:false,body:null};ig.modules[name]=ig._current;ig._loadQueue.push(ig._current);return ig;},requires:function(){ig._current.requires=Array.prototype.slice.call(arguments);return ig;},external:function(){var externalRequires=Array.prototype.slice.call(arguments);for(var i=0;i<externalRequires.length;i++){if(!ig.modules[name])ig._loadScript(externalRequires[i]);}
return ig;},defines:function(body){ig._current.body=body;ig._current=null;ig._initDOMReady();},addResource:function(resource){ig.resources.push(resource);},setNocache:function(set){ig.nocache=set?'?'+Date.now():'';},log:function(msg){if(this.debug&&window.console&&console.log){console.log(msg);}},assert:function(condition,msg){},show:function(name,number){},mark:function(msg,color){},_loadScript:function(name,requiredFrom){ig.modules[name]={name:name,requires:[],loaded:false,body:null};ig._waitForOnload++;var path=ig.prefix+ig.lib+name.replace(/\./g,'/')+'.js'+ig.nocache;var script=ig.$new('script');script.type='text/javascript';script.onload=function(){ig._waitForOnload--;ig._execModules();};script.onerror=function(){throw('Failed to load module '+name+' at '+path+' '+'required from '+requiredFrom);};script.src=path;ig.$('head')[0].appendChild(script);},_execModules:function(){var i,j,m,modulesLoaded=false;for(i=0;i<ig._loadQueue.length;i++){m=ig._loadQueue[i];var dependenciesLoaded=true;for(j=0;j<m.requires.length;j++){var name=m.requires[j];if(!ig.modules[name]){dependenciesLoaded=false;ig._loadScript(name,m.name);}
else if(!ig.modules[name].loaded){dependenciesLoaded=false;}}
if(dependenciesLoaded&&m.body){ig._loadQueue.splice(i,1);m.loaded=true;m.body();modulesLoaded=true;i--;}}
if(modulesLoaded){ig._execModules();}
else if(!ig.baked&&ig._waitForOnload===0&&ig._loadQueue.length!==0){var unresolved=[];for(i=0;i<ig._loadQueue.length;i++){var unloaded=[];var requires=ig._loadQueue[i].requires;for(j=0;j<requires.length;j++){m=ig.modules[requires[j]];if(!m||!m.loaded){unloaded.push(requires[j]);}}
unresolved.push(ig._loadQueue[i].name+' (requires: '+unloaded.join(', ')+')');}
throw('Unresolved (circular?) dependencies. '+"Most likely there's a name/path mismatch for one of the listed modules:\n"+
unresolved.join('\n'));}},_DOMReady:function(){if(!ig.modules['dom.ready'].loaded){if(!document.body){return setTimeout(ig._DOMReady,13);}
ig.modules['dom.ready'].loaded=true;ig._waitForOnload--;ig._execModules();}
return 0;},_boot:function(){if(document.location.href.match(/\?nocache/)){ig.setNocache(true);}
ig.ua.pixelRatio=window.devicePixelRatio||1;ig.ua.viewport={width:window.innerWidth,height:window.innerHeight};ig.ua.screen={width:window.screen.availWidth*ig.ua.pixelRatio,height:window.screen.availHeight*ig.ua.pixelRatio};ig.ua.small=!(window.innerWidth>=768&&window.innerHeight>=768);ig.ua.iPhone=/iPhone/i.test(navigator.userAgent);ig.ua.iPod=/iPod/i.test(navigator.userAgent);ig.ua.iPad=/iPad/i.test(navigator.userAgent);ig.ua.android=/android/i.test(navigator.userAgent);ig.ua.kindle=/Silk/i.test(navigator.userAgent);ig.ua.iOS=ig.ua.iPhone||ig.ua.iPad||ig.ua.iPod;ig.ua.mobile=ig.ua.iOS||ig.ua.android||ig.ua.winPhone||ig.ua.kindle||/mobile/i.test(navigator.userAgent);ig.ua.touchDevice=(('ontouchstart'in window)||(window.navigator.msMaxTouchPoints));},_initDOMReady:function(){if(ig.modules['dom.ready']){ig._execModules();return;}
ig._boot();ig.modules['dom.ready']={requires:[],loaded:false,body:null};ig._waitForOnload++;document.addEventListener('DOMContentLoaded',ig._DOMReady,false);window.addEventListener('load',ig._DOMReady,false);}};var initializing=false,fnTest=/xyz/.test(function(){xyz;})?/\bparent\b/:/.*/;window.ig.Class=function(){};var inject=function(prop){var proto=this.prototype;var parent={};for(var name in prop){if(typeof(prop[name])=="function"&&typeof(proto[name])=="function"&&fnTest.test(prop[name])){parent[name]=proto[name];proto[name]=(function(name,fn){return function(){this.parent=parent[name];return fn.apply(this,arguments);};})(name,prop[name]);}
else{proto[name]=prop[name];}}};window.ig.Class.extend=function(prop){var parent=this.prototype;initializing=true;var prototype=new this();initializing=false;for(var name in prop){if(typeof(prop[name])=="function"&&typeof(parent[name])=="function"&&fnTest.test(prop[name])){prototype[name]=(function(name,fn){return function(){this.parent=parent[name];return fn.apply(this,arguments);};})(name,prop[name]);}
else{prototype[name]=prop[name];}}
function Class(){if(!initializing){if(this.staticInstantiate){var obj=this.staticInstantiate.apply(this,arguments);if(obj){return obj;}}
for(var p in this){if(typeof(this[p])=='object'){this[p]=ig.copy(this[p]);}}
if(this.init){this.init.apply(this,arguments);}}
return this;}
Class.prototype=prototype;Class.prototype.constructor=Class;Class.extend=window.ig.Class.extend;Class.inject=inject;return Class;};})(window);

// lib/impact/system.js
ig.baked=true;ig.module('impact.system').defines(function(){"use strict";ig.System=ig.Class.extend({fps:30,width:320,height:240,tick:0,delegate:null,stage:null,init:function(fps,width,height){if(!window.createjs){throw("CreateJS is not included");}
this.resize(width,height);this.fps=fps;createjs.Ticker.timingMode=createjs.Ticker.RAF;createjs.Ticker.addEventListener("tick",this.run.bind(this));},addStage:function(stage){stage.canvas.width=this.width;stage.canvas.height=this.height;this.stage=stage;return stage;},resize:function(width,height){this.width=width;this.height=height;if(this.stage){this.stage.canvas.width=width;this.stage.canvas.height=height;this.stage.update();}},setGame:function(GameClass){ig.main=new(GameClass)();this.delegate=ig.main;},run:function(event){this.tick=event.delta/1000;if(this.delegate){this.delegate.update(event);ig.input.clearPressed();}
if(!this.stage.stopUpdate){this.stage.update(event);}}});});

// lib/impact/input.js
ig.baked=true;ig.module('impact.input').defines(function(){"use strict";ig.KEY={'MOUSE1':-1,'MOUSE2':-3,'MWHEEL_UP':-4,'MWHEEL_DOWN':-5,'BACKSPACE':8,'TAB':9,'ENTER':13,'PAUSE':19,'CAPS':20,'ESC':27,'SPACE':32,'PAGE_UP':33,'PAGE_DOWN':34,'END':35,'HOME':36,'LEFT_ARROW':37,'UP_ARROW':38,'RIGHT_ARROW':39,'DOWN_ARROW':40,'INSERT':45,'DELETE':46,'_0':48,'_1':49,'_2':50,'_3':51,'_4':52,'_5':53,'_6':54,'_7':55,'_8':56,'_9':57,'A':65,'B':66,'C':67,'D':68,'E':69,'F':70,'G':71,'H':72,'I':73,'J':74,'K':75,'L':76,'M':77,'N':78,'O':79,'P':80,'Q':81,'R':82,'S':83,'T':84,'U':85,'V':86,'W':87,'X':88,'Y':89,'Z':90,'NUMPAD_0':96,'NUMPAD_1':97,'NUMPAD_2':98,'NUMPAD_3':99,'NUMPAD_4':100,'NUMPAD_5':101,'NUMPAD_6':102,'NUMPAD_7':103,'NUMPAD_8':104,'NUMPAD_9':105,'MULTIPLY':106,'ADD':107,'SUBSTRACT':109,'DECIMAL':110,'DIVIDE':111,'F1':112,'F2':113,'F3':114,'F4':115,'F5':116,'F6':117,'F7':118,'F8':119,'F9':120,'F10':121,'F11':122,'F12':123,'SHIFT':16,'CTRL':17,'ALT':18,'PLUS':187,'COMMA':188,'MINUS':189,'PERIOD':190};ig.Input=ig.Class.extend({bindings:{},actions:{},presses:{},locks:{},delayedKeyup:{},isUsingMouse:false,isUsingKeyboard:false,mouse:{x:0,y:0},accel:{x:0,y:0,z:0},numTouches:0,initMouse:function(stage){if(this.isUsingMouse){return;}
this.isUsingMouse=true;stage.on("stagemousedown",this.keydown.bind(this));stage.on("stagemouseup",this.keyup.bind(this));stage.on("stagemousemove",this.mousemove.bind(this));},initKeyboard:function(){if(this.isUsingKeyboard){return;}
this.isUsingKeyboard=true;window.addEventListener('keydown',this.keydown.bind(this),false);window.addEventListener('keyup',this.keyup.bind(this),false);},mousemove:function(event){if(!event.primary){return;}
this.mouse.x=event.stageX;this.mouse.y=event.stageY;},keydown:function(event){var nativeEvent=event.nativeEvent||event;var tag=nativeEvent.target.tagName;if(tag=='INPUT'||tag=='TEXTAREA'){return;}
var code=nativeEvent.type=='keydown'?nativeEvent.keyCode:(nativeEvent.button==2?ig.KEY.MOUSE2:ig.KEY.MOUSE1);if(event.type=='stagemousedown'){if(nativeEvent.touches){this.numTouches=nativeEvent.touches.length;}
if(event.primary)
this.mousemove(event);else
return;}
var action=this.bindings[code];if(action){this.actions[action]=true;if(!this.locks[action]){this.presses[action]=true;this.locks[action]=true;}
if(code!==ig.KEY.MOUSE1&&code!==ig.KEY.MOUSE2){event.stopPropagation();event.preventDefault();}}},keyup:function(event){var nativeEvent=event.nativeEvent||event;var tag=nativeEvent.target.tagName;if(tag=='INPUT'||tag=='TEXTAREA'){return;}
var code=nativeEvent.type=='keyup'?nativeEvent.keyCode:(nativeEvent.button==2?ig.KEY.MOUSE2:ig.KEY.MOUSE1);if(nativeEvent.touches){this.numTouches=nativeEvent.touches.length;if(!event.primary){return;}}
var action=this.bindings[code];if(action){this.delayedKeyup[action]=true;if(code!==ig.KEY.MOUSE1&&code!==ig.KEY.MOUSE2){event.stopPropagation();event.preventDefault();}}},bind:function(key,action){if(key<0){this.initMouse();}
else if(key>0){this.initKeyboard();}
this.bindings[key]=action;},unbind:function(key){var action=this.bindings[key];this.delayedKeyup[action]=true;this.bindings[key]=null;},unbindAll:function(){this.bindings={};this.actions={};this.presses={};this.locks={};this.delayedKeyup={};},state:function(action){return this.actions[action];},pressed:function(action){return this.presses[action];},released:function(action){return!!this.delayedKeyup[action];},clearPressed:function(){for(var action in this.delayedKeyup){this.actions[action]=false;this.locks[action]=false;}
this.delayedKeyup={};this.presses={};}});});

// lib/impact/impact.js
ig.baked=true;ig.module('impact.impact').requires('dom.ready','impact.system','impact.input').defines(function(){"use strict";ig.main=function(gameClass,fps,width,height){ig.system=new ig.System(fps,width,height);ig.input=new ig.Input();ig.ready=true;ig.system.setGame(gameClass);};});

// lib/impact/entity.js
ig.baked=true;ig.module('impact.entity').requires('impact.impact').defines(function(){"use strict";ig.Entity=ig.Class.extend({id:0,settings:{},size:{x:16,y:16,dx:0,dy:0},offset:{x:0,y:0},pos:{x:0,y:0},last:{x:0,y:0},vel:{x:0,y:0},accel:{x:0,y:0},friction:{x:0,y:0},maxVel:{x:1000,y:1000},gravityFactor:0,standing:false,bounciness:0,minBounceVelocity:40,onGround:false,type:0,checkAgainst:0,collides:0,_killed:false,active:true,world:null,container:null,_debugShape:null,_displayObject:null,_active:false,slopeStanding:{min:Math.toRad(44),max:Math.toRad(136)},init:function(x,y,settings){this.id=++ig.Entity._lastId;this.pos.x=this.last.x=x;this.pos.y=this.last.y=y;this.world=settings.world;this.container=settings.container;settings.world=null;settings.container=null;delete settings.world;delete settings.container;ig.merge(this,settings);this.size.dx=this.size.dx||this.size.x;this.size.dy=this.size.dy||this.size.y;if(this.world._debugDraw){this._debugShape=new cjs.Shape();this._debugShape.graphics.s("#F00").r(0,0,this.size.x,this.size.y);ig.LAYERS.DEBUG.addChild(this._debugShape);}
this._active=true;},reset:function(x,y,settings){var proto=this.constructor.prototype;this.pos.x=x;this.pos.y=y;this.last.x=x;this.last.y=y;this.vel.x=proto.vel.x;this.vel.y=proto.vel.y;this.accel.x=proto.accel.x;this.accel.y=proto.accel.y;this.health=proto.health;this._killed=proto._killed;this.standing=proto.standing;this.type=proto.type;this.checkAgainst=proto.checkAgainst;this.collides=proto.collides;ig.merge(this,settings);},onAdded:function(){},update:function(){this.last.x=this.pos.x;this.last.y=this.pos.y;this.vel.y+=this.world.gravity*ig.system.tick*this.gravityFactor;this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x);this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);var mx=this.vel.x*ig.system.tick;var my=this.vel.y*ig.system.tick;this.handleMovement(this.pos.x,this.pos.y,mx,my,this.size.x,this.size.y);},draw:function(){if(this._displayObject){this._displayObject.x=this.pos.x;this._displayObject.y=this.pos.y;this.checkVisibility();if(this.world._debugDraw){var globalPoint=this._displayObject.localToGlobal(this._displayObject.regX,this._displayObject.regY);this._debugShape.graphics.c().s("#F00").r(0,0,this.size.x,this.size.y);this._debugShape.x=globalPoint.x;this._debugShape.y=globalPoint.y;this._debugShape.visible=this._displayObject.visible;}}},setActive:function(active){this._active=active;},checkVisibility:function(){if(!this._displayObject.parent)
return;if(!this._active){this._displayObject.active=false;}
if(this._displayObject.x-this._displayObject.regX+this._displayObject.parent.x>ig.system.width||this._displayObject.x-this._displayObject.regX+this.size.dx+this._displayObject.parent.x<0){this._displayObject.visible=false;}else{this._displayObject.visible=true;}},getNewVelocity:function(vel,accel,friction,max){if(accel){return Math.limit(vel+accel*ig.system.tick,-max,max);}
else if(friction){var delta=friction*ig.system.tick;if(vel-delta>0){return vel-delta;}
else if(vel+delta<0){return vel+delta;}
else{return 0;}}
return Math.limit(vel,-max,max);},handleMovement:function(x,y,vx,vy){var yCollision=false;var xCollision=false;this.standing=false;this.pos.x=x+vx;if(y+this.size.y+vy>this.world.groundY){this.pos.y=this.world.groundY-this.size.y;yCollision=true;}else{this.pos.y=y+vy;}
if(yCollision){if(this.bounciness>0&&Math.abs(this.vel.y)>this.minBounceVelocity){this.vel.y*=-this.bounciness;}
else{if(this.vel.y>0){this.standing=true;}
this.vel.y=0;}}
if(xCollision){if(this.bounciness>0&&Math.abs(this.vel.x)>this.minBounceVelocity){this.vel.x*=-this.bounciness;}
else{this.vel.x=0;}}
this.onGround=this.standing;},kill:function(){this.world.removeEntity(this);},touches:function(other){return!(this.pos.x>=other.pos.x+other.size.x||this.pos.x+this.size.x<=other.pos.x||this.pos.y>=other.pos.y+other.size.y||this.pos.y+this.size.y<=other.pos.y);},distanceTo:function(other){var xd=(this.pos.x+this.size.x/2)-(other.pos.x+other.size.x/2);var yd=(this.pos.y+this.size.y/2)-(other.pos.y+other.size.y/2);return Math.sqrt(xd*xd+yd*yd);},angleTo:function(other){return Math.atan2((other.pos.y+other.size.y/2)-(this.pos.y+this.size.y/2),(other.pos.x+other.size.x/2)-(this.pos.x+this.size.x/2));},check:function(other){},collideWith:function(other,axis){},ready:function(){},erase:function(){}});ig.Entity._lastId=0;ig.Entity.COLLIDES={NEVER:0,LITE:1,PASSIVE:2,ACTIVE:4,FIXED:8};ig.Entity.TYPE={NONE:0,A:1,B:2,BOTH:3};ig.Entity.checkPair=function(a,b){if(a.checkAgainst&b.type){a.check(b);}
if(b.checkAgainst&a.type){b.check(a);}
if(a.collides&&b.collides&&a.collides+b.collides>ig.Entity.COLLIDES.ACTIVE){ig.Entity.solveCollision(a,b);}};ig.Entity.solveCollision=function(a,b){var weak=null;if(a.collides==ig.Entity.COLLIDES.LITE||b.collides==ig.Entity.COLLIDES.FIXED){weak=a;}
else if(b.collides==ig.Entity.COLLIDES.LITE||a.collides==ig.Entity.COLLIDES.FIXED){weak=b;}
if(a.last.x+a.size.x>b.last.x&&a.last.x<b.last.x+b.size.x){if(a.last.y<b.last.y){ig.Entity.seperateOnYAxis(a,b,weak);}
else{ig.Entity.seperateOnYAxis(b,a,weak);}
a.collideWith(b,'y');b.collideWith(a,'y');}
else if(a.last.y+a.size.y>b.last.y&&a.last.y<b.last.y+b.size.y){if(a.last.x<b.last.x){ig.Entity.seperateOnXAxis(a,b,weak);}
else{ig.Entity.seperateOnXAxis(b,a,weak);}
a.collideWith(b,'x');b.collideWith(a,'x');}};ig.Entity.seperateOnXAxis=function(left,right,weak){var nudge=(left.pos.x+left.size.x-right.pos.x);if(weak){var strong=left===weak?right:left;weak.vel.x=-weak.vel.x*weak.bounciness+strong.vel.x;weak.pos.x+=weak==left?-nudge:nudge;}
else{var v2=(left.vel.x-right.vel.x)/2;left.vel.x=-v2;right.vel.x=v2;left.pos.x=Math.floor(left.pos.x-nudge/2);right.pos.x=Math.ceil(right.pos.x+nudge/2);}};ig.Entity.seperateOnYAxis=function(top,bottom,weak){var nudge=(top.pos.y+top.size.y-bottom.pos.y);var world=top.world;var nudgeX=0;if(weak){var strong=top===weak?bottom:top;weak.vel.y=-weak.vel.y*weak.bounciness+strong.vel.y;if(weak==top&&Math.abs(weak.vel.y-strong.vel.y)<weak.minBounceVelocity){weak.standing=true;nudgeX=strong.vel.x*ig.system.tick;}
weak.pos.y+=weak==top?-nudge:nudge;weak.pos.x+=nudgeX;}
else if(world.gravity&&(bottom.standing||top.vel.y>0)){top.pos.y+=-(top.pos.y+top.size.y-bottom.pos.y);if(top.bounciness>0&&top.vel.y>top.minBounceVelocity){top.vel.y*=-top.bounciness;}
else{top.standing=true;top.vel.y=0;}}
else{var v2=(top.vel.y-bottom.vel.y)/2;top.vel.y=-v2;bottom.vel.y=v2;nudgeX=bottom.vel.x*ig.system.tick;top.pos.y+=-nudge/2;bottom.pos.y+=nudge/2;}};});

// lib/impact/world.js
ig.baked=true;ig.module('impact.world').requires('impact.impact','impact.entity').defines(function(){"use strict";ig.World=ig.Class.extend({_debugDraw:false,gravity:0,player:null,groundY:9999,entities:[],namedEntities:{},_deferredKill:[],ready:false,init:function(settings){ig.merge(this,settings);this.createWorld();},createWorld:function(){},spawnEntity:function(type,container,x,y,settings){var EntityClass=typeof(type)==='string'?ig.global[type]:type;if(!EntityClass){throw("Can't spawn entity of type "+type);}
settings=settings||{};settings.container=container;settings.world=this;var ent=new(EntityClass)(x,y,settings);this.entities.push(ent);if(ent.name){this.namedEntities[ent.name]=ent;}
container.addChild(ent._displayObject);ent.onAdded();return ent;},removeEntity:function(ent){if(ent.name){delete this.namedEntities[ent.name];}
if(ent.container){ent.container.removeChild(ent._displayObject);}
if(this._debugDraw&&ent._debugShape){ig.LAYERS.DEBUG.removeChild(ent._debugShape);}
ent._killed=true;ent.type=ig.Entity.TYPE.NONE;ent.checkAgainst=ig.Entity.TYPE.NONE;ent.collides=ig.Entity.COLLIDES.NEVER;this._deferredKill.push(ent);},update:function(){this.updateEntities();this.checkEntities();var n=this._deferredKill.length;if(n){for(var i=0;i<n;i++){this._deferredKill[i].erase();this.entities.erase(this._deferredKill[i]);}
this._deferredKill.length=0;}
this.drawEntities();this.ready=true;},updateEntities:function(){var l=this.entities.length;for(var i=0;i<l;i++){var ent=this.entities[i];if(!ent._killed&&ent._active){ent.update();}}},drawEntities:function(){var l=this.entities.length;for(var i=0;i<l;i++){var ent=this.entities[i];ent.draw();}},checkEntities:function(){var l=this.entities.length;for(var i=0;i<l;i++){var e=this.entities[i];if(e._displayObject&&!e._displayObject.visible){continue;}
var noah=ig.main.game.noah;var nell=ig.main.game.nell;var brisa=ig.main.game.brisa;if(e!==noah&&e!==nell&&e!==brisa){if(noah.touches(e)){ig.Entity.checkPair(noah,e);}
if(nell.touches(e)){ig.Entity.checkPair(nell,e);}
if(brisa.touches(e)){ig.Entity.checkPair(brisa,e);}}}},kill:function(){ig.LAYERS.GAME.removeAllChildren();if(this._debugDraw){ig.LAYERS.DEBUG.removeAllChildren();}}});});

// lib/game/entities/character.js
ig.baked=true;ig.module('game.entities.character').requires('impact.entity','impact.world').defines(function(){ig.Character=ig.Entity.extend({characterName:"default",_wasVisible:false,_active:true,_targetX:0,_onDestinationHandler:null,_currentAnimation:"",_currentAction:"",_interactionWaiting:false,speechBubble:false,speechBubbleOffset:{x:0,y:0},isTalking:false,usesPhysics:false,autoPilot:false,gotoX:function(x,onComplete){this._onDestinationHandler=onComplete;this._targetX=x;},setActive:function(active){this._targetX=0;this._displayObject.visible=active;this._active=active;},update:function(){if(!this._active||!this.world.ready)
return;if(this.usesPhysics){if(this._targetX!==0){this.moveTowardsTarget();}
if(this.autoPilot){this.checkForObstacles();}
this.parent();}
this.updateBubble();this.isTalking=this.characterName===ig.VO.character;if(this._wasVisible!==this._displayObject.visible){if(this._displayObject.visible){this.onVisible();}else{this.onHidden();}
this._wasVisible=this._displayObject.visible;}},draw:function(){if(this._active){this.parent();}},onVisible:function(){},onHidden:function(){},action:function(action,waiting){this._currentAction=action;this._interactionWaiting=!!waiting;},onActionEnd:function(action){},onActionComplete:function(){this.onActionEnd(this._currentAction);this._currentAction="";if(this._interactionWaiting){ig.InteractionControl.next();}},moveTowardsTarget:function(){var tx=this._targetX;var px=this.pos.x;this.vel.x=tx>px?this.maxVel.x:-this.maxVel.x;var vx=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x);vx*=ig.system.tick;if((vx>0&&px+vx>tx)||(vx<0&&px+vx<tx)){this.pos.x=tx;this.vel.x=0;this._targetX=0;if(this._onDestinationHandler){this._onDestinationHandler();this._onDestinationHandler=null;}}},checkForObstacles:function(){var wouldBeVelX=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x);if(wouldBeVelX===0||!this.standing){return;}
var sx=this.size.x;var ox=this.pos.x;var d=(Math.abs(wouldBeVelX)/this.maxVel.x)*150;this.size.x+=d+1;if(wouldBeVelX<0){this.pos.x-=d-2;}
var ents=this.world.entities;var l=ents.length;for(var i=0;i<l;i++){var e=ents[i];if(!e.isObstacle){continue;}
if(this.touches(e)){this.jump();break;}}
this.pos.x=ox;this.size.x=sx;},updateBubble:function(){var b=this.speechBubble;if(b){var bubble,tail,bb;if(this.pos.x+this._displayObject.parent.x<ig.system.width*0.5){b.x=this.speechBubbleOffset.r;if(b.side!=="R"){b.side="R";tail=b.getChildAt(0);bubble=b.getChildAt(1);bb=bubble.getBounds();tail.scaleX=1;bubble.regX=6;bubble.regY=bb.height+36;}}else{b.x=this.speechBubbleOffset.l;if(b.side!=="L"){b.side="L";tail=b.getChildAt(0);bubble=b.getChildAt(1);bb=bubble.getBounds();tail.scaleX=-1;bubble.regX=bb.width;bubble.regY=bb.height+36;}}
b.y=this.speechBubbleOffset.y;if(!b.alert){b.x+=this._displayObject.x;b.y+=this._displayObject.y;}}},showBubble:function(string){if(this.speechBubble){this.returnBubble(this.speechBubble);}
this.speechBubble=ig.SpeechBubblePool.get(string);this.speechBubble.set({scaleX:0,scaleY:0,visible:true});if(this.speechBubble.alert){this._displayObject.addChild(this.speechBubble);}else{this.world.bubbles.addChild(this.speechBubble);}
this.updateBubble();cjs.Tween.get(this.speechBubble).to({scaleX:1,scaleY:1},250,cjs.Ease.cubicOut);},hideBubble:function(){var bubble=this.speechBubble;if(bubble){cjs.Tween.get(bubble).to({scaleX:0,scaleY:0},200,cjs.Ease.cubicIn).set({speechBubble:false},this).call(this.returnBubble,[bubble],this);}},returnBubble:function(bubble){if(bubble.parent)
bubble.parent.removeChild(bubble);ig.SpeechBubblePool.put(bubble);}});});

// lib/game/entities/peq.js
ig.baked=true;ig.module('game.entities.peq').requires('game.entities.character').defines(function(){ig.Peq=ig.Character.extend({gravityFactor:0,size:{x:70,y:94},speechBubbleOffset:{l:-10,r:80,y:-10},_onDraw:null,hasDrawn:false,init:function(x,y,settings){this.parent(x,y,settings);this._displayObject=new cjs.Container().set({mouseChildren:false,isPeq:true,ent:this});this._peq=new cjs.Sprite(ig.Sheets.lib.peq,"idle").set({regX:140,regY:200});this._displayObject.addChild(this._peq);this.bounds=this._displayObject.getBounds();},reset:function(){this._displayObject.mouseEnabled=true;this._peq.gotoAndStop("idle");if(this.drawing){this._displayObject.removeChild(this.drawing);}},showUpAt:function(spot){this.reset();this.setActive(true);this.pos.x=spot.x-this.size.x*0.5;this.pos.y=spot.y-this.size.y;this.draw();},action:function(action,waiting){this.parent(action,waiting);switch(action){case"faceNoah":this.hideBubble();this.onActionComplete();break;case"drawQuestObject":this.drawImage();break;}},onVisible:function(){if(this.hasDrawn)
return;if(!ig.Session.tutorials.CHARACTER){ig.Session.tutorials.CHARACTER=true;ig.Tutorials.character=this;ig.Tutorials.start("character");}
this.showBubble("!");},onHidden:function(){this.hideBubble();},drawImage:function(){this.hasDrawn=true;this._displayObject.mouseChildren=this._displayObject.mouseEnabled=false;this._peq.gotoAndPlay("draw");this._peq.on("animationend",this.onAnimComplete,this);this.drawing=new cjs.Sprite(ig.Sheets.lib["object"+ig.Session.activeObject.id],"sketch-peq");this.drawing.set({x:-135,y:-140,visible:false});this._displayObject.addChild(this.drawing);ig.Session.activeObject.status=ig.Session.OBJECT_STATUS.SKETCHED;ig.main.game.ui.updatePack();cjs.Tween.get(this).wait(2800).call(this.onActionComplete,null,this);},checkVisibility:function(){if(!this._displayObject.parent)
return;if(!this._active){this._displayObject.active=false;}
if(this._displayObject.x+this.bounds.x+this._displayObject.parent.x>ig.system.width||this._displayObject.x+this.bounds.x+this.bounds.width+this._displayObject.parent.x<0){this._displayObject.visible=false;}else{this._displayObject.visible=true;}},onAnimComplete:function(e){e.remove();cjs.Sound.play("sfx_peqtada");this.drawing.visible=true;},update:function(){this.parent();}});});

// lib/game/entities/noah.js
ig.baked=true;ig.module('game.entities.noah').requires('game.entities.character').defines(function(){ig.Noah=ig.Character.extend({characterName:"noah",speed:1000,gravityFactor:1,size:{x:60,y:130},maxVel:{x:500,y:1000},friction:{x:1000,y:0},type:ig.Entity.TYPE.A,checkAgainst:ig.Entity.TYPE.B,collides:ig.Entity.COLLIDES.ACTIVE,usesPhysics:true,yTimer:0,lastMouseY:0,wasOffGround:false,cameraOffset:500,cameraFollow:true,dScaleX:1,speechBubbleOffset:{l:-29,r:90,y:-102},distanceTraveled:0,numJumps:0,controlsActive:true,autoPilot:false,otherCharacter:null,jumpSound:null,landSound:null,init:function(x,y,settings){this.parent(x,y,settings);this.initSprites();this.jumpSound=cjs.Sound.createInstance("sfx_whoosh");this.landSound=cjs.Sound.createInstance("sfx_thud");},setActive:function(toggle){this.active=toggle;},initSprites:function(){this._displayObject=new cjs.Container().set({mouseChildren:false,mouseEnabled:false,ent:this});this._bodySprite=new cjs.Sprite(ig.Sheets.lib.noah,"run").set({regY:104});this._mouthSprite=new cjs.Sprite(ig.Sheets.lib.noahMouth,"run").set({regY:104});this._displayObject.addChild(this._bodySprite,this._mouthSprite);this.size.dx=239;},updateSprite:function(anim){if(this._currentAnimation!==anim){this._bodySprite.gotoAndPlay(anim);this._mouthSprite.gotoAndPlay(anim);}
this._currentAnimation=anim;this._bodySprite.scaleX=this._mouthSprite.scaleX=this.dScaleX;this._bodySprite.regX=this._mouthSprite.regX=this.dScaleX<0?118:58;},update:function(){var sx=this.pos.x;this.parent();this.distanceTraveled+=Math.abs(this.pos.x-sx);if(this.onPlatform){this.standing=this.onPlatform;}
this.onPlatform=false;if(this.active&&!ig.InteractionControl.active&&!this.world.isDistractor&&!ig.main.game.ui.isBlocking){if(ig.ua.mobile){this.handleMobileControls();}else{this.handleDesktopControls();}
if(this.pos.x<0){this.pos.x=0;}
if(ig.Tutorials.active&&ig.Tutorials._tutorialType==="main"){if(this.pos.x>ig.system.width-100){this.pos.x=ig.system.width-100;}}}else{this.accel.x=0;}
if(this.vel.x!==0){this.dScaleX=this.vel.x>0?1:-1;}
if(this.cameraFollow){this.cameraOffset=this.dScaleX>0?440-this.world.levelStartX:ig.system.width-(500-this.world.levelStartX);}
if(this.wasOffGround&&this.standing&&this.active){this.landSound.play({volume:0.2});}
this.wasOffGround=!this.standing;if(!this.standing){this.updateSprite("jump");}else if(this.vel.x!==0){this.updateSprite(this.isTalking?"run_blab":"run");}else if(this.world.isDistractor){this.updateSprite(this.isTalking?"scaredblab":"scared");}else if(ig.InteractionControl.active){if(ig.InteractionControl.character&&ig.InteractionControl.character.characterName==="coco"){this.updateSprite(this.isTalking?"blab":"engagedlow");}else{this.updateSprite(this.isTalking?"blab":"engaged");}}else{this.updateSprite(this.isTalking?"blab":"idle");}},jump:function(){this.numJumps++;this.jumpSound.play({volume:0.2});this.pos.y-=5;this.vel.y=-800;},action:function(action,waiting){this.parent(action,waiting);var tx;var complete=this.onActionComplete.bind(this);switch(action){case"gotoStartPos":tx=430;break;case"gotoNeighbor":this.otherCharacter=ig.main.game.neighbor;tx=this.otherCharacter.pos.x>this.pos.x?this.otherCharacter.pos.x-400:this.otherCharacter.pos.x+400;break;case"gotoBrisa":this.otherCharacter=ig.main.game.brisa;tx=this.otherCharacter.pos.x>this.pos.x?this.otherCharacter.pos.x-400:this.otherCharacter.pos.x+400;break;case"gotoPeq":this.otherCharacter=ig.main.game.peq;tx=this.otherCharacter.pos.x>this.pos.x?this.otherCharacter.pos.x-400:this.otherCharacter.pos.x+400;break;case"gotoFarmer":this.otherCharacter=ig.main.game.farmer;tx=this.world.miniGameX+430;break;case"gotoArtGirl":this.otherCharacter=ig.main.game.artgirl;tx=this.world.miniGameX+430;break;}
if(tx){this.autoPilot=true;this.gotoX(tx,complete);}},onActionEnd:function(action){this.autoPilot=false;if(this.otherCharacter){this.dScaleX=this.otherCharacter.pos.x>this.pos.x?1:-1;this.otherCharacter=null;}},handleMobileControls:function(){var playerScreenX=this.pos.x+this.size.x/2+this._displayObject.parent.x;var distance=Math.abs(playerScreenX-ig.input.mouse.x);if(ig.input.state("mouse")){this.yTimer+=ig.system.tick;if(this.standing&&this.lastMouseY>ig.input.mouse.y&&this.lastMouseY-ig.input.mouse.y>30){this.jump();}
if(this.yTimer>0.4||ig.input.mouse.y>this.lastMouseY){this.lastMouseY=ig.input.mouse.y;this.yTimer=0;}
if(distance>20){var ms=distance/240*this.speed;if(ms>this.maxVel.x){ms=this.maxVel.x;}
if(ig.input.mouse.x<playerScreenX){this.vel.x=-ms;}else if(ig.input.mouse.x>playerScreenX){this.vel.x=ms;}}else{this.accel.x=0;}}else{this.accel.x=0;this.lastMouseY=0;this.yTimer=0;}},handleDesktopControls:function(){if(ig.input.state('up')&&this.standing){this.jump();}
if(ig.input.state('right')){this.accel.x=this.speed;if(this.vel.x<0){this.vel.x*=-1;}}else if(ig.input.state('left')){this.accel.x=-this.speed;if(this.vel.x>0){this.vel.x*=-1;}}else{this.accel.x=0;}},collideWith:function(other,axis){if(axis==='y'&&this.pos.y+this.size.y<=other.pos.y){this.onPlatform=true;}}});});

// lib/game/entities/nell.js
ig.baked=true;ig.module('game.entities.nell').requires('game.entities.character').defines(function(){ig.Nell=ig.Character.extend({characterName:"nell",speed:2000,gravityFactor:1,size:{x:60,y:130},maxVel:{x:500,y:1000},friction:{x:1000,y:0},collides:ig.Entity.COLLIDES.ACTIVE,usesPhysics:true,dScaleX:1,speechBubbleOffset:{l:-29,r:90,y:-102},bubbleCountDown:-100,autoPilot:true,init:function(x,y,settings){this.parent(x,y,settings);this.initSprites();},initSprites:function(){this._displayObject=new cjs.Container().set({mouseChildren:false,mouseEnabled:false,ent:this});this._bodySprite=new cjs.Sprite(ig.Sheets.lib.nell,"run").set({regY:106});this._mouthSprite=new cjs.Sprite(ig.Sheets.lib.nellMouth,"run").set({regY:106});this._displayObject.addChild(this._bodySprite,this._mouthSprite);this.size.dx=151;},updateSprite:function(anim){if(this._currentAnimation!==anim){this._bodySprite.gotoAndPlay(anim);this._mouthSprite.gotoAndPlay(anim);}
this._currentAnimation=anim;this._bodySprite.scaleX=this._mouthSprite.scaleX=this.dScaleX;this._bodySprite.regX=this._mouthSprite.regX=this._bodySprite.scaleX<0?118:58;},update:function(){this.moveToNoahSide();this.checkForObstacles();this.parent();if(this.onPlatform){this.standing=this.onPlatform;}
this.onPlatform=false;if(this.bubbleCountDown>0){this.bubbleCountDown-=ig.system.tick;}else if(this.bubbleCountDown>-10){this.bubbleCountDown=-100;this.hideBubble();}
if(this.vel.x>0){this.dScaleX=1;}else if(this.vel.x<0){this.dScaleX=-1;}else{this.dScaleX=this.pos.x<ig.main.game.noah.pos.x?1:-1;}
if(!this.standing){this.updateSprite("jump");}else if(this.vel.x!==0){this.updateSprite(this.isTalking?"run_blab":"run");}else if(this.world.isDistractor){this.updateSprite(this.isTalking?"scaredblab":"scared");}else{this.updateSprite(this.isTalking?"blab":"idle");}},moveToNoahSide:function(){var nx=ig.main.game.noah.pos.x;var tx=ig.main.game.noah.dScaleX>0?nx-160:nx+160;var diff=tx-this.pos.x;diff=Math.limit(diff,-100,100);this.maxVel.x=500*(Math.abs(diff)/100)+100;if(Math.abs(diff)>10){this.accel.x=diff>0?this.speed:-this.speed;}else{this.accel.x=0;this.vel.x*=0.6;}},showTimedBubble:function(str){this.showBubble(str);this.bubbleCountDown=4;},showBubble:function(str){this.parent(str);this.bubbleCountDown=-100;},jump:function(){this.pos.y-=5;this.vel.y=-800;},collideWith:function(other,axis){if(axis==='y'&&this.pos.y+this.size.y<=other.pos.y){this.onPlatform=true;}}});});

// lib/game/entities/coco.js
ig.baked=true;ig.module('game.entities.coco').requires('game.entities.character').defines(function(){ig.Coco=ig.Character.extend({characterName:"coco",gravityFactor:1,size:{x:40,y:71},maxVel:{x:400,y:1000},friction:{x:1000,y:0},speechBubbleOffset:{l:-50,r:75,y:-72},usesPhysics:true,init:function(x,y,settings){this.parent(x,y,settings);this.initSprites();},initSprites:function(){this._displayObject=new cjs.Container().set({mouseChildren:false,mouseEnabled:false,ent:this});this._sprite=new cjs.Sprite(ig.Sheets.lib.coco,"run").set({regY:100});this._displayObject.addChild(this._sprite);this.size.dx=154;},updateSprite:function(anim){if(this._currentAnimation!==anim){this._sprite.gotoAndPlay(anim);}
this._currentAnimation=anim;this._sprite.regX=this._sprite.scaleX<0?115:70;},action:function(action,waiting){this.parent(action,waiting);this.setActive(true);var tx;var complete=this.onActionComplete.bind(this);switch(action){case"gotoStartPos":tx=900;break;case"moveUp":tx=700;break;case"disappearRight":tx=this.world.cameraX+ig.system.width+100;break;}
if(tx){this.gotoX(tx,complete);}},onActionEnd:function(action){switch(action){case"gotoStartPos":case"moveUp":this._sprite.scaleX=-1;break;case"disappearRight":this.setActive(false);break;}},update:function(){this.parent();this._sprite.scaleX=this.vel.x>0?1:-1;if(!this.standing){this.updateSprite("jump");}else if(this.vel.x!==0){this.updateSprite("run");}else{this.updateSprite(this.isTalking?"blab":"idle");}}});});

// lib/game/entities/brisa.js
ig.baked=true;ig.module('game.entities.brisa').requires('game.entities.character').defines(function(){ig.Brisa=ig.Character.extend({characterName:"brisa",gravityFactor:1,size:{x:60,y:130},maxVel:{x:500,y:1000},friction:{x:1000,y:0},collides:ig.Entity.COLLIDES.ACTIVE,speechBubbleOffset:{l:-10,r:90,y:-96},inRun:false,usesPhysics:true,timeRunning:0,timeRestLeft:0,autoPilot:true,isInIntro:false,init:function(x,y,settings){this.parent(x,y,settings);this.initSprites();},initSprites:function(){this._displayObject=new cjs.Container().set({mouseChildren:false,isBrisa:true,ent:this});this._sprite=new cjs.Sprite(ig.Sheets.lib.brisa,"run").set({regY:140});this._displayObject.addChild(this._sprite);this.size.dx=178;},onVisible:function(){if(this.isInIntro)
return;if(!ig.Session.tutorials.CHARACTER){ig.Session.tutorials.CHARACTER=true;ig.Tutorials.character=this;ig.Tutorials.start("character");}
this.showBubble("!");},onHidden:function(){this.hideBubble();},action:function(action,waiting){this.parent(action,waiting);this.setActive(true);var tx;var complete=this.onActionComplete.bind(this);switch(action){case"gotoStartPos":tx=1050;break;case"disappearRight":this.isInIntro=false;tx=this.world.cameraX+ig.system.width+100;break;case"faceNoah":this.hideBubble();this.inRun=false;this.vel.x=0;this.update();this._sprite.scaleX=ig.main.game.noah.pos.x>this.pos.x?1:-1;this.onActionComplete();break;case"translate":ig.Session.activeObject.status=ig.Session.OBJECT_STATUS.TRANSLATED;ig.main.game.ui.updatePack();this.onActionComplete();break;case"continueRun":this.timeRestLeft=0;this.inRun=true;this.vel.x=-this.maxVel.x;this.onActionComplete();break;}
if(tx){this.gotoX(tx,complete);}},onActionEnd:function(action){switch(action){case"gotoStartPos":case"moveUp":this._sprite.scaleX=-1;break;case"disappearRight":this.setActive(false);break;}},setInactive:function(){this.setActive(false);},doRun:function(){this.hideBubble();this.setActive(true);this.inRun=true;this.pos.x=this.world.levelEndX-200;this.draw();this.maxVel.x=300;this.vel.x=-this.maxVel.x;},updateSprite:function(anim){if(this._currentAnimation!==anim){this._sprite.gotoAndPlay(anim);}
this._currentAnimation=anim;this._sprite.regX=this._sprite.scaleX<0?148:92;},update:function(){if(ig.InteractionControl.active&&this.inRun&&!this._displayObject.visible){return;}
this.checkForObstacles();this.parent();if(this.onPlatform){this.standing=this.onPlatform;}
this.onPlatform=false;var d=this._sprite;if(this.vel.x!==0){d.scaleX=this.vel.x>0?1:-1;}
if(!this.standing){this.updateSprite("jump");}else if(this.vel.x!==0){this.updateSprite("run");}else{this.updateSprite(this.isTalking?"blab":"idle");}
if(this.inRun){if(this.pos.x<-100){this.inRun=false;this.vel.x=0;this.setActive(false);}else if(this.timeRestLeft<=0){this.timeRunning+=ig.system.tick;this.vel.x=-this.maxVel.x;}else{this.timeRestLeft-=ig.system.tick;}
if(this.timeRunning>10&&this.pos.y>425){this.timeRunning=0;this.timeRestLeft=6;}}},jump:function(){this.pos.y-=5;this.vel.y=-800;},collideWith:function(other,axis){if(axis==='y'&&this.pos.y+this.size.y<=other.pos.y){this.onPlatform=true;}}});});

// lib/game/entities/artgirl.js
ig.baked=true;ig.module('game.entities.artgirl').requires('game.entities.character').defines(function(){ig.ArtGirl=ig.Character.extend({characterName:"artgirl",gravityFactor:0,speechBubbleOffset:{l:-65,r:65,y:-185},init:function(x,y,settings){this.parent(x,y,settings);this._displayObject=new cjs.Container().set({mouseChildren:false,isArtGirl:true,ent:this});this.sprite=new cjs.Sprite(ig.Sheets.lib.artGirl,"idle").set({regX:108,regY:192,scaleX:-1});this._displayObject.addChild(this.sprite);var mcBounds=this.sprite.getBounds();this.bounds=mcBounds;},updateMovieclip:function(anim){if(this._currentAnimation!==anim){this.sprite.gotoAndPlay(anim);}
this._currentAnimation=anim;},onHidden:function(){this.hideBubble();},checkVisibility:function(){if(!this._displayObject.parent)
return;if(!this._active){this._displayObject.active=false;}
if(this._displayObject.x+this.bounds.x+this._displayObject.parent.x>ig.system.width||this._displayObject.x+this.bounds.x+this.bounds.width+100+this._displayObject.parent.x<0){this._displayObject.visible=false;}else{this._displayObject.visible=true;}},update:function(){this.parent();this.updateMovieclip(this.isTalking?"blab":"idle");}});});

// lib/game/entities/neighbor.js
ig.baked=true;ig.module('game.entities.neighbor').requires('game.entities.character').defines(function(){ig.Neighbor=ig.Character.extend({characterName:"neighbor",gravityFactor:0,speechBubbleOffset:{l:-10,r:90,y:-100},isNeighbor:true,init:function(x,y,settings){this.data=settings.data;settings.data=null;delete settings.data;this.parent(x,y,settings);this.initSprites();},initSprites:function(){this._displayObject=new cjs.Container().set({mouseChildren:false,isNeighbor:true,cursor:"pointer",ent:this});this.characterName=this.data.id;switch(this.data.id){case"neighborA":this.mouth=new cjs.Sprite(ig.Sheets.lib.neighborAMouth,"idle");this.body=new cjs.Sprite(ig.Sheets.lib.neighborABody,"idle");this.body.regX=this.mouth.regX=84;this.body.regY=this.mouth.regY=170;this.speechBubbleOffset.l=-70;this.speechBubbleOffset.r=70;this.speechBubbleOffset.y=-160;break;case"neighborB":this.mouth=new cjs.Sprite(ig.Sheets.lib.neighborBMouth,"idle");this.body=new cjs.Sprite(ig.Sheets.lib.neighborBBody,"idle");this.body.regX=this.mouth.regX=67;this.body.regY=this.mouth.regY=174;this.speechBubbleOffset.l=-65;this.speechBubbleOffset.r=65;this.speechBubbleOffset.y=-160;break;case"neighborC":this.mouth=new cjs.Sprite(ig.Sheets.lib.neighborCMouth,"idle");this.body=new cjs.Sprite(ig.Sheets.lib.neighborCBody,"idle");this.body.regX=this.mouth.regX=95;this.body.regY=this.mouth.regY=262;this.speechBubbleOffset.l=-70;this.speechBubbleOffset.r=70;this.speechBubbleOffset.y=-250;break;case"neighborD":this.mouth=new cjs.Sprite(ig.Sheets.lib.neighborDMouth,"idle");this.body=new cjs.Sprite(ig.Sheets.lib.neighborDBody,"idle");this.body.regX=this.mouth.regX=94;this.body.regY=this.mouth.regY=246;this.speechBubbleOffset.l=-77;this.speechBubbleOffset.r=77;this.speechBubbleOffset.y=-210;break;}
this._displayObject.addChild(this.body,this.mouth);this.bounds=this._displayObject.getBounds();},updateSprite:function(anim){if(this._currentAnimation!==anim){this.mouth.gotoAndPlay(anim);this.body.gotoAndPlay(anim);}
this._currentAnimation=anim;},pointLeft:function(){this.direct("left");},pointRight:function(){this.direct("right");},direct:function(direction){if(direction==="left"&&this.body.scaleX===-1){direction="right";}else if(direction==="right"&&this.body.scaleX===-1){direction="left";}
this.mouth.gotoAndPlay(direction);this.body.gotoAndPlay(direction);},onVisible:function(){if(!ig.Session.tutorials.CHARACTER){ig.Session.tutorials.CHARACTER=true;ig.Tutorials.character=this;ig.Tutorials.start("character");}
ig.Session.pushNeighborBack(this.data);this.showBubble("!");},onHidden:function(){this.mouth.gotoAndPlay("idle");this.body.gotoAndPlay("idle");this.hideBubble();},action:function(action,waiting){this.parent(action,waiting);switch(action){case"faceNoah":this.body.scaleX=this.mouth.scaleX=ig.main.game.noah.pos.x>this.pos.x?1:-1;this.onActionComplete();break;case"pointRight":this.pointRight();cjs.Tween.get(this).wait(500).call(this.onActionComplete,null,this);break;case"pointLeft":this.pointLeft();cjs.Tween.get(this).wait(500).call(this.onActionComplete,null,this);break;}},update:function(){this.parent();if(this.body&&this.body.currentAnimation!=="left"&&this.body.currentAnimation!=="right"){this.updateSprite(this.isTalking?"blab":"idle");}},checkVisibility:function(){if(!this._displayObject.parent)
return;if(!this._active){this._displayObject.active=false;}
if(this._displayObject.x+this.bounds.x+this._displayObject.parent.x>ig.system.width||this._displayObject.x+this.bounds.x+this.bounds.width+this._displayObject.parent.x<0){this._displayObject.visible=false;}else{this._displayObject.visible=true;}},draw:function(){if(this._displayObject){this._displayObject.x=this.pos.x;this._displayObject.y=this.pos.y;this.checkVisibility();}}});});

// lib/game/entities/obstacle.js
ig.baked=true;ig.module('game.entities.obstacle').requires('impact.entity','impact.world').defines(function(){ig.Obstacle=ig.Entity.extend({collides:ig.Entity.COLLIDES.FIXED,isObstacle:true,init:function(x,y,settings){var symbolData=settings.data;if(!symbolData||!symbolData.box){ig.log("No symbolData in entity data!!!!!");}
if(symbolData.assets){this._displayObject=new cjs.Container();for(var k=0;k<symbolData.assets.length;k++){var asset=symbol.assets[k];var sprite=new cjs.Sprite(ig.Sheets.lib.location,asset.sprite);if(asset.x)sprite.x=asset.x;if(asset.y)sprite.y=asset.y;if(asset.sx)sprite.scaleX=asset.sx;if(asset.sy)sprite.scaleY=asset.sy;if(asset.rot)sprite.rotation=asset.rot;this._displayObject.addChild(sprite);}}else if(symbolData.asset){this._displayObject=new cjs.Sprite(ig.Sheets.lib.location,symbolData.asset);}
x+=symbolData.box.x;y+=symbolData.box.y;if(this._displayObject){var b=this._displayObject.getBounds();this._displayObject.regX=symbolData.box.x;this._displayObject.regY=symbolData.box.y;this._displayObject.mouseChildren=this._displayObject.mouseEnabled=false;this._displayObject.ent=this;this.size.dx=b.width;this.size.dy=b.height;}
this.size.x=symbolData.box.width;this.size.y=symbolData.box.height;this.parent(x,y,settings);},update:function(){}});});

// lib/game/levels/level.js
ig.baked=true;ig.module('game.levels.level').requires('impact.world').defines(function(){ig.World.Level=ig.World.extend({gravity:1600,groundY:540,levelStartX:0,levelEndX:99999,cameraX:0,isDistractor:false,availableCharacterSpots:[],neighbors:[],isAtLevelEnd:true,init:function(settings){this.parent(settings);},createWorld:function(){this.levelStartX=(1425-ig.system.width)/2;this.addLayers();this.generateScenery();},addLayers:function(){},generateScenery:function(){},makeLayer:function(parallaxFactor,isInteractive,snapToX){return new cjs.Container().set({px:parallaxFactor,mouseChildren:isInteractive,mouseEnabled:isInteractive,tickChildren:isInteractive,snap:snapToX});},generateMap:function(map,symbolData){var i=0,ii=0;var n=0,nn=0;n=map.length;for(i=0;i<n;i++){var layer=map[i];var layerContainer=this[layer.name];if(!layerContainer){ig.log("Layer: "+layer.name+" missing!");continue;}
layerContainer.px=layer.px;nn=layer.children.length;for(ii=0;ii<nn;ii++){var item=layer.children[ii];var symbolDef=symbolData[item.symbol];if(!symbolDef.type){continue;}
switch(symbolDef.type){case"trigger":this._createTriggerObject(item,symbolDef,layerContainer);break;case"entity":this._createEntityObject(item,symbolDef,layerContainer);break;case"spot":this._createHidingSpotObject(item,symbolDef,layerContainer);break;case"container":this._createMultiSpriteObject(item,symbolDef,layerContainer);break;case"sprite":this._createSpriteObject(item,symbolDef,layerContainer);break;case"animation":this._createMovieClip(item,symbolDef,layerContainer);break;}}}},generateNeighbors:function(){var neighbors=ig.Session.currentNeighbors;this.availableCharacterSpots.shuffle();for(var i=0;i<neighbors.length;i++){var neighborData=neighbors[i];if(neighborData.isException)
continue;var spot=this.availableCharacterSpots.pop();var neighbor=this.spawnEntity(ig.Neighbor,this.path,spot.x,spot.y,{world:this,data:neighborData});this.neighbors.push(neighbor);}},update:function(){this.parent();var noah=ig.main.game.noah;if(!noah.cameraFollow){return;}
var cx=noah.pos.x-noah.cameraOffset;this.cameraX+=(cx-this.cameraX)*0.05*(ig.system.tick/0.0166667);if(this.cameraX<this.levelStartX){if(!this.isAtLevelEnd){ig.main.game.hitLevelEnd();}
this.cameraX=this.levelStartX;this.isAtLevelEnd=true;}else if(this.cameraX>this.levelEndX){if(!this.isAtLevelEnd){ig.main.game.hitLevelEnd();}
this.cameraX=this.levelEndX;this.isAtLevelEnd=true;}else{this.isAtLevelEnd=false;}
var i,n=ig.LAYERS.GAME.children.length;for(i=0;i<n;i++){var l=ig.LAYERS.GAME.children[i];l.x=-this.cameraX*l.px;if(l.snap){l.x=Math.floor(l.x);}
var numChildren=l.children.length;for(var j=0;j<numChildren;j++){var child=l.children[j];if(child.ent){continue;}
if(child.dx+child.x+child.width+child.parent.x<0||child.dx+child.x+child.parent.x>ig.system.width){child.tickEnabled=child.tickChildren=child.visible=false;}else{child.tickEnabled=child.tickChildren=child.visible=true;}}}},handleAnimation:function(anim){},_createMovieClip:function(item,symbolDef,layerContainer){var Animation=NoahAnims[ig.Session.activeLocation][symbolDef.animation];if(!Animation){ig.log("!!!!! Animation does not exist!!"+symbolDef.animation);return;}
var movieclip=new Animation();movieclip.set({name:symbolDef.animation,isAnimation:true,framerate:24,mouseChildren:false,x:item.x,y:item.y,rotation:item.rotation,scaleX:item.sx||1,scaleY:item.sy||1});movieclip.dx=movieclip.nominalBounds?movieclip.nominalBounds.x:-200;movieclip.width=movieclip.nominalBounds?movieclip.nominalBounds.width:1424;layerContainer.addChild(movieclip);},_createTriggerObject:function(item,symbolDef,layerContainer){switch(symbolDef.triggerType){case"Character":this.availableCharacterSpots.push(item);break;case"BounceGame":if(ig.Session.activeLocation===ig.Session.bounceGameLocation){this.miniGameX=item.x;var bgCountainer=ig.main.game.minigame.inGameContainer;bgCountainer.x=item.x;bgCountainer.y=item.y;layerContainer.addChild(bgCountainer);ig.main.game.farmer=this.spawnEntity(ig.Farmer,this.path,item.x+1070,item.y+242);}
break;case"DrawingBoard":if(ig.Session.activeLocation===ig.Session.drawingBoardLocation){this.miniGameX=item.x;var drawingBoard=new cjs.Container();drawingBoard.name="drawingboard";drawingBoard.mouseChildren=false;drawingBoard.x=item.x;drawingBoard.y=item.y;drawingBoard.addChild(new cjs.Sprite(ig.Sheets.lib.drawingboard,"drawingboard").set({x:272,y:80}));drawingBoard.addChild(ig.main.game.minigame.container.set({x:292,y:106,scaleX:0.76,scaleY:0.76}));layerContainer.addChild(drawingBoard);ig.main.game.artgirl=this.spawnEntity(ig.ArtGirl,this.path,item.x+1055,item.y+550);}
break;case"OldLady":this.spawnEntity(ig.Neighbor,this.path,item.x+410,item.y+399,{world:this,data:ig.Session.specialNeighbor});break;}},_createEntityObject:function(item,symbolDef,layerContainer){if(layerContainer!==this.path){throw("All Entities need to be on the path layer");}
this.spawnEntity(ig.Obstacle,layerContainer,item.x,item.y,{world:this,data:symbolDef});},_createHidingSpotObject:function(item,symbolDef,layerContainer){if(item.hiddenObject==="OPEN"){return;}
var container=new cjs.Container().set({x:item.x,y:item.y,rotation:item.rotation,scaleX:item.sx||1,scaleY:item.sy||1});var n=symbolDef.assets.length;for(var i=0;i<n;i++){var asset=symbolDef.assets[i];if(asset.sprite.indexOf("FO-")===-1||asset.sprite.slice(3)===item.hiddenObject){var sprite;if(asset.sprite.slice(3)===item.hiddenObject){if(!ig.Session.hasItemBeenFound(item.hiddenObject)){sprite=new cjs.Sprite(ig.Sheets.lib.quest,item.hiddenObject);sprite.cursor="pointer";var bounds=sprite.getBounds();sprite.hitArea=new cjs.Shape(new cjs.Graphics().f("#000").r(bounds.x-20,bounds.y-20,bounds.width+40,bounds.height+40));sprite.isHiddenObject=true;if(item.hiddenObject===ig.Session.getCurrentObjectId()){this.questObjectDisplayObject=sprite;}}else{continue;}}
else{sprite=new cjs.Sprite(ig.Sheets.lib.location,asset.sprite).set({mouseEnabled:false});}
if(asset.x)sprite.x=asset.x;if(asset.y)sprite.y=asset.y;if(asset.sx)sprite.scaleX=asset.sx;if(asset.sy)sprite.scaleY=asset.sy;if(asset.rot)sprite.rotation=asset.rot;container.addChild(sprite);}}
if(container.children.length===0){return;}
var b=container.getBounds();if(b){container.dx=b.x;container.width=b.width;}
layerContainer.addChild(container);},_createMultiSpriteObject:function(item,symbolDef,layerContainer){var container=new cjs.Container().set({x:item.x,y:item.y,rotation:item.rotation,scaleX:item.sx||1,scaleY:item.sy||1,mouseChildren:false,mouseEnabled:false,tickChildren:false});var n=symbolDef.assets.length;for(var i=0;i<n;i++){var asset=symbolDef.assets[i];var sprite=new cjs.Sprite(ig.Sheets.lib.location,asset.sprite);if(asset.x)sprite.x=asset.x;if(asset.y)sprite.y=asset.y;if(asset.sx)sprite.scaleX=asset.sx;if(asset.sy)sprite.scaleY=asset.sy;if(asset.rot)sprite.rotation=asset.rot;container.addChild(sprite);}
var b=container.getBounds();if(b){container.dx=b.x;container.width=b.width;}
layerContainer.addChild(container);},_createSpriteObject:function(item,symbolDef,layerContainer){var sprite=new cjs.Sprite(ig.Sheets.lib.location,symbolDef.asset).set({x:item.x,y:item.y,rotation:item.rotation,scaleX:item.sx||1,scaleY:item.sy||1,mouseEnabled:false,tickEnabled:false,snapToPixel:false});var b=sprite.getBounds();if(b){sprite.dx=b.x;sprite.width=b.width;}
layerContainer.addChild(sprite);},kill:function(){ig.log("Killing Level");this.parent();}});});

// lib/game/levels/park.js
ig.baked=true;ig.module('game.levels.park').requires('game.levels.level').defines(function(){ig.World.Level.Park=ig.World.Level.extend({groundY:606,levelEndX:18550,addLayers:function(){this.background=this.makeLayer(0,false,false);this.farTrees=this.makeLayer(0.4,false,true);this.closeTrees=this.makeLayer(0.9,false,false);this.behindGround=this.makeLayer(1,true,false);this.ground=this.makeLayer(1,false,true);this.path=this.makeLayer(1,true,false);this.closePath=this.makeLayer(1,false,false);this.foreground=this.makeLayer(1.1,true,false);this.bubbles=this.makeLayer(1,false,false);ig.LAYERS.GAME.addChild(this.background,this.farTrees,this.closeTrees,this.behindGround,this.ground,this.path,this.closePath,this.foreground,this.bubbles);},generateScenery:function(){var levelData=ig.Session.levelData.park;if(ig.Session.distractorLocation==="park"){this.isDistractor=true;this.generateMap(levelData.distractor,levelData.symbols);}else{this.generateMap(ig.Session.maps.park,levelData.symbols);this.generateNeighbors();}}});});

// lib/game/levels/beach.js
ig.baked=true;ig.module('game.levels.beach').requires('game.levels.level').defines(function(){ig.World.Level.Beach=ig.World.Level.extend({groundY:606,levelEndX:20505,addLayers:function(){this.background=this.makeLayer(0,false,false);this.backWaves=this.makeLayer(0.8,false,true);this.islands=this.makeLayer(0.82,true,false);this.frontWaves=this.makeLayer(0.85,false,true);this.behindGround=this.makeLayer(1,false,false);this.ground=this.makeLayer(1,false,true);this.path=this.makeLayer(1,true,false);this.closePath=this.makeLayer(1,true,false);this.foreground=this.makeLayer(1.1,false,false);this.bubbles=this.makeLayer(1,false,false);ig.LAYERS.GAME.addChild(this.background,this.backWaves,this.islands,this.frontWaves,this.behindGround,this.ground,this.path,this.closePath,this.foreground,this.bubbles);},generateScenery:function(){var levelData=ig.Session.levelData.beach;if(ig.Session.distractorLocation==="beach"){this.isDistractor=true;this.generateMap(levelData.distractor,levelData.symbols);}else{this.generateMap(ig.Session.maps.beach,levelData.symbols);this.generateNeighbors();}},handleAnimation:function(anim){switch(anim.name){case"Whale":cjs.Sound.play("sfx_burp");anim.getChildAt(0).play();break;}}});});

// lib/game/levels/jungle.js
ig.baked=true;ig.module('game.levels.jungle').requires('game.levels.level').defines(function(){ig.World.Level.Jungle=ig.World.Level.extend({groundY:605,levelEndX:22139,addLayers:function(){this.background=this.makeLayer(0,false,false);this.backgroundFoliage=this.makeLayer(0.95,false,true);this.behindGround=this.makeLayer(1,true,false);this.ground=this.makeLayer(1,false,true);this.path=this.makeLayer(1,true,false);this.closePath=this.makeLayer(1,true,false);this.foreground=this.makeLayer(1.1,false,false);this.bubbles=this.makeLayer(1,false,false);ig.LAYERS.GAME.addChild(this.background,this.backgroundFoliage,this.behindGround,this.ground,this.path,this.closePath,this.foreground,this.bubbles);},generateScenery:function(){var levelData=ig.Session.levelData.jungle;if(ig.Session.distractorLocation==="jungle"){this.isDistractor=true;this.generateMap(levelData.distractor,levelData.symbols);}else{this.generateMap(ig.Session.maps.jungle,levelData.symbols);this.generateNeighbors();}},handleAnimation:function(anim){switch(anim.name){case"Parrot":anim.gotoAndPlay("tap");break;}}});});

// lib/game/levels/country.js
ig.baked=true;ig.module('game.levels.country').requires('game.levels.level').defines(function(){ig.World.Level.Country=ig.World.Level.extend({groundY:605,levelEndX:16869,addLayers:function(){this.background=this.makeLayer(0,false,false);this.hills=this.makeLayer(0.9,true,true);this.ground=this.makeLayer(1,false,true);this.path=this.makeLayer(1,true,false);this.foreground=this.makeLayer(1.1,true,true);this.bubbles=this.makeLayer(1,false,false);ig.LAYERS.GAME.addChild(this.background,this.hills,this.ground,this.path,this.foreground,this.bubbles);},generateScenery:function(){var levelData=ig.Session.levelData.country;if(ig.Session.distractorLocation==="country"){this.isDistractor=true;this.generateMap(levelData.distractor,levelData.symbols);}else{this.generateMap(ig.Session.maps.country,levelData.symbols);this.generateNeighbors();}},handleAnimation:function(anim){switch(anim.name){case"Windmill":if(anim.isStopped){anim.isStopped=false;anim.play();}else{anim.isStopped=true;anim.stop();}
break;}}});});

// lib/game/minigames/minigame.js
ig.baked=true;ig.module('game.minigames.minigame').defines(function(){ig.MiniGame=ig.Class.extend({container:null,name:"",active:false,skipBtn:null,init:function(){this.build();},build:function(){},reset:function(){},addSelf:function(){},removeSelf:function(){ig.LAYERS.MINI_GAME.removeAllChildren();this.hideSkipBtn();},start:function(){if(ig.Session.miniGamesCompleted.indexOf(this.name)>-1){this.skipBtn=new cjs.Sprite(ig.Sheets.lib.btns,"SkipBtn").set({regX:99,regY:47,cursor:"pointer"});this.container.addChild(this.skipBtn);this.skipBtn.on("click",this.btnHandler,this);if(ig.ua.mobile){this.skipBtn.on("mousedown",this.btnHandler,this);this.skipBtn.on("pressup",this.btnHandler,this);}else{this.skipBtn.on("mouseover",this.btnHandler,this);this.skipBtn.on("mouseout",this.btnHandler,this);}}},hideSkipBtn:function(){if(this.skipBtn){this.container.removeChild(this.skipBtn);this.skipBtn.removeAllEventListeners();this.skipBtn=null;}},update:function(){if(this.skipBtn){this.skipBtn.x=ig.system.width-122-this.container.x;this.skipBtn.y=ig.system.height-70-this.container.y;}},leaveGame:function(){if(ig.Session.miniGamesCompleted.indexOf(this.name)===-1){ig.Session.miniGamesCompleted.push(this.name);}
ig.main.game.resumeFromMiniGame(this.name);},btnHandler:function(e){var btn=e.target;if(!btn)return;var ease=cjs.Ease.cubicOut;switch(e.type){case"click":this.hideSkipBtn();this.leaveGame();break;case"mouseover":cjs.Tween.get(btn,{override:true}).to({scaleX:1.1,scaleY:1.1},250,ease);break;case"mouseout":cjs.Tween.get(btn,{override:true}).to({scaleX:1,scaleY:1},250,ease);break;case"mousedown":btn.scaleX=btn.scaleY=0.9;break;case"pressup":btn.scaleX=btn.scaleY=1;break;}},kill:function(){}});});

// lib/game/minigames/drawingboard.js
ig.baked=true;ig.module('game.minigames.drawingboard').requires('game.minigames.minigame').defines(function(){ig.MiniGame.DrawingBoard=ig.MiniGame.extend({name:"drawingboard",mode:0,gameParent:null,savedX:0,savedY:0,data:null,displayData:null,inGameContainer:null,connectDotsCont:null,brushesCont:null,doneBtn:null,clearBtn:null,image:null,canvasBitmap:null,_dotsCompleted:false,_lastDot:false,_nextDot:false,_currentIndex:0,_currentLine:null,mx:0,my:0,drawCanvas:null,drawCanvasCtx:null,srcBrush:null,timeoutTime:0,init:function(){this.build();},build:function(){this.container=new cjs.Container();this.connectDotsCont=new cjs.Container();this.imageCont=new cjs.Container();this.clearBtn=new cjs.Sprite(ig.Sheets.lib.btns,"ClearBtn").set({x:382,y:480,regX:130,regY:47,cursor:"pointer"});this.doneBtn=this.clearBtn.clone().set({x:706});this.doneBtn.gotoAndStop("DoneBtn");this.drawCanvas=ig.MiniGame.DrawingBoard.drawCanvas;this.drawCanvasCtx=this.drawCanvas.getContext('2d');this.canvasBitmap=new cjs.Bitmap(this.drawCanvas).set({mouseEnabled:false,x:140,y:4});this.canvasMask=new cjs.Bitmap(ig.main.mainQueue.getResult("drawingBoardMask")).set({mouseEnabled:false,x:-1,y:-15});this.buildBrushes();this.srcBrush=new cjs.Sprite(ig.Sheets.lib.drawingboard,"brush01-b");this.loadNewPuzzle();this.container.addChild(this.canvasBitmap,this.canvasMask,this.imageCont,this.connectDotsCont,this.doneBtn,this.clearBtn,this.brushesCont);this.cacheContainer();},buildBrushes:function(){this.brushesCont=new cjs.Container();this.brushSelect=new cjs.Sprite(ig.Sheets.lib.drawingboard,"brush-selected").set({visible:false,regX:55,regY:42});this.brushesCont.addChild(this.brushSelect);var r=0;for(var i=1;i<9;i++){var brush=new cjs.Sprite(ig.Sheets.lib.drawingboard,"brush0"+i).set({regX:51,regY:38,x:i<5?81:974,y:100+85*r,cursor:"pointer"});r++;if(r===4){r=0;}
this.brushesCont.addChild(brush);}},reset:function(){this.mode=ig.MiniGame.DrawingBoard.MODES.CONNECT_THE_DOTS;this._currentLine=this._nextDot=this._lastDot=false;this._currentIndex=0;this.imageCont.set({alpha:0,visible:false});this.connectDotsCont.set({alpha:1,visible:true});this.brushesCont.set({alpha:0,visible:false});this.canvasBitmap.set({alpha:0,visible:false});this.clearBtn.scaleX=this.clearBtn.scaleY=this.doneBtn.scaleX=this.doneBtn.scaleY=0;this.clearBtn.visible=this.doneBtn.visible=false;},loadNewPuzzle:function(){this.connectDotsCont.removeAllChildren();this.imageCont.removeAllChildren();var dataArr=ig.ua.mobile?ig.config.drawingboard.mobile:ig.config.drawingboard.desktop;this.data=dataArr.shift();dataArr.push(this.data);this.displayData=ig.config.drawingboard.displayData[this.data.name];if(!this.displayData){throw("Missing Data for: "+this.data.name);}
this.placeImage();this.placeDotsNumbers();this._dotsCompleted=false;},placeImage:function(){var imageData=this.displayData.image.split(":");this.image=new cjs.Bitmap(ig.prefix+"images/drawingboard/"+this.data.name+".png").set({x:imageData[0],y:imageData[1]});this.imageCont.addChild(this.image);},placeDotsNumbers:function(){var numbers=this.displayData.numbers;var i=0,n=numbers.length;for(i=0;i<n;i++){var numData=numbers[i].split(":");var number=new cjs.Sprite(ig.Sheets.lib.drawingboard,numData[0]).set({x:numData[1],y:numData[2],mouseEnabled:false});this.connectDotsCont.addChild(number);}
this.lines=new cjs.Container();this.connectDotsCont.addChild(this.lines);var masterDot=new cjs.Shape();masterDot.graphics.f("#1B7E79").dc(0,0,10);var dots=this.displayData.dots;n=dots.length;for(i=0;i<n;i++){var dot=masterDot.clone();var data=dots[i].split(":");dot.set({name:"dot"+data[0],x:data[1],y:data[2],index:i});this.connectDotsCont.addChild(dot);}
var endLine=new cjs.Shape();this.lines.addChild(endLine);var dotOne=this.connectDotsCont.getChildByName("dot1");endLine.graphics.c().ss(4).s("#3ba4a4").mt(dot.x,dot.y).lt(dotOne.x,dotOne.y);},addSelf:function(){this.reset();if(this._dotsCompleted){this.loadNewPuzzle();}
this.gameParent=this.container.parent;this.savedX=this.container.x;this.savedY=this.container.y;this.container.set({x:194,y:70,scaleX:1,scaleY:1});this.container.uncache();this.container.x=194;ig.LAYERS.MINI_GAME.addChild(new cjs.Bitmap(ig.main.locationQueue.getResult("drawingBoardBackground")));ig.LAYERS.MINI_GAME.addChild(this.container);},removeSelf:function(){this.removeListeners();this.cacheContainer();this.container.set({x:this.savedX,y:this.savedY,scaleX:0.76,scaleY:0.76});this.gameParent.addChild(this.container);this.parent();},cacheContainer:function(){this.brushesCont.visible=this.doneBtn.visible=this.clearBtn.visible=this.brushSelect.visible=false;if(ig.MiniGame.DrawingBoard.hasDrawnOn){this.imageCont.visible=false;this.connectDotsCont.visible=false;this.canvasBitmap.visible=true;this.canvasBitmap.alpha=1;}
this.container.cache(0,0,1086,488);},start:function(){this.parent();if(this.mode===ig.MiniGame.DrawingBoard.MODES.CONNECT_THE_DOTS){if(ig.ua.mobile){ig.VO.play("nell_109");}else{ig.VO.play("nell_108");}
this.getNextDot();}else{this.getNextDot();}},leaveGame:function(){this.parent();},update:function(){this.parent();if(this.mode===ig.MiniGame.DrawingBoard.MODES.CONNECT_THE_DOTS&&!this._dotsCompleted){this.timeoutTime+=ig.system.tick;if(this.timeoutTime>15){this.timeoutTime=0;ig.VO.play("nell_125");}
this.mx=ig.input.mouse.x-this.container.x;this.my=ig.input.mouse.y-this.container.y;if(ig.input.state("mouse")){if(this._lastDot&&this._currentLine){this._currentLine.graphics.c().ss(4).s("#3ba4a4").mt(this._lastDot.x,this._lastDot.y).lt(this.mx,this.my);if(this.distanceToDot()<30){this.hideSkipBtn();this._currentLine.graphics.c().ss(4).s("#3ba4a4").mt(this._lastDot.x,this._lastDot.y).lt(this._nextDot.x,this._nextDot.y);this.setActiveDot(this._nextDot);this._currentLine=new cjs.Shape();this.lines.addChild(this._currentLine);this.getNextDot();}}else if(this.distanceToDot()<30){this.setActiveDot(this._nextDot);this._currentLine=new cjs.Shape();this.lines.addChild(this._currentLine);this.getNextDot();}}else if(this._currentLine){this._lastDot=null;this.lines.removeChild(this._currentLine);this._currentLine=null;this._currentIndex--;this._currentIndex--;this.getNextDot();}}},getNextDot:function(){this.timeoutTime=0;this._currentIndex++;this._nextDot=this.connectDotsCont.getChildByName("dot"+this._currentIndex);if(!this._nextDot){this._dotsCompleted=true;cjs.Tween.get(this).wait(800).call(this.completeDots,null,this);}},completeDots:function(){cjs.Tween.get(this.connectDotsCont).to({alpha:0},750,cjs.Ease.quadInOut).set({visible:false});cjs.Tween.get(this.imageCont).set({visible:true}).to({alpha:1},750,cjs.Ease.quadInOut).wait(200).call(this.completeAudio,null,this);},completeAudio:function(){ig.VO.play([this.data.audio,{id:"noah_123",delay:300}],this.transitionToDrawMode.bind(this));},transitionToDrawMode:function(){this.mode=ig.MiniGame.DrawingBoard.MODES.DRAWING;this.setActiveBrush(this.brushesCont.children[1]);ig.VO.play("nell_127");cjs.Tween.get(this.imageCont).to({alpha:0},750,cjs.Ease.quadInOut).set({visible:false});cjs.Tween.get(this.doneBtn).wait(600).set({visible:true}).to({scaleX:1,scaleY:1},800,cjs.Ease.elasticOut);cjs.Tween.get(this.clearBtn).wait(500).set({visible:true}).to({scaleX:1,scaleY:1},800,cjs.Ease.elasticOut);cjs.Tween.get(this.canvasBitmap).wait(250).set({visible:true}).to({alpha:1},800,cjs.Ease.quadInOut);cjs.Tween.get(this.brushesCont).wait(250).set({visible:true}).to({alpha:1},800,cjs.Ease.quadInOut).call(this.addDrawingListeners,null,this);},mouseHandler:function(e){var target=e.target;if(!target)return;var ease=cjs.Ease.cubicOut;switch(e.type){case"click":cjs.Sound.play("sfxclick");switch(target){case this.clearBtn:this.clearCanvas();break;case this.doneBtn:this.leaveGame();break;default:this.setActiveBrush(target);break;}
break;case"mouseover":cjs.Sound.play("sfxrollover");cjs.Tween.get(target,{override:true}).to({scaleX:1.1,scaleY:1.1},250,ease);break;case"mouseout":cjs.Tween.get(target,{override:true}).to({scaleX:1,scaleY:1},250,ease);break;case"mousedown":target.scaleX=target.scaleY=0.9;break;case"pressup":target.scaleX=target.scaleY=1;break;}},mouseMoveHander:function(e){ig.MiniGame.DrawingBoard.hasDrawnOn=true;if(this.srcBrush&&this.brushSelect.visible){var bx=e.stageX-this.container.x-this.canvasBitmap.x-23;var by=e.stageY-this.container.y-this.canvasBitmap.y-17;this.drawCanvasCtx.save();this.drawCanvasCtx.translate(bx,by);this.srcBrush.draw(this.drawCanvasCtx);this.drawCanvasCtx.restore();}},setActiveBrush:function(btn){this.brushSelect.x=btn.x;this.brushSelect.y=btn.y;this.brushSelect.visible=true;this.srcBrush.gotoAndStop(btn.currentAnimation+"-b");},clearCanvas:function(){this.drawCanvasCtx.clearRect(0,0,750,460);},setActiveDot:function(dot){var sound="artgirl_"+(321+dot.index);ig.VO.play(sound);cjs.Tween.get(dot).to({scaleX:2,scaleY:2},150,cjs.Ease.QuadOut).to({scaleX:1,scaleY:1},150,cjs.Ease.QuadIn);this._lastDot=dot;},addDrawingListeners:function(){this.container.on("click",this.mouseHandler,this);if(ig.ua.mobile){this.container.on("mousedown",this.mouseHandler,this);this.container.on("pressup",this.mouseHandler,this);}else{this.container.on("mouseover",this.mouseHandler,this);this.container.on("mouseout",this.mouseHandler,this);}
this.stageListener=ig.main.stage.on("stagemousedown",this.mouseMoveHander,this);this.stageListener=ig.main.stage.on("pressmove",this.mouseMoveHander,this);},removeListeners:function(){this.container.removeAllEventListeners();if(this.stageListener){ig.main.stage.off("pressmove",this.stageListener);this.stageListener=false;}},distanceToDot:function(){var xd=this.mx-this._nextDot.x;var yd=this.my-this._nextDot.y;return Math.sqrt(xd*xd+yd*yd);},kill:function(){}});ig.MiniGame.DrawingBoard.MODES={CONNECT_THE_DOTS:0,DRAWING:1};ig.MiniGame.DrawingBoard.hasDrawnOn=false;ig.MiniGame.DrawingBoard.drawCanvas=null;});

// lib/game/entities/farmer.js
ig.baked=true;ig.module('game.entities.farmer').requires('game.entities.character').defines(function(){ig.Farmer=ig.Character.extend({characterName:"farmer",gravityFactor:0,speechBubbleOffset:{l:-65,r:65,y:4},init:function(x,y,settings){this.parent(x,y,settings);this._displayObject=new cjs.Container().set({mouseChildren:false,isFarmer:true,ent:this});this._movieclip=new NoahAnims.bouncegame.Farmer().set({framerate:24,scaleX:-1,regX:76});this._displayObject.addChild(this._movieclip);this.bounds=this._displayObject.getBounds();},updateMovieclip:function(anim){if(this._currentAnimation!==anim){this._movieclip.gotoAndPlay(anim);}
this._currentAnimation=anim;},onHidden:function(){this.hideBubble();},checkVisibility:function(){if(!this._displayObject.parent)
return;if(!this._active){this._displayObject.active=false;}
if(this._displayObject.x+this.bounds.x+this._displayObject.parent.x>ig.system.width||this._displayObject.x+this.bounds.x+this.bounds.width+this._displayObject.parent.x<0){this._displayObject.visible=false;}else{this._displayObject.visible=true;}},update:function(){this.parent();this.updateMovieclip(this.isTalking?"blab":"idle");}});});

// lib/game/entities/trampoline.js
ig.baked=true;ig.module('game.entities.trampoline').requires('impact.entity').defines(function(){ig.Trampoline=ig.Entity.extend({type:ig.Entity.TYPE.A,checkAgainst:ig.Entity.TYPE.B,collides:ig.Entity.COLLIDES.FIXED,gravityFactor:0,speed:1000,active:true,size:{x:190,y:20},init:function(x,y,settings){this.parent(x,y,settings);this.maxVel.x=500;this.friction.x=1000;this.initSprites();},setActive:function(toggle){this.active=toggle;},initSprites:function(){this._displayObject=new cjs.Container();var tramp=new cjs.Sprite(ig.Sheets.lib.bouncegame,"trampoline");this._noah=new cjs.Sprite(ig.Sheets.lib.noahTramp,"stop").set({x:190,y:-119});this._displayObject.addChild(tramp,this._noah);},update:function(){this.parent();if(this.active){if(ig.ua.mobile){this.handleMobileControls();}else{this.handleDesktopControls();}
if(this.pos.x<392){this.pos.x=392;}else if(this.pos.x>750){this.pos.x=750;}
if(this.vel.x<0){this.changeAnim("toLeft");}else if(this.vel.x>0){this.changeAnim("toRight");}else{this.changeAnim("stop");}}else{if(ig.VO.character==="noah"){this.changeAnim("blab");}else{this.changeAnim("stop");}
this.accel.x=0;}},draw:function(){this._displayObject.x=this.pos.x;this._displayObject.y=this.pos.y;},changeAnim:function(anim){if(this._noah.currentAnimation!==anim){this._noah.gotoAndPlay(anim);}},handleMobileControls:function(){var mouseDown=ig.input.state("mouse");if(mouseDown){var pt=this._displayObject.globalToLocal(ig.input.mouse.x,0);if(pt.x>this.size.x*0.6){this.accel.x=this.speed;if(this.vel.x<0){this.vel.x*=-1;}}else if(pt.x<this.size.x*0.4){this.accel.x=-this.speed;if(this.vel.x>0){this.vel.x*=-1;}}else{this.accel.x=0;}}else{this.accel.x=0;}},handleDesktopControls:function(){if(ig.input.state('right')){this.accel.x=this.speed;if(this.vel.x<0){this.vel.x*=-1;}}else if(ig.input.state('left')){this.accel.x=-this.speed;if(this.vel.x>0){this.vel.x*=-1;}}else{this.accel.x=0;}}});});

// lib/game/entities/wagon.js
ig.baked=true;ig.module('game.entities.wagon').requires('impact.entity').defines(function(){ig.Wagon=ig.Entity.extend({type:ig.Entity.TYPE.A,checkAgainst:ig.Entity.TYPE.B,gravityFactor:0,size:{x:184,y:50},percentage:0,init:function(x,y,settings){this.parent(x,y,settings);this.maxVel.x=500;this.friction.x=1000;this.initSprites();},setActive:function(toggle){this.active=toggle;},initSprites:function(){var WagonClass;switch(ig.Session.activeLocation){case ig.LOCATIONS.PARK:WagonClass=NoahAnims.bouncegame.ParkWagon;break;case ig.LOCATIONS.BEACH:WagonClass=NoahAnims.bouncegame.BeachWagon;break;case ig.LOCATIONS.COUNTRY:WagonClass=NoahAnims.bouncegame.CountryWagon;break;case ig.LOCATIONS.JUNGLE:WagonClass=NoahAnims.bouncegame.JungleWagon;break;}
this._displayObject=new WagonClass().set({framerate:24,mouseChildren:false,ent:this});this._displayObject.gotoAndStop(0);},update:function(){this.parent();this._displayObject.gotoAndStop(Math.floor(this.percentage*99));},draw:function(){this._displayObject.x=this.pos.x-30;this._displayObject.y=this.pos.y-60;},check:function(other){cjs.Sound.play("sfxtrampolinecatch");this.world.collectObject();cjs.Tween.get(this).to({percentage:this.world.numCollected/10},300);other.kill();}});});

// lib/game/entities/tossobject.js
ig.baked=true;ig.module('game.entities.tossobject').requires('impact.entity').defines(function(){ig.TossObject=ig.Entity.extend({type:ig.Entity.TYPE.B,collides:ig.Entity.COLLIDES.ACTIVE,bounciness:1,isTossObject:true,gravityFactor:1,speed:1000,active:true,size:{x:40,y:40},angluarVel:0,init:function(x,y,settings){this.parent(x,y,settings);this.maxVel.x=1000;this.maxVel.y=9000;this.initSprites();this.angluarVel=Math.random()*180-90;},setActive:function(toggle){this.active=toggle;},initSprites:function(){this._displayObject=new cjs.Sprite(ig.Sheets.lib.bouncegame,ig.tossobject).set({mouseChildren:false,mouseEnabled:false,x:this.pos.x+20,y:this.pos.y+20});ig.CenterReg(this._displayObject);},update:function(){this.parent();if(this.pos.y>574&&this.gravityFactor>0){cjs.Sound.play("sfxtrampolinesplat");this.world.miss();this.angluarVel=0;this.gravityFactor=0;this.vel.x=0;this.vel.y=0;var currentAnim=this._displayObject.currentAnimation;this._displayObject.rotation=0;this._displayObject.spriteSheet=ig.Sheets.lib.splats;this._displayObject.regX=108;this._displayObject.regY=62;switch(currentAnim){case"tossobject01":this._displayObject.gotoAndPlay("orange");break;case"tossobject02":this._displayObject.gotoAndPlay("green");break;case"tossobject03":this._displayObject.gotoAndPlay("white");break;case"tossobject04":this._displayObject.gotoAndPlay("yellow");break;case"tossobject05":this._displayObject.gotoAndPlay("purple");break;case"tossobject06":this._displayObject.gotoAndPlay("yellow");break;}
this._displayObject.on("animationend",this.handleAnimationEnd,this);}},draw:function(){this._displayObject.rotation+=this.angluarVel*ig.system.tick;this._displayObject.x=this.pos.x+20;this._displayObject.y=this.pos.y+20;},collideWith:function(other,axis){if(other===this.world.tramp){cjs.Sound.play("sfxtrampolinebounce");this.angluarVel+=Math.random()*90-45;this.world.findBounceVel(this);}},handleAnimationEnd:function(event){event.remove();this.kill();}});});

// lib/game/minigames/bouncegame.js
ig.baked=true;ig.module('game.minigames.bouncegame').requires('game.entities.farmer','game.entities.trampoline','game.entities.wagon','game.entities.tossobject','game.minigames.minigame').defines(function(){ig.MiniGame.BounceGame=ig.MiniGame.extend({name:"bouncegame",inGameContainer:null,scoreBmpText:null,farmer:null,tramp:null,wagon:null,inGameWagon:null,throwTimer:0,throwLimit:2,isThrowingActive:false,numCollected:0,missesInARow:0,gravity:1600,groundY:9999,lx:100,ly:45,bounceAngle:70,entities:[],namedEntities:{},_deferredKill:[],tossTypes:{park:["tossobject01","tossobject05","tossobject06"],beach:["tossobject03","tossobject06"],country:["tossobject01","tossobject02"],jungle:["tossobject03","tossobject04"]},build:function(){this.buildInGameContainer();this.buildMiniGameContainer();},reset:function(){this.tramp.pos.x=600;this.updateEntities();this.drawEntities();this.missesInARow=0;this.numCollected=0;this.updateScore();},start:function(){this.parent();var onComplete=this.startThrowing.bind(this);if(ig.ua.mobile){ig.VO.play([{id:"nell_091",delay:200},"noah_092"],onComplete);}else{ig.VO.play([{id:"nell_090",delay:200},"noah_092"],onComplete);}},addSelf:function(){this.reset();this.tramp.active=false;this.farmer._movieclip.toss=this.spawnTossObject.bind(this);this.farmer._movieclip.set({scaleX:1});ig.LAYERS.MINI_GAME.addChild(new cjs.Bitmap(ig.main.locationQueue.getResult("bounceGameBackground")).set({x:(1424-ig.system.width)/-2}));ig.LAYERS.MINI_GAME.addChild(this.container);this.active=true;},removeSelf:function(){this.parent();var l=this.entities.length;for(var i=0;i<l;i++){var ent=this.entities[i];if(ent.isTossObject)ent.kill();}
this.updateEntities();this.drawEntities();},startThrowing:function(){this.tramp.active=true;this.throwTimer=this.throwLimit=2.5;this.isThrowingActive=true;},collectObject:function(){if(this.numCollected>=10)
return;this.numCollected++;this.missesInARow=0;this.updateScore();this.throwLimit*=0.95;var sound="farmer_"+(320+this.numCollected);ig.VO.play(sound);},miss:function(){this.missesInARow++;if(this.missesInARow>5&&this.numCollected<4){this.missesInARow=0;ig.VO.play("nell_097");}},playVarious:function(){var various=["noah_93","noah_94","nell_95","nell_96"];ig.VO.play(various.random());},updateScore:function(){this.scoreBmpText.text=this.numCollected+"/10";var b=this.scoreBmpText.getBounds();this.scoreBmpText.regX=Math.floor(b.width*0.5);this.scoreBmpText.regY=Math.floor(b.height*0.5);},leaveGame:function(){this.inGameWagon.gotoAndStop(99);this.isThrowingActive=false;this.parent();},shoot:function(){if(!this.isThrowingActive)return;if(this.numCollected>=10){this.isThrowingActive=false;cjs.Tween.get(this).wait(500).call(this.leaveGame,null,this);return;}
var tossObjects=this.tossTypes[ig.Session.activeLocation];ig.tossobject=tossObjects.shift();tossObjects.push(ig.tossobject);this.farmer._movieclip.gotoAndPlay("toss");},spawnTossObject:function(){var toss=this.spawnEntity(ig.TossObject,this.container,this.farmer.pos.x+this.lx,this.farmer.pos.y+this.ly);this.container.addChild(this.wagon._displayObject);var vp=0.52*Math.random()+0.11;var tp=(this.tramp.pos.x-392)/548;var twp=(this.tramp.pos.x+this.tramp.size.x-392)/548;if(vp>tp&&vp<twp){vp+=0.35;}
toss.vel.x=450*vp;toss.vel.y=-850;},findBounceVel:function(ent){if(ent.pos.x<650)
return;var xd=(this.wagon.pos.x+45)-ent.pos.x;var yd=0;var a=Math.toRad(this.bounceAngle);var ya=xd*Math.tan(a);var dist=xd+yd/Math.tan(a);var vel=Math.sqrt(dist*this.gravity/Math.sin(2*a));var norm=this.normalize({x:xd,y:ya},1);ent.vel.x=vel*norm.x;ent.vel.y=-vel*norm.y;},normalize:function(point,scale){var norm=Math.sqrt(point.x*point.x+point.y*point.y);if(norm!==0){point.x=scale*point.x/norm;point.y=scale*point.y/norm;}
return point;},getRandomInt:function(min,max){return Math.floor(Math.random()*(max-min+1))+min;},update:function(){this.parent();if(this.active){if(this.isThrowingActive){this.throwTimer+=ig.system.tick;if(this.throwTimer>this.throwLimit){this.throwTimer=0;this.shoot();}}
this.updateEntities();this.doEntityCheck();for(var i=0;i<this._deferredKill.length;i++){this._deferredKill[i].erase();this.entities.erase(this._deferredKill[i]);}
this._deferredKill.length=0;this.drawEntities();}},kill:function(){},buildInGameContainer:function(){this.inGameContainer=new cjs.Container().set({mouseChildren:false,name:this.name});var pile=this.getPileSprite();var wagon=this.getWagonDisplayObject();var tramp=new cjs.Sprite(ig.Sheets.lib.bouncegame,"trampoline").set({x:568,y:426});this.inGameWagon=wagon;this.inGameContainer.addChild(pile,wagon,tramp);},buildMiniGameContainer:function(){this.container=new cjs.Container();this.container.x=(1424-ig.system.width)/-2;this.pile=this.getPileSprite();this.container.addChild(this.pile);this.wagon=this.spawnEntity(ig.Wagon,this.container,1092,492);this.wagon._displayObject.gotoAndStop(0);this.tramp=this.spawnEntity(ig.Trampoline,this.container,600,485);this.farmer=this.spawnEntity(ig.Farmer,this.container,306,295);this.updateEntities();this.drawEntities();this.scoreBmpText=new cjs.BitmapText("0/10",ig.Sheets.lib.BOUNCE_FONT);this.container.addChild(this.scoreBmpText);this.scoreBmpText.x=712;this.scoreBmpText.y=100;this.updateScore();},getPileSprite:function(){var pile=new cjs.Sprite(ig.Sheets.lib.bouncegame,"pile-"+ig.Session.activeLocation);var bounds=pile.getBounds();pile.set({x:340,y:524,regX:Math.round(bounds.width*0.5),regY:bounds.height-30});return pile;},getWagonDisplayObject:function(){var WagonClass;switch(ig.Session.activeLocation){case ig.LOCATIONS.PARK:WagonClass=NoahAnims.bouncegame.ParkWagon;break;case ig.LOCATIONS.BEACH:WagonClass=NoahAnims.bouncegame.BeachWagon;break;case ig.LOCATIONS.COUNTRY:WagonClass=NoahAnims.bouncegame.CountryWagon;break;case ig.LOCATIONS.JUNGLE:WagonClass=NoahAnims.bouncegame.JungleWagon;break;}
var wagon=new WagonClass().set({x:1115,y:360});wagon.gotoAndStop(0);return wagon;},spawnEntity:function(type,container,x,y,settings){var EntityClass=typeof(type)==='string'?ig.global[type]:type;if(!EntityClass){throw("Can't spawn entity of type "+type);}
settings=settings||{};settings.container=container;settings.world=this;var ent=new(EntityClass)(x,y,settings);this.entities.push(ent);container.addChild(ent._displayObject);return ent;},removeEntity:function(ent){if(ent.container){ent.container.removeChild(ent._displayObject);}
ent._killed=true;ent.type=ig.Entity.TYPE.NONE;ent.checkAgainst=ig.Entity.TYPE.NONE;ent.collides=ig.Entity.COLLIDES.NEVER;this._deferredKill.push(ent);},updateEntities:function(){var l=this.entities.length;for(var i=0;i<l;i++){var ent=this.entities[i];if(!ent._killed){ent.update();}}},drawEntities:function(){var l=this.entities.length;for(var i=0;i<l;i++){var ent=this.entities[i];ent.draw();}},doEntityCheck:function(){var l=this.entities.length;for(var i=0;i<l;i++){var e=this.entities[i];if(e===this.tramp||e===this.wagon){continue;}
if(this.tramp.touches(e)){ig.Entity.checkPair(this.tramp,e);}
if(this.wagon.touches(e)){ig.Entity.checkPair(this.wagon,e);}}},trace:function(x,y,vx,vy){return{collision:{x:false,y:false,slope:false},pos:{x:x+vx,y:y+vy},tile:{x:0,y:0}};}});});

// lib/display/overlay.js
ig.baked=true;ig.module('display.overlay').defines(function(){ig.Overlay=ig.Class.extend({init:function(){},start:function(){this.setActive(true);},update:function(){},setActive:function(active){},kill:function(){}});});

// lib/display/overlays/pause.js
ig.baked=true;ig.module('display.overlays.pause').requires('display.overlay').defines(function(){ig.Overlay.Pause=ig.Overlay.extend({container:null,init:function(){this.build();this.container.visible=false;ig.LAYERS.OVERLAYS.addChild(this.container);},start:function(){this.parent();},build:function(){this.container=new cjs.Container();this.pauseContainer=new cjs.Container();var bg=new cjs.Sprite(ig.Sheets.lib.ui,"SmallMenuBg").set({mouseEnabled:false,regX:204,regY:236});var resumeBtn=new cjs.Sprite(ig.Sheets.lib.btns,"ResumeBtn").set({y:-129,regX:145,regY:47,cursor:"pointer",name:"resume"});var helpBtn=resumeBtn.clone().set({name:"help",y:0});helpBtn.gotoAndStop("HelpBtn");var newGameBtn=resumeBtn.clone().set({name:"newgame",y:129});newGameBtn.gotoAndStop("NewGameBtn");this.pauseContainer.addChild(bg,resumeBtn,helpBtn,newGameBtn);this.helpContainer=new cjs.Container().set({y:ig.system.height,tickChildren:false,visible:false});var xBtn=new cjs.Sprite(ig.Sheets.lib.btns,"xBtn").set({x:470,y:-330,regX:43,regY:40,cursor:"pointer",name:"back"});this.helpContainer.addChild(xBtn);this.container.addChild(this.pauseContainer,this.helpContainer);},setActive:function(active){if(active){this.container.on("click",this.btnHandler,this);if(ig.ua.mobile){this.container.on("mousedown",this.btnHandler,this);this.container.on("pressup",this.btnHandler,this);}else{this.container.on("mouseover",this.btnHandler,this);this.container.on("mouseout",this.btnHandler,this);}
ig.LAYERS.OVERLAY_DIM.on("click",this.onOverlayDimClick,this);}else{ig.LAYERS.OVERLAY_DIM.removeAllEventListeners();this.container.removeAllEventListeners();}},show:function(){ig.LAYERS.OVERLAYS.tickChildren=ig.LAYERS.OVERLAYS.visible=true;this.container.visible=true;this.container.y=ig.system.height;var src="";if(ig.ViewControl.currentID===ig.VIEWS.CROSSROADS){src=ig.prefix+"images/crossroads/crossroads-help.png";cjs.Tween.get(this.container).to({y:0},400,cjs.Ease.cubicInOut).call(this.setActive,[true],this);}
else{src=ig.ua.mobile?ig.prefix+"images/ui/mobile-help.png":ig.prefix+"images/ui/desktop-help.png";cjs.Tween.get(this.container).to({y:0},400,cjs.Ease.cubicInOut).call(this.setActive,[true],this);}
var helpImage=new cjs.Bitmap(src).set({mouseEnabled:false,regX:494,regY:350});this.helpContainer.addChildAt(helpImage,0);cjs.Tween.get(ig.LAYERS.OVERLAY_DIM).set({visible:true}).to({alpha:0.6},400,cjs.Ease.quadInOut);},hide:function(t){this.helpContainer.removeChildAt(0);this.setActive(false);if(isNaN(t))t=300;cjs.Tween.get(this.container).to({y:ig.system.height},t,cjs.Ease.cubicInOut).set({visible:false});cjs.Tween.get(ig.LAYERS.OVERLAY_DIM).to({alpha:0},t,cjs.Ease.quadInOut).set({visible:false}).set({visible:false,tickChildren:false},ig.LAYERS.OVERLAYS);},btnHandler:function(e){var btn=e.target;if(!btn)return;var ease=cjs.Ease.backOut;switch(e.type){case"click":cjs.Sound.play("sfxclick");this.handleClick(btn);break;case"mouseover":cjs.Sound.play("sfxrollover");if(btn.label)btn.label.gotoAndStop("MapLabelOver");cjs.Tween.get(btn,{override:true}).to({scaleX:1.05,scaleY:1.05},200,ease);break;case"mouseout":if(btn.label)btn.label.gotoAndStop("MapLabel");cjs.Tween.get(btn,{override:true}).to({scaleX:1,scaleY:1},200,ease);break;case"mousedown":btn.scaleX=btn.scaleY=0.9;break;case"pressup":btn.scaleX=btn.scaleY=1;break;}},onOverlayDimClick:function(){if(!this.pauseContainer.mouseEnabled){ig.VO.stop();this.pauseContainer.mouseEnabled=true;cjs.Tween.get(this.helpContainer).to({y:ig.system.height},400,cjs.Ease.cubicInOut).set({tickChildren:false,visible:false});}else{this.hide();ig.ViewControl.current.resume();}},handleClick:function(btn){var btnName=btn.name;switch(btnName){case"resume":this.hide();ig.ViewControl.current.resume();break;case"newgame":this.hide();ig.main.newGame();break;case"help":this.pauseContainer.mouseEnabled=false;cjs.Tween.get(this.helpContainer).set({tickChildren:true,visible:true}).to({y:0},400,cjs.Ease.cubicInOut).call(this.playInstructions,null,this);break;case"back":ig.VO.stop();this.pauseContainer.mouseEnabled=true;cjs.Tween.get(this.helpContainer).to({y:ig.system.height},400,cjs.Ease.cubicInOut).set({tickChildren:false,visible:false});break;}},playInstructions:function(){if(ig.ViewControl.currentID===ig.VIEWS.CROSSROADS){ig.VO.play(["noah_136","noah_137","noah_138","noah_142"]);}else{if(ig.ua.mobile){ig.VO.play(["noah_028","nell_029","noah_030"]);}else{ig.VO.play(["noah_026","nell_027","noah_030"]);}}},kill:function(){ig.LAYERS.OVERLAYS.removeChild(this.container);}});});

// lib/display/overlays/map.js
ig.baked=true;ig.module('display.overlays.map').requires('display.overlay').defines(function(){ig.Overlay.Map=ig.Overlay.extend({container:null,init:function(){this.build();this.container.visible=false;ig.LAYERS.OVERLAYS.addChild(this.container);},start:function(){this.parent();},build:function(){this.container=new cjs.Container();var bg=new cjs.Bitmap(ig.main.mainQueue.getResult("map")).set({mouseEnabled:false});ig.CenterReg(bg);this.park=this.makeLocationPip("Park",-262,-60,"coco_056A");this.beach=this.makeLocationPip("Beach",365,110,"coco_058A");this.jungle=this.makeLocationPip("Jungle",117,5,"coco_059A");this.country=this.makeLocationPip("Country",-101,186,"coco_057A");this.xBtn=new cjs.Sprite(ig.Sheets.lib.btns,"xBtn").set({x:482,y:-258,regX:43,regY:40,cursor:"pointer"});this.container.addChild(bg,this.park,this.beach,this.jungle,this.country,this.xBtn);},setActive:function(active){if(active){this.container.on("click",this.btnHandler,this);if(ig.ua.mobile){this.container.on("mousedown",this.btnHandler,this);this.container.on("pressup",this.btnHandler,this);}else{this.container.on("mouseover",this.btnHandler,this);this.container.on("mouseout",this.btnHandler,this);}
ig.LAYERS.OVERLAY_DIM.on("click",this.hide,this);}else{ig.LAYERS.OVERLAY_DIM.removeAllEventListeners();this.container.removeAllEventListeners();}},makeLocationPip:function(name,x,y,sound){var UI=ig.Sheets.lib.ui;var cont=new cjs.Container().set({x:x,y:y,mouseChildren:false,cursor:"pointer",name:name});cont.addChild(new cjs.Sprite(UI,name+"Map").set({x:-118,y:-257}));var label=new cjs.Container().set({y:-82});label.addChild(new cjs.Sprite(UI,"MapLabel").set({name:"label",regX:88,regY:32}));label.addChild(new cjs.Sprite(UI,name+"MapText").set({regX:85,regY:32}));cont.addChild(label);cont.addChild(new cjs.Sprite(UI,"MapNoah").set({name:"noah",x:-112,y:-152}));cont.label=label.getChildByName("label");cont.sound=sound;return cont;},show:function(){ig.LAYERS.OVERLAYS.tickChildren=ig.LAYERS.OVERLAYS.visible=true;this.container.visible=true;this.container.y=-ig.system.height;cjs.Tween.get(this.container).to({y:0},600,cjs.Ease.cubicInOut).call(this.setActive,[true],this);cjs.Tween.get(ig.LAYERS.OVERLAY_DIM).set({visible:true}).to({alpha:0.6},600,cjs.Ease.quadInOut);var pips=[this.park,this.country,this.jungle,this.beach];for(var i=0;i<4;i++){var pip=pips[i];pip.scaleX=pip.scaleY=0;var noah=pip.getChildByName("noah");noah.visible=ig.Session.activeLocation===pip.name.toLowerCase();pip.mouseEnabled=!noah.visible;cjs.Tween.get(pip).wait(500+i*50).to({scaleX:1,scaleY:1},500,cjs.Ease.backOut);}},hide:function(t){ig.main.game.setFullPause(false);ig.main.game.setPartialPause(false);this.setActive(false);if(isNaN(t))t=400;cjs.Tween.get(this.container).to({y:-ig.system.height},t,cjs.Ease.cubicInOut).set({visible:false});cjs.Tween.get(ig.LAYERS.OVERLAY_DIM).to({alpha:0},t,cjs.Ease.quadInOut).set({visible:false}).set({visible:false,tickChildren:false},ig.LAYERS.OVERLAYS);},handleClick:function(btn){switch(btn){case this.park:ig.main.gotoLocation(ig.LOCATIONS.PARK);break;case this.beach:ig.main.gotoLocation(ig.LOCATIONS.BEACH);break;case this.jungle:ig.main.gotoLocation(ig.LOCATIONS.JUNGLE);break;case this.country:ig.main.gotoLocation(ig.LOCATIONS.COUNTRY);break;case this.xBtn:this.hide();break;}},btnHandler:function(e){var btn=e.target;if(!btn)return;var ease=cjs.Ease.backOut;switch(e.type){case"click":if(ig.ua.mobile&&btn.sound)
ig.VO.play(btn.sound);else
cjs.Sound.play("sfxclick");this.handleClick(btn);break;case"mouseover":if(btn.sound)
ig.VO.play(btn.sound);else
cjs.Sound.play("sfxrollover");if(btn.label)btn.label.gotoAndStop("MapLabelOver");cjs.Tween.get(btn,{override:true}).to({scaleX:1.05,scaleY:1.05},200,ease);break;case"mouseout":if(btn.label)btn.label.gotoAndStop("MapLabel");cjs.Tween.get(btn,{override:true}).to({scaleX:1,scaleY:1},200,ease);break;case"mousedown":btn.scaleX=btn.scaleY=0.9;break;case"pressup":btn.scaleX=btn.scaleY=1;break;}},update:function(){},kill:function(){ig.LAYERS.OVERLAYS.removeChild(this.container);}});});

// lib/game/ui.js
ig.baked=true;ig.module('game.ui').requires('display.overlays.pause','display.overlays.map').defines(function(){ig.GameUI=ig.Class.extend({mapOverlay:null,pauseOverlay:null,traySpots:[],trayIndex:0,_bannerContainer:null,_banner:null,_bannerObject:null,_bannerObjectId:"",objectTray:null,isBlocking:false,init:function(){this.mapOverlay=new ig.Overlay.Map();this.pauseOverlay=new ig.Overlay.Pause();this._bannerContainer=new cjs.Container();var UI=ig.Sheets.lib.ui;var BTNS=ig.Sheets.lib.btns;this.objectTray=new cjs.Container();this.objectTray.addChild(new cjs.Sprite(UI,"BackPack").set({mouseEnabled:false}));this.traySpots.push(this.objectTray.addChild(new cjs.Sprite(UI,"qmark-sm").set({cursor:"pointer",index:0,regX:13,regY:31,x:62,y:24,visible:false})));this.traySpots.push(this.objectTray.addChild(new cjs.Sprite(UI,"qmark-sm").set({cursor:"pointer",index:1,regX:13,regY:31,x:150,y:24,visible:false})));this.traySpots.push(this.objectTray.addChild(new cjs.Sprite(UI,"qmark-sm").set({cursor:"pointer",index:2,regX:13,regY:31,x:236,y:26,visible:false})));this.traySpots.push(this.objectTray.addChild(new cjs.Sprite(UI,"qmark-sm").set({cursor:"pointer",index:3,regX:13,regY:31,x:87,y:86,visible:false})));this.traySpots.push(this.objectTray.addChild(new cjs.Sprite(UI,"qmark-sm").set({cursor:"pointer",index:4,regX:13,regY:31,x:218,y:82,visible:false})));for(var i=0;i<5;i++){var spot=this.traySpots[i];spot.hitArea=new cjs.Shape(new cjs.Graphics().f("#000").r(0,0,84,84));}
this.objectTray.on("click",this.trayMouseHandler,this);if(ig.ua.mobile){this.objectTray.on("mousedown",this.trayMouseHandler,this);this.objectTray.on("pressup",this.trayMouseHandler,this);}else{this.objectTray.on("mouseover",this.trayMouseHandler,this);this.objectTray.on("mouseout",this.trayMouseHandler,this);}
this.btns=new cjs.Container();this.nextBtn=new cjs.Sprite(BTNS,"NextBtn").set({cursor:"pointer",regX:100,regY:47,visible:false,scaleX:0,scaleY:0,mouseEnabled:false});this.mapBtn=new cjs.Sprite(BTNS,"MapBtn").set({cursor:"pointer",regX:48,regY:45,ox:120});this.pauseBtn=new cjs.Sprite(BTNS,"PauseBtn").set({cursor:"pointer",regX:48,regY:45,ox:-120});this.btns.addChild(this.pauseBtn,this.nextBtn,this.mapBtn);this.btns.on("click",this.btnHandler,this);if(ig.ua.mobile){this.btns.on("mousedown",this.btnHandler,this);this.btns.on("pressup",this.btnHandler,this);}else{this.btns.on("mouseover",this.btnHandler,this);this.btns.on("mouseout",this.btnHandler,this);}
ig.LAYERS.GAME_UI.addChild(this.objectTray,this.btns,this._bannerContainer);ig.InteractionControl.bindNextBtn(this.nextBtn);},showObjectBanner:function(index,inPlace){this.trayIndex=index;this.inPlace=inPlace;var object=ig.Session.questObjects[index];var spriteName;switch(object.status){case ig.Session.OBJECT_STATUS.ACTIVE:spriteName="qmark";break;case ig.Session.OBJECT_STATUS.SKETCHED:spriteName="sketch-lg";break;case ig.Session.OBJECT_STATUS.TRANSLATED:spriteName="bw-lg";break;case ig.Session.OBJECT_STATUS.FOUND:spriteName="color-lg";break;}
var spriteSheet=spriteName==="qmark"?ig.Sheets.lib.ui:ig.Sheets.lib["object"+object.id];var displayobject;var sprite=new cjs.Sprite(spriteSheet,spriteName);switch(object.status){case ig.Session.OBJECT_STATUS.ACTIVE:ig.CenterReg(sprite);displayobject=sprite;break;case ig.Session.OBJECT_STATUS.SKETCHED:displayobject=new cjs.Container().set({regX:140,regY:143,y:30});displayobject.addChild(new cjs.Sprite(ig.Sheets.lib.ui,"PeqPaper"));displayobject.addChild(sprite);break;case ig.Session.OBJECT_STATUS.TRANSLATED:case ig.Session.OBJECT_STATUS.FOUND:var spriteRect=spriteSheet.getFrame(sprite._currentFrame);sprite.regX=325;sprite.regY=Math.round(-spriteRect.regY+spriteRect.rect.height*0.5);sprite.y=sprite.regY-384;displayobject=sprite;break;}
displayobject.scaleX=displayobject.scaleY=0;var banner=ig.BannerPool.get(ig.Session.getObjectData(object.id,"spanish"));banner.y=ig.system.height*-0.5-100;this._bannerContainer.addChild(displayobject,banner);this._banner=banner;this._bannerObject=displayobject;this._bannerObjectId=object.id;cjs.Tween.get(banner,{override:true}).to({y:-200},800,cjs.Ease.cubicOut);cjs.Tween.get(displayobject,{override:true}).to({scaleX:1,scaleY:1},800,cjs.Ease.cubicOut);cjs.Tween.get(this,{override:true}).wait(3000).call(this.returnBannerObject,null,this);this.isBlocking=true;},collectObject:function(displayobject){this.inPlace=false;var gpt=displayobject.localToGlobal(0,0);var spriteSheet=ig.Sheets.lib["object"+ig.Session.activeObject.id];var sprite=new cjs.Sprite(spriteSheet,"color-lg").set({x:gpt.x-ig.system.width*0.5,y:gpt.y-ig.system.height*0.5,rotation:displayobject.rotation,mouseEnabled:false,mouseChildren:false});var spriteRect=spriteSheet.getFrame(sprite._currentFrame);sprite.regX=325;sprite.regY=Math.round(-spriteRect.regY+spriteRect.rect.height*0.5);var b=displayobject.getBounds();sprite.scaleX=sprite.scaleY=b.width/spriteRect.rect.width;var banner=ig.BannerPool.get(ig.Session.getObjectData(ig.Session.activeObject.id,"spanish"));banner.y=ig.system.height*-0.5-100;this._banner=banner;this._bannerObject=sprite;this._bannerObjectId=displayobject.currentAnimation;this._bannerContainer.addChild(sprite,banner);cjs.Tween.get(banner).to({y:-200},800,cjs.Ease.cubicOut);cjs.Tween.get(sprite).to({scaleX:1,scaleY:1,x:0,y:sprite.regY-384,rotation:0},800,cjs.Ease.cubicOut);cjs.Tween.get(this).wait(4000).call(this.returnBannerObject,null,this);this.isBlocking=true;},returnBannerObject:function(){if(!this._bannerObject)
return;if(ig.Session.activeObject.status===ig.Session.OBJECT_STATUS.FOUND){ig.main.game.onCollectionComplete();}
var banner=this._banner;cjs.Tween.get(banner).to({y:ig.system.height*-0.5-100},800,cjs.Ease.cubicOut);this._banner=null;var sprite=this._bannerObject;this._bannerObject=null;if(this.inPlace){cjs.Tween.get(sprite).to({scaleX:0,scaleY:0},500,cjs.Ease.cubicOut).call(this._bannerContainer.removeAllChildren,null,this._bannerContainer);}else{var spot=this.getSpotFor(this._bannerObjectId);var pt=this.objectTray.localToLocal(spot.x,spot.y,ig.LAYERS.GAME_UI);cjs.Tween.get(sprite).to({scaleX:0.3,scaleY:0.3,x:pt.x,y:pt.y},800,cjs.Ease.cubicOut).call(this._bannerContainer.removeAllChildren,null,this._bannerContainer).call(this.updatePack,null,this);}
this.inPlace=false;this.isBlocking=false;},getSpotFor:function(id){for(var i=0;i<ig.Session.questObjects.length;i++){var obj=ig.Session.questObjects[i];if(obj.id===id)
return this.traySpots[i];}
throw("Could not find spot");},updatePack:function(){var sname=ig.Session.activeObject.id;var spot=this.getSpotFor(sname);spot.scaleX=spot.scaleY=0;switch(ig.Session.activeObject.status){case ig.Session.OBJECT_STATUS.INACTIVE:return;case ig.Session.OBJECT_STATUS.ACTIVE:spot.spriteSheet=ig.Sheets.lib.ui;sname="qmark-sm";break;case ig.Session.OBJECT_STATUS.SKETCHED:spot.spriteSheet=ig.Sheets.lib["object"+ig.Session.activeObject.id];sname="sketch-sm";break;case ig.Session.OBJECT_STATUS.TRANSLATED:spot.spriteSheet=ig.Sheets.lib["object"+ig.Session.activeObject.id];sname="bw-sm";break;case ig.Session.OBJECT_STATUS.FOUND:spot.spriteSheet=ig.Sheets.lib["object"+ig.Session.activeObject.id];sname="color-sm";break;}
spot.gotoAndPlay(sname);ig.CenterReg(spot);cjs.Tween.get(spot).set({visible:true}).to({scaleX:1,scaleY:1},1500,cjs.Ease.elasticOut);},onCollectionComplete:function(){if(Math.random()>0.5){ig.InteractionControl.start("foundObject1",this.gotoCrossroads.bind(this));}else{ig.InteractionControl.start("foundObject2",this.gotoCrossroads.bind(this));}},trayMouseHandler:function(e){if(ig.Tutorials.active||ig.InteractionControl.active||ig.LAYERS.OVERLAYS.visible)
return;var btn=e.target;if(!btn)return;if(this._bannerContainer.children.length>0)
return;var ease=cjs.Ease.backOut;switch(e.type){case"click":cjs.Sound.play("sfxclick");var id=ig.Session.questObjects[btn.index].id;ig.VO.play(ig.Session.getObjectData(id,"cocoAudio"));this.showObjectBanner(btn.index,true);break;case"mouseover":cjs.Sound.play("sfxrollover");cjs.Tween.get(btn,{override:true}).to({scaleX:1.05,scaleY:1.05},200,ease);break;case"mouseout":cjs.Tween.get(btn,{override:true}).to({scaleX:1,scaleY:1},200,ease);break;case"mousedown":btn.scaleX=btn.scaleY=0.9;break;case"pressup":btn.scaleX=btn.scaleY=1;break;}},btnHandler:function(e){if(ig.Tutorials.active||ig.InteractionControl.active||ig.LAYERS.OVERLAYS.visible)
return;var btn=e.target;if(!btn)return;if(btn===this.nextBtn)
return;var ease=cjs.Ease.backOut;switch(e.type){case"click":cjs.Sound.play("sfxclick");this.handleClick(btn);break;case"mouseover":cjs.Sound.play("sfxrollover");cjs.Tween.get(btn,{override:true}).to({scaleX:1.05,scaleY:1.05},200,ease);break;case"mouseout":cjs.Tween.get(btn,{override:true}).to({scaleX:1,scaleY:1},200,ease);break;case"mousedown":btn.scaleX=btn.scaleY=0.9;break;case"pressup":btn.scaleX=btn.scaleY=1;break;}},handleClick:function(btn){switch(btn){case this.nextBtn:return;case this.mapBtn:ig.main.game.setFullPause(true);this.mapOverlay.show();break;case this.pauseBtn:ig.main.game.setFullPause(true);this.pauseOverlay.show();break;}},showUI:function(){cjs.Tween.get(this.mapBtn).to({ox:0},500,cjs.Ease.quadOut);cjs.Tween.get(this.pauseBtn).to({ox:0},500,cjs.Ease.quadOut);},update:function(){if(this._bannerObject&&ig.input.pressed("mouse")&&!cjs.Tween.hasActiveTweens(this._bannerObject)){this.returnBannerObject();}
var hw=Math.floor(ig.system.width*0.5);var hh=Math.floor(ig.system.height*0.5);this.nextBtn.y=hh-110;this.mapBtn.x=hw-60+this.mapBtn.ox;this.mapBtn.y=-hh+62;this.pauseBtn.x=-hw+60+this.pauseBtn.ox;this.pauseBtn.y=-hh+62;this.objectTray.x=-hw+8;this.objectTray.y=hh-135;},kill:function(){this.btns.removeAllEventListeners();}});});

// lib/display/view.js
ig.baked=true;ig.module('display.view').defines(function(){ig.View=ig.Class.extend({init:function(){},start:function(){this.setActive(true);},update:function(){},setActive:function(active){},kill:function(){}});});

// lib/game/views/game.js
ig.baked=true;ig.module('game.views.game').requires('game.entities.peq','game.entities.noah','game.entities.nell','game.entities.coco','game.entities.brisa','game.entities.artgirl','game.entities.neighbor','game.entities.obstacle','game.levels.park','game.levels.beach','game.levels.jungle','game.levels.country','game.minigames.drawingboard','game.minigames.bouncegame','game.ui','display.view').defines(function(){ig.View.Game=ig.View.extend({ui:null,numWrongs:0,timeUntilBrisa:30,timeInDistractor:0,timeSpentLooking:0,timeSinceLastEndHit:0,isFullPause:false,isPartialPause:false,minigame:null,minigameName:false,noah:null,nell:null,brisa:null,peq:null,waitForTutorial:false,init:function(){this.ui=new ig.GameUI();},start:function(){ig.MusicControl.set("locationLoop");this.setFullPause(false);this.setPartialPause(false);this.addWorldClickListener();if(!ig.Session.tutorials.MAIN){ig.Session.tutorials.MAIN=true;this.waitForTutorial=true;}
this.peq.setActive(false);this.brisa.setActive(false);this.coco.setActive(false);if(!ig.Session.seenSetup){this.brisa.isInIntro=true;ig.Session.seenSetup=true;ig.InteractionControl.start(ig.Session.activeQuest===ig.QUESTS.POOL?"quest1Setup":"quest2Setup",this.showNextObjectCue.bind(this));}else if(ig.Session.activeObject.status===ig.Session.OBJECT_STATUS.FOUND){ig.Session.nextItem();this.noah.pos.x=this.nell.pos.x=-300;this.coco.pos.x=2000;ig.InteractionControl.start("cocoNextItem",this.showNextObjectCue.bind(this));}else{this.ui.showUI();if(this.world.isDistractor){this.timeInDistractor=0;ig.InteractionControl.start(["distractorArrival1","distractorArrival2","distractorArrival3","distractorArrival4"].random());}else{ig.InteractionControl.start("locationArrival",this.enablePlayer.bind(this));}}},enablePlayer:function(){this.noah.active=true;},clearLevel:function(){this.ui.mapOverlay.hide(0);this.removeWorldClickListener();if(this.world){this.world.kill();}
this.world=null;this.peq=null;this.brisa=null;this.coco=null;this.nell=null;this.noah=null;if(this.minigame){this.minigame.kill();}
this.minigame=null;},buildLevel:function(){if(ig.Session.activeLocation===ig.Session.drawingBoardLocation){this.minigameName=ig.MINIGAMES.DRAWING_BOARD;this.minigame=new ig.MiniGame.DrawingBoard();}else if(ig.Session.activeLocation===ig.Session.bounceGameLocation){this.minigameName=ig.MINIGAMES.BOUNCE_GAME;this.minigame=new ig.MiniGame.BounceGame();}
switch(ig.Session.activeLocation){case ig.LOCATIONS.PARK:this.world=new ig.World.Level.Park();break;case ig.LOCATIONS.BEACH:this.world=new ig.World.Level.Beach();break;case ig.LOCATIONS.JUNGLE:this.world=new ig.World.Level.Jungle();break;case ig.LOCATIONS.COUNTRY:this.world=new ig.World.Level.Country();break;}
this.peq=this.world.spawnEntity(ig.Peq,this.world.path,-200,420);this.brisa=this.world.spawnEntity(ig.Brisa,this.world.path,2400,420);this.coco=this.world.spawnEntity(ig.Coco,this.world.path,2000,420);this.nell=this.world.spawnEntity(ig.Nell,this.world.path,-300,420);this.noah=this.world.spawnEntity(ig.Noah,this.world.path,-300,420);this.noah.active=false;if(Math.random()>0.3){this.addPeq();}},startTutorial:function(){this.noah.active=false;ig.Tutorials.start("main");},showNextObjectCue:function(){this.noah.active=true;this.ui.showObjectBanner(ig.Session.numObjectsFound);if(!this.waitForTutorial){this.ui.showUI();}},onWorldClick:function(e){var target=e.target;if(!target)return;if(this.isFullPause||ig.InteractionControl.active){return;}
if((target.name===ig.MINIGAMES.DRAWING_BOARD||target.isArtGirl)&&ig.Session.hasPlayedDrawingBoard){this.gotoMiniGame();return;}
if((target.name===ig.MINIGAMES.BOUNCE_GAME||target.isFarmer)&&ig.Session.hasPlayedBounceGame){this.gotoMiniGame();return;}
if(target.isHiddenObject){this.timeSpentLooking=0;if(target.currentAnimation===ig.Session.activeObject.id){cjs.Sound.play("sfxcorrect");ig.VO.play(ig.Session.getObjectData(target.currentAnimation,"cocoAudio"));this.collectObject();}else{ig.VO.play(ig.Session.getObjectData(target.currentAnimation,"cocoAudio"),this.wrongObject.bind(this));}}else if(target.isBrisa){this.timeSpentLooking=0;ig.InteractionControl.start("brisa",this.resume.bind(this));}else if(target.isNeighbor){this.timeSpentLooking=0;this.neighbor=target.ent;this.startNeighborHelp();}else if(target.isPeq){this.timeSpentLooking=0;ig.InteractionControl.start("peq",this.resume.bind(this));}else if(target.isAnimation){this.world.handleAnimation(target);}},startNeighborHelp:function(){this.neighbor.hideBubble();ig.InteractionControl.start("neighborStart",this.finishNeighborHelp.bind(this));},finishNeighborHelp:function(){if(!this.world.questObjectDisplayObject||this.world.questObjectDisplayObject.currentAnimation!==ig.Session.activeObject.id){var questObjectLocation=ig.Session.getCurrentObjectLocation();switch(questObjectLocation){case"park":ig.InteractionControl.start("neighborPark",this.resume.bind(this));break;case"beach":ig.InteractionControl.start("neighborBeach",this.resume.bind(this));break;case"jungle":ig.InteractionControl.start("neighborJungle",this.resume.bind(this));break;case"country":ig.InteractionControl.start("neighborCountry",this.resume.bind(this));break;}}else{var objectScreenPt=this.world.questObjectDisplayObject.localToLocal(0,0,this.world.path);if(this.neighbor.pos.x>objectScreenPt.x){ig.Session.heardToLeft++;ig.InteractionControl.start(ig.Session.heardToLeft<4?"neighborLeft":"neighborLeftShort",this.resume.bind(this));}else{ig.Session.heardToRight++;ig.InteractionControl.start(ig.Session.heardToRight<4?"neighborRight":"neighborRightShort",this.resume.bind(this));}}},collectObject:function(){ig.Session.activeObject.status=ig.Session.OBJECT_STATUS.FOUND;var questObject=this.world.questObjectDisplayObject;this.ui.collectObject(questObject);this.timeSpentLooking=0;questObject.parent.removeChild(questObject);},wrongObject:function(){ig.VO.play("nell_064");this.numWrongs++;if(this.numWrongs>2){this.numWrongs=0;this.timeSpentLooking=37;}},onCollectionComplete:function(){if(Math.random()>0.5){ig.InteractionControl.start("foundObject1",this.gotoCrossroads.bind(this));}else{ig.InteractionControl.start("foundObject2",this.gotoCrossroads.bind(this));}},gotoCrossroads:function(){this.setPartialPause(true);ig.main.gotoCrossroads();},gotoMiniGame:function(){this.setPartialPause(true);cjs.Tween.get(ig.LAYERS.BLACK).set({visible:true}).to({alpha:1},200,cjs.Ease.quadInOut).call(this.startMiniGame,null,this);},startMiniGame:function(){this.setFullPause(true);this.toggleGameLayer(false);ig.LAYERS.MINI_GAME.tickEnabled=ig.LAYERS.MINI_GAME.visible=true;this.minigame.addSelf();cjs.Tween.get(ig.LAYERS.BLACK).to({alpha:0},200,cjs.Ease.quadInOut).set({visible:false}).call(this.minigame.start,null,this.minigame);},resumeFromMiniGame:function(game){cjs.Tween.get(ig.LAYERS.BLACK).set({visible:true}).to({alpha:1},200,cjs.Ease.quadInOut).call(this.resumeMainGame,[game],this);},resumeMainGame:function(minigame){this.minigame.removeSelf();ig.LAYERS.MINI_GAME.tickEnabled=ig.LAYERS.MINI_GAME.visible=false;this.toggleGameLayer(true);this.resume();this.noah.pos.x=this.world.miniGameX+430;this.noah.dScaleX=1;this.noah.update();this.nell.pos.x=this.noah.pos.x-160;this.nell.update();this.world.cameraX=this.noah.pos.x-this.noah.cameraOffset;if(minigame===ig.MINIGAMES.BOUNCE_GAME){ig.InteractionControl.start("farmerEnd",this.resume.bind(this));}else if(minigame===ig.MINIGAMES.DRAWING_BOARD){ig.InteractionControl.start("artgirlEnd",this.resume.bind(this));}
cjs.Tween.get(ig.LAYERS.BLACK).to({alpha:0},200,cjs.Ease.quadInOut).set({visible:false});},toggleGameLayer:function(active){ig.LAYERS.GAME.tickEnabled=ig.LAYERS.GAME_UI.tickEnabled=active;ig.LAYERS.GAME.visible=ig.LAYERS.GAME_UI.visible=active;},setFullPause:function(bool){ig.LAYERS.GAME.tickChildren=!bool;this.isFullPause=bool;},setPartialPause:function(bool){this.isPartialPause=bool;},resume:function(){this.setFullPause(false);this.setPartialPause(false);},hitLevelEnd:function(){if(this.timeSinceLastEndHit>20){var data=ig.config.noninteractions.endOfLevel;ig.VO.play(data.audio);this.nell.showTimedBubble(data.bubble);}
this.timeSinceLastEndHit=0;},update:function(){if(this.world&&!this.isFullPause){ig.Tutorials.update();if(!ig.InteractionControl.active&&!this.ui.isBlocking&&this.waitForTutorial){this.waitForTutorial=false;this.ui.showUI();this.startTutorial();}
this.world.update();this.addTimers();if(this.timeSpentLooking>40){this.timeSpentLooking=0;this.displayHelp();}else if(this.timeInDistractor>20){this.timeInDistractor=0;this.showDistractorTimeout();}else if(this.timeUntilBrisa<=0){this.addBrisa();}
if(this.minigameName===ig.MINIGAMES.BOUNCE_GAME&&!ig.Session.hasPlayedBounceGame&&this.noah.pos.x>this.world.miniGameX){ig.Session.hasPlayedBounceGame=true;ig.InteractionControl.start("farmerStart",this.gotoMiniGame.bind(this));}
if(this.minigameName===ig.MINIGAMES.DRAWING_BOARD&&!ig.Session.hasPlayedDrawingBoard&&this.noah.pos.x>this.world.miniGameX){ig.Session.hasPlayedDrawingBoard=true;ig.InteractionControl.start("artgirlStart",this.gotoMiniGame.bind(this));}}
if(ig.LAYERS.MINI_GAME.tickEnabled&&ig.LAYERS.MINI_GAME.visible&&this.minigame){this.minigame.update();}
this.ui.update();},displayHelp:function(){if(this.peq._displayObject.visible||this.brisa._displayObject.visible||this.areAnyNeighborsVisible()){this.timeSpentLooking=25;return;}
var data;if(this.peq._active&&ig.Session.activeObject.status<ig.Session.OBJECT_STATUS.SKETCHED&&Math.random()>0.3){data=ig.config.noninteractions.peqtip;}else if(this.brisa._active&&ig.Session.activeObject.status<ig.Session.OBJECT_STATUS.TRANSLATED&&Math.random()>0.2){data=ig.config.noninteractions.brisatip;}else{data=ig.config.noninteractions.neighbortip;}
ig.VO.play(data.audio);this.nell.showTimedBubble(data.bubble);},addPeq:function(){if(this.peq._active||ig.Session.activeObject.status<ig.Session.OBJECT_STATUS.SKETCHED){return;}
var spot=this.world.availableCharacterSpots.random();if(spot){this.peq.showUpAt(spot);}},addBrisa:function(){if(!this.brisa._active&&ig.Session.activeObject.status<ig.Session.OBJECT_STATUS.TRANSLATED&&this.noah.pos.x<this.world.levelEndX-ig.system.width){this.brisa.doRun();}
this.timeUntilBrisa=30;},areAnyNeighborsVisible:function(){for(var i=0;i<this.world.neighbors.length;i++){var neighbor=this.world.neighbors[i];if(neighbor._displayObject.visible)
return true;}
return false;},addTimers:function(){if(this.world.isDistractor&&!ig.InteractionControl.active){this.timeInDistractor+=ig.system.tick;}else if(!this.isFullPause&&!this.isPartialPause&&!ig.InteractionControl.active&&!this.ui.isBlocking&&!this.waitForTutorial&&!this.brisa._active&&!ig.Tutorials.active){this.timeSinceLastEndHit+=ig.system.tick;this.timeSpentLooking+=ig.system.tick;if(!this.brisa._active){this.timeUntilBrisa-=ig.system.tick;}}},showDistractorTimeout:function(){var data=ig.config.noninteractions.distractorTimeout;ig.VO.play(data.audio);this.nell.showTimedBubble(data.bubble);},addWorldClickListener:function(){ig.LAYERS.GAME.on("click",this.onWorldClick,this);},removeWorldClickListener:function(){ig.LAYERS.GAME.removeAllEventListeners();},kill:function(force){if(force){this.removeWorldClickListener();this.ui.kill();ig.LAYERS.GAME.removeAllChildren();ig.LAYERS.GAME_UI.removeAllChildren();}}});});

// lib/impact/main.js
ig.baked=true;ig.module('impact.main').requires('impact.impact').defines(function(){"use strict";ig.Main=ig.Class.extend({staticInstantiate:function(){ig.main=this;return null;},update:function(event){}});});

// lib/display/preloader.js
ig.baked=true;ig.module('display.preloader').requires('impact.main').defines(function(){ig.Preloader=ig.Class.extend({queue:null,noah:null,edges:null,background:null,shown:false,_mask:null,init:function(){var layer=ig.LAYERS.PRELOADER;layer.set({mouseChildren:false,mouseEnabled:false});this._mask=new cjs.Shape(new cjs.Graphics().f("white").dc(0,0,900)).set({y:384,scaleX:0,scaleY:0});layer.mask=this._mask;var q=ig.main.preQueue;this.background=new cjs.Shape().set({regX:712,regY:384});this.background.graphics.f("#ffffd2").r(0,0,1424,768);layer.addChild(this.background);layer.addChild(new cjs.Bitmap(q.getResult("ldrEdge")).set({y:-384,regX:712,regY:66,scaleX:-1,scaleY:-1}));layer.addChild(new cjs.Bitmap(q.getResult("ldrEdge")).set({y:384,regX:712,regY:66}));layer.addChild(new cjs.Bitmap(q.getResult("ldrText")).set({y:83,regX:57}));layer.addChild(new cjs.Sprite(ig.Sheets.lib.noah,"run").set({regX:84,regY:180}));layer.addChild(new cjs.Sprite(ig.Sheets.lib.noahMouth,"run").set({regX:84,regY:180}));},show:function(callback){this.shown=true;cjs.Tween.get(this._mask).set({visible:true,tickEnabled:true},ig.LAYERS.PRELOADER).to({scaleX:1,scaleY:1},500,cjs.Ease.cubicOut).call(callback);},hide:function(){this.shown=false;cjs.Tween.get(this._mask).to({scaleX:0,scaleY:0},500,cjs.Ease.cubicIn).set({visible:false,tickEnabled:false},ig.LAYERS.PRELOADER);},update:function(){if(!this.shown||!ig.main._activeQueue)
return;this._mask.x=ig.system.width*0.5;}});});

// lib/controllers/sheets.js
ig.baked=true;ig.module('controllers.sheets').defines(function(){ig.SheetsController=ig.Class.extend({lib:{},init:function(){if(ig.Sheets!==null){console.error("You do not instantiate this class!");return;}
ig.Sheets=this;},add:function(name,image,data){data.images=[image];this.lib[name]=new createjs.SpriteSheet(data);},memory:function(){function nextPow(x){return Math.pow(2,Math.ceil(Math.log(x)/Math.log(2)));}
var totalBits=0;var totalMaxBits=0;var totalSheets=0;console.log("/////////////////////////////////////////");console.log("Calculating ig.Sheets Memory Footprint!!!");for(var key in this.lib){var ss=this.lib[key];if(!ss)continue;var img=ss._images[0];var bits=img.width*img.height*32;var maxBits=nextPow(img.width)*nextPow(img.height)*32;totalBits+=bits;totalMaxBits+=maxBits;totalSheets++;console.log(key+": "+(Math.round((bits/8/1024/1024)*100)/100)+"MB"+" : "+(Math.round((maxBits/8/1024/1024)*100)/100)+"MB");}
console.log("Total Num of Sheets: "+totalSheets);console.log("Total Estimate of Memory from Sheets: "+(Math.round((totalBits/8/1024/1024)*100)/100)+"MB");console.log("Total Max of Memory from Sheets: "+(Math.round((totalMaxBits/8/1024/1024)*100)/100)+"MB");console.log("/////////////////////////////////////////");}});ig.Sheets=null;new ig.SheetsController();});

// lib/game/views/title.js
ig.baked=true;ig.module('game.views.title').requires('display.view').defines(function(){ig.View.Title=ig.View.extend({container:null,playBtn:null,backBtn:null,questBtn1:null,questBtn2:null,bgContainer:null,elementsContainer:null,characterContainer:null,rolloverPlaying:"",init:function(){this.container=new cjs.Container().set({name:"title"});this.createBackgrounds();this.createElements();this.createCharacters();this.container.addChild(this.bgContainer,this.elementsContainer,this.characterContainer);ig.LAYERS.VIEWS.addChild(this.container);},createBackgrounds:function(){var q=ig.main.mainQueue;this.bgContainer=new cjs.Container().set({regX:712,regY:384,mouseEnabled:false,mouseChildren:false});this.bgContainer.addChild(new cjs.Bitmap(q.getResult("titleBG1")),new cjs.Bitmap(q.getResult("titleBG2")).set({x:1425}));},createElements:function(){this.elementsContainer=new cjs.Container();var sheet=ig.Sheets.lib["title"];this.playBtn=new cjs.Sprite(sheet,"PlayBtn").set({y:188,regX:85,regY:87,scaleX:0,scaleY:0,visible:false,mouseEnabled:false,cursor:"pointer"});var title=new cjs.Sprite(sheet,"Title").set({regX:424,y:-364,mouseEnabled:false});this.backBtn=new cjs.Sprite(sheet,"BackBtn").set({y:-323,regX:48,regY:45,mouseEnabled:false,cursor:"pointer"});var questTitle=new cjs.Sprite(sheet,"ChooseQuestTitle").set({regX:212,x:1424,y:-322,mouseEnabled:false});this.questBtn1=new cjs.Container().set({x:1189,mouseChildren:false,cursor:"pointer"});this.questBtn1.addChild(new cjs.Sprite(sheet,"Quest1Box").set({regX:208,regY:214}));this.questBtn1.addChild(new cjs.Sprite(sheet,"Quest1Btn").set({name:"btn",regX:150,regY:47,x:10,y:217}));this.questBtn2=new cjs.Container().set({x:1665,mouseChildren:false,cursor:"pointer"});this.questBtn2.addChild(new cjs.Sprite(sheet,"Quest2Box").set({regX:223,regY:200}));this.questBtn2.addChild(new cjs.Sprite(sheet,"Quest2Btn").set({name:"btn",regX:150,regY:47,x:-10,y:217}));this.elementsContainer.addChild(this.playBtn,this.backBtn,this.questBtn1,this.questBtn2,questTitle,title);},createCharacters:function(){this.characterContainer=new cjs.Container().set({mouseChildren:false,mouseEnabled:false});var nell=new cjs.Sprite(ig.Sheets.lib.nell,"idle").set({x:-480,y:36});var nellMouth=new cjs.Sprite(ig.Sheets.lib.nellMouth,"idle").set({x:-480,y:36});var noah=new cjs.Sprite(ig.Sheets.lib.noah,"idle").set({x:-340,y:36});var noahMouth=new cjs.Sprite(ig.Sheets.lib.noahMouth,"idle").set({x:-340,y:36});var peq=new cjs.Sprite(ig.Sheets.lib.peq,"idle").set({x:-312,y:-14});var coco=new cjs.Sprite(ig.Sheets.lib.coco,"idle").set({x:300,y:100,scaleX:-1});var brisa=new cjs.Sprite(ig.Sheets.lib.brisa,"idle").set({x:470,y:0,scaleX:-1});this.characterContainer.addChild(noah,noahMouth,peq,nell,nellMouth,coco,brisa);},start:function(){ig.VO.play(["noah_002","coco_002A"]);cjs.Tween.get(this.playBtn).set({visible:true,mouseEnabled:false}).to({scaleX:1,scaleY:1},500,cjs.Ease.backOut).set({mouseEnabled:true});this.parent();},setActive:function(active){this.playBtn.mouseEnabled=active;this.elementsContainer.on("click",this.btnHandler,this);if(ig.ua.mobile){this.elementsContainer.on("mousedown",this.btnHandler,this);this.elementsContainer.on("pressup",this.btnHandler,this);}else{this.elementsContainer.on("mouseover",this.btnHandler,this);this.elementsContainer.on("mouseout",this.btnHandler,this);}},gotoQuestSelect:function(){this.backBtn.mouseEnabled=true;cjs.Tween.get(this.bgContainer).to({x:-1425+127},1000,cjs.Ease.quadInOut);cjs.Tween.get(this.elementsContainer).to({x:-1425},1000,cjs.Ease.quadInOut);cjs.Tween.get(this.characterContainer).to({x:-1425+127},1000,cjs.Ease.quadInOut);},gotoTitle:function(){this.backBtn.mouseEnabled=false;cjs.Tween.get(this.bgContainer).to({x:0},1000,cjs.Ease.quadInOut);cjs.Tween.get(this.elementsContainer).to({x:0},1000,cjs.Ease.quadInOut);cjs.Tween.get(this.characterContainer).to({x:0},1000,cjs.Ease.quadInOut);},update:function(){this.backBtn.x=1424-ig.system.width*0.5+64;},btnHandler:function(e){var btn=e.target;if(!btn)return;var graphic=btn;if(btn===this.questBtn1||btn===this.questBtn2){graphic=btn.getChildByName("btn");}
var ease=cjs.Ease.cubicOut;switch(e.type){case"click":cjs.Sound.play("sfxclick");switch(btn){case this.playBtn:this.gotoQuestSelect();break;case this.backBtn:this.gotoTitle();break;case this.questBtn1:this.container.mouseEnabled=false;if(ig.ua.mobile){ig.VO.play(["noah_004","coco_004A"],this.gotoPool.bind(this));}else{this.gotoPool();}
break;case this.questBtn2:this.container.mouseEnabled=false;if(ig.ua.mobile){ig.VO.play(["noah_003","coco_003A"],this.gotoPicnic.bind(this));}else{this.gotoPicnic();}
break;}
break;case"mouseover":cjs.Sound.play("sfxrollover");if(btn==this.questBtn1&&this.rolloverPlaying!=="quest1"){this.rolloverPlaying="quest1";ig.VO.play(["noah_004","coco_004A"],this.endRollover.bind(this));}else if(btn==this.questBtn2&&this.rolloverPlaying!=="quest2"){this.rolloverPlaying="quest2";ig.VO.play(["noah_003","coco_003A"],this.endRollover.bind(this));}
cjs.Tween.get(graphic,{override:true}).to({scaleX:1.1,scaleY:1.1},250,ease);break;case"mouseout":cjs.Tween.get(graphic,{override:true}).to({scaleX:1,scaleY:1},250,ease);break;case"mousedown":graphic.scaleX=graphic.scaleY=0.9;break;case"pressup":graphic.scaleX=graphic.scaleY=1;break;}},endRollover:function(){this.rolloverPlaying=false;},gotoPool:function(){ig.main.gotoQuest(ig.QUESTS.POOL);},gotoPicnic:function(){ig.main.gotoQuest(ig.QUESTS.PICNIC);},kill:function(){this.elementsContainer.removeAllEventListeners();ig.LAYERS.VIEWS.removeChild(this.container);}});});

// lib/game/views/ending.js
ig.baked=true;ig.module('game.views.ending').requires('display.view').defines(function(){ig.View.Ending=ig.View.extend({container:null,skipBtn:null,init:function(){this.container=new cjs.Container().set({name:"ending",x:-712,y:-384});var Anim;if(ig.Session.activeQuest===ig.QUESTS.POOL){Anim=NoahAnims.poolending.endingpool;}else{Anim=NoahAnims.picnicending.endingpicnic;}
this.anim=new Anim().set({mouseChildren:false,framerate:24});this.anim.stop();this.anim.onAnimEnd=this.onAnimationEnd.bind(this);this.container.addChild(this.anim);ig.LAYERS.VIEWS.addChild(this.container);},start:function(){this.anim.gotoAndPlay(0);},onAnimationEnd:function(){ig.main.newGame();},kill:function(){ig.LAYERS.VIEWS.removeChild(this.container);}});});

// lib/display/overlays/crossroads-results.js
ig.baked=true;ig.module('display.overlays.crossroads-results').requires('display.overlay').defines(function(){ig.Overlay.CrossroadsResults=ig.Overlay.extend({container:null,init:function(){this.build();},start:function(){this.parent();},build:function(){this.container=new cjs.Container();this.paper=new cjs.Container();this.paper.addChild(new cjs.Bitmap(ig.main.crossroadsQueue.getResult("crossroadsEnd")).set({regX:497,regY:347}));this.movesTextbox=new cjs.BitmapText("0",ig.Sheets.lib.CROSSROADS_FONT).set({x:-114,y:34});ig.CenterReg(this.movesTextbox);this.paper.addChild(this.movesTextbox);this.timeTextbox=new cjs.BitmapText("0:00",ig.Sheets.lib.CROSSROADS_FONT).set({x:106,y:34});ig.CenterReg(this.timeTextbox);this.paper.addChild(this.timeTextbox);this.questObject=new cjs.Sprite(ig.Sheets.lib["object"+ig.Session.activeObject.id],"crossroad-lg").set({x:195,y:-132});this.paper.addChild(this.questObject);var nn=(ig.Session.numObjectsFound+1).toString();this.paper.addChild(new cjs.Sprite(ig.Sheets.lib.crossroads,"n"+nn).set({x:-314,y:-262}));var b=this.paper.getBounds();this.paper.cache(b.x,b.y,b.width,b.height);this.replayBtn=new cjs.Sprite(ig.Sheets.lib.btns,"ReplayBtn").set({x:-131,y:224,regX:130,regY:47,cursor:"pointer",name:"replay"});this.continueBtn=this.replayBtn.clone().set({x:143,name:"continue"});this.continueBtn.gotoAndStop("ContinueBtn");this.resultsBtns=new cjs.Container();this.resultsBtns.addChild(this.continueBtn,this.replayBtn);this.noah=new cjs.Sprite(ig.Sheets.lib.crossroads,"BigNoah").set({y:Math.ceil(ig.system.height*0.5-436)});this.coco=new cjs.Sprite(ig.Sheets.lib.crossroads,"BigCoco").set({y:Math.ceil(ig.system.height*0.5-307)});this.container.addChild(this.paper,this.noah,this.coco,this.resultsBtns);this.container.visible=this.container.tickEnabled=false;ig.LAYERS.OVERLAYS.addChild(this.container);},updateResults:function(moves,time){this.movesTextbox.text=moves.toString();this.timeTextbox.text=this.getTimeString(time);this.paper.updateCache();},show:function(){ig.LAYERS.OVERLAYS.tickChildren=ig.LAYERS.OVERLAYS.visible=true;this.container.visible=this.container.tickEnabled=true;this.resultsBtns.y=this.paper.y=ig.system.height;this.noah.x=-ig.system.width;this.coco.x=ig.system.width;cjs.Tween.get(this.noah).to({x:-504},800,cjs.Ease.cubicInOut);cjs.Tween.get(this.coco).to({x:275},800,cjs.Ease.cubicInOut);cjs.Tween.get(this.paper).to({y:0},600,cjs.Ease.cubicInOut);cjs.Tween.get(this.resultsBtns).to({y:0},600,cjs.Ease.cubicInOut).call(this.setListeners,[true],this);cjs.Tween.get(ig.LAYERS.OVERLAY_DIM).set({visible:true}).to({alpha:0.6},600,cjs.Ease.quadInOut);},hide:function(){this.setListeners(false);cjs.Tween.get(this.paper).to({y:ig.system.height},600,cjs.Ease.cubicIn);cjs.Tween.get(this.resultsBtns).to({y:ig.system.height},600,cjs.Ease.cubicIn);cjs.Tween.get(this.noah).to({x:-ig.system.width},500,cjs.Ease.cubicIn);cjs.Tween.get(this.coco).to({x:ig.system.width},500,cjs.Ease.cubicIn);cjs.Tween.get(ig.LAYERS.OVERLAY_DIM).to({alpha:0},700,cjs.Ease.quadInOut).set({visible:false}).set({visible:false,tickChildren:false},ig.LAYERS.OVERLAYS);},btnHandler:function(e){var btn=e.target;if(!btn)return;var ease=cjs.Ease.backOut;switch(e.type){case"click":cjs.Sound.play("sfxclick");this.handleClick(btn);break;case"mouseover":cjs.Sound.play("sfxrollover");if(btn.label)btn.label.gotoAndStop("MapLabelOver");cjs.Tween.get(btn,{override:true}).to({scaleX:1.05,scaleY:1.05},200,ease);break;case"mouseout":if(btn.label)btn.label.gotoAndStop("MapLabel");cjs.Tween.get(btn,{override:true}).to({scaleX:1,scaleY:1},200,ease);break;case"mousedown":btn.scaleX=btn.scaleY=0.9;break;case"pressup":btn.scaleX=btn.scaleY=1;break;}},handleClick:function(btn){var btnName=btn.name;switch(btnName){case"continue":ig.main.crossroadsComplete();break;case"replay":ig.ViewControl.current.restart();break;}
this.hide();},setListeners:function(active){if(active){this.resultsBtns.on("click",this.btnHandler,this);if(ig.ua.mobile){this.resultsBtns.on("mousedown",this.btnHandler,this);this.resultsBtns.on("pressup",this.btnHandler,this);}else{this.resultsBtns.on("mouseover",this.btnHandler,this);this.resultsBtns.on("mouseout",this.btnHandler,this);}}else{this.resultsBtns.removeAllEventListeners();}},getTimeString:function(seconds){var minutes=Math.floor(seconds/60);var leftovers=Math.floor(seconds%60);leftovers=leftovers.toString();leftovers=leftovers.length>1?leftovers:"0"+leftovers;return minutes+":"+leftovers;},kill:function(){ig.LAYERS.OVERLAYS.removeChild(this.container);}});});

// lib/display/overlays/crossroads-gameover.js
ig.baked=true;ig.module('display.overlays.crossroads-gameover').requires('display.overlay').defines(function(){ig.Overlay.CrossroadsGameOver=ig.Overlay.extend({container:null,init:function(){this.build();},start:function(){this.parent();},build:function(){this.container=new cjs.Container();var bg=new cjs.Sprite(ig.Sheets.lib.ui,"SmallMenuBg").set({mouseEnabled:false,regX:204,regY:236});var outOfMoves=new cjs.Sprite(ig.Sheets.lib.crossroads,"OutOfMoves").set({mouseEnabled:false,regX:142,regY:172,y:25});var tryAgainBtn=new cjs.Sprite(ig.Sheets.lib.btns,"TryAgainBtn").set({y:102,regX:130,regY:47,cursor:"pointer",name:"tryagain"});this.container.addChild(bg,outOfMoves,tryAgainBtn);this.container.visible=false;ig.LAYERS.OVERLAYS.addChild(this.container);},show:function(){ig.LAYERS.OVERLAYS.tickChildren=ig.LAYERS.OVERLAYS.visible=true;this.container.visible=true;this.container.y=ig.system.height;if(ig.ViewControl.currentID===ig.VIEWS.CROSSROADS)
cjs.Tween.get(this.container).to({y:-69},400,cjs.Ease.cubicInOut).call(this.setListeners,[true],this);else
cjs.Tween.get(this.container).to({y:0},400,cjs.Ease.cubicInOut).call(this.setListeners,[true],this);cjs.Tween.get(ig.LAYERS.OVERLAY_DIM).set({visible:true}).to({alpha:0.6},400,cjs.Ease.quadInOut);},hide:function(t){this.setListeners(false);if(isNaN(t))t=300;cjs.Tween.get(this.container).to({y:ig.system.height},t,cjs.Ease.cubicInOut).set({visible:false});cjs.Tween.get(ig.LAYERS.OVERLAY_DIM).to({alpha:0},t,cjs.Ease.quadInOut).set({visible:false}).set({visible:false,tickChildren:false},ig.LAYERS.OVERLAYS);},btnHandler:function(e){var btn=e.target;if(!btn)return;var ease=cjs.Ease.backOut;switch(e.type){case"click":cjs.Sound.play("sfxclick");this.handleClick(btn);break;case"mouseover":cjs.Sound.play("sfxrollover");if(btn.label)btn.label.gotoAndStop("MapLabelOver");cjs.Tween.get(btn,{override:true}).to({scaleX:1.05,scaleY:1.05},200,ease);break;case"mouseout":if(btn.label)btn.label.gotoAndStop("MapLabel");cjs.Tween.get(btn,{override:true}).to({scaleX:1,scaleY:1},200,ease);break;case"mousedown":btn.scaleX=btn.scaleY=0.9;break;case"pressup":btn.scaleX=btn.scaleY=1;break;}},handleClick:function(btn){var btnName=btn.name;switch(btnName){case"tryagain":this.hide();ig.ViewControl.current.restart();break;}},setListeners:function(active){if(active){this.container.on("click",this.btnHandler,this);if(ig.ua.mobile){this.container.on("mousedown",this.btnHandler,this);this.container.on("pressup",this.btnHandler,this);}else{this.container.on("mouseover",this.btnHandler,this);this.container.on("mouseout",this.btnHandler,this);}}else{this.container.removeAllEventListeners();}},kill:function(){ig.LAYERS.OVERLAYS.removeChild(this.container);}});});

// lib/game/views/crossroads.js
ig.baked=true;ig.module('game.views.crossroads').requires('display.overlays.crossroads-results','display.overlays.crossroads-gameover','display.view').defines(function(){ig.CR={};ig.View.Crossroads=ig.View.extend({container:null,_debug:null,data:null,_level:null,fuelLevels:{car:0,scooter:0,onfoot:0},noah:null,coco:null,darkScreen:null,cx:0,cy:6,ex:8,ey:2,ui:null,btns:[],arrows:[],_cVehicle:-1,popup:null,_tutorialStep:-1,statMoves:3,statTime:75,_moveChoosen:false,_paused:false,init:function(){this.build();},start:function(){var noahPip=this.noah.getChildByName("pip");cjs.Tween.get(noahPip).set({visible:true}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);var cocoPip=this.coco.getChildByName("pip");cjs.Tween.get(cocoPip).wait(100).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);if(ig.Session.tutorials.CROSSROADS){ig.VO.play("noah_134");this.startGame();}else{ig.VO.play("noah_134",this.startTutorial.bind(this));}},reset:function(){this.cx=this.data.sx;this.cy=this.data.sy;this.ex=this.data.ex;this.ey=this.data.ey;this.noah.x=314+100*this.cx;this.noah.y=71+81*this.cy;this.coco.x=314+100*this.ex;this.coco.y=71+81*this.ey;this._level=this.data.map;var vehicle=this.noah.getChildByName("vehicle");vehicle.gotoAndStop("dot");ig.CenterReg(vehicle);this.statTime=this.statMoves=0;this.hideArrows();for(var vehicleName in this.fuelLevels){this.fuelLevels[vehicleName]=ig.CR.FUELS[vehicleName];}
for(var i=0;i<3;i++){var btn=this.btns[i];btn.alpha=1;btn.visibleFuel=this.fuelLevels[btn.name];}
this.container.removeAllEventListeners();this.ui.removeAllEventListeners();this.gameActive=false;this.resume();this.restartBtn.alpha=0.5;this.restartBtn.mouseEnabled=false;},showDebug:function(){this._debug=this._debug?this._debug.removeAllChildren():new cjs.Container();for(var i=0;i<this._level.length;i++){var yArr=this._level[i];for(var j=0;j<yArr.length;j++){var value=yArr[j];this._debug.addChild(new cjs.Text(value,"20px Arial","#ff0000").set({x:314+100*j,y:71+81*i}));}}
this.container.addChild(this._debug);},startGame:function(){ig.VO.play("noah_140");this.ui.removeAllEventListeners();this.noah.removeAllEventListeners();this.restartBtn.alpha=0.5;this.restartBtn.mouseEnabled=false;this.ui.on("click",this.uiMouseHandler,this);if(ig.ua.mobile){this.ui.on("mousedown",this.uiMouseHandler,this);this.ui.on("pressup",this.uiMouseHandler,this);}else{this.ui.on("mouseover",this.uiMouseHandler,this);this.ui.on("mouseout",this.uiMouseHandler,this);}
this.noah.on("click",this.arrowMouseHandler,this);if(ig.ua.mobile){this.noah.on("mousedown",this.arrowMouseHandler,this);this.noah.on("pressup",this.arrowMouseHandler,this);}else{this.noah.on("mouseover",this.arrowMouseHandler,this);this.noah.on("mouseout",this.arrowMouseHandler,this);}},readyForNext:function(){this._moveChoosen=false;if(this.isFuelAvailable()){this.showArrows();}else{this.gameover();}},showArrows:function(){if(!this.gameActive){return;}
var fuel=this.fuelLevels[this._cVehicle.id];if(fuel<=0){switch(this._cVehicle){case ig.CR.VEHICLES.CAR:ig.VO.play("noah_144");break;case ig.CR.VEHICLES.SCOOTER:ig.VO.play("noah_145");break;case ig.CR.VEHICLES.ONFOOT:ig.VO.play("noah_146");break;}
this.hideArrows();return;}
this.hideNoah();for(var i=0;i<8;i++){var arrow=this.arrows[i];var _x=this.cx+arrow._x;var _y=this.cy+arrow._y;if(_x<0||_x>8||_y<0||_y>6){arrow.mouseEnabled=false;}else{var value=this._level[_y][_x];if(this._cVehicle===ig.CR.VEHICLES.ONFOOT&&(value===3||value===4)){if(value===3){arrow.mouseEnabled=(this.cx<_x&&this.cy>_y)||(this.cx>_x&&this.cy<_y);}else{arrow.mouseEnabled=(this.cx<_x&&this.cy<_y)||(this.cx>_x&&this.cy>_y);}}else{arrow.mouseEnabled=value<=this._cVehicle.value;}}
if(arrow.mouseEnabled)
cjs.Tween.get(arrow,{override:true}).set({visible:true,alpha:1}).to({scaleX:0.72,scaleY:0.72},250,cjs.Ease.backOut);else
cjs.Tween.get(arrow,{override:true}).to({scaleX:0,scaleY:0},100,cjs.Ease.backIn).set({visible:false});}},hideArrows:function(exception){for(var i=0;i<8;i++){var arrow=this.arrows[i];arrow.mouseEnabled=false;if(arrow===exception){continue;}
cjs.Tween.get(arrow,{override:true}).to({scaleX:0,scaleY:0},100,cjs.Ease.backIn).set({visible:false});}},hideNoah:function(){var noahPip=this.noah.getChildByName("pip");cjs.Tween.get(noahPip).to({scaleX:0,scaleY:0},100,cjs.Ease.backIn).set({visible:false});var questObject=this.noah.getChildByName("questObject");cjs.Tween.get(questObject).to({scaleX:0,scaleY:0},100,cjs.Ease.backIn).set({visible:false});},changeVehicle:function(name){if(!ig.Session.tutorials.CROSSROADS){this.stepTutorial();}
this.gameActive=true;var vehicle=this.noah.getChildByName("vehicle");vehicle.gotoAndStop(name);ig.CenterReg(vehicle);if(name==="car"){this._cVehicle=ig.CR.VEHICLES.CAR;}else if(name==="scooter"){this._cVehicle=ig.CR.VEHICLES.SCOOTER;}else if(name==="onfoot"){this._cVehicle=ig.CR.VEHICLES.ONFOOT;}
for(var i=0;i<3;i++){var btn=this.btns[i];var sprite=btn.getChildByName("image");sprite.gotoAndStop(btn.name===name?"option-"+btn.name+"-selected":"option-"+btn.name);}
vehicle.scaleX=vehicle.scaleY=0;cjs.Tween.get(vehicle).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);this.showArrows();},isFuelAvailable:function(){for(var type in this.fuelLevels){if(this.fuelLevels[type]>0){return true;}}
return false;},chooseArrow:function(arrow){this.hideArrows(arrow);this._moveChoosen=true;switch(arrow.directional){case ig.CR.VECTS.NW:ig.VO.play("coco_152");break;case ig.CR.VECTS.N:ig.VO.play("coco_150");break;case ig.CR.VECTS.NE:ig.VO.play("coco_152");break;case ig.CR.VECTS.E:ig.VO.play("coco_148");break;case ig.CR.VECTS.SE:ig.VO.play("coco_152");break;case ig.CR.VECTS.S:ig.VO.play("coco_151");break;case ig.CR.VECTS.SW:ig.VO.play("coco_152");break;case ig.CR.VECTS.W:ig.VO.play("coco_149");break;}
cjs.Tween.get(this).wait(1000).call(this.moveTo,[arrow.directional],this);},moveTo:function(direction){this.statMoves++;switch(direction){case ig.CR.VECTS.NW:this.cx-=2;this.cy-=2;break;case ig.CR.VECTS.N:this.cy-=2;break;case ig.CR.VECTS.NE:this.cx+=2;this.cy-=2;break;case ig.CR.VECTS.E:this.cx+=2;break;case ig.CR.VECTS.SE:this.cx+=2;this.cy+=2;break;case ig.CR.VECTS.S:this.cy+=2;break;case ig.CR.VECTS.SW:this.cx-=2;this.cy+=2;break;case ig.CR.VECTS.W:this.cx-=2;break;}
switch(this._cVehicle){case ig.CR.VEHICLES.CAR:cjs.Sound.play("sfxcar",{volume:0.5});break;case ig.CR.VEHICLES.SCOOTER:cjs.Sound.play("sfxscooter",{volume:0.7});break;case ig.CR.VEHICLES.ONFOOT:cjs.Sound.play("sfxfootstep",{loop:2});break;}
var speed=this._cVehicle.value*250+300;if(this.cx===this.ex&&this.cy===this.ey){this.gameActive=false;cjs.Tween.get(this.noah).wait(50+speed).call(this.win,null,this);}
this.hideArrows();this.useFuel();var noahPip=this.noah.getChildByName("pip");cjs.Tween.get(noahPip).set({visible:true}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);cjs.Tween.get(this.noah).wait(100).to({x:314+100*this.cx,y:71+81*this.cy},speed,cjs.Ease.sineInOut).call(this.readyForNext,null,this);this.restartBtn.alpha=1;this.restartBtn.mouseEnabled=true;},useFuel:function(){this.updateFuels=true;var btn=this.ui.getChildByName(this._cVehicle.id);var fuelLevel=--this.fuelLevels[btn.name];cjs.Tween.get(btn).to({visibleFuel:fuelLevel,alpha:fuelLevel<=0?0.6:1},300,cjs.Ease.linear);},pause:function(){this._paused=true;this.container.tickEnabled=false;this.ui.mouseEnabled=false;ig.main.game.ui.pauseOverlay.show();},resume:function(){this._paused=false;this.container.tickEnabled=true;this.ui.mouseEnabled=true;},restart:function(){this.reset();cjs.Tween.get(this.resultsOverlay).to({y:ig.system.height*1.5},200,cjs.Ease.cubicIn);this.start();},win:function(){ig.VO.play(["coco_154",{id:"noah_094",delay:100}]);this._paused=true;this.resultsOverlay.updateResults(this.statMoves,this.statTime);this.resultsOverlay.show();},gameover:function(){this._paused=true;this.gameoverOverlay.show();},containerClickHandler:function(){if(this.popup&&!cjs.Tween.hasActiveTweens(this.popup)&&this.popup.scaleX>0){this.hidePopup();}},uiMouseHandler:function(e){var target=e.target;if(!target)return;if(this._moveChoosen||this._paused)
return;switch(e.type){case"click":cjs.Sound.play("sfxclick");if(target===this.pauseBtn){this.pause();}else if(target===this.restartBtn){this.restart();}else if(target.isVehicleBtn){this.changeVehicle(target.name.toLowerCase());}
break;case"mouseover":cjs.Sound.play("sfxrollover");cjs.Tween.get(target,{override:true}).to({scaleX:1.1,scaleY:1.1},250,cjs.Ease.backOut);break;case"mouseout":cjs.Tween.get(target,{override:true}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);break;case"mousedown":target.scaleX=target.scaleY=0.9;break;case"pressup":target.scaleX=target.scaleY=1;break;}},arrowMouseHandler:function(e){var target=e.target;if(!target||!target.mouseEnabled)return;switch(e.type){case"click":cjs.Sound.play("sfxclick");this.chooseArrow(target);break;case"mouseover":cjs.Sound.play("sfxrollover");cjs.Tween.get(target,{override:true}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);break;case"mouseout":cjs.Tween.get(target,{override:true}).to({scaleX:0.72,scaleY:0.72},250,cjs.Ease.backOut);break;case"mousedown":target.scaleX=target.scaleY=0.9;break;case"pressup":target.scaleX=target.scaleY=1;break;}},build:function(){this.container=new cjs.Container().set({name:"crossroads"});this.container.x=-712;this.container.y=-384;this.container.addChild(new cjs.Bitmap(ig.main.crossroadsQueue.getResult("crossroadsMap")));this.noah=this.buildNoah();this.coco=this.buildCoco();this.darkScreen=new cjs.Shape().set({x:(1424-ig.system.width)/2,visible:false,alpha:0});this.darkScreen.graphics.f("#000").r(0,0,ig.system.width,ig.system.height);this.ui=this.buildUI();this.resultsOverlay=new ig.Overlay.CrossroadsResults();this.gameoverOverlay=new ig.Overlay.CrossroadsGameOver();this.container.addChild(this.coco,this.noah,this.darkScreen,this.ui);ig.LAYERS.VIEWS.addChild(this.container);this.data=ig.Session.getCrossroadsData();this.reset();},buildNoah:function(){var CROSSROADS_SHEET=ig.Sheets.lib.crossroads;var c=new cjs.Container();c.addChild(new cjs.Sprite(CROSSROADS_SHEET,"dot").set({name:"vehicle",mouseEnabled:false,regX:10,regY:10}));c.addChild(new cjs.Sprite(CROSSROADS_SHEET,"Noah").set({name:"pip",mouseEnabled:false,regX:56,regY:143,scaleX:0,scaleY:0}));c.addChild(new cjs.Sprite(ig.Sheets.lib["object"+ig.Session.activeObject.id],"crossroad-sm").set({name:"questObject",mouseEnabled:false,regX:58,regY:88}));var directions=["NW","N","NE","E","SE","S","SW","W"];for(var i=0;i<8;i++){var arrow=new cjs.Sprite(CROSSROADS_SHEET,"arrow").set({cursor:"pointer",regX:-40,regY:30,hitArea:new createjs.Shape(new cjs.Graphics().f("#000").r(0,0,200,80)).set({regY:10}),directional:ig.CR.VECTS[directions[i]],visible:false,scaleX:0,scaleY:0,rotation:225+45*i,});arrow._x=arrow.directional[0];arrow._y=arrow.directional[1];c.addChild(arrow);this.arrows.push(arrow);}
return c;},buildCoco:function(){var CROSSROADS_SHEET=ig.Sheets.lib.crossroads;var c=new cjs.Container().set({mouseChildren:false,mouseEnabled:false});c.addChild(new cjs.Sprite(CROSSROADS_SHEET,"dot").set({regX:10,regY:10}));c.addChild(new cjs.Sprite(CROSSROADS_SHEET,"Coco").set({name:"pip",regX:55,regY:145,scaleX:0,scaleY:0}));return c;},buildUI:function(){var CROSSROADS_SHEET=ig.Sheets.lib.crossroads;var c=new cjs.Container().set({x:712,y:694});c.addChild(new cjs.Bitmap(ig.main.crossroadsQueue.getResult("crossroadsBar")).set({regX:712,regY:72,mouseEnabled:false}));var vehicles=[ig.CR.VEHICLES.CAR,ig.CR.VEHICLES.SCOOTER,ig.CR.VEHICLES.ONFOOT];for(i=0;i<3;i++){var btn=new cjs.Container().set({mouseChildren:false,cursor:"pointer",vehicle:vehicles[i],name:vehicles[i].id,isVehicleBtn:true,x:255*i-255});var white=new cjs.Shape(new cjs.Graphics().f("white").r(0,0,174,20)).set({x:-88,y:18});var fill=new cjs.Shape(new cjs.Graphics().f("#98ca00").rr(0,0,184,15,2)).set({x:-93,y:20,name:"fill"});var image=new cjs.Sprite(CROSSROADS_SHEET,"option-"+btn.name).set({regX:114,regY:61,name:"image"});btn.addChild(white,fill,image);this.btns.push(btn);c.addChild(btn);}
this.pauseBtn=new cjs.Sprite(ig.Sheets.lib.btns,"PauseBtn").set({x:-440,cursor:"pointer",regX:48,regY:45});c.addChild(this.pauseBtn);this.restartBtn=new cjs.Sprite(ig.Sheets.lib.btns,"RestartBtn").set({x:440,cursor:"pointer",regX:48,regY:45});c.addChild(this.restartBtn);return c;},startTutorial:function(){this.container.on("click",this.containerClickHandler,this);cjs.Tween.get(this.darkScreen).set({visible:true}).to({alpha:0.4},500,cjs.Ease.quadInOut).call(this.stepTutorial,null,this);},stepTutorial:function(){this._tutorialStep++;switch(this._tutorialStep){case 0:ig.Session.tutorials.CROSSROADS=true;ig.VO.play("noah_136");this.popup=ig.SpeechBubblePool.getInfoBox("crossroads1",true);this.popup.set({x:-228,y:-53,scaleX:0,scaleY:0});this.ui.addChild(this.popup);cjs.Tween.get(this.popup,{override:true}).set({visible:true}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);break;case 1:this.ui.removeChild(this.popup);ig.SpeechBubblePool.putInfoBox(this.popup);ig.VO.play("noah_137");this.popup=ig.SpeechBubblePool.getInfoBox("crossroads2",true);this.popup.set({x:1,y:-57,scaleX:0,scaleY:0});this.ui.addChild(this.popup);cjs.Tween.get(this.popup,{override:true}).set({visible:true}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);break;case 2:this.ui.removeChild(this.popup);ig.SpeechBubblePool.putInfoBox(this.popup);ig.VO.play("noah_138");this.popup=ig.SpeechBubblePool.getInfoBox("crossroads3",true);this.popup.set({x:324,y:-42,scaleX:0,scaleY:0});this.ui.addChild(this.popup);cjs.Tween.get(this.popup,{override:true}).set({visible:true}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);break;case 3:this.ui.removeChild(this.popup);ig.SpeechBubblePool.putInfoBox(this.popup);cjs.Tween.get(this.darkScreen).to({alpha:0},500,cjs.Ease.quadInOut).set({visible:false}).call(this.startGame,null,this);break;case 4:ig.VO.play("noah_142");var pt=this.container.localToLocal(this.noah.x,this.noah.y,this.ui);this.popup=ig.SpeechBubblePool.getInfoBox("crossroads4",true);this.popup.set({x:pt.x+20,y:pt.y-20,scaleX:0,scaleY:0});this.ui.addChild(this.popup);cjs.Tween.get(this.popup,{override:true}).set({visible:true}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut);break;}},hidePopup:function(){cjs.Tween.get(this.popup,{override:true}).to({scaleX:0,scaleY:0},250,cjs.Ease.backIn).set({visible:false}).call(this.stepTutorial,null,this);},update:function(){if(this._paused){return;}
if(this.gameActive){this.statTime+=ig.system.tick;}
if(this.updateFuels){for(var i=0;i<3;i++){var btn=this.btns[i];var fill=btn.getChildByName("fill");var fuelPercent=btn.visibleFuel/ig.CR.FUELS[btn.name];fill.graphics.c().f("#98ca00").rr(0,0,184*fuelPercent,15,2);}}},kill:function(){this.ui.removeAllEventListeners();this.noah.removeAllEventListeners();this.container.removeAllEventListeners();ig.LAYERS.VIEWS.removeChild(this.container);}});ig.CR.FUELS={car:3,scooter:3,onfoot:3};ig.CR.VECTS={NW:[-1,-1],N:[0,-1],NE:[1,-1],E:[1,0],SE:[1,1],S:[0,1],SW:[-1,1],W:[-1,0]};ig.CR.VEHICLES={NONE:{value:0,id:"none"},CAR:{value:1,id:"car"},SCOOTER:{value:2,id:"scooter"},ONFOOT:{value:4,id:"onfoot"}};});

// lib/controllers/views.js
ig.baked=true;ig.module('controllers.views').requires('game.views.title','game.views.ending','game.views.crossroads').defines(function(){ig.ViewController=ig.Class.extend({current:null,currentID:-1,preloader:null,init:function(){if(ig.ViewControl!==null){console.error("You do not instantiate this class!");return;}
ig.ViewControl=this;},update:function(){if(this.current){this.current.update();}
if(this.preloader){this.preloader.update();}},gotoLoadScreen:function(callback){this.preloader.show(callback);},goto:function(view){if(this.preloader.shown){ig.MusicControl.fadeOut();if(this.current){this.current.kill();}
this.preloader.hide();}else if(this.current){ig.MusicControl.fadeOut();this.current.setActive(false);cjs.Tween.get(ig.LAYERS.BLACK).set({visible:true}).to({alpha:1},500,cjs.Ease.quadInOut).call(this.current.kill,null,this.current).call(this.goto,[view],this);this.current=null;return;}
this.setViewsActive(view!==ig.VIEWS.GAME);this.setGameActive(view===ig.VIEWS.GAME);this.currentID=view;switch(view){case ig.VIEWS.TITLE:ig.MusicControl.set("mainLoop");this.current=new ig.View.Title();break;case ig.VIEWS.ENDING:this.current=new ig.View.Ending();break;case ig.VIEWS.GAME:this.current=ig.main.game;break;case ig.VIEWS.CROSSROADS:ig.MusicControl.set("driveLoop");this.current=new ig.View.Crossroads();break;}
if(this.current){cjs.Tween.get(ig.LAYERS.BLACK).to({alpha:0},500,cjs.Ease.quadInOut).set({visible:false}).call(this.current.start,null,this.current);}},setViewsActive:function(active){ig.LAYERS.VIEWS.visible=ig.LAYERS.VIEWS.tickEnabled=active;},setGameActive:function(active){ig.LAYERS.GAME.visible=ig.LAYERS.GAME.tickEnabled=active;ig.LAYERS.GAME_UI.visible=ig.LAYERS.GAME_UI.tickEnabled=active;}});ig.ViewControl=null;new ig.ViewController();});

// lib/controllers/session.js
ig.baked=true;ig.module('controllers.session').defines(function(){ig.SessionController=ig.Class.extend({GOAL_TO_FIND:5,OBJECT_STATUS:{INACTIVE:0,ACTIVE:1,SKETCHED:2,TRANSLATED:3,FOUND:4},activeQuest:"",activeLocation:"",activeObject:{},numObjectsFound:0,questObjects:[],questObjectIds:[],availableDistractors:[],startLocation:"",bounceGameLocation:"",drawingBoardLocation:"",distractorLocation:"",seenSetup:false,miniGamesCompleted:[],hasPlayedBounceGame:false,hasPlayedDrawingBoard:false,heardToLeft:0,heardToRight:0,currentNeighbors:[],neighborCycle:[],specialNeighbor:{isException:true,id:"neighborD",body:"neighbor-d.png",bodyData:"neighbor-d.json",mouth:"neighbor-d-mouth.png",mouthData:"neighbor-d-mouth.json"},maps:{park:[],beach:[],jungle:[],country:[]},levelData:{park:null,beach:null,jungle:null,country:null},tutorials:{MAIN:false,CHARACTER:false,CROSSROADS:false},init:function(){if(ig.Session!==null){console.error("You do not instantiate this class!");return;}
ig.Session=this;},newData:function(quest){this.activeQuest=quest;this.activeLocation="";this.activeObject={};this.numObjectsFound=0;this.availableDistractors=[];this.startLocation="";this.bounceGameLocation="";this.drawingBoardLocation="";this.distractorLocation="";this.seenSetup=false;this.miniGamesCompleted=[];this.neighborCycle=[{id:"neighborA",body:"neighbor-a.png",bodyData:"neighbor-a.json",mouth:"neighbor-a-mouth.png",mouthData:"neighbor-a-mouth.json"},{id:"neighborB",body:"neighbor-b.png",bodyData:"neighbor-b.json",mouth:"neighbor-b-mouth.png",mouthData:"neighbor-b-mouth.json"},{id:"neighborC",body:"neighbor-c.png",bodyData:"neighbor-c.json",mouth:"neighbor-c-mouth.png",mouthData:"neighbor-c-mouth.json"}];ig.MiniGame.DrawingBoard.drawCanvas=ig.$new("canvas");ig.MiniGame.DrawingBoard.drawCanvas.width=750;ig.MiniGame.DrawingBoard.drawCanvas.height=460;this.levelData.park=ig.main.mainQueue.getResult("parkLevelData");this.levelData.beach=ig.main.mainQueue.getResult("beachLevelData");this.levelData.jungle=ig.main.mainQueue.getResult("jungleLevelData");this.levelData.country=ig.main.mainQueue.getResult("countryLevelData");this.generateObjects();this.generateMaps();ig.config.drawingboard.mobile.shuffle();ig.config.drawingboard.desktop.shuffle();this.neighborCycle.shuffle();this.activeLocation=this.startLocation=this.questObjects[0].location;this.nextItem();ig.log("Start Location is at "+this.startLocation);ig.log("Bounce Game Location is at "+this.bounceGameLocation);ig.log("Drawing Board Location is at "+this.drawingBoardLocation);},nextItem:function(){this.activeObject=this.questObjects[this.numObjectsFound];this.activeObject.status=this.OBJECT_STATUS.ACTIVE;this.setNewDistractorLocation();},addSuccess:function(){this.numObjectsFound++;},getCrossroadsData:function(){return ig.config.crossroads[this.numObjectsFound];},getCurrentObjectData:function(id){return this.activeObject.data[id];},getObjectData:function(id,prop){var objects=ig.config.quests[this.activeQuest].objects;var n=objects.length;for(var i=0;i<n;i++){if(id===objects[i].id){return objects[i][prop];}}
return null;},getActiveObjectData:function(indentifier){var prop=indentifier.substring(indentifier.indexOf(":")+1,indentifier.indexOf("}"));return this.activeObject.data[prop];},getCurrentObjectLocation:function(){return this.activeObject.location;},getCurrentObjectId:function(){return this.questObjectIds[this.numObjectsFound];},setLocation:function(location){this.activeLocation=location;this.currentNeighbors=[];if(this.activeLocation===ig.LOCATIONS.PARK){this.currentNeighbors.push(this.getNextNeighbor());this.currentNeighbors.push(this.specialNeighbor);}else{this.currentNeighbors.push(this.getNextNeighbor());this.currentNeighbors.push(this.getNextNeighbor());}},getNextNeighbor:function(){var n=this.neighborCycle.shift();this.neighborCycle.push(n);return n;},pushNeighborBack:function(n){var nIndex=this.neighborCycle.indexOf(n);if(nIndex>-1){this.neighborCycle.splice(nIndex,1);this.neighborCycle.push(n);}else{ig.log("!!! Neighbor Not Found to push back!");}},hasItemBeenFound:function(objectId){if(this.questObjectIds.indexOf(objectId)>-1){for(var i=0;i<this.questObjects.length;i++){var object=this.questObjects[i];if(object.id===objectId){return object.status===this.OBJECT_STATUS.FOUND;}}}
return false;},setNewDistractorLocation:function(){var distractor=this.getRandomLocation();while(distractor===this.distractorLocation||distractor===this.activeLocation||distractor===this.activeObject.location){distractor=this.getRandomLocation();}
this.distractorLocation=distractor;},generateObjects:function(){this.questObjects=[];this.questObjectIds=[];var tempArr=[ig.LOCATIONS.PARK,ig.LOCATIONS.BEACH,ig.LOCATIONS.JUNGLE,ig.LOCATIONS.COUNTRY];tempArr.push(tempArr.random());tempArr.shuffle();var quest=this.activeQuest;var _unusedObjects=ig.config.quests[quest].objects.slice();_unusedObjects.shuffle();_unusedObjects.shuffle();while(this.questObjectIds.length<this.GOAL_TO_FIND){for(var i=0;i<_unusedObjects.length;i++){var object=_unusedObjects[i];if(object.trayPos===this.questObjectIds.length){_unusedObjects.splice(i,1);this.questObjectIds.push(object.id);this.questObjects.push({id:object.id,location:tempArr[this.questObjects.length],status:0,data:object});break;}}}
for(var j=0;j<_unusedObjects.length;j++){var distractor=_unusedObjects[j];this.availableDistractors.push(distractor.id);}},generateMaps:function(){this.bounceGameLocation=this.getRandomLocation();this.drawingBoardLocation=this.getRandomLocation();while(this.bounceGameLocation===this.drawingBoardLocation){this.drawingBoardLocation=this.getRandomLocation();}
for(var location in this.maps){var map=this.maps[location]=ig.copy(this.levelData[location].level);var hidingSpots=[];var i=0,ii=0,nn=0,n=map.length;for(i=0;i<n;i++){var children=map[i].children;nn=children.length;for(ii=0;ii<nn;ii++){var childItem=children[ii];if(childItem.hiddenObject){hidingSpots.push(childItem);}}}
hidingSpots.shuffle();var spot,symbol,found=false;var symbolData=this.levelData[location].symbols;var questObjects=this.getObjectsIn(location);n=questObjects.length;for(i=0;i<n;i++){var objectName=questObjects[i].id;found=false;nn=hidingSpots.length;for(ii=0;ii<nn;ii++){spot=hidingSpots[ii];symbol=symbolData[spot.symbol];if(this.doesSymbolHaveAsset(symbol,objectName)){spot.hiddenObject=objectName;hidingSpots.splice(hidingSpots.indexOf(spot),1);found=true;break;}}
if(!found){throw("Failed to find location for quest item!! "+objectName);}}
var usedObjects=[];hidingSpots.shuffle();n=hidingSpots.length;for(i=0;i<n;i++){spot=hidingSpots[i];symbol=symbolData[spot.symbol];var realName;if(symbol.asset){realName=symbol.asset.slice(3);if(usedObjects.indexOf(realName)===-1&&this.availableDistractors.indexOf(realName)>-1){usedObjects.push(realName);}}else{nn=symbol.assets.length;for(ii=0;ii<nn;ii++){var asset=symbol.assets[ii];realName=asset.sprite.slice(3);if(usedObjects.indexOf(realName)===-1&&this.availableDistractors.indexOf(realName)>-1){usedObjects.push(realName);spot.hiddenObject=realName;break;}}}}}},getObjectsIn:function(location){var arr=[];for(var i=0;i<this.questObjects.length;i++){var object=this.questObjects[i];if(object.location===location){arr.push(object);}}
return arr;},doesSymbolHaveAsset:function(symbol,assetName){if(symbol.asset){return symbol.asset===assetName;}
for(var i=0;i<symbol.assets.length;i++){var asset=symbol.assets[i];if(asset.sprite==="FO-"+assetName){return true;}}
return false;},getRandomLocation:function(){return[ig.LOCATIONS.PARK,ig.LOCATIONS.BEACH,ig.LOCATIONS.JUNGLE,ig.LOCATIONS.COUNTRY].random();}});ig.Session=null;new ig.SessionController();});

// lib/controllers/music.js
ig.baked=true;ig.module('controllers.music').defines(function(){ig.MusicController=ig.Class.extend({current:null,currentID:"",init:function(){if(ig.MusicControl!==null){console.error("You do not instantiate this class!");return;}
ig.MusicControl=this;},set:function(id){if(id===this.currentID)
return;if(this.current)
this.current.stop();this.current=cjs.Sound.play(id,{loop:-1,volume:0.6});this.currentID=id;},stop:function(){this.currentID="";if(this.current)
this.current.stop();},pause:function(){if(this.current)
this.current.setPaused(true);},resume:function(){if(this.current)
this.current.setPaused(false);},fadeOut:function(){this.currentID="";if(this.current){cjs.Tween.get(this.current).to({volume:0},500);}
this.current=null;}});ig.MusicControl=null;new ig.MusicController();});

// lib/controllers/visibility.js
ig.baked=true;ig.module('controllers.visibility').defines(function(){ig.VisibilityController=ig.Class.extend({_bindedHandler:null,hidden:null,visibilitychange:null,i:0,init:function(){if(ig.Visibility!==null){console.error("You do not instantiate this class!");return;}
ig.Visibility=this;},addListeners:function(){ig.log("Visibility Listeners Active");this._bindedHandler=this.onPageVisibilityChange.bind(this);window.addEventListener("pagehide",this._bindedHandler);window.addEventListener("pageshow",this._bindedHandler);window.addEventListener('focus',this._bindedHandler);window.addEventListener('blur',this._bindedHandler);if(typeof document.hidden!=="undefined"){this.hidden="hidden";this.visibilityChange="visibilitychange";}else if(typeof document.mozHidden!=="undefined"){this.hidden="mozHidden";this.visibilityChange="mozvisibilitychange";}else if(typeof document.msHidden!=="undefined"){this.hidden="msHidden";this.visibilityChange="msvisibilitychange";}else if(typeof document.webkitHidden!=="undefined"){this.hidden="webkitHidden";this.visibilityChange="webkitvisibilitychange";}
if(this.visibilityChange&&this.hidden){document.addEventListener(this.visibilityChange,this._bindedHandler);window.addEventListener(this.visibilityChange,this._bindedHandler);}},removeListeners:function(){if(!this._bindedHandler)
return;window.removeEventListener("pagehide",this._bindedHandler);window.removeEventListener("pageshow",this._bindedHandler);window.removeEventListener('focus',this._bindedHandler);window.removeEventListener('blur',this._bindedHandler);if(this.visibilityChange&&this.hidden){document.removeEventListener(this.visibilityChange,this._bindedHandler);}},onPageVisibilityChange:function(event){if(!event)
return;switch(event.type){case this.visibilityChange:case"visibilitychange":cjs.Sound.setMute(document[this.hidden]);if(document[this.hidden]){ig.MusicControl.pause();}else{ig.MusicControl.resume();}
break;case"pagehide":case"blur":ig.MusicControl.pause();cjs.Sound.setMute(true);break;case"pageshow":case"focus":ig.MusicControl.resume();cjs.Sound.setMute(false);break;}}});ig.Visibility=null;new ig.VisibilityController();});

// lib/controllers/interaction.js
ig.baked=true;ig.module('controllers.interaction').defines(function(){ig.InteractionController=ig.Class.extend({_steps:[],_index:-1,_currentStep:null,_callback:null,_nextBtn:null,character:null,active:false,init:function(){if(ig.InteractionControl!==null){console.error("You do not instantiate this class!");return;}
ig.InteractionControl=this;},bindNextBtn:function(btn){if(this._nextBtn){this.unbindNextBtn();}
this._nextBtn=btn;this._nextBtn.on("click",this.handleNextBtn,this);},unbindNextBtn:function(){this._nextBtn.removeAllEventListeners();this._nextBtn=null;},handleNextBtn:function(e){var btn=e.target;var ease=cjs.Ease.backOut;switch(e.type){case"click":this.clearStep();break;case"mouseover":cjs.Sound.play("sfxrollover");cjs.Tween.get(btn,{override:true}).to({scaleX:1.05,scaleY:1.05},200,ease);break;case"mouseout":cjs.Tween.get(btn,{override:true}).to({scaleX:1,scaleY:1},200,ease);break;case"mousedown":btn.scaleX=btn.scaleY=0.9;break;case"pressup":btn.scaleX=btn.scaleY=1;break;}},start:function(data,callback){this.active=true;this._index=-1;this._steps=ig.config.interactions[data];this._callback=callback;this.next();},end:function(){this.active=false;cjs.Tween.get(this._nextBtn,{override:true}).set({mouseEnabled:false}).to({scaleX:0,scaleY:0},200,cjs.Ease.backIn).set({visible:false});if(this._callback)
this._callback();this._callback=null;},next:function(){this._index++;if(this._index>=this._steps.length){this.end();return;}
this._currentStep=this._steps[this._index];this.character=ig.main.game[this._currentStep.character];if(this._currentStep.audio){this._doAudio();}
if(this._currentStep.bubble){this._doBubble();cjs.Tween.get(this._nextBtn,{override:true}).set({visible:true,mouseEnabled:true}).to({scaleX:1,scaleY:1},500,cjs.Ease.backOut);}else if(this._currentStep.action){this._doAction();}else{this.next();}},clearStep:function(){ig.VO.stop();if(this.character&&this._currentStep.bubble){cjs.Tween.get(this).wait(250).call(this.next,null,this);this.character.hideBubble();}
cjs.Tween.get(this._nextBtn,{override:true}).set({mouseEnabled:false}).to({scaleX:0,scaleY:0},200,cjs.Ease.backIn).set({visible:false});},_doBubble:function(){var bubbleStr=this._currentStep.bubble;bubbleStr=bubbleStr.replace("{object:spanish}",ig.Session.getCurrentObjectData("spanish"));bubbleStr=bubbleStr.replace("{object:english}",ig.Session.getCurrentObjectData("english"));bubbleStr=bubbleStr.replace("{object:neighbor}",ig.Session.getCurrentObjectData("neighbor"));bubbleStr=bubbleStr.replace("{object:isAre}",ig.Session.getCurrentObjectData("isAre"));this.character.showBubble(bubbleStr);},_doAudio:function(){var audio=this._currentStep.audio;ig.VO.play(audio);},_doAction:function(){switch(this._currentStep.advance){case"wait":this.character.action(this._currentStep.action,true);break;default:this.character.action(this._currentStep.action);this.next();break;}}});ig.InteractionControl=null;new ig.InteractionController();});

// lib/controllers/tutorials.js
ig.baked=true;ig.module('controllers.tutorials').defines(function(){ig.TutorialsController=ig.Class.extend({active:false,_popup:null,_stepIndex:-1,_tutorialType:"",_pt:null,_check:false,init:function(){if(ig.Tutorials!==null){console.error("You do not instantiate this class!");return;}
ig.Tutorials=this;this._pt=new cjs.Point();},update:function(){if(this._tutorialType==="main"&&this._popup&&this._stepIndex<2){ig.main.game.noah._displayObject.localToLocal(88,-90,ig.LAYERS.GAME_UI,this._pt);if(ig.main.game.noah._displayObject.scaleX<0)this._pt.x+=111;this._popup.x=this._pt.x;this._popup.y=this._pt.y;}else if(this._tutorialType==="character"&&this._popup){if(this.character.speechBubble){this.character.speechBubble.localToLocal(-150,0,ig.LAYERS.GAME_UI,this._pt);this._popup.x=this._pt.x;this._popup.y=this._pt.y;}else{this.removePopup();this.end();}}
if(this._check){this.checkStatus();}},start:function(type){this.active=true;this._tutorialType=type;this._stepIndex=-1;this._stageListener=ig.main.stage.on("stagemousedown",this._handleStageClick,this);this._step();},end:function(){this.active=false;ig.main.game.noah.active=true;ig.main.game.noah.cameraFollow=true;ig.main.stage.off("stagemousedown",this._stageListener);},checkStatus:function(){if(this._tutorialType==="character")
return;var noah=ig.main.game.noah;switch(this._stepIndex){case 0:if(noah.distanceTraveled>200&&ig.VO._soundInstance.playState===cjs.Sound.PLAY_FINISHED){this._check=false;this._step();}
break;case 1:if(noah.numJumps>0&&ig.VO._soundInstance.playState===cjs.Sound.PLAY_FINISHED){this._check=false;this._step();}
break;}},_handleStageClick:function(e){if(this._popup&&this._popup.hidable){this.hidePopup();}},_step:function(){this._stepIndex++;if(this._tutorialType==="main"){this.mainTutorialStep();}else if(this._tutorialType==="character"){this.characterTutorialStep();}
if(this._popup){this._popup.set({scaleX:0,scaleY:0});ig.LAYERS.GAME_UI.addChild(this._popup);cjs.Tween.get(this._popup,{override:true}).set({visible:true}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut).set({_check:true},this);}},hidePopup:function(){cjs.Tween.get(this._popup,{override:true}).to({scaleX:0,scaleY:0},250,cjs.Ease.backIn).set({visible:false}).call(this._step,null,this);},removePopup:function(){if(this._popup&&this._popup.parent){ig.SpeechBubblePool.putInfoBox(this._popup);this._popup.parent.removeChild(this._popup);}
this._popup=null;},mainTutorialStep:function(){var noah=ig.main.game.noah;if(this._stepIndex>=0){noah.active=true;noah.cameraFollow=false;}
this.removePopup();switch(this._stepIndex){case 0:noah.distanceTraveled=0;ig.VO.play(ig.ua.mobile?"noah_028":"noah_026");this._popup=ig.SpeechBubblePool.getInfoBox(ig.ua.mobile?"walkMobile":"walkDesktop",false);this._popup.hidable=false;break;case 1:noah.numJumps=0;ig.VO.play(ig.ua.mobile?"nell_029":"nell_027");this._popup=ig.SpeechBubblePool.getInfoBox(ig.ua.mobile?"jumpMobile":"jumpDesktop",false);this._popup.hidable=false;break;case 2:ig.VO.play("noah_030");this._popup=ig.SpeechBubblePool.getInfoBox("map",true);this._popup.set({x:ig.system.width/2-120,y:ig.system.height/-2+120});this._popup.hidable=true;break;case 3:this.end();break;}},characterTutorialStep:function(){this.removePopup();switch(this._stepIndex){case 0:ig.VO.play(ig.ua.mobile?"nell_032":"nell_031");this._popup=ig.SpeechBubblePool.getInfoBox(ig.ua.mobile?"characterMobile":"characterDesktop",true);this._popup.hidable=true;break;case 1:this.end();break;}}});ig.Tutorials=null;new ig.TutorialsController();});

// lib/controllers/vo.js
ig.baked=true;ig.module('controllers.vo').defines(function(){ig.VoiceOverController=ig.Class.extend({_soundInstance:null,_sequence:[],_index:0,_callback:null,character:"",init:function(){if(ig.VO!==null){console.error("You do not instantiate this class!");return;}
ig.VO=this;},play:function(idOrSeq,callback){if(this._soundInstance){this._soundInstance.stop();}
if(typeof idOrSeq==="string"){this._sequence=[idOrSeq];}else{this._sequence=idOrSeq;}
this._index=-1;this._callback=callback;this._next();},stop:function(){if(this._soundInstance){this._soundInstance.stop();}
this._callback=null;this.character="";},_next:function(){this._index++;if(this._soundInstance){this._soundInstance.removeAllEventListeners();}
var seq=this._sequence[this._index];if(seq){var id,delay=0;if(typeof seq==="string"){id=seq;}else{id=seq.id;delay=seq.delay;}
if(id.indexOf("{object")>-1){id=ig.Session.getActiveObjectData(id);}else if(id.indexOf("{neighbor")>-1){id=ig.main.game.neighbor.data.id+"_"+id.substring(id.indexOf(":")+1,id.indexOf("}"));}
this.character=id.split("_")[0];this._soundInstance=cjs.Sound.play(id,{delay:delay});if(this._soundInstance&&this._soundInstance.playState!==cjs.Sound.PLAY_FAILED){this._soundInstance.on("complete",this._onSoundComplete,this);}else{this._next();}}else if(this._callback){this.character="";this._callback();this._callback=null;}},_onSoundComplete:function(){this.character="";this._next();}});ig.VO=null;new ig.VoiceOverController();});

// lib/pools/bubble-pool.js
ig.baked=true;ig.module('pools.bubble-pool').defines(function(){ig.SpeechBubblePoolManager=ig.Class.extend({H_PADDING:40,V_PADDING:32,_pool:[],_alerts:[],_boxes:[],_specific:{},init:function(){if(ig.SpeechBubblePool!==null){console.error("You do not instantiate this class!");return;}
ig.SpeechBubblePool=this;},build:function(){this.makeBlankBubble();this.makeBlankBubble();this.makeBlankBubble();},get:function(string){if(string==="!"){return this.getAlertBubble();}
if(this._pool.length===0){ig.log("Add Another Bubble");this.makeBlankBubble();}
var bubble=this._pool.shift();bubble.side="NA";var box=bubble.getChildByName("box");var shape=box.getChildAt(0);var bmpText=box.getChildAt(1);var data=this.parseBubbleStr(string);bmpText.updateBits(data.strings,data.fonts);var textBounds=bmpText.getBounds();var bw=textBounds.width+this.H_PADDING*2;var bh=textBounds.height+this.V_PADDING*2-6;shape.graphics.c().f("#fff").rr(0,0,bw,bh,30);box.cache(0,0,bw,bh);box.regX=bw-6;box.regY=bh+34;return bubble;},put:function(bubble){if(bubble.alert){this._alerts.push(bubble);}else{this._pool.push(bubble);}},parseBubbleStr:function(bubbleString){var strings=[];var fonts=[];var parts=bubbleString.split("|");var lineLength=0;var i=0,ii=0,nn=0,n=parts.length;for(i=0;i<n;i++){var part=parts[i].split("::");fonts.push(this._getFont(part[0]));var str=part[1];if(i===0||str.charAt(0)===""){str=this._checkCase(str);}
var words=str.split(" ");nn=words.length;str="";for(ii=0;ii<nn;ii++){var word=words[ii];if(lineLength+word.length>29){lineLength=word.length;str+="\n"+word;}else{str+=word;lineLength+=word.length+1;}
if(ii<nn-1){str+=" ";}}
strings.push(str);}
return{strings:strings,fonts:fonts};},makeBlankBubble:function(){var bubble=new cjs.Container();bubble.side="R";var tail=new cjs.Sprite(ig.Sheets.lib.ui,"SpeechBubbleTail").set({regY:40});var box=new cjs.Container();box.name="box";var roundRect=new cjs.Shape();roundRect.graphics.f("#fff").rr(0,0,100,100,30);box.addChild(roundRect);var bmpText=new cjs.BitmapTextExtended([],[]);bmpText.name="bmpText";bmpText.x=this.H_PADDING;bmpText.y=this.V_PADDING;bmpText.letterSpacing=-1;bmpText.lineHeight=33;box.addChild(bmpText);box.regX=6;box.regY=136;bubble.addChild(tail);bubble.addChild(box);box.cache(0,0,100,100);this._pool.push(bubble);},_getFont:function(code){switch(code){case"MO":return ig.Sheets.lib.MAIDEN_ORANGE;case"BS":return ig.Sheets.lib.BODEGA_SANS;}},_checkCase:function(str){if(str.charAt(0)===""){return""+str.charAt(1).toUpperCase()+str.slice(2);}else{return str.charAt(0).toUpperCase()+str.slice(1);}},getInfoBox:function(id,withXbtn){var data=ig.config.infoboxes[id];if(this._boxes.length===0){ig.log("Add Another Box");this.makeNewInfoBox();}
var box=this._boxes.shift();var cachedShapes=box.getChildAt(0);var xBtn=box.getChildAt(1);cachedShapes.removeAllChildren();var sprite=false;if(data.sprite){sprite=new cjs.Sprite(ig.Sheets.lib[data.spritesheet],data.sprite);sprite.x=data.gx;sprite.y=data.gy;}
var bmpText=new cjs.BitmapText(data.string,ig.Sheets.lib.MAIDEN_ORANGE).set({letterSpacing:-1,lineHeight:34,x:data.tx,y:data.ty});var b=bmpText.getBounds();var bw=bmpText.x+b.width+30;var bh=bmpText.y+b.height+30;if(bh<data.minHeight)
bh=data.minHeight;var poly=new cjs.Shape();var shd=new cjs.Shape().set({x:-4,y:4,alpha:0.15});if(data.tailOnTop){poly.graphics.f("#fff").mt(0,0).lt(data.tail[0],0).lt(data.tail[1],-data.tailHeight).lt(data.tail[2],0).lt(bw,0).lt(bw,bh).lt(0,bh).cp();shd.graphics.f("000").mt(0,0).lt(data.tail[0],0).lt(data.tail[1],-data.tailHeight).lt(data.tail[2],0).lt(bw,0).lt(bw,bh).lt(0,bh).cp();}else{poly.graphics.f("#fff").mt(0,0).lt(0,bh).lt(data.tail[0],bh).lt(data.tail[1],bh+data.tailHeight).lt(data.tail[2],bh).lt(bw,bh).lt(bw,0).cp();shd.graphics.f("000").mt(0,0).lt(0,bh).lt(data.tail[0],bh).lt(data.tail[1],bh+data.tailHeight).lt(data.tail[2],bh).lt(bw,bh).lt(bw,0).cp();}
cachedShapes.addChild(shd,poly,bmpText);if(sprite){cachedShapes.addChild(sprite);}
if(data.tailOnTop){cachedShapes.regX=data.tail[1];cachedShapes.regY=-data.tailHeight;cachedShapes.cache(-4,-data.tailHeight,bw,data.tailHeight+bh+4);xBtn.x=-cachedShapes.regX+bw;xBtn.y=data.tailHeight;}else{cachedShapes.regX=data.tail[1];cachedShapes.regY=bh+data.tailHeight;if(sprite&&(sprite.x<-4||sprite.y<0)){cachedShapes.cache(sprite.x,sprite.y,bw+Math.abs(sprite.x),cachedShapes.regY+4+Math.abs(sprite.y));}else{cachedShapes.cache(-4,0,bw,cachedShapes.regY+4);}
xBtn.x=-cachedShapes.regX+bw;xBtn.y=-cachedShapes.regY;}
xBtn.visible=!!withXbtn;return box;},putInfoBox:function(box){this._boxes.push(box);},makeNewInfoBox:function(){var box=new cjs.Container();var cachedShapes=new cjs.Container().set({mouseChildren:false,mouseEnabled:false});var xBtn=new cjs.Sprite(ig.Sheets.lib.btns,"xBtn").set({regX:43,regY:39,cursor:"pointer"});if(ig.ua.mobile){xBtn.on("mousedown",this.xBtnHandler,this);xBtn.on("pressup",this.xBtnHandler,this);}else{xBtn.on("mouseover",this.xBtnHandler,this);xBtn.on("mouseout",this.xBtnHandler,this);}
box.addChild(cachedShapes,xBtn);this._boxes.push(box);},xBtnHandler:function(e){var btn=e.target;if(!btn)return;var ease=cjs.Ease.backOut;switch(e.type){case"mouseover":cjs.Sound.play("sfxrollover");cjs.Tween.get(btn,{override:true}).to({scaleX:1.05,scaleY:1.05},200,ease);break;case"mouseout":cjs.Tween.get(btn,{override:true}).to({scaleX:1,scaleY:1},200,ease);break;case"mousedown":btn.scaleX=btn.scaleY=0.9;break;case"pressup":btn.scaleX=btn.scaleY=1;break;}},getAlertBubble:function(){if(this._alerts.length){return this._alerts.pop();}
var bubble=new cjs.Container();bubble.alert=true;bubble.side="R";var tail=new cjs.Sprite(ig.Sheets.lib.ui,"SpeechBubbleTail").set({regY:40});var box=new cjs.Container();box.name="box";var roundRect=new cjs.Shape();roundRect.graphics.f("#fff").rr(0,0,82,106,30);box.addChild(roundRect);var exclam=new cjs.Sprite(ig.Sheets.lib.ui,"alerticon").set({x:36,y:27});box.addChild(exclam);box.regX=6;box.regY=136;bubble.addChild(tail);bubble.addChild(box);box.cache(0,0,82,106);return bubble;}});ig.SpeechBubblePool=null;new ig.SpeechBubblePoolManager();});

// lib/pools/banner-pool.js
ig.baked=true;ig.module('pools.banner-pool').defines(function(){ig.BannerPoolManager=ig.Class.extend({_banner:null,init:function(){if(ig.BannerPool!==null){console.error("You do not instantiate this class!");return;}
ig.BannerPool=this;},build:function(){var bmpText=new cjs.BitmapText("Temp",ig.Sheets.lib["BODEGA_SANS_94"]);var textBounds=bmpText.getBounds();bmpText.regX=Math.floor(textBounds.width*0.5);bmpText.regY=48;var UI=ig.Sheets.lib["ui"];var banner=new cjs.Sprite(UI,"LongBanner");var bannerBounds=banner.getBounds();bmpText.x=Math.floor(bannerBounds.width*0.5);bmpText.y=Math.floor(bannerBounds.height*0.5);var container=new cjs.Container();container.mouseEnabled=container.mouseChildren=false;container.addChild(banner);container.addChild(bmpText);container.regX=bmpText.x;container.regY=bmpText.y;this._banner=container;},get:function(string){var bmpText=this._banner.getChildAt(1);bmpText.text=string;var textBounds=bmpText.getBounds();bmpText.regX=Math.floor(textBounds.width*0.5);var bannerImg=this._banner.getChildAt(0);if(textBounds.width>562){bannerImg.gotoAndStop("LongBanner");}else if(textBounds.width>336){bannerImg.gotoAndStop("MediumBanner");}else{bannerImg.gotoAndStop("ShortBanner");}
var bannerBounds=bannerImg.getBounds();bmpText.x=Math.floor(bannerBounds.width*0.5);bmpText.y=Math.floor(bannerBounds.height*0.5);this._banner.regX=bmpText.x;this._banner.regY=bmpText.y;return this._banner;}});ig.BannerPool=null;new ig.BannerPoolManager();});

// lib/utils/utils.js
ig.baked=true;ig.module('utils.utils').requires('impact.impact').defines(function(){"use strict";ig.CenterReg=function(bmp){var b=bmp.getBounds();bmp.regX=Math.round(b.width*0.5);bmp.regY=Math.round(b.height*0.5);};});

// lib/game/main.js
ig.baked=true;ig.module('game.main').requires('game.views.game','display.preloader','controllers.sheets','controllers.views','controllers.session','controllers.music','controllers.visibility','controllers.interaction','controllers.tutorials','controllers.vo','pools.bubble-pool','pools.banner-pool','utils.utils','impact.main').defines(function(){ig.QUESTS={POOL:"pool",PICNIC:"picnic"};ig.LOCATIONS={PARK:"park",BEACH:"beach",JUNGLE:"jungle",COUNTRY:"country"};ig.MINIGAMES={BOUNCE_GAME:"bouncegame",DRAWING_BOARD:"drawingboard"};ig.LAYERS={};ig.VIEWS={TITLE:0,QUEST_SELECT:1,GAME:2,CROSSROADS:3,ENDING:4};ig.LostAndFound=ig.Main.extend({stage:null,preQueue:null,mainQueue:null,questQueue:null,locationQueue:null,miniGameQueue:null,endingQueue:null,_activeQueue:null,isAudioLimited:false,_seenIntro:false,init:function(){ig.debug=false;this.isAudioLimited=ig.ua.mobile&&!cjs.WebAudioPlugin.isSupported();cjs.Sound.EXTENSION_MAP.mp3="mpeg";cjs.LoadQueue.loadTimeout=160000;ig.Visibility.addListeners();this.initializeCanvases();this.load();},initializeCanvases:function(){ig.log("Initialize Stages");this.stage=ig.system.addStage(new cjs.Stage("gameCanvas"));if(ig.ua.mobile&&cjs.Touch.isSupported()){cjs.Touch.enable(this.stage);this.stage.enableDOMEvents(false);this.stage.snapToPixelEnabled=true;}else{this.stage.enableMouseOver(30);}
this.stage.preventSelection=false;ig.input.initMouse(this.stage);ig.input.initKeyboard();ig.input.bind(ig.KEY.MOUSE1,'mouse');ig.input.bind(ig.KEY.LEFT_ARROW,'left');ig.input.bind(ig.KEY.UP_ARROW,'up');ig.input.bind(ig.KEY.RIGHT_ARROW,'right');ig.input.bind(ig.KEY.DOWN_ARROW,'down');ig.input.bind(ig.KEY.SPACE,'up');ig.input.bind(ig.KEY.SHIFT,'shift');if(ig.ua.mobile){this.stage.on("stagemousedown",this.doubleTapDetect,this);}},load:function(){ig.log("-----------Pre Queue------------");this.preQueue=new createjs.LoadQueue(true,ig.prefix);this.preQueue.setMaxConnections(4);this.preQueue.on("complete",this.onPreQueueComplete,this);this.preQueue.on("fileload",this.handleFileLoad,this);this.preQueue.loadManifest([{id:"ldrEdge",src:"images/loader/loader-edge.png"},{id:"ldrText",src:"images/loader/loader-text.png"},{id:"noahImage",src:"images/characters/noah.png"},{id:"noahData",src:"images/characters/noah.json"},{id:"noahMouthImage",src:"images/characters/noah-mouth.png"},{id:"noahMouthData",src:"images/characters/noah-mouth.json"}]);this.preQueue.loadFile({id:"audioSpriteData",src:"audio/vo/audiosprites.min.json"});this._activeQueue=this.preQueue;},onPreQueueComplete:function(){ig.log("^^^^^^^^^^^ Complete ^^^^^^^^^^^");this.preQueue.removeAllEventListeners();var data=this.preQueue.getResult("noahData");var img=this.preQueue.getResult("noahImage");ig.Sheets.add("noah",img,data);data=this.preQueue.getResult("noahMouthData");img=this.preQueue.getResult("noahMouthImage");ig.Sheets.add("noahMouth",img,data);this.soundData=this.preQueue.getResult("audioSpriteData");this.initLayers();this.startLoad();},doubleTapDetect:function(){var newDate=Date.now();if(newDate-this.lastDate<180){this.goFullScreen();}
this.lastDate=newDate;},startLoad:function(){this.initSound();ig.ViewControl.gotoLoadScreen(this.loadStartUpAssets.bind(this));},goFullScreen:function(){var element=document.documentElement;if(element.requestFullscreen){element.requestFullscreen();}else if(element.mozRequestFullScreen){element.mozRequestFullScreen();}else if(element.webkitRequestFullscreen){element.webkitRequestFullscreen();}else if(element.msRequestFullscreen){element.msRequestFullscreen();}},initSound:function(){ig.log("Initialize sounds");var isChrome40=navigator&&navigator.userAgent&&navigator.userAgent.match("40.0.2214.111");if(isChrome40){createjs.Sound.registerPlugins([createjs.HTMLAudioPlugin]);}else if(!cjs.Sound.initializeDefaultPlugins()){ig.log("Sound Problem!!!");return;}
cjs.Sound.alternateExtensions=["ogg","mp3"];cjs.Sound.defaultInterruptBehavior=cjs.Sound.INTERRUPT_EARLY;},initLayers:function(){ig.LAYERS.GAME=new cjs.Container().set({visible:false});ig.LAYERS.GAME_UI=new cjs.Container().set({visible:false});ig.LAYERS.MINI_GAME=new cjs.Container().set({visible:false,tickEnabled:false});ig.LAYERS.VIEWS=new cjs.Container().set({visible:false});ig.LAYERS.OVERLAYS=new cjs.Container().set({visible:false});ig.LAYERS.PRELOADER=new cjs.Container().set({visible:false});ig.LAYERS.BLACK=this.stage.addChild(new cjs.Shape()).set({regX:712,regY:384,alpha:0,visible:false});ig.LAYERS.BLACK.graphics.f("#000").r(0,0,1424,768);ig.LAYERS.OVERLAY_DIM=this.stage.addChild(new cjs.Shape()).set({regX:712,regY:384,alpha:0,visible:false});ig.LAYERS.OVERLAY_DIM.graphics.f("#000").r(0,0,1424,768);this.stage.addChild(ig.LAYERS.GAME,ig.LAYERS.GAME_UI,ig.LAYERS.MINI_GAME,ig.LAYERS.VIEWS,ig.LAYERS.OVERLAY_DIM,ig.LAYERS.OVERLAYS,ig.LAYERS.PRELOADER,ig.LAYERS.BLACK);ig.ViewControl.preloader=new ig.Preloader();if(ig.debug){ig.LAYERS.DEBUG=this.stage.addChild(new cjs.Container());var s=new cjs.Shape();s.graphics.f("#000000").r(0,0,20,14);ig.LAYERS.DEBUG.addChild(s);this.fpsTextbox=new cjs.Text("fps","11px Arial","#FFFFFF").set({x:2});ig.LAYERS.DEBUG.addChild(this.fpsTextbox);}},loadStartUpAssets:function(){ig.log("-----------Main Queue------------");this.fileLoadHandler=this.handleFileLoad.bind(this);this.mainLoadHandler=this.onStartUpAssetsComplete.bind(this);this.mainQueue=new createjs.LoadQueue(true,ig.prefix);this.mainQueue.stopOnError=true;this.mainQueue.setMaxConnections(4);this.mainQueue.installPlugin(cjs.Sound);this.mainQueue.addEventListener("fileload",this.fileLoadHandler);this.mainQueue.addEventListener("error",function(e){ig.log(e);});this.addVOToManifest(this.mainQueue,"distractor-vo");this.addVOToManifest(this.mainQueue,"scroller-vo");this.addVOToManifest(this.mainQueue,"title-vo");this.mainQueue.addEventListener("complete",this.mainLoadHandler);this.mainQueue.loadManifest({path:"leveldata/",manifest:[{id:"parkLevelData",src:"park.json"},{id:"beachLevelData",src:"beach.json"},{id:"jungleLevelData",src:"jungle.json"},{id:"countryLevelData",src:"country.json"}]});this.mainQueue.loadManifest({path:"images/title/",manifest:[{id:"titleBG1",src:"title-bg1.jpg"},{id:"titleBG2",src:"title-bg2.jpg"},{id:"titleSheet",src:"titlesheet.png"},{id:"titleSheetData",src:"titlesheet.json"}]});this.mainQueue.loadManifest({path:"images/ui/",manifest:[{id:"uiSheet",src:"ui.png"},{id:"uiSheetData",src:"ui.json"},{id:"btnsSheet",src:"btns.png"},{id:"btnsSheetData",src:"btns.json"},{id:"map",src:"map.png"},{id:"quickHelp",src:ig.ua.mobile?"mobile-help.png":"desktop-help.png"}]});this.mainQueue.loadManifest({path:"fonts/",manifest:[{id:"maidenorangeSheet",src:"maidenorange.png"},{id:"maidenorangeData",src:"maidenorange.json"},{id:"bodegasansSheet",src:"bodegasans.png"},{id:"bodegasansData",src:"bodegasans.json"},{id:"bodegasans94Sheet",src:"bodegasans94.png"},{id:"bodegasans94Data",src:"bodegasans94.json"},{id:"bounceGameFontSheet",src:"bouncegame-font.png"},{id:"bounceGameFontData",src:"bouncegame-font.json"},]});this.mainQueue.loadManifest({path:"images/characters/",manifest:[{id:"nellImage",src:"nell.png"},{id:"nellData",src:"nell.json"},{id:"nellMouthImage",src:"nell-mouth.png"},{id:"nellMouthData",src:"nell-mouth.json"},{id:"noahTrampImage",src:"noah-tramp.png"},{id:"noahTrampData",src:"noah-tramp.json"},{id:"brisaImage",src:"brisa.png"},{id:"brisaData",src:"brisa.json"},{id:"peqImage",src:"peq.png"},{id:"peqData",src:"peq.json"},{id:"cocoImage",src:"coco.png"},{id:"cocoData",src:"coco.json"},{id:"artGirlImage",src:"artgirl.png"},{id:"artGirlData",src:"artgirl.json"}]});this.mainQueue.loadManifest({path:"images/bouncegame/",manifest:[{id:"bounceGameImage",src:"bouncegame.png"},{id:"bounceGameData",src:"bouncegame.json"},{id:"splatsImage",src:"splats.png"},{id:"splatsData",src:"splats.json"}]});this.mainQueue.loadManifest({path:"images/drawingboard/",manifest:[{id:"drawingboardSheetImage",src:"drawingboard.png"},{id:"drawingboardSheetData",src:"drawingboard.json"},{id:"drawingBoardMask",src:"drawingboard-mask.png"}]});this.mainQueue.loadManifest({path:"animations/",manifest:[{id:"bounceGameAnims",src:"bouncegame.js"}]});this.mainQueue.loadManifest({path:"audio/sfx/",manifest:[{id:"sfxcar",src:"sfxcar.ogg"},{id:"sfxclick",src:"sfxclick.ogg"},{id:"sfxcorrect",src:"sfxcorrect.ogg"},{id:"sfxfootstep",src:"sfxfootstep.ogg"},{id:"sfxjump",src:"sfxjump.ogg"},{id:"sfxrollover",src:"sfxrollover.ogg"},{id:"sfxscooter",src:"sfxscooter.ogg"},{id:"sfxtrampolinebounce",src:"sfxtrampolinebounce.ogg"},{id:"sfxtrampolinecatch",src:"sfxtrampolinecatch.ogg"},{id:"sfxtrampolinesplat",src:"sfxtrampolinesplat.ogg"},{id:"sfx_bullsnort",src:"sfx_bullsnort.ogg"},{id:"sfx_croc",src:"sfx_croc.ogg"},{id:"sfx_elephant",src:"sfx_elephant.ogg"},{id:"sfx_monkey2",src:"sfx_monkey2.ogg"},{id:"sfx_monkey3",src:"sfx_monkey3.ogg"},{id:"sfx_birdfly",src:"sfx_birdfly.ogg"},{id:"sfx_peqtada",src:"sfx_peqtada.ogg"},{id:"sfx_burp",src:"sfx_burp.ogg"},{id:"sfx_thud",src:"sfx_thud.ogg"},{id:"sfx_whoosh",src:"sfx_whoosh.ogg"},{id:"sfx_dustscuff",src:"sfx_dustscuff.ogg"},{id:"sfx_splash",src:"sfx_splash.ogg"}]});this.mainQueue.loadFile({id:"mainLoop",src:"audio/music/main-loop.ogg"});this._activeQueue=this.mainQueue;},onStartUpAssetsComplete:function(){ig.log("^^^^^^^^^^^ Complete ^^^^^^^^^^^");this.mainQueue.removeEventListener("fileload",this.fileLoadHandler);this.mainQueue.removeEventListener("complete",this.mainLoadHandler);this.mainLoadHandler=null;var data=this.mainQueue.getResult("titleSheetData");img=this.mainQueue.getResult("titleSheet");ig.Sheets.add("title",img,data);data=this.mainQueue.getResult("uiSheetData");img=this.mainQueue.getResult("uiSheet");ig.Sheets.add("ui",img,data);data=this.mainQueue.getResult("btnsSheetData");img=this.mainQueue.getResult("btnsSheet");ig.Sheets.add("btns",img,data);data=this.mainQueue.getResult("nellData");img=this.mainQueue.getResult("nellImage");ig.Sheets.add("nell",img,data);data=this.mainQueue.getResult("noahTrampData");img=this.mainQueue.getResult("noahTrampImage");ig.Sheets.add("noahTramp",img,data);data=this.mainQueue.getResult("nellMouthData");img=this.mainQueue.getResult("nellMouthImage");ig.Sheets.add("nellMouth",img,data);data=this.mainQueue.getResult("brisaData");img=this.mainQueue.getResult("brisaImage");ig.Sheets.add("brisa",img,data);data=this.mainQueue.getResult("peqData");img=this.mainQueue.getResult("peqImage");ig.Sheets.add("peq",img,data);data=this.mainQueue.getResult("cocoData");img=this.mainQueue.getResult("cocoImage");ig.Sheets.add("coco",img,data);data=this.mainQueue.getResult("artGirlData");img=this.mainQueue.getResult("artGirlImage");ig.Sheets.add("artGirl",img,data);data=this.mainQueue.getResult("drawingboardSheetData");img=this.mainQueue.getResult("drawingboardSheetImage");ig.Sheets.add("drawingboard",img,data);data=this.mainQueue.getResult("bounceGameData");img=this.mainQueue.getResult("bounceGameImage");ig.Sheets.add("bouncegame",img,data);data=this.mainQueue.getResult("splatsData");img=this.mainQueue.getResult("splatsImage");ig.Sheets.add("splats",img,data);data=this.mainQueue.getResult("maidenorangeData");img=this.mainQueue.getResult("maidenorangeSheet");ig.Sheets.add("MAIDEN_ORANGE",img,data);data=this.mainQueue.getResult("bounceGameFontData");img=this.mainQueue.getResult("bounceGameFontSheet");ig.Sheets.add("BOUNCE_FONT",img,data);data=this.mainQueue.getResult("bodegasansData");img=this.mainQueue.getResult("bodegasansSheet");ig.Sheets.add("BODEGA_SANS",img,data);ig.Sheets.lib.BODEGA_SANS.yOffset=-3;data=this.mainQueue.getResult("bodegasans94Data");img=this.mainQueue.getResult("bodegasans94Sheet");ig.Sheets.add("BODEGA_SANS_94",img,data);ig.Sheets.lib.BODEGA_SANS_94.yOffset=-3;ig.SpeechBubblePool.build();ig.BannerPool.build();this.startExperience();},startExperience:function(){ig.log("Start Experience");ig.ViewControl.goto(ig.VIEWS.TITLE);},newGame:function(){if(this.game){this.game.kill(true);}
this.startExperience();},gotoQuest:function(id){ig.Session.newData(id);ig.ViewControl.gotoLoadScreen(this.loadQuest.bind(this));},loadQuest:function(){ig.log("-----------Quest Queue------------");var q=this.questQueue=new createjs.LoadQueue(true,ig.prefix);q.setMaxConnections(4);q.installPlugin(cjs.Sound);q.on("fileload",this.handleFileLoad,this);q.on("complete",this.onQuestAssetsComplete,this);var quest=ig.Session.activeQuest;q.loadManifest({path:"images/quests/",manifest:[{id:"questImages",src:quest+"-ingame.png"},{id:"questImagesData",src:quest+"-ingame.json"}]});if(quest===ig.QUESTS.POOL){this.addVOToManifest(q,"poolquest-vo");}else{this.addVOToManifest(q,"picnicquest-vo");}
for(var i=0;i<5;i++){var objectName=ig.Session.questObjectIds[i];q.loadFile({id:objectName+"Image",src:"images/objects/"+objectName+".png"});q.loadFile({id:objectName+"Data",src:"images/objects/"+objectName+".json"});}},onQuestAssetsComplete:function(){ig.log("^^^^^^^^^^^ Complete ^^^^^^^^^^^");this.questQueue.removeAllEventListeners();var data=this.questQueue.getResult("questImagesData");var img=this.questQueue.getResult("questImages");ig.Sheets.add("quest",img,data);for(var i=0;i<5;i++){var objectName=ig.Session.questObjectIds[i];data=this.questQueue.getResult(objectName+"Data");img=this.questQueue.getResult(objectName+"Image");ig.Sheets.add("object"+objectName,img,data);}
this.game=new ig.View.Game();this.gotoLocation(ig.Session.startLocation);},loadLocation:function(){ig.log("-----------Location Queue------------");this.game.clearLevel();var location=ig.Session.activeLocation;var q=this.locationQueue=new createjs.LoadQueue(true,ig.prefix);q.setMaxConnections(4);q.installPlugin(cjs.Sound);q.on("fileload",this.handleFileLoad,this);q.on("complete",this.onLocationAssetsComplete,this);q.loadManifest([{id:"locationImages",src:"images/levels/"+location+"/scenery.png"},{id:"locationImagesData",src:"images/levels/"+location+"/scenery.json"},{id:"locationAnimations",src:"animations/"+location+".js"},{id:"locationLoop",src:"audio/music/"+location+"-loop.ogg"}]);for(var i=0;i<ig.Session.currentNeighbors.length;i++){var neighbor=ig.Session.currentNeighbors[i];q.loadManifest({path:"images/characters/",manifest:[{id:neighbor.id+"Image",src:neighbor.body},{id:neighbor.id+"Data",src:neighbor.bodyData},{id:neighbor.id+"MouthImage",src:neighbor.mouth},{id:neighbor.id+"MouthData",src:neighbor.mouthData}]});}
if(ig.Session.drawingBoardLocation===location){this.addVOToManifest(q,"drawingboard-vo");q.loadFile({id:"drawingBoardBackground",src:"images/levels/"+location+"/drawing-board.jpg"});}else if(ig.Session.bounceGameLocation===location){this.addVOToManifest(this.mainQueue,"trampolinegame-vo");q.loadFile({id:"bounceGameBackground",src:"images/levels/"+location+"/bouncegame-background.jpg"});}},onLocationAssetsComplete:function(){ig.log("^^^^^^^^^^^ Complete ^^^^^^^^^^^");this.locationQueue.removeAllEventListeners();var data=this.locationQueue.getResult("locationImagesData");var img=this.locationQueue.getResult("locationImages");ig.Sheets.add("location",img,data);for(var i=0;i<ig.Session.currentNeighbors.length;i++){var neighbor=ig.Session.currentNeighbors[i];data=this.locationQueue.getResult(neighbor.id+"Data");img=this.locationQueue.getResult(neighbor.id+"Image");ig.Sheets.add(neighbor.id+"Body",img,data);data=this.locationQueue.getResult(neighbor.id+"MouthData");img=this.locationQueue.getResult(neighbor.id+"MouthImage");ig.Sheets.add(neighbor.id+"Mouth",img,data);}
this.game.buildLevel();ig.ViewControl.goto(ig.VIEWS.GAME);},loadCrossroads:function(){ig.log("-----------Crossroads Queue------------");var q=this.crossroadsQueue=new createjs.LoadQueue(true,ig.prefix);q.setMaxConnections(4);q.installPlugin(cjs.Sound);q.on("fileload",this.handleFileLoad,this);q.on("complete",this.onCrossroadsAssetsComplete,this);q.loadManifest([{id:"driveLoop",src:"audio/music/crossroads-loop.ogg"},{id:"crossroadsFontSheet",src:"fonts/crossroads-font.png"},{id:"crossroadsFontData",src:"fonts/crossroads-font.json"},{id:"crossroadsImage",src:"images/crossroads/crossroads.png"},{id:"crossroadsData",src:"images/crossroads/crossroads.json"},{id:"crossroadsBar",src:"images/crossroads/crossroads-bar.png"},{id:"crossroadsEnd",src:"images/crossroads/crossroads-end.png"}]);this.addVOToManifest(q,"crossroads-vo");var crossroadsData=ig.Session.getCrossroadsData();q.loadFile({id:"crossroadsMap",src:"images/crossroads/"+crossroadsData.image});},onCrossroadsAssetsComplete:function(){ig.log("^^^^^^^^^^^ Complete ^^^^^^^^^^^");this.crossroadsQueue.removeAllEventListeners();var data=this.crossroadsQueue.getResult("crossroadsData");var img=this.crossroadsQueue.getResult("crossroadsImage");ig.Sheets.add("crossroads",img,data);data=this.crossroadsQueue.getResult("crossroadsFontData");img=this.crossroadsQueue.getResult("crossroadsFontSheet");ig.Sheets.add("CROSSROADS_FONT",img,data);ig.ViewControl.goto(ig.VIEWS.CROSSROADS);},startGame:function(){ig.ViewControl.goto(ig.VIEWS.GAME);},gotoLocation:function(location){ig.Session.setLocation(location);ig.ViewControl.gotoLoadScreen(this.loadLocation.bind(this));},gotoCrossroads:function(){ig.ViewControl.gotoLoadScreen(this.loadCrossroads.bind(this));},gotoEnding:function(){ig.ViewControl.gotoLoadScreen(this.loadEnding.bind(this));},crossroadsComplete:function(){ig.VO.stop();ig.Session.addSuccess();if(ig.Session.numObjectsFound>=5){this.gotoEnding();}else{this.gotoLocation(ig.Session.activeLocation);}},loadEnding:function(){ig.log("-----------Ending Queue------------");var quest=ig.Session.activeQuest;var q=this.endingQueue=new createjs.LoadQueue(true,ig.prefix);q.setMaxConnections(4);q.installPlugin(cjs.Sound);q.on("fileload",this.handleFileLoad,this);q.on("complete",this.onEndingAssetsComplete,this);q.loadManifest([{id:"endingAnims",src:"animations/ending-"+quest+".js"},{id:"endingSheet",src:"images/endings/"+quest+".png"},{id:"endingSheetData",src:"images/endings/"+quest+".json"},{id:"endingBackground",src:"images/endings/"+quest+"background.jpg"}]);if(quest===ig.QUESTS.POOL){this.addVOToManifest(q,"poolending-vo");}else{this.addVOToManifest(q,"picnicoutro-vo");}},onEndingAssetsComplete:function(){ig.log("^^^^^^^^^^^ Complete ^^^^^^^^^^^");this.endingQueue.removeAllEventListeners();var data=this.endingQueue.getResult("endingSheetData");var img=this.endingQueue.getResult("endingSheet");ig.Sheets.add("ending",img,data);ig.ViewControl.goto(ig.VIEWS.ENDING);},update:function(){if(ig.debug&&this.fpsTextbox){this.fpsTextbox.text=Math.round(cjs.Ticker.getMeasuredFPS());}
if(ig.ViewControl){ig.ViewControl.update();}
if(ig.LAYERS.BLACK){ig.LAYERS.BLACK.x=ig.LAYERS.OVERLAY_DIM.x=ig.LAYERS.OVERLAYS.x=ig.LAYERS.VIEWS.x=ig.LAYERS.PRELOADER.x=ig.LAYERS.GAME_UI.x=ig.system.width*0.5;ig.LAYERS.BLACK.y=ig.LAYERS.OVERLAY_DIM.y=ig.LAYERS.OVERLAYS.y=ig.LAYERS.VIEWS.y=ig.LAYERS.PRELOADER.y=ig.LAYERS.GAME_UI.y=ig.system.height*0.5;}
if(ig.LAYERS.MINI_GAME&&ig.LAYERS.MINI_GAME.visible){ig.LAYERS.MINI_GAME.x=(1424-ig.system.width)/-2;}},addVOToManifest:function(queue,key){var sData=this.soundData[key];queue.loadManifest([{src:"audio/vo/"+sData.urls[0],data:{channels:1,audioSprite:sData.audioSprite}}]);},handleFileLoad:function(e){var item=e.item;ig.log("Loaded: "+item.src);}});ig.deploy=function(mediaPath,width,height){ig.prefix=mediaPath||"";ig.main(ig.LostAndFound,60,width,height);};});